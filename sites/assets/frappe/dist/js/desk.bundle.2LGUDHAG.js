(()=>{var op=Object.create;var Bi=Object.defineProperty,ap=Object.defineProperties,sp=Object.getOwnPropertyDescriptor,lp=Object.getOwnPropertyDescriptors,cp=Object.getOwnPropertyNames,va=Object.getOwnPropertySymbols,up=Object.getPrototypeOf,ya=Object.prototype.hasOwnProperty,dp=Object.prototype.propertyIsEnumerable;var ba=(r,t,e)=>t in r?Bi(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,lt=(r,t)=>{for(var e in t||(t={}))ya.call(t,e)&&ba(r,e,t[e]);if(va)for(var e of va(t))dp.call(t,e)&&ba(r,e,t[e]);return r},Ht=(r,t)=>ap(r,lp(t));var ti=(r=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(r,{get:(t,e)=>(typeof require!="undefined"?require:t)[e]}):r)(function(r){if(typeof require!="undefined")return require.apply(this,arguments);throw new Error('Dynamic require of "'+r+'" is not supported')});var ye=(r,t)=>()=>(t||r((t={exports:{}}).exports,t),t.exports),fp=(r,t)=>{for(var e in t)Bi(r,e,{get:t[e],enumerable:!0})},pp=(r,t,e,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of cp(t))!ya.call(r,n)&&n!==e&&Bi(r,n,{get:()=>t[n],enumerable:!(i=sp(t,n))||i.enumerable});return r};var Vt=(r,t,e)=>(e=r!=null?op(up(r)):{},pp(t||!r||!r.__esModule?Bi(e,"default",{value:r,enumerable:!0}):e,r));var ts=ye(($3,es)=>{"use strict";var Za=Array.isArray,Qa=Object.keys,Fp=Object.prototype.hasOwnProperty;es.exports=function r(t,e){if(t===e)return!0;if(t&&e&&typeof t=="object"&&typeof e=="object"){var i=Za(t),n=Za(e),o,a,s;if(i&&n){if(a=t.length,a!=e.length)return!1;for(o=a;o--!==0;)if(!r(t[o],e[o]))return!1;return!0}if(i!=n)return!1;var l=t instanceof Date,u=e instanceof Date;if(l!=u)return!1;if(l&&u)return t.getTime()==e.getTime();var c=t instanceof RegExp,h=e instanceof RegExp;if(c!=h)return!1;if(c&&h)return t.toString()==e.toString();var p=Qa(t);if(a=p.length,a!==Qa(e).length)return!1;for(o=a;o--!==0;)if(!Fp.call(e,p[o]))return!1;for(o=a;o--!==0;)if(s=p[o],!r(t[s],e[s]))return!1;return!0}return t!==t&&e!==e}});var is=ye((R3,rs)=>{function Hp(){this.__data__=[],this.size=0}rs.exports=Hp});var no=ye((L3,ns)=>{function qp(r,t){return r===t||r!==r&&t!==t}ns.exports=qp});var ui=ye((B3,os)=>{var Up=no();function Wp(r,t){for(var e=r.length;e--;)if(Up(r[e][0],t))return e;return-1}os.exports=Wp});var ss=ye((I3,as)=>{var Vp=ui(),Yp=Array.prototype,Gp=Yp.splice;function Xp(r){var t=this.__data__,e=Vp(t,r);if(e<0)return!1;var i=t.length-1;return e==i?t.pop():Gp.call(t,e,1),--this.size,!0}as.exports=Xp});var cs=ye((M3,ls)=>{var Kp=ui();function Jp(r){var t=this.__data__,e=Kp(t,r);return e<0?void 0:t[e][1]}ls.exports=Jp});var ds=ye((N3,us)=>{var Zp=ui();function Qp(r){return Zp(this.__data__,r)>-1}us.exports=Qp});var ps=ye((P3,fs)=>{var eh=ui();function th(r,t){var e=this.__data__,i=eh(e,r);return i<0?(++this.size,e.push([r,t])):e[i][1]=t,this}fs.exports=th});var di=ye((D3,hs)=>{var rh=is(),ih=ss(),nh=cs(),oh=ds(),ah=ps();function Mr(r){var t=-1,e=r==null?0:r.length;for(this.clear();++t<e;){var i=r[t];this.set(i[0],i[1])}}Mr.prototype.clear=rh;Mr.prototype.delete=ih;Mr.prototype.get=nh;Mr.prototype.has=oh;Mr.prototype.set=ah;hs.exports=Mr});var ms=ye((j3,_s)=>{var sh=di();function lh(){this.__data__=new sh,this.size=0}_s.exports=lh});var vs=ye((z3,gs)=>{function ch(r){var t=this.__data__,e=t.delete(r);return this.size=t.size,e}gs.exports=ch});var ys=ye((F3,bs)=>{function uh(r){return this.__data__.get(r)}bs.exports=uh});var ks=ye((H3,ws)=>{function dh(r){return this.__data__.has(r)}ws.exports=dh});var oo=ye((q3,xs)=>{var fh=typeof global=="object"&&global&&global.Object===Object&&global;xs.exports=fh});var lr=ye((U3,Cs)=>{var ph=oo(),hh=typeof self=="object"&&self&&self.Object===Object&&self,_h=ph||hh||Function("return this")();Cs.exports=_h});var Vi=ye((W3,Ss)=>{var mh=lr(),gh=mh.Symbol;Ss.exports=gh});var $s=ye((V3,As)=>{var Ts=Vi(),Es=Object.prototype,vh=Es.hasOwnProperty,bh=Es.toString,fi=Ts?Ts.toStringTag:void 0;function yh(r){var t=vh.call(r,fi),e=r[fi];try{r[fi]=void 0;var i=!0}catch(o){}var n=bh.call(r);return i&&(t?r[fi]=e:delete r[fi]),n}As.exports=yh});var Rs=ye((Y3,Os)=>{var wh=Object.prototype,kh=wh.toString;function xh(r){return kh.call(r)}Os.exports=xh});var pi=ye((G3,Is)=>{var Ls=Vi(),Ch=$s(),Sh=Rs(),Th="[object Null]",Eh="[object Undefined]",Bs=Ls?Ls.toStringTag:void 0;function Ah(r){return r==null?r===void 0?Eh:Th:Bs&&Bs in Object(r)?Ch(r):Sh(r)}Is.exports=Ah});var Nr=ye((X3,Ms)=>{function $h(r){var t=typeof r;return r!=null&&(t=="object"||t=="function")}Ms.exports=$h});var ao=ye((K3,Ns)=>{var Oh=pi(),Rh=Nr(),Lh="[object AsyncFunction]",Bh="[object Function]",Ih="[object GeneratorFunction]",Mh="[object Proxy]";function Nh(r){if(!Rh(r))return!1;var t=Oh(r);return t==Bh||t==Ih||t==Lh||t==Mh}Ns.exports=Nh});var Ds=ye((J3,Ps)=>{var Ph=lr(),Dh=Ph["__core-js_shared__"];Ps.exports=Dh});var Fs=ye((Z3,zs)=>{var so=Ds(),js=function(){var r=/[^.]+$/.exec(so&&so.keys&&so.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}();function jh(r){return!!js&&js in r}zs.exports=jh});var lo=ye((Q3,Hs)=>{var zh=Function.prototype,Fh=zh.toString;function Hh(r){if(r!=null){try{return Fh.call(r)}catch(t){}try{return r+""}catch(t){}}return""}Hs.exports=Hh});var Us=ye((e2,qs)=>{var qh=ao(),Uh=Fs(),Wh=Nr(),Vh=lo(),Yh=/[\\^$.*+?()[\]{}|]/g,Gh=/^\[object .+?Constructor\]$/,Xh=Function.prototype,Kh=Object.prototype,Jh=Xh.toString,Zh=Kh.hasOwnProperty,Qh=RegExp("^"+Jh.call(Zh).replace(Yh,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function e_(r){if(!Wh(r)||Uh(r))return!1;var t=qh(r)?Qh:Gh;return t.test(Vh(r))}qs.exports=e_});var Vs=ye((t2,Ws)=>{function t_(r,t){return r==null?void 0:r[t]}Ws.exports=t_});var yr=ye((r2,Ys)=>{var r_=Us(),i_=Vs();function n_(r,t){var e=i_(r,t);return r_(e)?e:void 0}Ys.exports=n_});var Yi=ye((i2,Gs)=>{var o_=yr(),a_=lr(),s_=o_(a_,"Map");Gs.exports=s_});var hi=ye((n2,Xs)=>{var l_=yr(),c_=l_(Object,"create");Xs.exports=c_});var Zs=ye((o2,Js)=>{var Ks=hi();function u_(){this.__data__=Ks?Ks(null):{},this.size=0}Js.exports=u_});var el=ye((a2,Qs)=>{function d_(r){var t=this.has(r)&&delete this.__data__[r];return this.size-=t?1:0,t}Qs.exports=d_});var rl=ye((s2,tl)=>{var f_=hi(),p_="__lodash_hash_undefined__",h_=Object.prototype,m_=h_.hasOwnProperty;function g_(r){var t=this.__data__;if(f_){var e=t[r];return e===p_?void 0:e}return m_.call(t,r)?t[r]:void 0}tl.exports=g_});var nl=ye((l2,il)=>{var v_=hi(),b_=Object.prototype,y_=b_.hasOwnProperty;function w_(r){var t=this.__data__;return v_?t[r]!==void 0:y_.call(t,r)}il.exports=w_});var al=ye((c2,ol)=>{var k_=hi(),x_="__lodash_hash_undefined__";function C_(r,t){var e=this.__data__;return this.size+=this.has(r)?0:1,e[r]=k_&&t===void 0?x_:t,this}ol.exports=C_});var ll=ye((u2,sl)=>{var S_=Zs(),T_=el(),E_=rl(),A_=nl(),$_=al();function Pr(r){var t=-1,e=r==null?0:r.length;for(this.clear();++t<e;){var i=r[t];this.set(i[0],i[1])}}Pr.prototype.clear=S_;Pr.prototype.delete=T_;Pr.prototype.get=E_;Pr.prototype.has=A_;Pr.prototype.set=$_;sl.exports=Pr});var dl=ye((d2,ul)=>{var cl=ll(),O_=di(),R_=Yi();function L_(){this.size=0,this.__data__={hash:new cl,map:new(R_||O_),string:new cl}}ul.exports=L_});var pl=ye((f2,fl)=>{function B_(r){var t=typeof r;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?r!=="__proto__":r===null}fl.exports=B_});var _i=ye((p2,hl)=>{var I_=pl();function M_(r,t){var e=r.__data__;return I_(t)?e[typeof t=="string"?"string":"hash"]:e.map}hl.exports=M_});var ml=ye((h2,_l)=>{var N_=_i();function P_(r){var t=N_(this,r).delete(r);return this.size-=t?1:0,t}_l.exports=P_});var vl=ye((_2,gl)=>{var D_=_i();function j_(r){return D_(this,r).get(r)}gl.exports=j_});var yl=ye((m2,bl)=>{var z_=_i();function F_(r){return z_(this,r).has(r)}bl.exports=F_});var kl=ye((g2,wl)=>{var H_=_i();function q_(r,t){var e=H_(this,r),i=e.size;return e.set(r,t),this.size+=e.size==i?0:1,this}wl.exports=q_});var Cl=ye((v2,xl)=>{var U_=dl(),W_=ml(),V_=vl(),Y_=yl(),G_=kl();function Dr(r){var t=-1,e=r==null?0:r.length;for(this.clear();++t<e;){var i=r[t];this.set(i[0],i[1])}}Dr.prototype.clear=U_;Dr.prototype.delete=W_;Dr.prototype.get=V_;Dr.prototype.has=Y_;Dr.prototype.set=G_;xl.exports=Dr});var Tl=ye((b2,Sl)=>{var X_=di(),K_=Yi(),J_=Cl(),Z_=200;function Q_(r,t){var e=this.__data__;if(e instanceof X_){var i=e.__data__;if(!K_||i.length<Z_-1)return i.push([r,t]),this.size=++e.size,this;e=this.__data__=new J_(i)}return e.set(r,t),this.size=e.size,this}Sl.exports=Q_});var Al=ye((y2,El)=>{var em=di(),tm=ms(),rm=vs(),im=ys(),nm=ks(),om=Tl();function jr(r){var t=this.__data__=new em(r);this.size=t.size}jr.prototype.clear=tm;jr.prototype.delete=rm;jr.prototype.get=im;jr.prototype.has=nm;jr.prototype.set=om;El.exports=jr});var Ol=ye((w2,$l)=>{function am(r,t){for(var e=-1,i=r==null?0:r.length;++e<i&&t(r[e],e,r)!==!1;);return r}$l.exports=am});var Ll=ye((k2,Rl)=>{var sm=yr(),lm=function(){try{var r=sm(Object,"defineProperty");return r({},"",{}),r}catch(t){}}();Rl.exports=lm});var co=ye((x2,Il)=>{var Bl=Ll();function cm(r,t,e){t=="__proto__"&&Bl?Bl(r,t,{configurable:!0,enumerable:!0,value:e,writable:!0}):r[t]=e}Il.exports=cm});var uo=ye((C2,Ml)=>{var um=co(),dm=no(),fm=Object.prototype,pm=fm.hasOwnProperty;function hm(r,t,e){var i=r[t];(!(pm.call(r,t)&&dm(i,e))||e===void 0&&!(t in r))&&um(r,t,e)}Ml.exports=hm});var mi=ye((S2,Nl)=>{var _m=uo(),mm=co();function gm(r,t,e,i){var n=!e;e||(e={});for(var o=-1,a=t.length;++o<a;){var s=t[o],l=i?i(e[s],r[s],s,e,r):void 0;l===void 0&&(l=r[s]),n?mm(e,s,l):_m(e,s,l)}return e}Nl.exports=gm});var Dl=ye((T2,Pl)=>{function vm(r,t){for(var e=-1,i=Array(r);++e<r;)i[e]=t(e);return i}Pl.exports=vm});var zr=ye((E2,jl)=>{function bm(r){return r!=null&&typeof r=="object"}jl.exports=bm});var Fl=ye((A2,zl)=>{var ym=pi(),wm=zr(),km="[object Arguments]";function xm(r){return wm(r)&&ym(r)==km}zl.exports=xm});var Wl=ye(($2,Ul)=>{var Hl=Fl(),Cm=zr(),ql=Object.prototype,Sm=ql.hasOwnProperty,Tm=ql.propertyIsEnumerable,Em=Hl(function(){return arguments}())?Hl:function(r){return Cm(r)&&Sm.call(r,"callee")&&!Tm.call(r,"callee")};Ul.exports=Em});var Gi=ye((O2,Vl)=>{var Am=Array.isArray;Vl.exports=Am});var Gl=ye((R2,Yl)=>{function $m(){return!1}Yl.exports=$m});var fo=ye((gi,Fr)=>{var Om=lr(),Rm=Gl(),Jl=typeof gi=="object"&&gi&&!gi.nodeType&&gi,Xl=Jl&&typeof Fr=="object"&&Fr&&!Fr.nodeType&&Fr,Lm=Xl&&Xl.exports===Jl,Kl=Lm?Om.Buffer:void 0,Bm=Kl?Kl.isBuffer:void 0,Im=Bm||Rm;Fr.exports=Im});var Ql=ye((L2,Zl)=>{var Mm=9007199254740991,Nm=/^(?:0|[1-9]\d*)$/;function Pm(r,t){var e=typeof r;return t=t==null?Mm:t,!!t&&(e=="number"||e!="symbol"&&Nm.test(r))&&r>-1&&r%1==0&&r<t}Zl.exports=Pm});var po=ye((B2,ec)=>{var Dm=9007199254740991;function jm(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=Dm}ec.exports=jm});var rc=ye((I2,tc)=>{var zm=pi(),Fm=po(),Hm=zr(),qm="[object Arguments]",Um="[object Array]",Wm="[object Boolean]",Vm="[object Date]",Ym="[object Error]",Gm="[object Function]",Xm="[object Map]",Km="[object Number]",Jm="[object Object]",Zm="[object RegExp]",Qm="[object Set]",eg="[object String]",tg="[object WeakMap]",rg="[object ArrayBuffer]",ig="[object DataView]",ng="[object Float32Array]",og="[object Float64Array]",ag="[object Int8Array]",sg="[object Int16Array]",lg="[object Int32Array]",cg="[object Uint8Array]",ug="[object Uint8ClampedArray]",dg="[object Uint16Array]",fg="[object Uint32Array]",gt={};gt[ng]=gt[og]=gt[ag]=gt[sg]=gt[lg]=gt[cg]=gt[ug]=gt[dg]=gt[fg]=!0;gt[qm]=gt[Um]=gt[rg]=gt[Wm]=gt[ig]=gt[Vm]=gt[Ym]=gt[Gm]=gt[Xm]=gt[Km]=gt[Jm]=gt[Zm]=gt[Qm]=gt[eg]=gt[tg]=!1;function pg(r){return Hm(r)&&Fm(r.length)&&!!gt[zm(r)]}tc.exports=pg});var Xi=ye((M2,ic)=>{function hg(r){return function(t){return r(t)}}ic.exports=hg});var Ki=ye((vi,Hr)=>{var _g=oo(),nc=typeof vi=="object"&&vi&&!vi.nodeType&&vi,bi=nc&&typeof Hr=="object"&&Hr&&!Hr.nodeType&&Hr,mg=bi&&bi.exports===nc,ho=mg&&_g.process,gg=function(){try{var r=bi&&bi.require&&bi.require("util").types;return r||ho&&ho.binding&&ho.binding("util")}catch(t){}}();Hr.exports=gg});var lc=ye((N2,sc)=>{var vg=rc(),bg=Xi(),oc=Ki(),ac=oc&&oc.isTypedArray,yg=ac?bg(ac):vg;sc.exports=yg});var _o=ye((P2,cc)=>{var wg=Dl(),kg=Wl(),xg=Gi(),Cg=fo(),Sg=Ql(),Tg=lc(),Eg=Object.prototype,Ag=Eg.hasOwnProperty;function $g(r,t){var e=xg(r),i=!e&&kg(r),n=!e&&!i&&Cg(r),o=!e&&!i&&!n&&Tg(r),a=e||i||n||o,s=a?wg(r.length,String):[],l=s.length;for(var u in r)(t||Ag.call(r,u))&&!(a&&(u=="length"||n&&(u=="offset"||u=="parent")||o&&(u=="buffer"||u=="byteLength"||u=="byteOffset")||Sg(u,l)))&&s.push(u);return s}cc.exports=$g});var Ji=ye((D2,uc)=>{var Og=Object.prototype;function Rg(r){var t=r&&r.constructor,e=typeof t=="function"&&t.prototype||Og;return r===e}uc.exports=Rg});var mo=ye((j2,dc)=>{function Lg(r,t){return function(e){return r(t(e))}}dc.exports=Lg});var pc=ye((z2,fc)=>{var Bg=mo(),Ig=Bg(Object.keys,Object);fc.exports=Ig});var _c=ye((F2,hc)=>{var Mg=Ji(),Ng=pc(),Pg=Object.prototype,Dg=Pg.hasOwnProperty;function jg(r){if(!Mg(r))return Ng(r);var t=[];for(var e in Object(r))Dg.call(r,e)&&e!="constructor"&&t.push(e);return t}hc.exports=jg});var go=ye((H2,mc)=>{var zg=ao(),Fg=po();function Hg(r){return r!=null&&Fg(r.length)&&!zg(r)}mc.exports=Hg});var Zi=ye((q2,gc)=>{var qg=_o(),Ug=_c(),Wg=go();function Vg(r){return Wg(r)?qg(r):Ug(r)}gc.exports=Vg});var bc=ye((U2,vc)=>{var Yg=mi(),Gg=Zi();function Xg(r,t){return r&&Yg(t,Gg(t),r)}vc.exports=Xg});var wc=ye((W2,yc)=>{function Kg(r){var t=[];if(r!=null)for(var e in Object(r))t.push(e);return t}yc.exports=Kg});var xc=ye((V2,kc)=>{var Jg=Nr(),Zg=Ji(),Qg=wc(),ev=Object.prototype,tv=ev.hasOwnProperty;function rv(r){if(!Jg(r))return Qg(r);var t=Zg(r),e=[];for(var i in r)i=="constructor"&&(t||!tv.call(r,i))||e.push(i);return e}kc.exports=rv});var Qi=ye((Y2,Cc)=>{var iv=_o(),nv=xc(),ov=go();function av(r){return ov(r)?iv(r,!0):nv(r)}Cc.exports=av});var Tc=ye((G2,Sc)=>{var sv=mi(),lv=Qi();function cv(r,t){return r&&sv(t,lv(t),r)}Sc.exports=cv});var Rc=ye((yi,qr)=>{var uv=lr(),Oc=typeof yi=="object"&&yi&&!yi.nodeType&&yi,Ec=Oc&&typeof qr=="object"&&qr&&!qr.nodeType&&qr,dv=Ec&&Ec.exports===Oc,Ac=dv?uv.Buffer:void 0,$c=Ac?Ac.allocUnsafe:void 0;function fv(r,t){if(t)return r.slice();var e=r.length,i=$c?$c(e):new r.constructor(e);return r.copy(i),i}qr.exports=fv});var Bc=ye((X2,Lc)=>{function pv(r,t){var e=-1,i=r.length;for(t||(t=Array(i));++e<i;)t[e]=r[e];return t}Lc.exports=pv});var Mc=ye((K2,Ic)=>{function hv(r,t){for(var e=-1,i=r==null?0:r.length,n=0,o=[];++e<i;){var a=r[e];t(a,e,r)&&(o[n++]=a)}return o}Ic.exports=hv});var vo=ye((J2,Nc)=>{function _v(){return[]}Nc.exports=_v});var en=ye((Z2,Dc)=>{var mv=Mc(),gv=vo(),vv=Object.prototype,bv=vv.propertyIsEnumerable,Pc=Object.getOwnPropertySymbols,yv=Pc?function(r){return r==null?[]:(r=Object(r),mv(Pc(r),function(t){return bv.call(r,t)}))}:gv;Dc.exports=yv});var zc=ye((Q2,jc)=>{var wv=mi(),kv=en();function xv(r,t){return wv(r,kv(r),t)}jc.exports=xv});var bo=ye((eT,Fc)=>{function Cv(r,t){for(var e=-1,i=t.length,n=r.length;++e<i;)r[n+e]=t[e];return r}Fc.exports=Cv});var yo=ye((tT,Hc)=>{var Sv=mo(),Tv=Sv(Object.getPrototypeOf,Object);Hc.exports=Tv});var wo=ye((rT,qc)=>{var Ev=bo(),Av=yo(),$v=en(),Ov=vo(),Rv=Object.getOwnPropertySymbols,Lv=Rv?function(r){for(var t=[];r;)Ev(t,$v(r)),r=Av(r);return t}:Ov;qc.exports=Lv});var Wc=ye((iT,Uc)=>{var Bv=mi(),Iv=wo();function Mv(r,t){return Bv(r,Iv(r),t)}Uc.exports=Mv});var ko=ye((nT,Vc)=>{var Nv=bo(),Pv=Gi();function Dv(r,t,e){var i=t(r);return Pv(r)?i:Nv(i,e(r))}Vc.exports=Dv});var Gc=ye((oT,Yc)=>{var jv=ko(),zv=en(),Fv=Zi();function Hv(r){return jv(r,Fv,zv)}Yc.exports=Hv});var Kc=ye((aT,Xc)=>{var qv=ko(),Uv=wo(),Wv=Qi();function Vv(r){return qv(r,Wv,Uv)}Xc.exports=Vv});var Zc=ye((sT,Jc)=>{var Yv=yr(),Gv=lr(),Xv=Yv(Gv,"DataView");Jc.exports=Xv});var eu=ye((lT,Qc)=>{var Kv=yr(),Jv=lr(),Zv=Kv(Jv,"Promise");Qc.exports=Zv});var ru=ye((cT,tu)=>{var Qv=yr(),eb=lr(),tb=Qv(eb,"Set");tu.exports=tb});var nu=ye((uT,iu)=>{var rb=yr(),ib=lr(),nb=rb(ib,"WeakMap");iu.exports=nb});var tn=ye((dT,du)=>{var xo=Zc(),Co=Yi(),So=eu(),To=ru(),Eo=nu(),uu=pi(),Ur=lo(),ou="[object Map]",ob="[object Object]",au="[object Promise]",su="[object Set]",lu="[object WeakMap]",cu="[object DataView]",ab=Ur(xo),sb=Ur(Co),lb=Ur(So),cb=Ur(To),ub=Ur(Eo),Or=uu;(xo&&Or(new xo(new ArrayBuffer(1)))!=cu||Co&&Or(new Co)!=ou||So&&Or(So.resolve())!=au||To&&Or(new To)!=su||Eo&&Or(new Eo)!=lu)&&(Or=function(r){var t=uu(r),e=t==ob?r.constructor:void 0,i=e?Ur(e):"";if(i)switch(i){case ab:return cu;case sb:return ou;case lb:return au;case cb:return su;case ub:return lu}return t});du.exports=Or});var pu=ye((fT,fu)=>{var db=Object.prototype,fb=db.hasOwnProperty;function pb(r){var t=r.length,e=new r.constructor(t);return t&&typeof r[0]=="string"&&fb.call(r,"index")&&(e.index=r.index,e.input=r.input),e}fu.exports=pb});var _u=ye((pT,hu)=>{var hb=lr(),_b=hb.Uint8Array;hu.exports=_b});var rn=ye((hT,gu)=>{var mu=_u();function mb(r){var t=new r.constructor(r.byteLength);return new mu(t).set(new mu(r)),t}gu.exports=mb});var bu=ye((_T,vu)=>{var gb=rn();function vb(r,t){var e=t?gb(r.buffer):r.buffer;return new r.constructor(e,r.byteOffset,r.byteLength)}vu.exports=vb});var wu=ye((mT,yu)=>{var bb=/\w*$/;function yb(r){var t=new r.constructor(r.source,bb.exec(r));return t.lastIndex=r.lastIndex,t}yu.exports=yb});var Tu=ye((gT,Su)=>{var ku=Vi(),xu=ku?ku.prototype:void 0,Cu=xu?xu.valueOf:void 0;function wb(r){return Cu?Object(Cu.call(r)):{}}Su.exports=wb});var Au=ye((vT,Eu)=>{var kb=rn();function xb(r,t){var e=t?kb(r.buffer):r.buffer;return new r.constructor(e,r.byteOffset,r.length)}Eu.exports=xb});var Ou=ye((bT,$u)=>{var Cb=rn(),Sb=bu(),Tb=wu(),Eb=Tu(),Ab=Au(),$b="[object Boolean]",Ob="[object Date]",Rb="[object Map]",Lb="[object Number]",Bb="[object RegExp]",Ib="[object Set]",Mb="[object String]",Nb="[object Symbol]",Pb="[object ArrayBuffer]",Db="[object DataView]",jb="[object Float32Array]",zb="[object Float64Array]",Fb="[object Int8Array]",Hb="[object Int16Array]",qb="[object Int32Array]",Ub="[object Uint8Array]",Wb="[object Uint8ClampedArray]",Vb="[object Uint16Array]",Yb="[object Uint32Array]";function Gb(r,t,e){var i=r.constructor;switch(t){case Pb:return Cb(r);case $b:case Ob:return new i(+r);case Db:return Sb(r,e);case jb:case zb:case Fb:case Hb:case qb:case Ub:case Wb:case Vb:case Yb:return Ab(r,e);case Rb:return new i;case Lb:case Mb:return new i(r);case Bb:return Tb(r);case Ib:return new i;case Nb:return Eb(r)}}$u.exports=Gb});var Bu=ye((yT,Lu)=>{var Xb=Nr(),Ru=Object.create,Kb=function(){function r(){}return function(t){if(!Xb(t))return{};if(Ru)return Ru(t);r.prototype=t;var e=new r;return r.prototype=void 0,e}}();Lu.exports=Kb});var Mu=ye((wT,Iu)=>{var Jb=Bu(),Zb=yo(),Qb=Ji();function ey(r){return typeof r.constructor=="function"&&!Qb(r)?Jb(Zb(r)):{}}Iu.exports=ey});var Pu=ye((kT,Nu)=>{var ty=tn(),ry=zr(),iy="[object Map]";function ny(r){return ry(r)&&ty(r)==iy}Nu.exports=ny});var Fu=ye((xT,zu)=>{var oy=Pu(),ay=Xi(),Du=Ki(),ju=Du&&Du.isMap,sy=ju?ay(ju):oy;zu.exports=sy});var qu=ye((CT,Hu)=>{var ly=tn(),cy=zr(),uy="[object Set]";function dy(r){return cy(r)&&ly(r)==uy}Hu.exports=dy});var Yu=ye((ST,Vu)=>{var fy=qu(),py=Xi(),Uu=Ki(),Wu=Uu&&Uu.isSet,hy=Wu?py(Wu):fy;Vu.exports=hy});var Zu=ye((TT,Ju)=>{var _y=Al(),my=Ol(),gy=uo(),vy=bc(),by=Tc(),yy=Rc(),wy=Bc(),ky=zc(),xy=Wc(),Cy=Gc(),Sy=Kc(),Ty=tn(),Ey=pu(),Ay=Ou(),$y=Mu(),Oy=Gi(),Ry=fo(),Ly=Fu(),By=Nr(),Iy=Yu(),My=Zi(),Ny=Qi(),Py=1,Dy=2,jy=4,Gu="[object Arguments]",zy="[object Array]",Fy="[object Boolean]",Hy="[object Date]",qy="[object Error]",Xu="[object Function]",Uy="[object GeneratorFunction]",Wy="[object Map]",Vy="[object Number]",Ku="[object Object]",Yy="[object RegExp]",Gy="[object Set]",Xy="[object String]",Ky="[object Symbol]",Jy="[object WeakMap]",Zy="[object ArrayBuffer]",Qy="[object DataView]",ew="[object Float32Array]",tw="[object Float64Array]",rw="[object Int8Array]",iw="[object Int16Array]",nw="[object Int32Array]",ow="[object Uint8Array]",aw="[object Uint8ClampedArray]",sw="[object Uint16Array]",lw="[object Uint32Array]",_t={};_t[Gu]=_t[zy]=_t[Zy]=_t[Qy]=_t[Fy]=_t[Hy]=_t[ew]=_t[tw]=_t[rw]=_t[iw]=_t[nw]=_t[Wy]=_t[Vy]=_t[Ku]=_t[Yy]=_t[Gy]=_t[Xy]=_t[Ky]=_t[ow]=_t[aw]=_t[sw]=_t[lw]=!0;_t[qy]=_t[Xu]=_t[Jy]=!1;function nn(r,t,e,i,n,o){var a,s=t&Py,l=t&Dy,u=t&jy;if(e&&(a=n?e(r,i,n,o):e(r)),a!==void 0)return a;if(!By(r))return r;var c=Oy(r);if(c){if(a=Ey(r),!s)return wy(r,a)}else{var h=Ty(r),p=h==Xu||h==Uy;if(Ry(r))return yy(r,s);if(h==Ku||h==Gu||p&&!n){if(a=l||p?{}:$y(r),!s)return l?xy(r,by(a,r)):ky(r,vy(a,r))}else{if(!_t[h])return n?r:{};a=Ay(r,h,s)}}o||(o=new _y);var g=o.get(r);if(g)return g;o.set(r,a),Iy(r)?r.forEach(function(k){a.add(nn(k,t,e,k,r,o))}):Ly(r)&&r.forEach(function(k,C){a.set(C,nn(k,t,e,C,r,o))});var b=u?l?Sy:Cy:l?Ny:My,v=c?void 0:b(r);return my(v||r,function(k,C){v&&(C=k,k=r[C]),gy(a,C,nn(k,t,e,C,r,o))}),a}Ju.exports=nn});var ed=ye((ET,Qu)=>{var cw=Zu(),uw=1,dw=4;function fw(r,t){return t=typeof t=="function"?t:void 0,cw(r,uw|dw,t)}Qu.exports=fw});var id=ye((exports,module)=>{frappe.provide("frappe.model");$.extend(frappe.model,{no_value_type:["Section Break","Column Break","Tab Break","HTML","Table","Table MultiSelect","Button","Image","Fold","Heading"],layout_fields:["Section Break","Column Break","Tab Break","Fold"],std_fields_list:["name","owner","creation","modified","modified_by","_user_tags","_comments","_assign","_liked_by","docstatus","idx"],child_table_field_list:["parent","parenttype","parentfield"],core_doctypes_list:["DocType","DocField","DocPerm","User","Role","Has Role","Page","Module Def","Print Format","Report","Customize Form","Customize Form Field","Property Setter","Custom Field","Client Script"],std_fields:[{fieldname:"name",fieldtype:"Link",label:__("ID")},{fieldname:"owner",fieldtype:"Link",label:__("Created By"),options:"User"},{fieldname:"idx",fieldtype:"Int",label:__("Index")},{fieldname:"creation",fieldtype:"Date",label:__("Created On")},{fieldname:"modified",fieldtype:"Date",label:__("Last Updated On")},{fieldname:"modified_by",fieldtype:"Data",label:__("Last Updated By")},{fieldname:"_user_tags",fieldtype:"Data",label:__("Tags")},{fieldname:"_liked_by",fieldtype:"Data",label:__("Liked By")},{fieldname:"_comments",fieldtype:"Text",label:__("Comments")},{fieldname:"_assign",fieldtype:"Text",label:__("Assigned To")},{fieldname:"docstatus",fieldtype:"Int",label:__("Document Status")}],numeric_fieldtypes:["Int","Float","Currency","Percent","Duration"],std_fields_table:[{fieldname:"parent",fieldtype:"Data",label:__("Parent")}],table_fields:["Table","Table MultiSelect"],new_names:{},events:{},user_settings:{},init:function(){frappe.realtime.on("doc_update",function(r){var t=locals[r.doctype]&&locals[r.doctype][r.name];t&&(frappe.get_route()[0]==="Form"&&cur_frm.doc.doctype===t.doctype&&cur_frm.doc.name===t.name?!frappe.ui.form.is_saving&&r.modified!=cur_frm.doc.modified&&(t.__needs_refresh=!0,cur_frm.show_conflict_message()):t.__unsaved?t.__needs_refresh=!0:frappe.model.remove_from_locals(t.doctype,t.name))})},is_value_type:function(r){return typeof r=="object"&&(r=r.fieldtype),frappe.model.no_value_type.indexOf(r)===-1},is_non_std_field:function(r){return![...frappe.model.std_fields_list,...frappe.model.child_table_field_list].includes(r)},get_std_field:function(r,t=!1){var e=$.map([].concat(frappe.model.std_fields).concat(frappe.model.std_fields_table),function(i){if(i.fieldname==r)return i});if(!e.length){if(t)return{fieldname:r};frappe.msgprint(__("Unknown Column: {0}",[r]))}return e[0]},get_from_localstorage:function(r){if(localStorage["_doctype:"+r])return JSON.parse(localStorage["_doctype:"+r])},set_in_localstorage:function(r,t){try{localStorage["_doctype:"+r]=JSON.stringify(t)}catch(e){console.warn("localStorage quota exceeded, clearing doctype cache"),frappe.model.clear_local_storage(),localStorage["_doctype:"+r]=JSON.stringify(t)}},clear_local_storage:function(){for(var r in localStorage)r.startsWith("_doctype:")&&localStorage.removeItem(r)},with_doctype:function(r,t,e){if(locals.DocType[r])return t&&t(),Promise.resolve();{let i=null,n=null,o=frappe.model.get_from_localstorage(r);return o&&(n=o.filter(a=>a.name===r)[0],n&&(i=n.modified)),frappe.call({method:"frappe.desk.form.load.getdoctype",type:"GET",args:{doctype:r,with_parent:1,cached_timestamp:i},async:e,callback:function(a){if(a.exc)throw frappe.msgprint(__("Unable to load: {0}",[__(r)])),"No doctype";a.message=="use_cache"?frappe.model.sync(n):frappe.model.set_in_localstorage(r,a.docs),frappe.model.init_doctype(r),a.user_settings&&(frappe.model.user_settings[r]=JSON.parse(a.user_settings),frappe.model.user_settings[r].updated_on=moment().toString()),t&&t(a)}})}},init_doctype:function(doctype){var meta=locals.DocType[doctype];meta.__list_js&&eval(meta.__list_js),meta.__custom_list_js&&eval(meta.__custom_list_js),meta.__calendar_js&&eval(meta.__calendar_js),meta.__map_js&&eval(meta.__map_js),meta.__tree_js&&eval(meta.__tree_js),meta.__templates&&$.extend(frappe.templates,meta.__templates)},with_doc:function(r,t,e){return new Promise(i=>{if(t||(t=r),locals[r]&&locals[r][t]&&frappe.model.get_docinfo(r,t))e&&e(t),i(frappe.get_doc(r,t));else return frappe.call({method:"frappe.desk.form.load.getdoc",type:"GET",args:{doctype:r,name:t},callback:function(n){e&&e(t,n),i(frappe.get_doc(r,t))}})})},get_docinfo:function(r,t){return frappe.model.docinfo[r]&&frappe.model.docinfo[r][t]||null},set_docinfo:function(r,t,e,i){frappe.model.docinfo[r]&&frappe.model.docinfo[r][t]&&(frappe.model.docinfo[r][t][e]=i)},get_shared:function(r,t){return frappe.model.get_docinfo(r,t).shared},get_server_module_name:function(r){var t=frappe.model.scrub(r),e=frappe.model.scrub(locals.DocType[r].module),i=frappe.boot.module_app[e];return i+"."+e+".doctype."+t+"."+t},scrub:function(r){return r.replace(/ /g,"_").toLowerCase()},unscrub:function(r){return __(r||"").replace(/-|_/g," ").replace(/\w*/g,function(t){return t.charAt(0).toUpperCase()+t.substr(1).toLowerCase()})},can_create:function(r){return frappe.boot.user.can_create.indexOf(r)!==-1},can_select:function(r){if(frappe.boot.user)return frappe.boot.user.can_select.indexOf(r)!==-1},can_read:function(r){if(frappe.boot.user)return frappe.boot.user.can_read.indexOf(r)!==-1},can_write:function(r){return frappe.boot.user.can_write.indexOf(r)!==-1},can_get_report:function(r){return frappe.boot.user.can_get_report.indexOf(r)!==-1},can_delete:function(r){return r?frappe.boot.user.can_delete.indexOf(r)!==-1:!1},can_cancel:function(r){return r?frappe.boot.user.can_cancel.indexOf(r)!==-1:!1},has_workflow:function(r){return frappe.get_list("Workflow",{document_type:r,is_active:1}).length},is_submittable:function(r){return r?locals.DocType[r]&&locals.DocType[r].is_submittable:!1},is_table:function(r){return r?locals.DocType[r]&&locals.DocType[r].istable:!1},is_single:function(r){return r?frappe.boot.single_types.indexOf(r)!=-1:!1},is_tree:function(r){return r?frappe.boot.treeviews.indexOf(r)!=-1:!1},is_fresh(r){return r&&r.__last_sync_on&&new Date-r.__last_sync_on<5e3},can_import:function(r,t,e=null){return e&&!e.allow_import?!1:frappe.user_roles.includes("System Manager")?!0:t?t.perm[0].import===1:frappe.boot.user.can_import.indexOf(r)!==-1},can_export:function(r,t){return frappe.user_roles.includes("System Manager")?!0:t?t.perm[0].export===1:frappe.boot.user.can_export.indexOf(r)!==-1},can_print:function(r,t){return t?t.perm[0].print===1:frappe.boot.user.can_print.indexOf(r)!==-1},can_email:function(r,t){return t?t.perm[0].email===1:frappe.boot.user.can_email.indexOf(r)!==-1},can_share:function(r,t){return t?t.perm[0].share===1:frappe.boot.user.can_share.indexOf(r)!==-1},can_set_user_permissions:function(r,t){return frappe.user_roles.includes("System Manager")?!0:t?t.perm[0].set_user_permissions===1:frappe.boot.user.can_set_user_permissions.indexOf(r)!==-1},has_value:function(r,t,e){var i=locals[r]&&locals[r][t]&&locals[r][t][e],n=frappe.meta.get_docfield(r,e,t);if(frappe.model.table_fields.includes(n.fieldtype)){var o=!1;$.each(locals[n.options]||{},function(a,s){if(s.parent==t&&s.parenttype==r&&s.parentfield==n.fieldname)return o=!0,!1})}else var o=!is_null(i);return!!o},get_list:function(r,t){var e=locals[r]||locals[":"+r]||{};return $.isEmptyObject(e)?[]:frappe.utils.filter_dict(e,t)},get_value:function(r,t,e,i){if(i)frappe.call({method:"frappe.client.get_value",args:{doctype:r,fieldname:e,filters:t},callback:function(o){o.exc||i(o.message)}});else{if(["number","string"].includes(typeof t)&&locals[r]&&locals[r][t])return locals[r][t][e];var n=frappe.get_list(r,t);return n.length&&n[0]?n[0][e]:null}},set_value:function(r,t,e,i,n,o=!1){var a;$.isPlainObject(r)?(a=r,e=t,i=e):a=locals[r]&&locals[r][t];let s=e,l=[];return $.isPlainObject(s)||(s={},s[e]=i),$.each(s,(u,c)=>{a&&a[u]!==c?(a.__unedited&&!(!a[u]&&!c)&&(a.__unedited=!1),a[u]=c,l.push(()=>frappe.model.trigger(u,c,a,o))):in_list(["Link","Dynamic Link"],n)&&a&&l.push(()=>frappe.model.trigger(u,c,a,o))}),frappe.run_serially(l)},on:function(r,t,e){frappe.provide("frappe.model.events."+r),frappe.model.events[r][t]||(frappe.model.events[r][t]=[]),frappe.model.events[r][t].push(e)},trigger:function(r,t,e,i=!1){let n=[];function o(a){if(!!a)for(let s of a)!s||n.push(()=>{let l=s(r,t,e,i);return l&&l.then?l:frappe.after_server_call()})}return frappe.model.events[e.doctype]&&(o(frappe.model.events[e.doctype][r]),o(frappe.model.events[e.doctype]["*"])),frappe.run_serially(n)},get_doc:function(r,t){if(t||(t=r),$.isPlainObject(t)){var e=frappe.get_list(r,t);return e&&e.length?e[0]:null}return locals[r]?locals[r][t]:null},get_children:function(r,t,e,i){if($.isPlainObject(r))var n=r,i=e,e=t;else var n=frappe.get_doc(r,t);var o=n[e]||[];return i?frappe.utils.filter_dict(o,i):o},clear_table:function(r,t){for(var e=0,i=(r[t]||[]).length;e<i;e++){var n=r[t][e];delete locals[n.doctype][n.name]}r[t]=[]},remove_from_locals:function(r,t){this.clear_doc(r,t),frappe.views.formview[r]&&delete frappe.views.formview[r].frm.opendocs[t]},clear_doc:function(r,t){var e=locals[r]&&locals[r][t];if(!!e){var i=null;if(e.parenttype)var i=e.parent,n=e.parenttype,o=e.parentfield;if(delete locals[r][t],i){var a=locals[n][i],s=[],l=1;$.each(a[o],function(u,c){c.name!=t&&(s.push(c),c.idx=l,l++),a[o]=s})}}},get_no_copy_list:function(r){for(var t=["name","amended_from","amendment_date","cancel_reason"],e=frappe.get_doc("DocType",r).fields||[],i=0,n=e.length;i<n;i++){var o=e[i];cint(o.no_copy)&&t.push(o.fieldname)}return t},delete_doc:function(r,t,e){let i=t,n=frappe.get_meta(r).title_field;if(frappe.get_meta(r).autoname=="hash"&&n){let o=frappe.model.get_value(r,t,n);o&&(i=`${o} (${t})`)}frappe.confirm(__("Permanently delete {0}?",[i.bold()]),function(){return frappe.call({method:"frappe.client.delete",args:{doctype:r,name:t},callback:function(o,a){o.exc||(frappe.utils.play_sound("delete"),frappe.model.clear_doc(r,t),e&&e(o,a))}})})},rename_doc:function(r,t,e){let i=__("Merge with existing"),n=__("This cannot be undone"),o=i+" <b>("+n+")</b>";var a=new frappe.ui.Dialog({title:__("Rename {0}",[__(t)]),fields:[{label:__("New Name"),fieldname:"new_name",fieldtype:"Data",reqd:1,default:t},{label:o,fieldtype:"Check",fieldname:"merge"}]});a.set_primary_action(__("Rename"),function(){a.hide();var s=a.get_values();if(!!s)return frappe.call({method:"frappe.rename_doc",freeze:!0,freeze_message:"Updating related fields...",args:{doctype:r,old:t,new:s.new_name,merge:s.merge},btn:a.get_primary_btn(),callback:function(l,u){l.exc||($(document).trigger("rename",[r,t,l.message||s.new_name]),locals[r]&&locals[r][t]&&delete locals[r][t],a.hide(),e&&e(l.message))}})}),a.show()},round_floats_in:function(r,t){t||(t=frappe.meta.get_fieldnames(r.doctype,r.parent,{fieldtype:["in",["Currency","Float"]]}));for(var e=0,i=t.length;e<i;e++){var n=t[e];r[n]=flt(r[n],precision(n,r))}},validate_missing:function(r,t){r[t]||frappe.throw(__("Please specify")+": "+__(frappe.meta.get_label(r.doctype,t,r.parent||r.name)))},get_all_docs:function(r){var t=[r];for(var e in r)if($.isArray(r[e]))for(var i=r[e],n=0,o=i.length;n<o;n++)t.push(i[n]);return t},get_full_column_name:function(r,t){return r.includes("`tab")?r:"`tab"+t+"`.`"+r+"`"},is_numeric_field:function(r){if(!!r)return typeof r=="object"&&(r=r.fieldtype),frappe.model.numeric_fieldtypes.includes(r)}});frappe.get_doc=frappe.model.get_doc;frappe.get_children=frappe.model.get_children;frappe.get_list=frappe.model.get_list;var getchildren=function(r,t,e){var i=[];return $.each(locals[r]||{},function(n,o){o.parent===t&&o.parentfield===e&&i.push(o)}),i}});var od=ye((DT,nd)=>{(function(){var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t={rotl:function(e,i){return e<<i|e>>>32-i},rotr:function(e,i){return e<<32-i|e>>>i},endian:function(e){if(e.constructor==Number)return t.rotl(e,8)&16711935|t.rotl(e,24)&4278255360;for(var i=0;i<e.length;i++)e[i]=t.endian(e[i]);return e},randomBytes:function(e){for(var i=[];e>0;e--)i.push(Math.floor(Math.random()*256));return i},bytesToWords:function(e){for(var i=[],n=0,o=0;n<e.length;n++,o+=8)i[o>>>5]|=e[n]<<24-o%32;return i},wordsToBytes:function(e){for(var i=[],n=0;n<e.length*32;n+=8)i.push(e[n>>>5]>>>24-n%32&255);return i},bytesToHex:function(e){for(var i=[],n=0;n<e.length;n++)i.push((e[n]>>>4).toString(16)),i.push((e[n]&15).toString(16));return i.join("")},hexToBytes:function(e){for(var i=[],n=0;n<e.length;n+=2)i.push(parseInt(e.substr(n,2),16));return i},bytesToBase64:function(e){for(var i=[],n=0;n<e.length;n+=3)for(var o=e[n]<<16|e[n+1]<<8|e[n+2],a=0;a<4;a++)n*8+a*6<=e.length*8?i.push(r.charAt(o>>>6*(3-a)&63)):i.push("=");return i.join("")},base64ToBytes:function(e){e=e.replace(/[^A-Z0-9+\/]/ig,"");for(var i=[],n=0,o=0;n<e.length;o=++n%4)o!=0&&i.push((r.indexOf(e.charAt(n-1))&Math.pow(2,-2*o+8)-1)<<o*2|r.indexOf(e.charAt(n))>>>6-o*2);return i}};nd.exports=t})()});var $o=ye((jT,ad)=>{var Ao={utf8:{stringToBytes:function(r){return Ao.bin.stringToBytes(unescape(encodeURIComponent(r)))},bytesToString:function(r){return decodeURIComponent(escape(Ao.bin.bytesToString(r)))}},bin:{stringToBytes:function(r){for(var t=[],e=0;e<r.length;e++)t.push(r.charCodeAt(e)&255);return t},bytesToString:function(r){for(var t=[],e=0;e<r.length;e++)t.push(String.fromCharCode(r[e]));return t.join("")}}};ad.exports=Ao});var cd=ye((zT,ld)=>{ld.exports=function(r){return r!=null&&(sd(r)||bw(r)||!!r._isBuffer)};function sd(r){return!!r.constructor&&typeof r.constructor.isBuffer=="function"&&r.constructor.isBuffer(r)}function bw(r){return typeof r.readFloatLE=="function"&&typeof r.slice=="function"&&sd(r.slice(0,0))}});var dd=ye((FT,ud)=>{(function(){var r=od(),t=$o().utf8,e=cd(),i=$o().bin,n=function(o,a){o.constructor==String?a&&a.encoding==="binary"?o=i.stringToBytes(o):o=t.stringToBytes(o):e(o)?o=Array.prototype.slice.call(o,0):!Array.isArray(o)&&o.constructor!==Uint8Array&&(o=o.toString());for(var s=r.bytesToWords(o),l=o.length*8,u=1732584193,c=-271733879,h=-1732584194,p=271733878,g=0;g<s.length;g++)s[g]=(s[g]<<8|s[g]>>>24)&16711935|(s[g]<<24|s[g]>>>8)&4278255360;s[l>>>5]|=128<<l%32,s[(l+64>>>9<<4)+14]=l;for(var b=n._ff,v=n._gg,k=n._hh,C=n._ii,g=0;g<s.length;g+=16){var O=u,d=c,_=h,m=p;u=b(u,c,h,p,s[g+0],7,-680876936),p=b(p,u,c,h,s[g+1],12,-389564586),h=b(h,p,u,c,s[g+2],17,606105819),c=b(c,h,p,u,s[g+3],22,-1044525330),u=b(u,c,h,p,s[g+4],7,-176418897),p=b(p,u,c,h,s[g+5],12,1200080426),h=b(h,p,u,c,s[g+6],17,-1473231341),c=b(c,h,p,u,s[g+7],22,-45705983),u=b(u,c,h,p,s[g+8],7,1770035416),p=b(p,u,c,h,s[g+9],12,-1958414417),h=b(h,p,u,c,s[g+10],17,-42063),c=b(c,h,p,u,s[g+11],22,-1990404162),u=b(u,c,h,p,s[g+12],7,1804603682),p=b(p,u,c,h,s[g+13],12,-40341101),h=b(h,p,u,c,s[g+14],17,-1502002290),c=b(c,h,p,u,s[g+15],22,1236535329),u=v(u,c,h,p,s[g+1],5,-165796510),p=v(p,u,c,h,s[g+6],9,-1069501632),h=v(h,p,u,c,s[g+11],14,643717713),c=v(c,h,p,u,s[g+0],20,-373897302),u=v(u,c,h,p,s[g+5],5,-701558691),p=v(p,u,c,h,s[g+10],9,38016083),h=v(h,p,u,c,s[g+15],14,-660478335),c=v(c,h,p,u,s[g+4],20,-405537848),u=v(u,c,h,p,s[g+9],5,568446438),p=v(p,u,c,h,s[g+14],9,-1019803690),h=v(h,p,u,c,s[g+3],14,-187363961),c=v(c,h,p,u,s[g+8],20,1163531501),u=v(u,c,h,p,s[g+13],5,-1444681467),p=v(p,u,c,h,s[g+2],9,-51403784),h=v(h,p,u,c,s[g+7],14,1735328473),c=v(c,h,p,u,s[g+12],20,-1926607734),u=k(u,c,h,p,s[g+5],4,-378558),p=k(p,u,c,h,s[g+8],11,-2022574463),h=k(h,p,u,c,s[g+11],16,1839030562),c=k(c,h,p,u,s[g+14],23,-35309556),u=k(u,c,h,p,s[g+1],4,-1530992060),p=k(p,u,c,h,s[g+4],11,1272893353),h=k(h,p,u,c,s[g+7],16,-155497632),c=k(c,h,p,u,s[g+10],23,-1094730640),u=k(u,c,h,p,s[g+13],4,681279174),p=k(p,u,c,h,s[g+0],11,-358537222),h=k(h,p,u,c,s[g+3],16,-722521979),c=k(c,h,p,u,s[g+6],23,76029189),u=k(u,c,h,p,s[g+9],4,-640364487),p=k(p,u,c,h,s[g+12],11,-421815835),h=k(h,p,u,c,s[g+15],16,530742520),c=k(c,h,p,u,s[g+2],23,-995338651),u=C(u,c,h,p,s[g+0],6,-198630844),p=C(p,u,c,h,s[g+7],10,1126891415),h=C(h,p,u,c,s[g+14],15,-1416354905),c=C(c,h,p,u,s[g+5],21,-57434055),u=C(u,c,h,p,s[g+12],6,1700485571),p=C(p,u,c,h,s[g+3],10,-1894986606),h=C(h,p,u,c,s[g+10],15,-1051523),c=C(c,h,p,u,s[g+1],21,-2054922799),u=C(u,c,h,p,s[g+8],6,1873313359),p=C(p,u,c,h,s[g+15],10,-30611744),h=C(h,p,u,c,s[g+6],15,-1560198380),c=C(c,h,p,u,s[g+13],21,1309151649),u=C(u,c,h,p,s[g+4],6,-145523070),p=C(p,u,c,h,s[g+11],10,-1120210379),h=C(h,p,u,c,s[g+2],15,718787259),c=C(c,h,p,u,s[g+9],21,-343485551),u=u+O>>>0,c=c+d>>>0,h=h+_>>>0,p=p+m>>>0}return r.endian([u,c,h,p])};n._ff=function(o,a,s,l,u,c,h){var p=o+(a&s|~a&l)+(u>>>0)+h;return(p<<c|p>>>32-c)+a},n._gg=function(o,a,s,l,u,c,h){var p=o+(a&l|s&~l)+(u>>>0)+h;return(p<<c|p>>>32-c)+a},n._hh=function(o,a,s,l,u,c,h){var p=o+(a^s^l)+(u>>>0)+h;return(p<<c|p>>>32-c)+a},n._ii=function(o,a,s,l,u,c,h){var p=o+(s^(a|~l))+(u>>>0)+h;return(p<<c|p>>>32-c)+a},n._blocksize=16,n._digestsize=16,ud.exports=function(o,a){if(o==null)throw new Error("Illegal argument "+o);var s=r.wordsToBytes(n(o,a));return a&&a.asBytes?s:a&&a.asString?i.bytesToString(s):r.bytesToHex(s)}})()});var pd=ye((fd,on)=>{(function(){function r(d){"use strict";var _={omitExtraWLInCodeBlocks:{defaultValue:!1,describe:"Omit the default extra whiteline added to code blocks",type:"boolean"},noHeaderId:{defaultValue:!1,describe:"Turn on/off generated header id",type:"boolean"},prefixHeaderId:{defaultValue:!1,describe:"Add a prefix to the generated header ids. Passing a string will prefix that string to the header id. Setting to true will add a generic 'section-' prefix",type:"string"},rawPrefixHeaderId:{defaultValue:!1,describe:'Setting this option to true will prevent showdown from modifying the prefix. This might result in malformed IDs (if, for instance, the " char is used in the prefix)',type:"boolean"},ghCompatibleHeaderId:{defaultValue:!1,describe:"Generate header ids compatible with github style (spaces are replaced with dashes, a bunch of non alphanumeric chars are removed)",type:"boolean"},rawHeaderId:{defaultValue:!1,describe:`Remove only spaces, ' and " from generated header ids (including prefixes), replacing them with dashes (-). WARNING: This might result in malformed ids`,type:"boolean"},headerLevelStart:{defaultValue:!1,describe:"The header blocks level start",type:"integer"},parseImgDimensions:{defaultValue:!1,describe:"Turn on/off image dimension parsing",type:"boolean"},simplifiedAutoLink:{defaultValue:!1,describe:"Turn on/off GFM autolink style",type:"boolean"},excludeTrailingPunctuationFromURLs:{defaultValue:!1,describe:"Excludes trailing punctuation from links generated with autoLinking",type:"boolean"},literalMidWordUnderscores:{defaultValue:!1,describe:"Parse midword underscores as literal underscores",type:"boolean"},literalMidWordAsterisks:{defaultValue:!1,describe:"Parse midword asterisks as literal asterisks",type:"boolean"},strikethrough:{defaultValue:!1,describe:"Turn on/off strikethrough support",type:"boolean"},tables:{defaultValue:!1,describe:"Turn on/off tables support",type:"boolean"},tablesHeaderId:{defaultValue:!1,describe:"Add an id to table headers",type:"boolean"},ghCodeBlocks:{defaultValue:!0,describe:"Turn on/off GFM fenced code blocks support",type:"boolean"},tasklists:{defaultValue:!1,describe:"Turn on/off GFM tasklist support",type:"boolean"},smoothLivePreview:{defaultValue:!1,describe:"Prevents weird effects in live previews due to incomplete input",type:"boolean"},smartIndentationFix:{defaultValue:!1,describe:"Tries to smartly fix indentation in es6 strings",type:"boolean"},disableForced4SpacesIndentedSublists:{defaultValue:!1,describe:"Disables the requirement of indenting nested sublists by 4 spaces",type:"boolean"},simpleLineBreaks:{defaultValue:!1,describe:"Parses simple line breaks as <br> (GFM Style)",type:"boolean"},requireSpaceBeforeHeadingText:{defaultValue:!1,describe:"Makes adding a space between `#` and the header text mandatory (GFM Style)",type:"boolean"},ghMentions:{defaultValue:!1,describe:"Enables github @mentions",type:"boolean"},ghMentionsLink:{defaultValue:"https://github.com/{u}",describe:"Changes the link generated by @mentions. Only applies if ghMentions option is enabled.",type:"string"},encodeEmails:{defaultValue:!0,describe:"Encode e-mail addresses through the use of Character Entities, transforming ASCII e-mail addresses into its equivalent decimal entities",type:"boolean"},openLinksInNewWindow:{defaultValue:!1,describe:"Open all links in new windows",type:"boolean"},backslashEscapesHTMLTags:{defaultValue:!1,describe:"Support for HTML Tag escaping. ex: <div>foo</div>",type:"boolean"},emoji:{defaultValue:!1,describe:"Enable emoji support. Ex: `this is a :smile: emoji`",type:"boolean"},underline:{defaultValue:!1,describe:"Enable support for underline. Syntax is double or triple underscores: `__underline word__`. With this option enabled, underscores no longer parses into `<em>` and `<strong>`",type:"boolean"},ellipsis:{defaultValue:!0,describe:"Replaces three dots with the ellipsis unicode character",type:"boolean"},completeHTMLDocument:{defaultValue:!1,describe:"Outputs a complete html document, including `<html>`, `<head>` and `<body>` tags",type:"boolean"},metadata:{defaultValue:!1,describe:"Enable support for document metadata (defined at the top of the document between `\xAB\xAB\xAB` and `\xBB\xBB\xBB` or between `---` and `---`).",type:"boolean"},splitAdjacentBlockquotes:{defaultValue:!1,describe:"Split adjacent blockquote blocks",type:"boolean"}};if(d===!1)return JSON.parse(JSON.stringify(_));var m={};for(var y in _)_.hasOwnProperty(y)&&(m[y]=_[y].defaultValue);return m}function t(){"use strict";var d=r(!0),_={};for(var m in d)d.hasOwnProperty(m)&&(_[m]=!0);return _}var e={},i={},n={},o=r(!0),a="vanilla",s={github:{omitExtraWLInCodeBlocks:!0,simplifiedAutoLink:!0,excludeTrailingPunctuationFromURLs:!0,literalMidWordUnderscores:!0,strikethrough:!0,tables:!0,tablesHeaderId:!0,ghCodeBlocks:!0,tasklists:!0,disableForced4SpacesIndentedSublists:!0,simpleLineBreaks:!0,requireSpaceBeforeHeadingText:!0,ghCompatibleHeaderId:!0,ghMentions:!0,backslashEscapesHTMLTags:!0,emoji:!0,splitAdjacentBlockquotes:!0},original:{noHeaderId:!0,ghCodeBlocks:!1},ghost:{omitExtraWLInCodeBlocks:!0,parseImgDimensions:!0,simplifiedAutoLink:!0,excludeTrailingPunctuationFromURLs:!0,literalMidWordUnderscores:!0,strikethrough:!0,tables:!0,tablesHeaderId:!0,ghCodeBlocks:!0,tasklists:!0,smoothLivePreview:!0,simpleLineBreaks:!0,requireSpaceBeforeHeadingText:!0,ghMentions:!1,encodeEmails:!0},vanilla:r(!0),allOn:t()};e.helper={},e.extensions={},e.setOption=function(d,_){"use strict";return o[d]=_,this},e.getOption=function(d){"use strict";return o[d]},e.getOptions=function(){"use strict";return o},e.resetOptions=function(){"use strict";o=r(!0)},e.setFlavor=function(d){"use strict";if(!s.hasOwnProperty(d))throw Error(d+" flavor was not found");e.resetOptions();var _=s[d];a=d;for(var m in _)_.hasOwnProperty(m)&&(o[m]=_[m])},e.getFlavor=function(){"use strict";return a},e.getFlavorOptions=function(d){"use strict";if(s.hasOwnProperty(d))return s[d]},e.getDefaultOptions=function(d){"use strict";return r(d)},e.subParser=function(d,_){"use strict";if(e.helper.isString(d))if(typeof _!="undefined")i[d]=_;else{if(i.hasOwnProperty(d))return i[d];throw Error("SubParser named "+d+" not registered!")}},e.extension=function(d,_){"use strict";if(!e.helper.isString(d))throw Error("Extension 'name' must be a string");if(d=e.helper.stdExtName(d),e.helper.isUndefined(_)){if(!n.hasOwnProperty(d))throw Error("Extension named "+d+" is not registered!");return n[d]}else{typeof _=="function"&&(_=_()),e.helper.isArray(_)||(_=[_]);var m=l(_,d);if(m.valid)n[d]=_;else throw Error(m.error)}},e.getAllExtensions=function(){"use strict";return n},e.removeExtension=function(d){"use strict";delete n[d]},e.resetExtensions=function(){"use strict";n={}};function l(d,_){"use strict";var m=_?"Error in "+_+" extension->":"Error in unnamed extension",y={valid:!0,error:""};e.helper.isArray(d)||(d=[d]);for(var x=0;x<d.length;++x){var S=m+" sub-extension "+x+": ",w=d[x];if(typeof w!="object")return y.valid=!1,y.error=S+"must be an object, but "+typeof w+" given",y;if(!e.helper.isString(w.type))return y.valid=!1,y.error=S+'property "type" must be a string, but '+typeof w.type+" given",y;var E=w.type=w.type.toLowerCase();if(E==="language"&&(E=w.type="lang"),E==="html"&&(E=w.type="output"),E!=="lang"&&E!=="output"&&E!=="listener")return y.valid=!1,y.error=S+"type "+E+' is not recognized. Valid values: "lang/language", "output/html" or "listener"',y;if(E==="listener"){if(e.helper.isUndefined(w.listeners))return y.valid=!1,y.error=S+'. Extensions of type "listener" must have a property called "listeners"',y}else if(e.helper.isUndefined(w.filter)&&e.helper.isUndefined(w.regex))return y.valid=!1,y.error=S+E+' extensions must define either a "regex" property or a "filter" method',y;if(w.listeners){if(typeof w.listeners!="object")return y.valid=!1,y.error=S+'"listeners" property must be an object but '+typeof w.listeners+" given",y;for(var L in w.listeners)if(w.listeners.hasOwnProperty(L)&&typeof w.listeners[L]!="function")return y.valid=!1,y.error=S+'"listeners" property must be an hash of [event name]: [callback]. listeners.'+L+" must be a function but "+typeof w.listeners[L]+" given",y}if(w.filter){if(typeof w.filter!="function")return y.valid=!1,y.error=S+'"filter" must be a function, but '+typeof w.filter+" given",y}else if(w.regex){if(e.helper.isString(w.regex)&&(w.regex=new RegExp(w.regex,"g")),!(w.regex instanceof RegExp))return y.valid=!1,y.error=S+'"regex" property must either be a string or a RegExp object, but '+typeof w.regex+" given",y;if(e.helper.isUndefined(w.replace))return y.valid=!1,y.error=S+'"regex" extensions must implement a replace string or function',y}}return y}e.validateExtension=function(d){"use strict";var _=l(d,null);return _.valid?!0:(console.warn(_.error),!1)},e.hasOwnProperty("helper")||(e.helper={}),e.helper.isString=function(d){"use strict";return typeof d=="string"||d instanceof String},e.helper.isFunction=function(d){"use strict";var _={};return d&&_.toString.call(d)==="[object Function]"},e.helper.isArray=function(d){"use strict";return Array.isArray(d)},e.helper.isUndefined=function(d){"use strict";return typeof d=="undefined"},e.helper.forEach=function(d,_){"use strict";if(e.helper.isUndefined(d))throw new Error("obj param is required");if(e.helper.isUndefined(_))throw new Error("callback param is required");if(!e.helper.isFunction(_))throw new Error("callback param must be a function/closure");if(typeof d.forEach=="function")d.forEach(_);else if(e.helper.isArray(d))for(var m=0;m<d.length;m++)_(d[m],m,d);else if(typeof d=="object")for(var y in d)d.hasOwnProperty(y)&&_(d[y],y,d);else throw new Error("obj does not seem to be an array or an iterable object")},e.helper.stdExtName=function(d){"use strict";return d.replace(/[_?*+\/\\.^-]/g,"").replace(/\s/g,"").toLowerCase()};function u(d,_){"use strict";var m=_.charCodeAt(0);return"\xA8E"+m+"E"}e.helper.escapeCharactersCallback=u,e.helper.escapeCharacters=function(d,_,m){"use strict";var y="(["+_.replace(/([\[\]\\])/g,"\\$1")+"])";m&&(y="\\\\"+y);var x=new RegExp(y,"g");return d=d.replace(x,u),d},e.helper.unescapeHTMLEntities=function(d){"use strict";return d.replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")};var c=function(d,_,m,y){"use strict";var x=y||"",S=x.indexOf("g")>-1,w=new RegExp(_+"|"+m,"g"+x.replace(/g/g,"")),E=new RegExp(_,x.replace(/g/g,"")),L=[],I,A,B,T,M;do for(I=0;B=w.exec(d);)if(E.test(B[0]))I++||(A=w.lastIndex,T=A-B[0].length);else if(I&&!--I){M=B.index+B[0].length;var j={left:{start:T,end:A},match:{start:A,end:B.index},right:{start:B.index,end:M},wholeMatch:{start:T,end:M}};if(L.push(j),!S)return L}while(I&&(w.lastIndex=A));return L};e.helper.matchRecursiveRegExp=function(d,_,m,y){"use strict";for(var x=c(d,_,m,y),S=[],w=0;w<x.length;++w)S.push([d.slice(x[w].wholeMatch.start,x[w].wholeMatch.end),d.slice(x[w].match.start,x[w].match.end),d.slice(x[w].left.start,x[w].left.end),d.slice(x[w].right.start,x[w].right.end)]);return S},e.helper.replaceRecursiveRegExp=function(d,_,m,y,x){"use strict";if(!e.helper.isFunction(_)){var S=_;_=function(){return S}}var w=c(d,m,y,x),E=d,L=w.length;if(L>0){var I=[];w[0].wholeMatch.start!==0&&I.push(d.slice(0,w[0].wholeMatch.start));for(var A=0;A<L;++A)I.push(_(d.slice(w[A].wholeMatch.start,w[A].wholeMatch.end),d.slice(w[A].match.start,w[A].match.end),d.slice(w[A].left.start,w[A].left.end),d.slice(w[A].right.start,w[A].right.end))),A<L-1&&I.push(d.slice(w[A].wholeMatch.end,w[A+1].wholeMatch.start));w[L-1].wholeMatch.end<d.length&&I.push(d.slice(w[L-1].wholeMatch.end)),E=I.join("")}return E},e.helper.regexIndexOf=function(d,_,m){"use strict";if(!e.helper.isString(d))throw"InvalidArgumentError: first parameter of showdown.helper.regexIndexOf function must be a string";if(!(_ instanceof RegExp))throw"InvalidArgumentError: second parameter of showdown.helper.regexIndexOf function must be an instance of RegExp";var y=d.substring(m||0).search(_);return y>=0?y+(m||0):y},e.helper.splitAtIndex=function(d,_){"use strict";if(!e.helper.isString(d))throw"InvalidArgumentError: first parameter of showdown.helper.regexIndexOf function must be a string";return[d.substring(0,_),d.substring(_)]},e.helper.encodeEmailAddress=function(d){"use strict";var _=[function(m){return"&#"+m.charCodeAt(0)+";"},function(m){return"&#x"+m.charCodeAt(0).toString(16)+";"},function(m){return m}];return d=d.replace(/./g,function(m){if(m==="@")m=_[Math.floor(Math.random()*2)](m);else{var y=Math.random();m=y>.9?_[2](m):y>.45?_[1](m):_[0](m)}return m}),d},e.helper.padEnd=function(_,m,y){"use strict";return m=m>>0,y=String(y||" "),_.length>m?String(_):(m=m-_.length,m>y.length&&(y+=y.repeat(m/y.length)),String(_)+y.slice(0,m))},typeof console=="undefined"&&(console={warn:function(d){"use strict";alert(d)},log:function(d){"use strict";alert(d)},error:function(d){"use strict";throw d}}),e.helper.regexes={asteriskDashAndColon:/([*_:~])/g},e.helper.emojis={"+1":"\u{1F44D}","-1":"\u{1F44E}","100":"\u{1F4AF}","1234":"\u{1F522}","1st_place_medal":"\u{1F947}","2nd_place_medal":"\u{1F948}","3rd_place_medal":"\u{1F949}","8ball":"\u{1F3B1}",a:"\u{1F170}\uFE0F",ab:"\u{1F18E}",abc:"\u{1F524}",abcd:"\u{1F521}",accept:"\u{1F251}",aerial_tramway:"\u{1F6A1}",airplane:"\u2708\uFE0F",alarm_clock:"\u23F0",alembic:"\u2697\uFE0F",alien:"\u{1F47D}",ambulance:"\u{1F691}",amphora:"\u{1F3FA}",anchor:"\u2693\uFE0F",angel:"\u{1F47C}",anger:"\u{1F4A2}",angry:"\u{1F620}",anguished:"\u{1F627}",ant:"\u{1F41C}",apple:"\u{1F34E}",aquarius:"\u2652\uFE0F",aries:"\u2648\uFE0F",arrow_backward:"\u25C0\uFE0F",arrow_double_down:"\u23EC",arrow_double_up:"\u23EB",arrow_down:"\u2B07\uFE0F",arrow_down_small:"\u{1F53D}",arrow_forward:"\u25B6\uFE0F",arrow_heading_down:"\u2935\uFE0F",arrow_heading_up:"\u2934\uFE0F",arrow_left:"\u2B05\uFE0F",arrow_lower_left:"\u2199\uFE0F",arrow_lower_right:"\u2198\uFE0F",arrow_right:"\u27A1\uFE0F",arrow_right_hook:"\u21AA\uFE0F",arrow_up:"\u2B06\uFE0F",arrow_up_down:"\u2195\uFE0F",arrow_up_small:"\u{1F53C}",arrow_upper_left:"\u2196\uFE0F",arrow_upper_right:"\u2197\uFE0F",arrows_clockwise:"\u{1F503}",arrows_counterclockwise:"\u{1F504}",art:"\u{1F3A8}",articulated_lorry:"\u{1F69B}",artificial_satellite:"\u{1F6F0}",astonished:"\u{1F632}",athletic_shoe:"\u{1F45F}",atm:"\u{1F3E7}",atom_symbol:"\u269B\uFE0F",avocado:"\u{1F951}",b:"\u{1F171}\uFE0F",baby:"\u{1F476}",baby_bottle:"\u{1F37C}",baby_chick:"\u{1F424}",baby_symbol:"\u{1F6BC}",back:"\u{1F519}",bacon:"\u{1F953}",badminton:"\u{1F3F8}",baggage_claim:"\u{1F6C4}",baguette_bread:"\u{1F956}",balance_scale:"\u2696\uFE0F",balloon:"\u{1F388}",ballot_box:"\u{1F5F3}",ballot_box_with_check:"\u2611\uFE0F",bamboo:"\u{1F38D}",banana:"\u{1F34C}",bangbang:"\u203C\uFE0F",bank:"\u{1F3E6}",bar_chart:"\u{1F4CA}",barber:"\u{1F488}",baseball:"\u26BE\uFE0F",basketball:"\u{1F3C0}",basketball_man:"\u26F9\uFE0F",basketball_woman:"\u26F9\uFE0F&zwj;\u2640\uFE0F",bat:"\u{1F987}",bath:"\u{1F6C0}",bathtub:"\u{1F6C1}",battery:"\u{1F50B}",beach_umbrella:"\u{1F3D6}",bear:"\u{1F43B}",bed:"\u{1F6CF}",bee:"\u{1F41D}",beer:"\u{1F37A}",beers:"\u{1F37B}",beetle:"\u{1F41E}",beginner:"\u{1F530}",bell:"\u{1F514}",bellhop_bell:"\u{1F6CE}",bento:"\u{1F371}",biking_man:"\u{1F6B4}",bike:"\u{1F6B2}",biking_woman:"\u{1F6B4}&zwj;\u2640\uFE0F",bikini:"\u{1F459}",biohazard:"\u2623\uFE0F",bird:"\u{1F426}",birthday:"\u{1F382}",black_circle:"\u26AB\uFE0F",black_flag:"\u{1F3F4}",black_heart:"\u{1F5A4}",black_joker:"\u{1F0CF}",black_large_square:"\u2B1B\uFE0F",black_medium_small_square:"\u25FE\uFE0F",black_medium_square:"\u25FC\uFE0F",black_nib:"\u2712\uFE0F",black_small_square:"\u25AA\uFE0F",black_square_button:"\u{1F532}",blonde_man:"\u{1F471}",blonde_woman:"\u{1F471}&zwj;\u2640\uFE0F",blossom:"\u{1F33C}",blowfish:"\u{1F421}",blue_book:"\u{1F4D8}",blue_car:"\u{1F699}",blue_heart:"\u{1F499}",blush:"\u{1F60A}",boar:"\u{1F417}",boat:"\u26F5\uFE0F",bomb:"\u{1F4A3}",book:"\u{1F4D6}",bookmark:"\u{1F516}",bookmark_tabs:"\u{1F4D1}",books:"\u{1F4DA}",boom:"\u{1F4A5}",boot:"\u{1F462}",bouquet:"\u{1F490}",bowing_man:"\u{1F647}",bow_and_arrow:"\u{1F3F9}",bowing_woman:"\u{1F647}&zwj;\u2640\uFE0F",bowling:"\u{1F3B3}",boxing_glove:"\u{1F94A}",boy:"\u{1F466}",bread:"\u{1F35E}",bride_with_veil:"\u{1F470}",bridge_at_night:"\u{1F309}",briefcase:"\u{1F4BC}",broken_heart:"\u{1F494}",bug:"\u{1F41B}",building_construction:"\u{1F3D7}",bulb:"\u{1F4A1}",bullettrain_front:"\u{1F685}",bullettrain_side:"\u{1F684}",burrito:"\u{1F32F}",bus:"\u{1F68C}",business_suit_levitating:"\u{1F574}",busstop:"\u{1F68F}",bust_in_silhouette:"\u{1F464}",busts_in_silhouette:"\u{1F465}",butterfly:"\u{1F98B}",cactus:"\u{1F335}",cake:"\u{1F370}",calendar:"\u{1F4C6}",call_me_hand:"\u{1F919}",calling:"\u{1F4F2}",camel:"\u{1F42B}",camera:"\u{1F4F7}",camera_flash:"\u{1F4F8}",camping:"\u{1F3D5}",cancer:"\u264B\uFE0F",candle:"\u{1F56F}",candy:"\u{1F36C}",canoe:"\u{1F6F6}",capital_abcd:"\u{1F520}",capricorn:"\u2651\uFE0F",car:"\u{1F697}",card_file_box:"\u{1F5C3}",card_index:"\u{1F4C7}",card_index_dividers:"\u{1F5C2}",carousel_horse:"\u{1F3A0}",carrot:"\u{1F955}",cat:"\u{1F431}",cat2:"\u{1F408}",cd:"\u{1F4BF}",chains:"\u26D3",champagne:"\u{1F37E}",chart:"\u{1F4B9}",chart_with_downwards_trend:"\u{1F4C9}",chart_with_upwards_trend:"\u{1F4C8}",checkered_flag:"\u{1F3C1}",cheese:"\u{1F9C0}",cherries:"\u{1F352}",cherry_blossom:"\u{1F338}",chestnut:"\u{1F330}",chicken:"\u{1F414}",children_crossing:"\u{1F6B8}",chipmunk:"\u{1F43F}",chocolate_bar:"\u{1F36B}",christmas_tree:"\u{1F384}",church:"\u26EA\uFE0F",cinema:"\u{1F3A6}",circus_tent:"\u{1F3AA}",city_sunrise:"\u{1F307}",city_sunset:"\u{1F306}",cityscape:"\u{1F3D9}",cl:"\u{1F191}",clamp:"\u{1F5DC}",clap:"\u{1F44F}",clapper:"\u{1F3AC}",classical_building:"\u{1F3DB}",clinking_glasses:"\u{1F942}",clipboard:"\u{1F4CB}",clock1:"\u{1F550}",clock10:"\u{1F559}",clock1030:"\u{1F565}",clock11:"\u{1F55A}",clock1130:"\u{1F566}",clock12:"\u{1F55B}",clock1230:"\u{1F567}",clock130:"\u{1F55C}",clock2:"\u{1F551}",clock230:"\u{1F55D}",clock3:"\u{1F552}",clock330:"\u{1F55E}",clock4:"\u{1F553}",clock430:"\u{1F55F}",clock5:"\u{1F554}",clock530:"\u{1F560}",clock6:"\u{1F555}",clock630:"\u{1F561}",clock7:"\u{1F556}",clock730:"\u{1F562}",clock8:"\u{1F557}",clock830:"\u{1F563}",clock9:"\u{1F558}",clock930:"\u{1F564}",closed_book:"\u{1F4D5}",closed_lock_with_key:"\u{1F510}",closed_umbrella:"\u{1F302}",cloud:"\u2601\uFE0F",cloud_with_lightning:"\u{1F329}",cloud_with_lightning_and_rain:"\u26C8",cloud_with_rain:"\u{1F327}",cloud_with_snow:"\u{1F328}",clown_face:"\u{1F921}",clubs:"\u2663\uFE0F",cocktail:"\u{1F378}",coffee:"\u2615\uFE0F",coffin:"\u26B0\uFE0F",cold_sweat:"\u{1F630}",comet:"\u2604\uFE0F",computer:"\u{1F4BB}",computer_mouse:"\u{1F5B1}",confetti_ball:"\u{1F38A}",confounded:"\u{1F616}",confused:"\u{1F615}",congratulations:"\u3297\uFE0F",construction:"\u{1F6A7}",construction_worker_man:"\u{1F477}",construction_worker_woman:"\u{1F477}&zwj;\u2640\uFE0F",control_knobs:"\u{1F39B}",convenience_store:"\u{1F3EA}",cookie:"\u{1F36A}",cool:"\u{1F192}",policeman:"\u{1F46E}",copyright:"\xA9\uFE0F",corn:"\u{1F33D}",couch_and_lamp:"\u{1F6CB}",couple:"\u{1F46B}",couple_with_heart_woman_man:"\u{1F491}",couple_with_heart_man_man:"\u{1F468}&zwj;\u2764\uFE0F&zwj;\u{1F468}",couple_with_heart_woman_woman:"\u{1F469}&zwj;\u2764\uFE0F&zwj;\u{1F469}",couplekiss_man_man:"\u{1F468}&zwj;\u2764\uFE0F&zwj;\u{1F48B}&zwj;\u{1F468}",couplekiss_man_woman:"\u{1F48F}",couplekiss_woman_woman:"\u{1F469}&zwj;\u2764\uFE0F&zwj;\u{1F48B}&zwj;\u{1F469}",cow:"\u{1F42E}",cow2:"\u{1F404}",cowboy_hat_face:"\u{1F920}",crab:"\u{1F980}",crayon:"\u{1F58D}",credit_card:"\u{1F4B3}",crescent_moon:"\u{1F319}",cricket:"\u{1F3CF}",crocodile:"\u{1F40A}",croissant:"\u{1F950}",crossed_fingers:"\u{1F91E}",crossed_flags:"\u{1F38C}",crossed_swords:"\u2694\uFE0F",crown:"\u{1F451}",cry:"\u{1F622}",crying_cat_face:"\u{1F63F}",crystal_ball:"\u{1F52E}",cucumber:"\u{1F952}",cupid:"\u{1F498}",curly_loop:"\u27B0",currency_exchange:"\u{1F4B1}",curry:"\u{1F35B}",custard:"\u{1F36E}",customs:"\u{1F6C3}",cyclone:"\u{1F300}",dagger:"\u{1F5E1}",dancer:"\u{1F483}",dancing_women:"\u{1F46F}",dancing_men:"\u{1F46F}&zwj;\u2642\uFE0F",dango:"\u{1F361}",dark_sunglasses:"\u{1F576}",dart:"\u{1F3AF}",dash:"\u{1F4A8}",date:"\u{1F4C5}",deciduous_tree:"\u{1F333}",deer:"\u{1F98C}",department_store:"\u{1F3EC}",derelict_house:"\u{1F3DA}",desert:"\u{1F3DC}",desert_island:"\u{1F3DD}",desktop_computer:"\u{1F5A5}",male_detective:"\u{1F575}\uFE0F",diamond_shape_with_a_dot_inside:"\u{1F4A0}",diamonds:"\u2666\uFE0F",disappointed:"\u{1F61E}",disappointed_relieved:"\u{1F625}",dizzy:"\u{1F4AB}",dizzy_face:"\u{1F635}",do_not_litter:"\u{1F6AF}",dog:"\u{1F436}",dog2:"\u{1F415}",dollar:"\u{1F4B5}",dolls:"\u{1F38E}",dolphin:"\u{1F42C}",door:"\u{1F6AA}",doughnut:"\u{1F369}",dove:"\u{1F54A}",dragon:"\u{1F409}",dragon_face:"\u{1F432}",dress:"\u{1F457}",dromedary_camel:"\u{1F42A}",drooling_face:"\u{1F924}",droplet:"\u{1F4A7}",drum:"\u{1F941}",duck:"\u{1F986}",dvd:"\u{1F4C0}","e-mail":"\u{1F4E7}",eagle:"\u{1F985}",ear:"\u{1F442}",ear_of_rice:"\u{1F33E}",earth_africa:"\u{1F30D}",earth_americas:"\u{1F30E}",earth_asia:"\u{1F30F}",egg:"\u{1F95A}",eggplant:"\u{1F346}",eight_pointed_black_star:"\u2734\uFE0F",eight_spoked_asterisk:"\u2733\uFE0F",electric_plug:"\u{1F50C}",elephant:"\u{1F418}",email:"\u2709\uFE0F",end:"\u{1F51A}",envelope_with_arrow:"\u{1F4E9}",euro:"\u{1F4B6}",european_castle:"\u{1F3F0}",european_post_office:"\u{1F3E4}",evergreen_tree:"\u{1F332}",exclamation:"\u2757\uFE0F",expressionless:"\u{1F611}",eye:"\u{1F441}",eye_speech_bubble:"\u{1F441}&zwj;\u{1F5E8}",eyeglasses:"\u{1F453}",eyes:"\u{1F440}",face_with_head_bandage:"\u{1F915}",face_with_thermometer:"\u{1F912}",fist_oncoming:"\u{1F44A}",factory:"\u{1F3ED}",fallen_leaf:"\u{1F342}",family_man_woman_boy:"\u{1F46A}",family_man_boy:"\u{1F468}&zwj;\u{1F466}",family_man_boy_boy:"\u{1F468}&zwj;\u{1F466}&zwj;\u{1F466}",family_man_girl:"\u{1F468}&zwj;\u{1F467}",family_man_girl_boy:"\u{1F468}&zwj;\u{1F467}&zwj;\u{1F466}",family_man_girl_girl:"\u{1F468}&zwj;\u{1F467}&zwj;\u{1F467}",family_man_man_boy:"\u{1F468}&zwj;\u{1F468}&zwj;\u{1F466}",family_man_man_boy_boy:"\u{1F468}&zwj;\u{1F468}&zwj;\u{1F466}&zwj;\u{1F466}",family_man_man_girl:"\u{1F468}&zwj;\u{1F468}&zwj;\u{1F467}",family_man_man_girl_boy:"\u{1F468}&zwj;\u{1F468}&zwj;\u{1F467}&zwj;\u{1F466}",family_man_man_girl_girl:"\u{1F468}&zwj;\u{1F468}&zwj;\u{1F467}&zwj;\u{1F467}",family_man_woman_boy_boy:"\u{1F468}&zwj;\u{1F469}&zwj;\u{1F466}&zwj;\u{1F466}",family_man_woman_girl:"\u{1F468}&zwj;\u{1F469}&zwj;\u{1F467}",family_man_woman_girl_boy:"\u{1F468}&zwj;\u{1F469}&zwj;\u{1F467}&zwj;\u{1F466}",family_man_woman_girl_girl:"\u{1F468}&zwj;\u{1F469}&zwj;\u{1F467}&zwj;\u{1F467}",family_woman_boy:"\u{1F469}&zwj;\u{1F466}",family_woman_boy_boy:"\u{1F469}&zwj;\u{1F466}&zwj;\u{1F466}",family_woman_girl:"\u{1F469}&zwj;\u{1F467}",family_woman_girl_boy:"\u{1F469}&zwj;\u{1F467}&zwj;\u{1F466}",family_woman_girl_girl:"\u{1F469}&zwj;\u{1F467}&zwj;\u{1F467}",family_woman_woman_boy:"\u{1F469}&zwj;\u{1F469}&zwj;\u{1F466}",family_woman_woman_boy_boy:"\u{1F469}&zwj;\u{1F469}&zwj;\u{1F466}&zwj;\u{1F466}",family_woman_woman_girl:"\u{1F469}&zwj;\u{1F469}&zwj;\u{1F467}",family_woman_woman_girl_boy:"\u{1F469}&zwj;\u{1F469}&zwj;\u{1F467}&zwj;\u{1F466}",family_woman_woman_girl_girl:"\u{1F469}&zwj;\u{1F469}&zwj;\u{1F467}&zwj;\u{1F467}",fast_forward:"\u23E9",fax:"\u{1F4E0}",fearful:"\u{1F628}",feet:"\u{1F43E}",female_detective:"\u{1F575}\uFE0F&zwj;\u2640\uFE0F",ferris_wheel:"\u{1F3A1}",ferry:"\u26F4",field_hockey:"\u{1F3D1}",file_cabinet:"\u{1F5C4}",file_folder:"\u{1F4C1}",film_projector:"\u{1F4FD}",film_strip:"\u{1F39E}",fire:"\u{1F525}",fire_engine:"\u{1F692}",fireworks:"\u{1F386}",first_quarter_moon:"\u{1F313}",first_quarter_moon_with_face:"\u{1F31B}",fish:"\u{1F41F}",fish_cake:"\u{1F365}",fishing_pole_and_fish:"\u{1F3A3}",fist_raised:"\u270A",fist_left:"\u{1F91B}",fist_right:"\u{1F91C}",flags:"\u{1F38F}",flashlight:"\u{1F526}",fleur_de_lis:"\u269C\uFE0F",flight_arrival:"\u{1F6EC}",flight_departure:"\u{1F6EB}",floppy_disk:"\u{1F4BE}",flower_playing_cards:"\u{1F3B4}",flushed:"\u{1F633}",fog:"\u{1F32B}",foggy:"\u{1F301}",football:"\u{1F3C8}",footprints:"\u{1F463}",fork_and_knife:"\u{1F374}",fountain:"\u26F2\uFE0F",fountain_pen:"\u{1F58B}",four_leaf_clover:"\u{1F340}",fox_face:"\u{1F98A}",framed_picture:"\u{1F5BC}",free:"\u{1F193}",fried_egg:"\u{1F373}",fried_shrimp:"\u{1F364}",fries:"\u{1F35F}",frog:"\u{1F438}",frowning:"\u{1F626}",frowning_face:"\u2639\uFE0F",frowning_man:"\u{1F64D}&zwj;\u2642\uFE0F",frowning_woman:"\u{1F64D}",middle_finger:"\u{1F595}",fuelpump:"\u26FD\uFE0F",full_moon:"\u{1F315}",full_moon_with_face:"\u{1F31D}",funeral_urn:"\u26B1\uFE0F",game_die:"\u{1F3B2}",gear:"\u2699\uFE0F",gem:"\u{1F48E}",gemini:"\u264A\uFE0F",ghost:"\u{1F47B}",gift:"\u{1F381}",gift_heart:"\u{1F49D}",girl:"\u{1F467}",globe_with_meridians:"\u{1F310}",goal_net:"\u{1F945}",goat:"\u{1F410}",golf:"\u26F3\uFE0F",golfing_man:"\u{1F3CC}\uFE0F",golfing_woman:"\u{1F3CC}\uFE0F&zwj;\u2640\uFE0F",gorilla:"\u{1F98D}",grapes:"\u{1F347}",green_apple:"\u{1F34F}",green_book:"\u{1F4D7}",green_heart:"\u{1F49A}",green_salad:"\u{1F957}",grey_exclamation:"\u2755",grey_question:"\u2754",grimacing:"\u{1F62C}",grin:"\u{1F601}",grinning:"\u{1F600}",guardsman:"\u{1F482}",guardswoman:"\u{1F482}&zwj;\u2640\uFE0F",guitar:"\u{1F3B8}",gun:"\u{1F52B}",haircut_woman:"\u{1F487}",haircut_man:"\u{1F487}&zwj;\u2642\uFE0F",hamburger:"\u{1F354}",hammer:"\u{1F528}",hammer_and_pick:"\u2692",hammer_and_wrench:"\u{1F6E0}",hamster:"\u{1F439}",hand:"\u270B",handbag:"\u{1F45C}",handshake:"\u{1F91D}",hankey:"\u{1F4A9}",hatched_chick:"\u{1F425}",hatching_chick:"\u{1F423}",headphones:"\u{1F3A7}",hear_no_evil:"\u{1F649}",heart:"\u2764\uFE0F",heart_decoration:"\u{1F49F}",heart_eyes:"\u{1F60D}",heart_eyes_cat:"\u{1F63B}",heartbeat:"\u{1F493}",heartpulse:"\u{1F497}",hearts:"\u2665\uFE0F",heavy_check_mark:"\u2714\uFE0F",heavy_division_sign:"\u2797",heavy_dollar_sign:"\u{1F4B2}",heavy_heart_exclamation:"\u2763\uFE0F",heavy_minus_sign:"\u2796",heavy_multiplication_x:"\u2716\uFE0F",heavy_plus_sign:"\u2795",helicopter:"\u{1F681}",herb:"\u{1F33F}",hibiscus:"\u{1F33A}",high_brightness:"\u{1F506}",high_heel:"\u{1F460}",hocho:"\u{1F52A}",hole:"\u{1F573}",honey_pot:"\u{1F36F}",horse:"\u{1F434}",horse_racing:"\u{1F3C7}",hospital:"\u{1F3E5}",hot_pepper:"\u{1F336}",hotdog:"\u{1F32D}",hotel:"\u{1F3E8}",hotsprings:"\u2668\uFE0F",hourglass:"\u231B\uFE0F",hourglass_flowing_sand:"\u23F3",house:"\u{1F3E0}",house_with_garden:"\u{1F3E1}",houses:"\u{1F3D8}",hugs:"\u{1F917}",hushed:"\u{1F62F}",ice_cream:"\u{1F368}",ice_hockey:"\u{1F3D2}",ice_skate:"\u26F8",icecream:"\u{1F366}",id:"\u{1F194}",ideograph_advantage:"\u{1F250}",imp:"\u{1F47F}",inbox_tray:"\u{1F4E5}",incoming_envelope:"\u{1F4E8}",tipping_hand_woman:"\u{1F481}",information_source:"\u2139\uFE0F",innocent:"\u{1F607}",interrobang:"\u2049\uFE0F",iphone:"\u{1F4F1}",izakaya_lantern:"\u{1F3EE}",jack_o_lantern:"\u{1F383}",japan:"\u{1F5FE}",japanese_castle:"\u{1F3EF}",japanese_goblin:"\u{1F47A}",japanese_ogre:"\u{1F479}",jeans:"\u{1F456}",joy:"\u{1F602}",joy_cat:"\u{1F639}",joystick:"\u{1F579}",kaaba:"\u{1F54B}",key:"\u{1F511}",keyboard:"\u2328\uFE0F",keycap_ten:"\u{1F51F}",kick_scooter:"\u{1F6F4}",kimono:"\u{1F458}",kiss:"\u{1F48B}",kissing:"\u{1F617}",kissing_cat:"\u{1F63D}",kissing_closed_eyes:"\u{1F61A}",kissing_heart:"\u{1F618}",kissing_smiling_eyes:"\u{1F619}",kiwi_fruit:"\u{1F95D}",koala:"\u{1F428}",koko:"\u{1F201}",label:"\u{1F3F7}",large_blue_circle:"\u{1F535}",large_blue_diamond:"\u{1F537}",large_orange_diamond:"\u{1F536}",last_quarter_moon:"\u{1F317}",last_quarter_moon_with_face:"\u{1F31C}",latin_cross:"\u271D\uFE0F",laughing:"\u{1F606}",leaves:"\u{1F343}",ledger:"\u{1F4D2}",left_luggage:"\u{1F6C5}",left_right_arrow:"\u2194\uFE0F",leftwards_arrow_with_hook:"\u21A9\uFE0F",lemon:"\u{1F34B}",leo:"\u264C\uFE0F",leopard:"\u{1F406}",level_slider:"\u{1F39A}",libra:"\u264E\uFE0F",light_rail:"\u{1F688}",link:"\u{1F517}",lion:"\u{1F981}",lips:"\u{1F444}",lipstick:"\u{1F484}",lizard:"\u{1F98E}",lock:"\u{1F512}",lock_with_ink_pen:"\u{1F50F}",lollipop:"\u{1F36D}",loop:"\u27BF",loud_sound:"\u{1F50A}",loudspeaker:"\u{1F4E2}",love_hotel:"\u{1F3E9}",love_letter:"\u{1F48C}",low_brightness:"\u{1F505}",lying_face:"\u{1F925}",m:"\u24C2\uFE0F",mag:"\u{1F50D}",mag_right:"\u{1F50E}",mahjong:"\u{1F004}\uFE0F",mailbox:"\u{1F4EB}",mailbox_closed:"\u{1F4EA}",mailbox_with_mail:"\u{1F4EC}",mailbox_with_no_mail:"\u{1F4ED}",man:"\u{1F468}",man_artist:"\u{1F468}&zwj;\u{1F3A8}",man_astronaut:"\u{1F468}&zwj;\u{1F680}",man_cartwheeling:"\u{1F938}&zwj;\u2642\uFE0F",man_cook:"\u{1F468}&zwj;\u{1F373}",man_dancing:"\u{1F57A}",man_facepalming:"\u{1F926}&zwj;\u2642\uFE0F",man_factory_worker:"\u{1F468}&zwj;\u{1F3ED}",man_farmer:"\u{1F468}&zwj;\u{1F33E}",man_firefighter:"\u{1F468}&zwj;\u{1F692}",man_health_worker:"\u{1F468}&zwj;\u2695\uFE0F",man_in_tuxedo:"\u{1F935}",man_judge:"\u{1F468}&zwj;\u2696\uFE0F",man_juggling:"\u{1F939}&zwj;\u2642\uFE0F",man_mechanic:"\u{1F468}&zwj;\u{1F527}",man_office_worker:"\u{1F468}&zwj;\u{1F4BC}",man_pilot:"\u{1F468}&zwj;\u2708\uFE0F",man_playing_handball:"\u{1F93E}&zwj;\u2642\uFE0F",man_playing_water_polo:"\u{1F93D}&zwj;\u2642\uFE0F",man_scientist:"\u{1F468}&zwj;\u{1F52C}",man_shrugging:"\u{1F937}&zwj;\u2642\uFE0F",man_singer:"\u{1F468}&zwj;\u{1F3A4}",man_student:"\u{1F468}&zwj;\u{1F393}",man_teacher:"\u{1F468}&zwj;\u{1F3EB}",man_technologist:"\u{1F468}&zwj;\u{1F4BB}",man_with_gua_pi_mao:"\u{1F472}",man_with_turban:"\u{1F473}",tangerine:"\u{1F34A}",mans_shoe:"\u{1F45E}",mantelpiece_clock:"\u{1F570}",maple_leaf:"\u{1F341}",martial_arts_uniform:"\u{1F94B}",mask:"\u{1F637}",massage_woman:"\u{1F486}",massage_man:"\u{1F486}&zwj;\u2642\uFE0F",meat_on_bone:"\u{1F356}",medal_military:"\u{1F396}",medal_sports:"\u{1F3C5}",mega:"\u{1F4E3}",melon:"\u{1F348}",memo:"\u{1F4DD}",men_wrestling:"\u{1F93C}&zwj;\u2642\uFE0F",menorah:"\u{1F54E}",mens:"\u{1F6B9}",metal:"\u{1F918}",metro:"\u{1F687}",microphone:"\u{1F3A4}",microscope:"\u{1F52C}",milk_glass:"\u{1F95B}",milky_way:"\u{1F30C}",minibus:"\u{1F690}",minidisc:"\u{1F4BD}",mobile_phone_off:"\u{1F4F4}",money_mouth_face:"\u{1F911}",money_with_wings:"\u{1F4B8}",moneybag:"\u{1F4B0}",monkey:"\u{1F412}",monkey_face:"\u{1F435}",monorail:"\u{1F69D}",moon:"\u{1F314}",mortar_board:"\u{1F393}",mosque:"\u{1F54C}",motor_boat:"\u{1F6E5}",motor_scooter:"\u{1F6F5}",motorcycle:"\u{1F3CD}",motorway:"\u{1F6E3}",mount_fuji:"\u{1F5FB}",mountain:"\u26F0",mountain_biking_man:"\u{1F6B5}",mountain_biking_woman:"\u{1F6B5}&zwj;\u2640\uFE0F",mountain_cableway:"\u{1F6A0}",mountain_railway:"\u{1F69E}",mountain_snow:"\u{1F3D4}",mouse:"\u{1F42D}",mouse2:"\u{1F401}",movie_camera:"\u{1F3A5}",moyai:"\u{1F5FF}",mrs_claus:"\u{1F936}",muscle:"\u{1F4AA}",mushroom:"\u{1F344}",musical_keyboard:"\u{1F3B9}",musical_note:"\u{1F3B5}",musical_score:"\u{1F3BC}",mute:"\u{1F507}",nail_care:"\u{1F485}",name_badge:"\u{1F4DB}",national_park:"\u{1F3DE}",nauseated_face:"\u{1F922}",necktie:"\u{1F454}",negative_squared_cross_mark:"\u274E",nerd_face:"\u{1F913}",neutral_face:"\u{1F610}",new:"\u{1F195}",new_moon:"\u{1F311}",new_moon_with_face:"\u{1F31A}",newspaper:"\u{1F4F0}",newspaper_roll:"\u{1F5DE}",next_track_button:"\u23ED",ng:"\u{1F196}",no_good_man:"\u{1F645}&zwj;\u2642\uFE0F",no_good_woman:"\u{1F645}",night_with_stars:"\u{1F303}",no_bell:"\u{1F515}",no_bicycles:"\u{1F6B3}",no_entry:"\u26D4\uFE0F",no_entry_sign:"\u{1F6AB}",no_mobile_phones:"\u{1F4F5}",no_mouth:"\u{1F636}",no_pedestrians:"\u{1F6B7}",no_smoking:"\u{1F6AD}","non-potable_water":"\u{1F6B1}",nose:"\u{1F443}",notebook:"\u{1F4D3}",notebook_with_decorative_cover:"\u{1F4D4}",notes:"\u{1F3B6}",nut_and_bolt:"\u{1F529}",o:"\u2B55\uFE0F",o2:"\u{1F17E}\uFE0F",ocean:"\u{1F30A}",octopus:"\u{1F419}",oden:"\u{1F362}",office:"\u{1F3E2}",oil_drum:"\u{1F6E2}",ok:"\u{1F197}",ok_hand:"\u{1F44C}",ok_man:"\u{1F646}&zwj;\u2642\uFE0F",ok_woman:"\u{1F646}",old_key:"\u{1F5DD}",older_man:"\u{1F474}",older_woman:"\u{1F475}",om:"\u{1F549}",on:"\u{1F51B}",oncoming_automobile:"\u{1F698}",oncoming_bus:"\u{1F68D}",oncoming_police_car:"\u{1F694}",oncoming_taxi:"\u{1F696}",open_file_folder:"\u{1F4C2}",open_hands:"\u{1F450}",open_mouth:"\u{1F62E}",open_umbrella:"\u2602\uFE0F",ophiuchus:"\u26CE",orange_book:"\u{1F4D9}",orthodox_cross:"\u2626\uFE0F",outbox_tray:"\u{1F4E4}",owl:"\u{1F989}",ox:"\u{1F402}",package:"\u{1F4E6}",page_facing_up:"\u{1F4C4}",page_with_curl:"\u{1F4C3}",pager:"\u{1F4DF}",paintbrush:"\u{1F58C}",palm_tree:"\u{1F334}",pancakes:"\u{1F95E}",panda_face:"\u{1F43C}",paperclip:"\u{1F4CE}",paperclips:"\u{1F587}",parasol_on_ground:"\u26F1",parking:"\u{1F17F}\uFE0F",part_alternation_mark:"\u303D\uFE0F",partly_sunny:"\u26C5\uFE0F",passenger_ship:"\u{1F6F3}",passport_control:"\u{1F6C2}",pause_button:"\u23F8",peace_symbol:"\u262E\uFE0F",peach:"\u{1F351}",peanuts:"\u{1F95C}",pear:"\u{1F350}",pen:"\u{1F58A}",pencil2:"\u270F\uFE0F",penguin:"\u{1F427}",pensive:"\u{1F614}",performing_arts:"\u{1F3AD}",persevere:"\u{1F623}",person_fencing:"\u{1F93A}",pouting_woman:"\u{1F64E}",phone:"\u260E\uFE0F",pick:"\u26CF",pig:"\u{1F437}",pig2:"\u{1F416}",pig_nose:"\u{1F43D}",pill:"\u{1F48A}",pineapple:"\u{1F34D}",ping_pong:"\u{1F3D3}",pisces:"\u2653\uFE0F",pizza:"\u{1F355}",place_of_worship:"\u{1F6D0}",plate_with_cutlery:"\u{1F37D}",play_or_pause_button:"\u23EF",point_down:"\u{1F447}",point_left:"\u{1F448}",point_right:"\u{1F449}",point_up:"\u261D\uFE0F",point_up_2:"\u{1F446}",police_car:"\u{1F693}",policewoman:"\u{1F46E}&zwj;\u2640\uFE0F",poodle:"\u{1F429}",popcorn:"\u{1F37F}",post_office:"\u{1F3E3}",postal_horn:"\u{1F4EF}",postbox:"\u{1F4EE}",potable_water:"\u{1F6B0}",potato:"\u{1F954}",pouch:"\u{1F45D}",poultry_leg:"\u{1F357}",pound:"\u{1F4B7}",rage:"\u{1F621}",pouting_cat:"\u{1F63E}",pouting_man:"\u{1F64E}&zwj;\u2642\uFE0F",pray:"\u{1F64F}",prayer_beads:"\u{1F4FF}",pregnant_woman:"\u{1F930}",previous_track_button:"\u23EE",prince:"\u{1F934}",princess:"\u{1F478}",printer:"\u{1F5A8}",purple_heart:"\u{1F49C}",purse:"\u{1F45B}",pushpin:"\u{1F4CC}",put_litter_in_its_place:"\u{1F6AE}",question:"\u2753",rabbit:"\u{1F430}",rabbit2:"\u{1F407}",racehorse:"\u{1F40E}",racing_car:"\u{1F3CE}",radio:"\u{1F4FB}",radio_button:"\u{1F518}",radioactive:"\u2622\uFE0F",railway_car:"\u{1F683}",railway_track:"\u{1F6E4}",rainbow:"\u{1F308}",rainbow_flag:"\u{1F3F3}\uFE0F&zwj;\u{1F308}",raised_back_of_hand:"\u{1F91A}",raised_hand_with_fingers_splayed:"\u{1F590}",raised_hands:"\u{1F64C}",raising_hand_woman:"\u{1F64B}",raising_hand_man:"\u{1F64B}&zwj;\u2642\uFE0F",ram:"\u{1F40F}",ramen:"\u{1F35C}",rat:"\u{1F400}",record_button:"\u23FA",recycle:"\u267B\uFE0F",red_circle:"\u{1F534}",registered:"\xAE\uFE0F",relaxed:"\u263A\uFE0F",relieved:"\u{1F60C}",reminder_ribbon:"\u{1F397}",repeat:"\u{1F501}",repeat_one:"\u{1F502}",rescue_worker_helmet:"\u26D1",restroom:"\u{1F6BB}",revolving_hearts:"\u{1F49E}",rewind:"\u23EA",rhinoceros:"\u{1F98F}",ribbon:"\u{1F380}",rice:"\u{1F35A}",rice_ball:"\u{1F359}",rice_cracker:"\u{1F358}",rice_scene:"\u{1F391}",right_anger_bubble:"\u{1F5EF}",ring:"\u{1F48D}",robot:"\u{1F916}",rocket:"\u{1F680}",rofl:"\u{1F923}",roll_eyes:"\u{1F644}",roller_coaster:"\u{1F3A2}",rooster:"\u{1F413}",rose:"\u{1F339}",rosette:"\u{1F3F5}",rotating_light:"\u{1F6A8}",round_pushpin:"\u{1F4CD}",rowing_man:"\u{1F6A3}",rowing_woman:"\u{1F6A3}&zwj;\u2640\uFE0F",rugby_football:"\u{1F3C9}",running_man:"\u{1F3C3}",running_shirt_with_sash:"\u{1F3BD}",running_woman:"\u{1F3C3}&zwj;\u2640\uFE0F",sa:"\u{1F202}\uFE0F",sagittarius:"\u2650\uFE0F",sake:"\u{1F376}",sandal:"\u{1F461}",santa:"\u{1F385}",satellite:"\u{1F4E1}",saxophone:"\u{1F3B7}",school:"\u{1F3EB}",school_satchel:"\u{1F392}",scissors:"\u2702\uFE0F",scorpion:"\u{1F982}",scorpius:"\u264F\uFE0F",scream:"\u{1F631}",scream_cat:"\u{1F640}",scroll:"\u{1F4DC}",seat:"\u{1F4BA}",secret:"\u3299\uFE0F",see_no_evil:"\u{1F648}",seedling:"\u{1F331}",selfie:"\u{1F933}",shallow_pan_of_food:"\u{1F958}",shamrock:"\u2618\uFE0F",shark:"\u{1F988}",shaved_ice:"\u{1F367}",sheep:"\u{1F411}",shell:"\u{1F41A}",shield:"\u{1F6E1}",shinto_shrine:"\u26E9",ship:"\u{1F6A2}",shirt:"\u{1F455}",shopping:"\u{1F6CD}",shopping_cart:"\u{1F6D2}",shower:"\u{1F6BF}",shrimp:"\u{1F990}",signal_strength:"\u{1F4F6}",six_pointed_star:"\u{1F52F}",ski:"\u{1F3BF}",skier:"\u26F7",skull:"\u{1F480}",skull_and_crossbones:"\u2620\uFE0F",sleeping:"\u{1F634}",sleeping_bed:"\u{1F6CC}",sleepy:"\u{1F62A}",slightly_frowning_face:"\u{1F641}",slightly_smiling_face:"\u{1F642}",slot_machine:"\u{1F3B0}",small_airplane:"\u{1F6E9}",small_blue_diamond:"\u{1F539}",small_orange_diamond:"\u{1F538}",small_red_triangle:"\u{1F53A}",small_red_triangle_down:"\u{1F53B}",smile:"\u{1F604}",smile_cat:"\u{1F638}",smiley:"\u{1F603}",smiley_cat:"\u{1F63A}",smiling_imp:"\u{1F608}",smirk:"\u{1F60F}",smirk_cat:"\u{1F63C}",smoking:"\u{1F6AC}",snail:"\u{1F40C}",snake:"\u{1F40D}",sneezing_face:"\u{1F927}",snowboarder:"\u{1F3C2}",snowflake:"\u2744\uFE0F",snowman:"\u26C4\uFE0F",snowman_with_snow:"\u2603\uFE0F",sob:"\u{1F62D}",soccer:"\u26BD\uFE0F",soon:"\u{1F51C}",sos:"\u{1F198}",sound:"\u{1F509}",space_invader:"\u{1F47E}",spades:"\u2660\uFE0F",spaghetti:"\u{1F35D}",sparkle:"\u2747\uFE0F",sparkler:"\u{1F387}",sparkles:"\u2728",sparkling_heart:"\u{1F496}",speak_no_evil:"\u{1F64A}",speaker:"\u{1F508}",speaking_head:"\u{1F5E3}",speech_balloon:"\u{1F4AC}",speedboat:"\u{1F6A4}",spider:"\u{1F577}",spider_web:"\u{1F578}",spiral_calendar:"\u{1F5D3}",spiral_notepad:"\u{1F5D2}",spoon:"\u{1F944}",squid:"\u{1F991}",stadium:"\u{1F3DF}",star:"\u2B50\uFE0F",star2:"\u{1F31F}",star_and_crescent:"\u262A\uFE0F",star_of_david:"\u2721\uFE0F",stars:"\u{1F320}",station:"\u{1F689}",statue_of_liberty:"\u{1F5FD}",steam_locomotive:"\u{1F682}",stew:"\u{1F372}",stop_button:"\u23F9",stop_sign:"\u{1F6D1}",stopwatch:"\u23F1",straight_ruler:"\u{1F4CF}",strawberry:"\u{1F353}",stuck_out_tongue:"\u{1F61B}",stuck_out_tongue_closed_eyes:"\u{1F61D}",stuck_out_tongue_winking_eye:"\u{1F61C}",studio_microphone:"\u{1F399}",stuffed_flatbread:"\u{1F959}",sun_behind_large_cloud:"\u{1F325}",sun_behind_rain_cloud:"\u{1F326}",sun_behind_small_cloud:"\u{1F324}",sun_with_face:"\u{1F31E}",sunflower:"\u{1F33B}",sunglasses:"\u{1F60E}",sunny:"\u2600\uFE0F",sunrise:"\u{1F305}",sunrise_over_mountains:"\u{1F304}",surfing_man:"\u{1F3C4}",surfing_woman:"\u{1F3C4}&zwj;\u2640\uFE0F",sushi:"\u{1F363}",suspension_railway:"\u{1F69F}",sweat:"\u{1F613}",sweat_drops:"\u{1F4A6}",sweat_smile:"\u{1F605}",sweet_potato:"\u{1F360}",swimming_man:"\u{1F3CA}",swimming_woman:"\u{1F3CA}&zwj;\u2640\uFE0F",symbols:"\u{1F523}",synagogue:"\u{1F54D}",syringe:"\u{1F489}",taco:"\u{1F32E}",tada:"\u{1F389}",tanabata_tree:"\u{1F38B}",taurus:"\u2649\uFE0F",taxi:"\u{1F695}",tea:"\u{1F375}",telephone_receiver:"\u{1F4DE}",telescope:"\u{1F52D}",tennis:"\u{1F3BE}",tent:"\u26FA\uFE0F",thermometer:"\u{1F321}",thinking:"\u{1F914}",thought_balloon:"\u{1F4AD}",ticket:"\u{1F3AB}",tickets:"\u{1F39F}",tiger:"\u{1F42F}",tiger2:"\u{1F405}",timer_clock:"\u23F2",tipping_hand_man:"\u{1F481}&zwj;\u2642\uFE0F",tired_face:"\u{1F62B}",tm:"\u2122\uFE0F",toilet:"\u{1F6BD}",tokyo_tower:"\u{1F5FC}",tomato:"\u{1F345}",tongue:"\u{1F445}",top:"\u{1F51D}",tophat:"\u{1F3A9}",tornado:"\u{1F32A}",trackball:"\u{1F5B2}",tractor:"\u{1F69C}",traffic_light:"\u{1F6A5}",train:"\u{1F68B}",train2:"\u{1F686}",tram:"\u{1F68A}",triangular_flag_on_post:"\u{1F6A9}",triangular_ruler:"\u{1F4D0}",trident:"\u{1F531}",triumph:"\u{1F624}",trolleybus:"\u{1F68E}",trophy:"\u{1F3C6}",tropical_drink:"\u{1F379}",tropical_fish:"\u{1F420}",truck:"\u{1F69A}",trumpet:"\u{1F3BA}",tulip:"\u{1F337}",tumbler_glass:"\u{1F943}",turkey:"\u{1F983}",turtle:"\u{1F422}",tv:"\u{1F4FA}",twisted_rightwards_arrows:"\u{1F500}",two_hearts:"\u{1F495}",two_men_holding_hands:"\u{1F46C}",two_women_holding_hands:"\u{1F46D}",u5272:"\u{1F239}",u5408:"\u{1F234}",u55b6:"\u{1F23A}",u6307:"\u{1F22F}\uFE0F",u6708:"\u{1F237}\uFE0F",u6709:"\u{1F236}",u6e80:"\u{1F235}",u7121:"\u{1F21A}\uFE0F",u7533:"\u{1F238}",u7981:"\u{1F232}",u7a7a:"\u{1F233}",umbrella:"\u2614\uFE0F",unamused:"\u{1F612}",underage:"\u{1F51E}",unicorn:"\u{1F984}",unlock:"\u{1F513}",up:"\u{1F199}",upside_down_face:"\u{1F643}",v:"\u270C\uFE0F",vertical_traffic_light:"\u{1F6A6}",vhs:"\u{1F4FC}",vibration_mode:"\u{1F4F3}",video_camera:"\u{1F4F9}",video_game:"\u{1F3AE}",violin:"\u{1F3BB}",virgo:"\u264D\uFE0F",volcano:"\u{1F30B}",volleyball:"\u{1F3D0}",vs:"\u{1F19A}",vulcan_salute:"\u{1F596}",walking_man:"\u{1F6B6}",walking_woman:"\u{1F6B6}&zwj;\u2640\uFE0F",waning_crescent_moon:"\u{1F318}",waning_gibbous_moon:"\u{1F316}",warning:"\u26A0\uFE0F",wastebasket:"\u{1F5D1}",watch:"\u231A\uFE0F",water_buffalo:"\u{1F403}",watermelon:"\u{1F349}",wave:"\u{1F44B}",wavy_dash:"\u3030\uFE0F",waxing_crescent_moon:"\u{1F312}",wc:"\u{1F6BE}",weary:"\u{1F629}",wedding:"\u{1F492}",weight_lifting_man:"\u{1F3CB}\uFE0F",weight_lifting_woman:"\u{1F3CB}\uFE0F&zwj;\u2640\uFE0F",whale:"\u{1F433}",whale2:"\u{1F40B}",wheel_of_dharma:"\u2638\uFE0F",wheelchair:"\u267F\uFE0F",white_check_mark:"\u2705",white_circle:"\u26AA\uFE0F",white_flag:"\u{1F3F3}\uFE0F",white_flower:"\u{1F4AE}",white_large_square:"\u2B1C\uFE0F",white_medium_small_square:"\u25FD\uFE0F",white_medium_square:"\u25FB\uFE0F",white_small_square:"\u25AB\uFE0F",white_square_button:"\u{1F533}",wilted_flower:"\u{1F940}",wind_chime:"\u{1F390}",wind_face:"\u{1F32C}",wine_glass:"\u{1F377}",wink:"\u{1F609}",wolf:"\u{1F43A}",woman:"\u{1F469}",woman_artist:"\u{1F469}&zwj;\u{1F3A8}",woman_astronaut:"\u{1F469}&zwj;\u{1F680}",woman_cartwheeling:"\u{1F938}&zwj;\u2640\uFE0F",woman_cook:"\u{1F469}&zwj;\u{1F373}",woman_facepalming:"\u{1F926}&zwj;\u2640\uFE0F",woman_factory_worker:"\u{1F469}&zwj;\u{1F3ED}",woman_farmer:"\u{1F469}&zwj;\u{1F33E}",woman_firefighter:"\u{1F469}&zwj;\u{1F692}",woman_health_worker:"\u{1F469}&zwj;\u2695\uFE0F",woman_judge:"\u{1F469}&zwj;\u2696\uFE0F",woman_juggling:"\u{1F939}&zwj;\u2640\uFE0F",woman_mechanic:"\u{1F469}&zwj;\u{1F527}",woman_office_worker:"\u{1F469}&zwj;\u{1F4BC}",woman_pilot:"\u{1F469}&zwj;\u2708\uFE0F",woman_playing_handball:"\u{1F93E}&zwj;\u2640\uFE0F",woman_playing_water_polo:"\u{1F93D}&zwj;\u2640\uFE0F",woman_scientist:"\u{1F469}&zwj;\u{1F52C}",woman_shrugging:"\u{1F937}&zwj;\u2640\uFE0F",woman_singer:"\u{1F469}&zwj;\u{1F3A4}",woman_student:"\u{1F469}&zwj;\u{1F393}",woman_teacher:"\u{1F469}&zwj;\u{1F3EB}",woman_technologist:"\u{1F469}&zwj;\u{1F4BB}",woman_with_turban:"\u{1F473}&zwj;\u2640\uFE0F",womans_clothes:"\u{1F45A}",womans_hat:"\u{1F452}",women_wrestling:"\u{1F93C}&zwj;\u2640\uFE0F",womens:"\u{1F6BA}",world_map:"\u{1F5FA}",worried:"\u{1F61F}",wrench:"\u{1F527}",writing_hand:"\u270D\uFE0F",x:"\u274C",yellow_heart:"\u{1F49B}",yen:"\u{1F4B4}",yin_yang:"\u262F\uFE0F",yum:"\u{1F60B}",zap:"\u26A1\uFE0F",zipper_mouth_face:"\u{1F910}",zzz:"\u{1F4A4}",octocat:'<img alt=":octocat:" height="20" width="20" align="absmiddle" src="https://assets-cdn.github.com/images/icons/emoji/octocat.png">',showdown:`<span style="font-family: 'Anonymous Pro', monospace; text-decoration: underline; text-decoration-style: dashed; text-decoration-color: #3e8b8a;text-underline-position: under;">S</span>`},e.Converter=function(d){"use strict";var _={},m=[],y=[],x={},S=a,w={parsed:{},raw:"",format:""};E();function E(){d=d||{};for(var T in o)o.hasOwnProperty(T)&&(_[T]=o[T]);if(typeof d=="object")for(var M in d)d.hasOwnProperty(M)&&(_[M]=d[M]);else throw Error("Converter expects the passed parameter to be an object, but "+typeof d+" was passed instead.");_.extensions&&e.helper.forEach(_.extensions,L)}function L(T,M){if(M=M||null,e.helper.isString(T))if(T=e.helper.stdExtName(T),M=T,e.extensions[T]){console.warn("DEPRECATION WARNING: "+T+" is an old extension that uses a deprecated loading method.Please inform the developer that the extension should be updated!"),I(e.extensions[T],T);return}else if(!e.helper.isUndefined(n[T]))T=n[T];else throw Error('Extension "'+T+'" could not be loaded. It was either not found or is not a valid extension.');typeof T=="function"&&(T=T()),e.helper.isArray(T)||(T=[T]);var j=l(T,M);if(!j.valid)throw Error(j.error);for(var J=0;J<T.length;++J){switch(T[J].type){case"lang":m.push(T[J]);break;case"output":y.push(T[J]);break}if(T[J].hasOwnProperty("listeners"))for(var U in T[J].listeners)T[J].listeners.hasOwnProperty(U)&&A(U,T[J].listeners[U])}}function I(T,M){typeof T=="function"&&(T=T(new e.Converter)),e.helper.isArray(T)||(T=[T]);var j=l(T,M);if(!j.valid)throw Error(j.error);for(var J=0;J<T.length;++J)switch(T[J].type){case"lang":m.push(T[J]);break;case"output":y.push(T[J]);break;default:throw Error("Extension loader error: Type unrecognized!!!")}}function A(T,M){if(!e.helper.isString(T))throw Error("Invalid argument in converter.listen() method: name must be a string, but "+typeof T+" given");if(typeof M!="function")throw Error("Invalid argument in converter.listen() method: callback must be a function, but "+typeof M+" given");x.hasOwnProperty(T)||(x[T]=[]),x[T].push(M)}function B(T){var M=T.match(/^\s*/)[0].length,j=new RegExp("^\\s{0,"+M+"}","gm");return T.replace(j,"")}this._dispatch=function(M,j,J,U){if(x.hasOwnProperty(M))for(var H=0;H<x[M].length;++H){var te=x[M][H](M,j,this,J,U);te&&typeof te!="undefined"&&(j=te)}return j},this.listen=function(T,M){return A(T,M),this},this.makeHtml=function(T){if(!T)return T;var M={gHtmlBlocks:[],gHtmlMdBlocks:[],gHtmlSpans:[],gUrls:{},gTitles:{},gDimensions:{},gListLevel:0,hashLinkCounts:{},langExtensions:m,outputModifiers:y,converter:this,ghCodeBlocks:[],metadata:{parsed:{},raw:"",format:""}};return T=T.replace(//g,"\xA8T"),T=T.replace(/\$/g,"\xA8D"),T=T.replace(/\r\n/g,`
`),T=T.replace(/\r/g,`
`),T=T.replace(/\u00A0/g,"&nbsp;"),_.smartIndentationFix&&(T=B(T)),T=`

`+T+`

`,T=e.subParser("detab")(T,_,M),T=T.replace(/^[ \t]+$/mg,""),e.helper.forEach(m,function(j){T=e.subParser("runExtension")(j,T,_,M)}),T=e.subParser("metadata")(T,_,M),T=e.subParser("hashPreCodeTags")(T,_,M),T=e.subParser("githubCodeBlocks")(T,_,M),T=e.subParser("hashHTMLBlocks")(T,_,M),T=e.subParser("hashCodeTags")(T,_,M),T=e.subParser("stripLinkDefinitions")(T,_,M),T=e.subParser("blockGamut")(T,_,M),T=e.subParser("unhashHTMLSpans")(T,_,M),T=e.subParser("unescapeSpecialChars")(T,_,M),T=T.replace(/D/g,"$$"),T=T.replace(/T/g,"\xA8"),T=e.subParser("completeHTMLDocument")(T,_,M),e.helper.forEach(y,function(j){T=e.subParser("runExtension")(j,T,_,M)}),w=M.metadata,T},this.makeMarkdown=this.makeMd=function(T,M){if(T=T.replace(/\r\n/g,`
`),T=T.replace(/\r/g,`
`),T=T.replace(/>[ \t]+</,">\xA8NBSP;<"),!M)if(window&&window.document)M=window.document;else throw new Error("HTMLParser is undefined. If in a webworker or nodejs environment, you need to provide a WHATWG DOM and HTML such as JSDOM");var j=M.createElement("div");j.innerHTML=T;var J={preList:W(j)};ae(j);for(var U=j.childNodes,H="",te=0;te<U.length;te++)H+=e.subParser("makeMarkdown.node")(U[te],J);function ae(Y){for(var re=0;re<Y.childNodes.length;++re){var ie=Y.childNodes[re];ie.nodeType===3?!/\S/.test(ie.nodeValue)&&!/^[ ]+$/.test(ie.nodeValue)?(Y.removeChild(ie),--re):(ie.nodeValue=ie.nodeValue.split(`
`).join(" "),ie.nodeValue=ie.nodeValue.replace(/(\s)+/g,"$1")):ie.nodeType===1&&ae(ie)}}function W(Y){for(var re=Y.querySelectorAll("pre"),ie=[],Q=0;Q<re.length;++Q)if(re[Q].childElementCount===1&&re[Q].firstChild.tagName.toLowerCase()==="code"){var ee=re[Q].firstChild.innerHTML.trim(),pe=re[Q].firstChild.getAttribute("data-language")||"";if(pe==="")for(var be=re[Q].firstChild.className.split(" "),we=0;we<be.length;++we){var Le=be[we].match(/^language-(.+)$/);if(Le!==null){pe=Le[1];break}}ee=e.helper.unescapeHTMLEntities(ee),ie.push(ee),re[Q].outerHTML='<precode language="'+pe+'" precodenum="'+Q.toString()+'"></precode>'}else ie.push(re[Q].innerHTML),re[Q].innerHTML="",re[Q].setAttribute("prenum",Q.toString());return ie}return H},this.setOption=function(T,M){_[T]=M},this.getOption=function(T){return _[T]},this.getOptions=function(){return _},this.addExtension=function(T,M){M=M||null,L(T,M)},this.useExtension=function(T){L(T)},this.setFlavor=function(T){if(!s.hasOwnProperty(T))throw Error(T+" flavor was not found");var M=s[T];S=T;for(var j in M)M.hasOwnProperty(j)&&(_[j]=M[j])},this.getFlavor=function(){return S},this.removeExtension=function(T){e.helper.isArray(T)||(T=[T]);for(var M=0;M<T.length;++M){for(var j=T[M],J=0;J<m.length;++J)m[J]===j&&m.splice(J,1);for(var U=0;U<y.length;++U)y[U]===j&&y.splice(U,1)}},this.getAllExtensions=function(){return{language:m,output:y}},this.getMetadata=function(T){return T?w.raw:w.parsed},this.getMetadataFormat=function(){return w.format},this._setMetadataPair=function(T,M){w.parsed[T]=M},this._setMetadataFormat=function(T){w.format=T},this._setMetadataRaw=function(T){w.raw=T}},e.subParser("anchors",function(d,_,m){"use strict";d=m.converter._dispatch("anchors.before",d,_,m);var y=function(x,S,w,E,L,I,A){if(e.helper.isUndefined(A)&&(A=""),w=w.toLowerCase(),x.search(/\(<?\s*>? ?(['"].*['"])?\)$/m)>-1)E="";else if(!E)if(w||(w=S.toLowerCase().replace(/ ?\n/g," ")),E="#"+w,!e.helper.isUndefined(m.gUrls[w]))E=m.gUrls[w],e.helper.isUndefined(m.gTitles[w])||(A=m.gTitles[w]);else return x;E=E.replace(e.helper.regexes.asteriskDashAndColon,e.helper.escapeCharactersCallback);var B='<a href="'+E+'"';return A!==""&&A!==null&&(A=A.replace(/"/g,"&quot;"),A=A.replace(e.helper.regexes.asteriskDashAndColon,e.helper.escapeCharactersCallback),B+=' title="'+A+'"'),_.openLinksInNewWindow&&!/^#/.test(E)&&(B+=' rel="noopener noreferrer" target="\xA8E95Eblank"'),B+=">"+S+"</a>",B};return d=d.replace(/\[((?:\[[^\]]*]|[^\[\]])*)] ?(?:\n *)?\[(.*?)]()()()()/g,y),d=d.replace(/\[((?:\[[^\]]*]|[^\[\]])*)]()[ \t]*\([ \t]?<([^>]*)>(?:[ \t]*((["'])([^"]*?)\5))?[ \t]?\)/g,y),d=d.replace(/\[((?:\[[^\]]*]|[^\[\]])*)]()[ \t]*\([ \t]?<?([\S]+?(?:\([\S]*?\)[\S]*?)?)>?(?:[ \t]*((["'])([^"]*?)\5))?[ \t]?\)/g,y),d=d.replace(/\[([^\[\]]+)]()()()()()/g,y),_.ghMentions&&(d=d.replace(/(^|\s)(\\)?(@([a-z\d]+(?:[a-z\d.-]+?[a-z\d]+)*))/gmi,function(x,S,w,E,L){if(w==="\\")return S+E;if(!e.helper.isString(_.ghMentionsLink))throw new Error("ghMentionsLink option must be a string");var I=_.ghMentionsLink.replace(/\{u}/g,L),A="";return _.openLinksInNewWindow&&(A=' rel="noopener noreferrer" target="\xA8E95Eblank"'),S+'<a href="'+I+'"'+A+">"+E+"</a>"})),d=m.converter._dispatch("anchors.after",d,_,m),d});var h=/([*~_]+|\b)(((https?|ftp|dict):\/\/|www\.)[^'">\s]+?\.[^'">\s]+?)()(\1)?(?=\s|$)(?!["<>])/gi,p=/([*~_]+|\b)(((https?|ftp|dict):\/\/|www\.)[^'">\s]+\.[^'">\s]+?)([.!?,()\[\]])?(\1)?(?=\s|$)(?!["<>])/gi,g=/()<(((https?|ftp|dict):\/\/|www\.)[^'">\s]+)()>()/gi,b=/(^|\s)(?:mailto:)?([A-Za-z0-9!#$%&'*+-/=?^_`{|}~.]+@[-a-z0-9]+(\.[-a-z0-9]+)*\.[a-z]+)(?=$|\s)/gmi,v=/<()(?:mailto:)?([-.\w]+@[-a-z0-9]+(\.[-a-z0-9]+)*\.[a-z]+)>/gi,k=function(d){"use strict";return function(_,m,y,x,S,w,E){y=y.replace(e.helper.regexes.asteriskDashAndColon,e.helper.escapeCharactersCallback);var L=y,I="",A="",B=m||"",T=E||"";return/^www\./i.test(y)&&(y=y.replace(/^www\./i,"http://www.")),d.excludeTrailingPunctuationFromURLs&&w&&(I=w),d.openLinksInNewWindow&&(A=' rel="noopener noreferrer" target="\xA8E95Eblank"'),B+'<a href="'+y+'"'+A+">"+L+"</a>"+I+T}},C=function(d,_){"use strict";return function(m,y,x){var S="mailto:";return y=y||"",x=e.subParser("unescapeSpecialChars")(x,d,_),d.encodeEmails?(S=e.helper.encodeEmailAddress(S+x),x=e.helper.encodeEmailAddress(x)):S=S+x,y+'<a href="'+S+'">'+x+"</a>"}};e.subParser("autoLinks",function(d,_,m){"use strict";return d=m.converter._dispatch("autoLinks.before",d,_,m),d=d.replace(g,k(_)),d=d.replace(v,C(_,m)),d=m.converter._dispatch("autoLinks.after",d,_,m),d}),e.subParser("simplifiedAutoLinks",function(d,_,m){"use strict";return _.simplifiedAutoLink&&(d=m.converter._dispatch("simplifiedAutoLinks.before",d,_,m),_.excludeTrailingPunctuationFromURLs?d=d.replace(p,k(_)):d=d.replace(h,k(_)),d=d.replace(b,C(_,m)),d=m.converter._dispatch("simplifiedAutoLinks.after",d,_,m)),d}),e.subParser("blockGamut",function(d,_,m){"use strict";return d=m.converter._dispatch("blockGamut.before",d,_,m),d=e.subParser("blockQuotes")(d,_,m),d=e.subParser("headers")(d,_,m),d=e.subParser("horizontalRule")(d,_,m),d=e.subParser("lists")(d,_,m),d=e.subParser("codeBlocks")(d,_,m),d=e.subParser("tables")(d,_,m),d=e.subParser("hashHTMLBlocks")(d,_,m),d=e.subParser("paragraphs")(d,_,m),d=m.converter._dispatch("blockGamut.after",d,_,m),d}),e.subParser("blockQuotes",function(d,_,m){"use strict";d=m.converter._dispatch("blockQuotes.before",d,_,m),d=d+`

`;var y=/(^ {0,3}>[ \t]?.+\n(.+\n)*\n*)+/gm;return _.splitAdjacentBlockquotes&&(y=/^ {0,3}>[\s\S]*?(?:\n\n)/gm),d=d.replace(y,function(x){return x=x.replace(/^[ \t]*>[ \t]?/gm,""),x=x.replace(/0/g,""),x=x.replace(/^[ \t]+$/gm,""),x=e.subParser("githubCodeBlocks")(x,_,m),x=e.subParser("blockGamut")(x,_,m),x=x.replace(/(^|\n)/g,"$1  "),x=x.replace(/(\s*<pre>[^\r]+?<\/pre>)/gm,function(S,w){var E=w;return E=E.replace(/^  /mg,"\xA80"),E=E.replace(/0/g,""),E}),e.subParser("hashBlock")(`<blockquote>
`+x+`
</blockquote>`,_,m)}),d=m.converter._dispatch("blockQuotes.after",d,_,m),d}),e.subParser("codeBlocks",function(d,_,m){"use strict";d=m.converter._dispatch("codeBlocks.before",d,_,m),d+="\xA80";var y=/(?:\n\n|^)((?:(?:[ ]{4}|\t).*\n+)+)(\n*[ ]{0,3}[^ \t\n]|(?=0))/g;return d=d.replace(y,function(x,S,w){var E=S,L=w,I=`
`;return E=e.subParser("outdent")(E,_,m),E=e.subParser("encodeCode")(E,_,m),E=e.subParser("detab")(E,_,m),E=E.replace(/^\n+/g,""),E=E.replace(/\n+$/g,""),_.omitExtraWLInCodeBlocks&&(I=""),E="<pre><code>"+E+I+"</code></pre>",e.subParser("hashBlock")(E,_,m)+L}),d=d.replace(/0/,""),d=m.converter._dispatch("codeBlocks.after",d,_,m),d}),e.subParser("codeSpans",function(d,_,m){"use strict";return d=m.converter._dispatch("codeSpans.before",d,_,m),typeof d=="undefined"&&(d=""),d=d.replace(/(^|[^\\])(`+)([^\r]*?[^`])\2(?!`)/gm,function(y,x,S,w){var E=w;return E=E.replace(/^([ \t]*)/g,""),E=E.replace(/[ \t]*$/g,""),E=e.subParser("encodeCode")(E,_,m),E=x+"<code>"+E+"</code>",E=e.subParser("hashHTMLSpans")(E,_,m),E}),d=m.converter._dispatch("codeSpans.after",d,_,m),d}),e.subParser("completeHTMLDocument",function(d,_,m){"use strict";if(!_.completeHTMLDocument)return d;d=m.converter._dispatch("completeHTMLDocument.before",d,_,m);var y="html",x=`<!DOCTYPE HTML>
`,S="",w=`<meta charset="utf-8">
`,E="",L="";typeof m.metadata.parsed.doctype!="undefined"&&(x="<!DOCTYPE "+m.metadata.parsed.doctype+`>
`,y=m.metadata.parsed.doctype.toString().toLowerCase(),(y==="html"||y==="html5")&&(w='<meta charset="utf-8">'));for(var I in m.metadata.parsed)if(m.metadata.parsed.hasOwnProperty(I))switch(I.toLowerCase()){case"doctype":break;case"title":S="<title>"+m.metadata.parsed.title+`</title>
`;break;case"charset":y==="html"||y==="html5"?w='<meta charset="'+m.metadata.parsed.charset+`">
`:w='<meta name="charset" content="'+m.metadata.parsed.charset+`">
`;break;case"language":case"lang":E=' lang="'+m.metadata.parsed[I]+'"',L+='<meta name="'+I+'" content="'+m.metadata.parsed[I]+`">
`;break;default:L+='<meta name="'+I+'" content="'+m.metadata.parsed[I]+`">
`}return d=x+"<html"+E+`>
<head>
`+S+w+L+`</head>
<body>
`+d.trim()+`
</body>
</html>`,d=m.converter._dispatch("completeHTMLDocument.after",d,_,m),d}),e.subParser("detab",function(d,_,m){"use strict";return d=m.converter._dispatch("detab.before",d,_,m),d=d.replace(/\t(?=\t)/g,"    "),d=d.replace(/\t/g,"\xA8A\xA8B"),d=d.replace(/B(.+?)A/g,function(y,x){for(var S=x,w=4-S.length%4,E=0;E<w;E++)S+=" ";return S}),d=d.replace(/A/g,"    "),d=d.replace(/B/g,""),d=m.converter._dispatch("detab.after",d,_,m),d}),e.subParser("ellipsis",function(d,_,m){"use strict";return _.ellipsis&&(d=m.converter._dispatch("ellipsis.before",d,_,m),d=d.replace(/\.\.\./g,"\u2026"),d=m.converter._dispatch("ellipsis.after",d,_,m)),d}),e.subParser("emoji",function(d,_,m){"use strict";if(!_.emoji)return d;d=m.converter._dispatch("emoji.before",d,_,m);var y=/:([\S]+?):/g;return d=d.replace(y,function(x,S){return e.helper.emojis.hasOwnProperty(S)?e.helper.emojis[S]:x}),d=m.converter._dispatch("emoji.after",d,_,m),d}),e.subParser("encodeAmpsAndAngles",function(d,_,m){"use strict";return d=m.converter._dispatch("encodeAmpsAndAngles.before",d,_,m),d=d.replace(/&(?!#?[xX]?(?:[0-9a-fA-F]+|\w+);)/g,"&amp;"),d=d.replace(/<(?![a-z\/?$!])/gi,"&lt;"),d=d.replace(/</g,"&lt;"),d=d.replace(/>/g,"&gt;"),d=m.converter._dispatch("encodeAmpsAndAngles.after",d,_,m),d}),e.subParser("encodeBackslashEscapes",function(d,_,m){"use strict";return d=m.converter._dispatch("encodeBackslashEscapes.before",d,_,m),d=d.replace(/\\(\\)/g,e.helper.escapeCharactersCallback),d=d.replace(/\\([`*_{}\[\]()>#+.!~=|:-])/g,e.helper.escapeCharactersCallback),d=m.converter._dispatch("encodeBackslashEscapes.after",d,_,m),d}),e.subParser("encodeCode",function(d,_,m){"use strict";return d=m.converter._dispatch("encodeCode.before",d,_,m),d=d.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/([*_{}\[\]\\=~-])/g,e.helper.escapeCharactersCallback),d=m.converter._dispatch("encodeCode.after",d,_,m),d}),e.subParser("escapeSpecialCharsWithinTagAttributes",function(d,_,m){"use strict";d=m.converter._dispatch("escapeSpecialCharsWithinTagAttributes.before",d,_,m);var y=/<\/?[a-z\d_:-]+(?:[\s]+[\s\S]+?)?>/gi,x=/<!(--(?:(?:[^>-]|-[^>])(?:[^-]|-[^-])*)--)>/gi;return d=d.replace(y,function(S){return S.replace(/(.)<\/?code>(?=.)/g,"$1`").replace(/([\\`*_~=|])/g,e.helper.escapeCharactersCallback)}),d=d.replace(x,function(S){return S.replace(/([\\`*_~=|])/g,e.helper.escapeCharactersCallback)}),d=m.converter._dispatch("escapeSpecialCharsWithinTagAttributes.after",d,_,m),d}),e.subParser("githubCodeBlocks",function(d,_,m){"use strict";return _.ghCodeBlocks?(d=m.converter._dispatch("githubCodeBlocks.before",d,_,m),d+="\xA80",d=d.replace(/(?:^|\n)(?: {0,3})(```+|~~~+)(?: *)([^\s`~]*)\n([\s\S]*?)\n(?: {0,3})\1/g,function(y,x,S,w){var E=_.omitExtraWLInCodeBlocks?"":`
`;return w=e.subParser("encodeCode")(w,_,m),w=e.subParser("detab")(w,_,m),w=w.replace(/^\n+/g,""),w=w.replace(/\n+$/g,""),w="<pre><code"+(S?' class="'+S+" language-"+S+'"':"")+">"+w+E+"</code></pre>",w=e.subParser("hashBlock")(w,_,m),`

\xA8G`+(m.ghCodeBlocks.push({text:y,codeblock:w})-1)+`G

`}),d=d.replace(/0/,""),m.converter._dispatch("githubCodeBlocks.after",d,_,m)):d}),e.subParser("hashBlock",function(d,_,m){"use strict";return d=m.converter._dispatch("hashBlock.before",d,_,m),d=d.replace(/(^\n+|\n+$)/g,""),d=`

\xA8K`+(m.gHtmlBlocks.push(d)-1)+`K

`,d=m.converter._dispatch("hashBlock.after",d,_,m),d}),e.subParser("hashCodeTags",function(d,_,m){"use strict";d=m.converter._dispatch("hashCodeTags.before",d,_,m);var y=function(x,S,w,E){var L=w+e.subParser("encodeCode")(S,_,m)+E;return"\xA8C"+(m.gHtmlSpans.push(L)-1)+"C"};return d=e.helper.replaceRecursiveRegExp(d,y,"<code\\b[^>]*>","</code>","gim"),d=m.converter._dispatch("hashCodeTags.after",d,_,m),d}),e.subParser("hashElement",function(d,_,m){"use strict";return function(y,x){var S=x;return S=S.replace(/\n\n/g,`
`),S=S.replace(/^\n/,""),S=S.replace(/\n+$/g,""),S=`

\xA8K`+(m.gHtmlBlocks.push(S)-1)+`K

`,S}}),e.subParser("hashHTMLBlocks",function(d,_,m){"use strict";d=m.converter._dispatch("hashHTMLBlocks.before",d,_,m);var y=["pre","div","h1","h2","h3","h4","h5","h6","blockquote","table","dl","ol","ul","script","noscript","form","fieldset","iframe","math","style","section","header","footer","nav","article","aside","address","audio","canvas","figure","hgroup","output","video","p"],x=function(T,M,j,J){var U=T;return j.search(/\bmarkdown\b/)!==-1&&(U=j+m.converter.makeHtml(M)+J),`

\xA8K`+(m.gHtmlBlocks.push(U)-1)+`K

`};_.backslashEscapesHTMLTags&&(d=d.replace(/\\<(\/?[^>]+?)>/g,function(T,M){return"&lt;"+M+"&gt;"}));for(var S=0;S<y.length;++S)for(var w,E=new RegExp("^ {0,3}(<"+y[S]+"\\b[^>]*>)","im"),L="<"+y[S]+"\\b[^>]*>",I="</"+y[S]+">";(w=e.helper.regexIndexOf(d,E))!==-1;){var A=e.helper.splitAtIndex(d,w),B=e.helper.replaceRecursiveRegExp(A[1],x,L,I,"im");if(B===A[1])break;d=A[0].concat(B)}return d=d.replace(/(\n {0,3}(<(hr)\b([^<>])*?\/?>)[ \t]*(?=\n{2,}))/g,e.subParser("hashElement")(d,_,m)),d=e.helper.replaceRecursiveRegExp(d,function(T){return`

\xA8K`+(m.gHtmlBlocks.push(T)-1)+`K

`},"^ {0,3}<!--","-->","gm"),d=d.replace(/(?:\n\n)( {0,3}(?:<([?%])[^\r]*?\2>)[ \t]*(?=\n{2,}))/g,e.subParser("hashElement")(d,_,m)),d=m.converter._dispatch("hashHTMLBlocks.after",d,_,m),d}),e.subParser("hashHTMLSpans",function(d,_,m){"use strict";d=m.converter._dispatch("hashHTMLSpans.before",d,_,m);function y(x){return"\xA8C"+(m.gHtmlSpans.push(x)-1)+"C"}return d=d.replace(/<[^>]+?\/>/gi,function(x){return y(x)}),d=d.replace(/<([^>]+?)>[\s\S]*?<\/\1>/g,function(x){return y(x)}),d=d.replace(/<([^>]+?)\s[^>]+?>[\s\S]*?<\/\1>/g,function(x){return y(x)}),d=d.replace(/<[^>]+?>/gi,function(x){return y(x)}),d=m.converter._dispatch("hashHTMLSpans.after",d,_,m),d}),e.subParser("unhashHTMLSpans",function(d,_,m){"use strict";d=m.converter._dispatch("unhashHTMLSpans.before",d,_,m);for(var y=0;y<m.gHtmlSpans.length;++y){for(var x=m.gHtmlSpans[y],S=0;/C(\d+)C/.test(x);){var w=RegExp.$1;if(x=x.replace("\xA8C"+w+"C",m.gHtmlSpans[w]),S===10){console.error("maximum nesting of 10 spans reached!!!");break}++S}d=d.replace("\xA8C"+y+"C",x)}return d=m.converter._dispatch("unhashHTMLSpans.after",d,_,m),d}),e.subParser("hashPreCodeTags",function(d,_,m){"use strict";d=m.converter._dispatch("hashPreCodeTags.before",d,_,m);var y=function(x,S,w,E){var L=w+e.subParser("encodeCode")(S,_,m)+E;return`

\xA8G`+(m.ghCodeBlocks.push({text:x,codeblock:L})-1)+`G

`};return d=e.helper.replaceRecursiveRegExp(d,y,"^ {0,3}<pre\\b[^>]*>\\s*<code\\b[^>]*>","^ {0,3}</code>\\s*</pre>","gim"),d=m.converter._dispatch("hashPreCodeTags.after",d,_,m),d}),e.subParser("headers",function(d,_,m){"use strict";d=m.converter._dispatch("headers.before",d,_,m);var y=isNaN(parseInt(_.headerLevelStart))?1:parseInt(_.headerLevelStart),x=_.smoothLivePreview?/^(.+)[ \t]*\n={2,}[ \t]*\n+/gm:/^(.+)[ \t]*\n=+[ \t]*\n+/gm,S=_.smoothLivePreview?/^(.+)[ \t]*\n-{2,}[ \t]*\n+/gm:/^(.+)[ \t]*\n-+[ \t]*\n+/gm;d=d.replace(x,function(L,I){var A=e.subParser("spanGamut")(I,_,m),B=_.noHeaderId?"":' id="'+E(I)+'"',T=y,M="<h"+T+B+">"+A+"</h"+T+">";return e.subParser("hashBlock")(M,_,m)}),d=d.replace(S,function(L,I){var A=e.subParser("spanGamut")(I,_,m),B=_.noHeaderId?"":' id="'+E(I)+'"',T=y+1,M="<h"+T+B+">"+A+"</h"+T+">";return e.subParser("hashBlock")(M,_,m)});var w=_.requireSpaceBeforeHeadingText?/^(#{1,6})[ \t]+(.+?)[ \t]*#*\n+/gm:/^(#{1,6})[ \t]*(.+?)[ \t]*#*\n+/gm;d=d.replace(w,function(L,I,A){var B=A;_.customizedHeaderId&&(B=A.replace(/\s?\{([^{]+?)}\s*$/,""));var T=e.subParser("spanGamut")(B,_,m),M=_.noHeaderId?"":' id="'+E(A)+'"',j=y-1+I.length,J="<h"+j+M+">"+T+"</h"+j+">";return e.subParser("hashBlock")(J,_,m)});function E(L){var I,A;if(_.customizedHeaderId){var B=L.match(/\{([^{]+?)}\s*$/);B&&B[1]&&(L=B[1])}return I=L,e.helper.isString(_.prefixHeaderId)?A=_.prefixHeaderId:_.prefixHeaderId===!0?A="section-":A="",_.rawPrefixHeaderId||(I=A+I),_.ghCompatibleHeaderId?I=I.replace(/ /g,"-").replace(/&amp;/g,"").replace(/T/g,"").replace(/D/g,"").replace(/[&+$,\/:;=?@"#{}|^~\[\]`\\*)(%.!'<>]/g,"").toLowerCase():_.rawHeaderId?I=I.replace(/ /g,"-").replace(/&amp;/g,"&").replace(/T/g,"\xA8").replace(/D/g,"$").replace(/["']/g,"-").toLowerCase():I=I.replace(/[^\w]/g,"").toLowerCase(),_.rawPrefixHeaderId&&(I=A+I),m.hashLinkCounts[I]?I=I+"-"+m.hashLinkCounts[I]++:m.hashLinkCounts[I]=1,I}return d=m.converter._dispatch("headers.after",d,_,m),d}),e.subParser("horizontalRule",function(d,_,m){"use strict";d=m.converter._dispatch("horizontalRule.before",d,_,m);var y=e.subParser("hashBlock")("<hr />",_,m);return d=d.replace(/^ {0,2}( ?-){3,}[ \t]*$/gm,y),d=d.replace(/^ {0,2}( ?\*){3,}[ \t]*$/gm,y),d=d.replace(/^ {0,2}( ?_){3,}[ \t]*$/gm,y),d=m.converter._dispatch("horizontalRule.after",d,_,m),d}),e.subParser("images",function(d,_,m){"use strict";d=m.converter._dispatch("images.before",d,_,m);var y=/!\[([^\]]*?)][ \t]*()\([ \t]?<?([\S]+?(?:\([\S]*?\)[\S]*?)?)>?(?: =([*\d]+[A-Za-z%]{0,4})x([*\d]+[A-Za-z%]{0,4}))?[ \t]*(?:(["'])([^"]*?)\6)?[ \t]?\)/g,x=/!\[([^\]]*?)][ \t]*()\([ \t]?<([^>]*)>(?: =([*\d]+[A-Za-z%]{0,4})x([*\d]+[A-Za-z%]{0,4}))?[ \t]*(?:(?:(["'])([^"]*?)\6))?[ \t]?\)/g,S=/!\[([^\]]*?)][ \t]*()\([ \t]?<?(data:.+?\/.+?;base64,[A-Za-z0-9+/=\n]+?)>?(?: =([*\d]+[A-Za-z%]{0,4})x([*\d]+[A-Za-z%]{0,4}))?[ \t]*(?:(["'])([^"]*?)\6)?[ \t]?\)/g,w=/!\[([^\]]*?)] ?(?:\n *)?\[([\s\S]*?)]()()()()()/g,E=/!\[([^\[\]]+)]()()()()()/g;function L(A,B,T,M,j,J,U,H){return M=M.replace(/\s/g,""),I(A,B,T,M,j,J,U,H)}function I(A,B,T,M,j,J,U,H){var te=m.gUrls,ae=m.gTitles,W=m.gDimensions;if(T=T.toLowerCase(),H||(H=""),A.search(/\(<?\s*>? ?(['"].*['"])?\)$/m)>-1)M="";else if(M===""||M===null)if((T===""||T===null)&&(T=B.toLowerCase().replace(/ ?\n/g," ")),M="#"+T,!e.helper.isUndefined(te[T]))M=te[T],e.helper.isUndefined(ae[T])||(H=ae[T]),e.helper.isUndefined(W[T])||(j=W[T].width,J=W[T].height);else return A;B=B.replace(/"/g,"&quot;").replace(e.helper.regexes.asteriskDashAndColon,e.helper.escapeCharactersCallback),M=M.replace(e.helper.regexes.asteriskDashAndColon,e.helper.escapeCharactersCallback);var Y='<img src="'+M+'" alt="'+B+'"';return H&&e.helper.isString(H)&&(H=H.replace(/"/g,"&quot;").replace(e.helper.regexes.asteriskDashAndColon,e.helper.escapeCharactersCallback),Y+=' title="'+H+'"'),j&&J&&(j=j==="*"?"auto":j,J=J==="*"?"auto":J,Y+=' width="'+j+'"',Y+=' height="'+J+'"'),Y+=" />",Y}return d=d.replace(w,I),d=d.replace(S,L),d=d.replace(x,I),d=d.replace(y,I),d=d.replace(E,I),d=m.converter._dispatch("images.after",d,_,m),d}),e.subParser("italicsAndBold",function(d,_,m){"use strict";d=m.converter._dispatch("italicsAndBold.before",d,_,m);function y(x,S,w){return S+x+w}return _.literalMidWordUnderscores?(d=d.replace(/\b___(\S[\s\S]*?)___\b/g,function(x,S){return y(S,"<strong><em>","</em></strong>")}),d=d.replace(/\b__(\S[\s\S]*?)__\b/g,function(x,S){return y(S,"<strong>","</strong>")}),d=d.replace(/\b_(\S[\s\S]*?)_\b/g,function(x,S){return y(S,"<em>","</em>")})):(d=d.replace(/___(\S[\s\S]*?)___/g,function(x,S){return/\S$/.test(S)?y(S,"<strong><em>","</em></strong>"):x}),d=d.replace(/__(\S[\s\S]*?)__/g,function(x,S){return/\S$/.test(S)?y(S,"<strong>","</strong>"):x}),d=d.replace(/_([^\s_][\s\S]*?)_/g,function(x,S){return/\S$/.test(S)?y(S,"<em>","</em>"):x})),_.literalMidWordAsterisks?(d=d.replace(/([^*]|^)\B\*\*\*(\S[\s\S]*?)\*\*\*\B(?!\*)/g,function(x,S,w){return y(w,S+"<strong><em>","</em></strong>")}),d=d.replace(/([^*]|^)\B\*\*(\S[\s\S]*?)\*\*\B(?!\*)/g,function(x,S,w){return y(w,S+"<strong>","</strong>")}),d=d.replace(/([^*]|^)\B\*(\S[\s\S]*?)\*\B(?!\*)/g,function(x,S,w){return y(w,S+"<em>","</em>")})):(d=d.replace(/\*\*\*(\S[\s\S]*?)\*\*\*/g,function(x,S){return/\S$/.test(S)?y(S,"<strong><em>","</em></strong>"):x}),d=d.replace(/\*\*(\S[\s\S]*?)\*\*/g,function(x,S){return/\S$/.test(S)?y(S,"<strong>","</strong>"):x}),d=d.replace(/\*([^\s*][\s\S]*?)\*/g,function(x,S){return/\S$/.test(S)?y(S,"<em>","</em>"):x})),d=m.converter._dispatch("italicsAndBold.after",d,_,m),d}),e.subParser("lists",function(d,_,m){"use strict";function y(w,E){m.gListLevel++,w=w.replace(/\n{2,}$/,`
`),w+="\xA80";var L=/(\n)?(^ {0,3})([*+-]|\d+[.])[ \t]+((\[(x|X| )?])?[ \t]*[^\r]+?(\n{1,2}))(?=\n*(0| {0,3}([*+-]|\d+[.])[ \t]+))/gm,I=/\n[ \t]*\n(?!0)/.test(w);return _.disableForced4SpacesIndentedSublists&&(L=/(\n)?(^ {0,3})([*+-]|\d+[.])[ \t]+((\[(x|X| )?])?[ \t]*[^\r]+?(\n{1,2}))(?=\n*(0|\2([*+-]|\d+[.])[ \t]+))/gm),w=w.replace(L,function(A,B,T,M,j,J,U){U=U&&U.trim()!=="";var H=e.subParser("outdent")(j,_,m),te="";return J&&_.tasklists&&(te=' class="task-list-item" style="list-style-type: none;"',H=H.replace(/^[ \t]*\[(x|X| )?]/m,function(){var ae='<input type="checkbox" disabled style="margin: 0px 0.35em 0.25em -1.6em; vertical-align: middle;"';return U&&(ae+=" checked"),ae+=">",ae})),H=H.replace(/^([-*+]|\d\.)[ \t]+[\S\n ]*/g,function(ae){return"\xA8A"+ae}),B||H.search(/\n{2,}/)>-1?(H=e.subParser("githubCodeBlocks")(H,_,m),H=e.subParser("blockGamut")(H,_,m)):(H=e.subParser("lists")(H,_,m),H=H.replace(/\n$/,""),H=e.subParser("hashHTMLBlocks")(H,_,m),H=H.replace(/\n\n+/g,`

`),I?H=e.subParser("paragraphs")(H,_,m):H=e.subParser("spanGamut")(H,_,m)),H=H.replace("\xA8A",""),H="<li"+te+">"+H+`</li>
`,H}),w=w.replace(/0/g,""),m.gListLevel--,E&&(w=w.replace(/\s+$/,"")),w}function x(w,E){if(E==="ol"){var L=w.match(/^ *(\d+)\./);if(L&&L[1]!=="1")return' start="'+L[1]+'"'}return""}function S(w,E,L){var I=_.disableForced4SpacesIndentedSublists?/^ ?\d+\.[ \t]/gm:/^ {0,3}\d+\.[ \t]/gm,A=_.disableForced4SpacesIndentedSublists?/^ ?[*+-][ \t]/gm:/^ {0,3}[*+-][ \t]/gm,B=E==="ul"?I:A,T="";if(w.search(B)!==-1)(function j(J){var U=J.search(B),H=x(w,E);U!==-1?(T+=`

<`+E+H+`>
`+y(J.slice(0,U),!!L)+"</"+E+`>
`,E=E==="ul"?"ol":"ul",B=E==="ul"?I:A,j(J.slice(U))):T+=`

<`+E+H+`>
`+y(J,!!L)+"</"+E+`>
`})(w);else{var M=x(w,E);T=`

<`+E+M+`>
`+y(w,!!L)+"</"+E+`>
`}return T}return d=m.converter._dispatch("lists.before",d,_,m),d+="\xA80",m.gListLevel?d=d.replace(/^(( {0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/gm,function(w,E,L){var I=L.search(/[*+-]/g)>-1?"ul":"ol";return S(E,I,!0)}):d=d.replace(/(\n\n|^\n?)(( {0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/gm,function(w,E,L,I){var A=I.search(/[*+-]/g)>-1?"ul":"ol";return S(L,A,!1)}),d=d.replace(/0/,""),d=m.converter._dispatch("lists.after",d,_,m),d}),e.subParser("metadata",function(d,_,m){"use strict";if(!_.metadata)return d;d=m.converter._dispatch("metadata.before",d,_,m);function y(x){m.metadata.raw=x,x=x.replace(/&/g,"&amp;").replace(/"/g,"&quot;"),x=x.replace(/\n {4}/g," "),x.replace(/^([\S ]+): +([\s\S]+?)$/gm,function(S,w,E){return m.metadata.parsed[w]=E,""})}return d=d.replace(/^\s*+(\S*?)\n([\s\S]+?)\n+\n/,function(x,S,w){return y(w),"\xA8M"}),d=d.replace(/^\s*---+(\S*?)\n([\s\S]+?)\n---+\n/,function(x,S,w){return S&&(m.metadata.format=S),y(w),"\xA8M"}),d=d.replace(/M/g,""),d=m.converter._dispatch("metadata.after",d,_,m),d}),e.subParser("outdent",function(d,_,m){"use strict";return d=m.converter._dispatch("outdent.before",d,_,m),d=d.replace(/^(\t|[ ]{1,4})/gm,"\xA80"),d=d.replace(/0/g,""),d=m.converter._dispatch("outdent.after",d,_,m),d}),e.subParser("paragraphs",function(d,_,m){"use strict";d=m.converter._dispatch("paragraphs.before",d,_,m),d=d.replace(/^\n+/g,""),d=d.replace(/\n+$/g,"");for(var y=d.split(/\n{2,}/g),x=[],S=y.length,w=0;w<S;w++){var E=y[w];E.search(/(K|G)(\d+)\1/g)>=0?x.push(E):E.search(/\S/)>=0&&(E=e.subParser("spanGamut")(E,_,m),E=E.replace(/^([ \t]*)/g,"<p>"),E+="</p>",x.push(E))}for(S=x.length,w=0;w<S;w++){for(var L="",I=x[w],A=!1;/(K|G)(\d+)\1/.test(I);){var B=RegExp.$1,T=RegExp.$2;B==="K"?L=m.gHtmlBlocks[T]:A?L=e.subParser("encodeCode")(m.ghCodeBlocks[T].text,_,m):L=m.ghCodeBlocks[T].codeblock,L=L.replace(/\$/g,"$$$$"),I=I.replace(/(\n\n)?(K|G)\d+\2(\n\n)?/,L),/^<pre\b[^>]*>\s*<code\b[^>]*>/.test(I)&&(A=!0)}x[w]=I}return d=x.join(`
`),d=d.replace(/^\n+/g,""),d=d.replace(/\n+$/g,""),m.converter._dispatch("paragraphs.after",d,_,m)}),e.subParser("runExtension",function(d,_,m,y){"use strict";if(d.filter)_=d.filter(_,y.converter,m);else if(d.regex){var x=d.regex;x instanceof RegExp||(x=new RegExp(x,"g")),_=_.replace(x,d.replace)}return _}),e.subParser("spanGamut",function(d,_,m){"use strict";return d=m.converter._dispatch("spanGamut.before",d,_,m),d=e.subParser("codeSpans")(d,_,m),d=e.subParser("escapeSpecialCharsWithinTagAttributes")(d,_,m),d=e.subParser("encodeBackslashEscapes")(d,_,m),d=e.subParser("images")(d,_,m),d=e.subParser("anchors")(d,_,m),d=e.subParser("autoLinks")(d,_,m),d=e.subParser("simplifiedAutoLinks")(d,_,m),d=e.subParser("emoji")(d,_,m),d=e.subParser("underline")(d,_,m),d=e.subParser("italicsAndBold")(d,_,m),d=e.subParser("strikethrough")(d,_,m),d=e.subParser("ellipsis")(d,_,m),d=e.subParser("hashHTMLSpans")(d,_,m),d=e.subParser("encodeAmpsAndAngles")(d,_,m),_.simpleLineBreaks?/\n\nK/.test(d)||(d=d.replace(/\n+/g,`<br />
`)):d=d.replace(/  +\n/g,`<br />
`),d=m.converter._dispatch("spanGamut.after",d,_,m),d}),e.subParser("strikethrough",function(d,_,m){"use strict";function y(x){return _.simplifiedAutoLink&&(x=e.subParser("simplifiedAutoLinks")(x,_,m)),"<del>"+x+"</del>"}return _.strikethrough&&(d=m.converter._dispatch("strikethrough.before",d,_,m),d=d.replace(/(?:~){2}([\s\S]+?)(?:~){2}/g,function(x,S){return y(S)}),d=m.converter._dispatch("strikethrough.after",d,_,m)),d}),e.subParser("stripLinkDefinitions",function(d,_,m){"use strict";var y=/^ {0,3}\[([^\]]+)]:[ \t]*\n?[ \t]*<?([^>\s]+)>?(?: =([*\d]+[A-Za-z%]{0,4})x([*\d]+[A-Za-z%]{0,4}))?[ \t]*\n?[ \t]*(?:(\n*)["|'(](.+?)["|')][ \t]*)?(?:\n+|(?=0))/gm,x=/^ {0,3}\[([^\]]+)]:[ \t]*\n?[ \t]*<?(data:.+?\/.+?;base64,[A-Za-z0-9+/=\n]+?)>?(?: =([*\d]+[A-Za-z%]{0,4})x([*\d]+[A-Za-z%]{0,4}))?[ \t]*\n?[ \t]*(?:(\n*)["|'(](.+?)["|')][ \t]*)?(?:\n\n|(?=0)|(?=\n\[))/gm;d+="\xA80";var S=function(w,E,L,I,A,B,T){return E=E.toLowerCase(),d.toLowerCase().split(E).length-1<2?w:(L.match(/^data:.+?\/.+?;base64,/)?m.gUrls[E]=L.replace(/\s/g,""):m.gUrls[E]=e.subParser("encodeAmpsAndAngles")(L,_,m),B?B+T:(T&&(m.gTitles[E]=T.replace(/"|'/g,"&quot;")),_.parseImgDimensions&&I&&A&&(m.gDimensions[E]={width:I,height:A}),""))};return d=d.replace(x,S),d=d.replace(y,S),d=d.replace(/0/,""),d}),e.subParser("tables",function(d,_,m){"use strict";if(!_.tables)return d;var y=/^ {0,3}\|?.+\|.+\n {0,3}\|?[ \t]*:?[ \t]*(?:[-=]){2,}[ \t]*:?[ \t]*\|[ \t]*:?[ \t]*(?:[-=]){2,}[\s\S]+?(?:\n\n|0)/gm,x=/^ {0,3}\|.+\|[ \t]*\n {0,3}\|[ \t]*:?[ \t]*(?:[-=]){2,}[ \t]*:?[ \t]*\|[ \t]*\n( {0,3}\|.+\|[ \t]*\n)*(?:\n|0)/gm;function S(A){return/^:[ \t]*--*$/.test(A)?' style="text-align:left;"':/^--*[ \t]*:[ \t]*$/.test(A)?' style="text-align:right;"':/^:[ \t]*--*[ \t]*:$/.test(A)?' style="text-align:center;"':""}function w(A,B){var T="";return A=A.trim(),(_.tablesHeaderId||_.tableHeaderId)&&(T=' id="'+A.replace(/ /g,"_").toLowerCase()+'"'),A=e.subParser("spanGamut")(A,_,m),"<th"+T+B+">"+A+`</th>
`}function E(A,B){var T=e.subParser("spanGamut")(A,_,m);return"<td"+B+">"+T+`</td>
`}function L(A,B){for(var T=`<table>
<thead>
<tr>
`,M=A.length,j=0;j<M;++j)T+=A[j];for(T+=`</tr>
</thead>
<tbody>
`,j=0;j<B.length;++j){T+=`<tr>
`;for(var J=0;J<M;++J)T+=B[j][J];T+=`</tr>
`}return T+=`</tbody>
</table>
`,T}function I(A){var B,T=A.split(`
`);for(B=0;B<T.length;++B)/^ {0,3}\|/.test(T[B])&&(T[B]=T[B].replace(/^ {0,3}\|/,"")),/\|[ \t]*$/.test(T[B])&&(T[B]=T[B].replace(/\|[ \t]*$/,"")),T[B]=e.subParser("codeSpans")(T[B],_,m);var M=T[0].split("|").map(function(Y){return Y.trim()}),j=T[1].split("|").map(function(Y){return Y.trim()}),J=[],U=[],H=[],te=[];for(T.shift(),T.shift(),B=0;B<T.length;++B)T[B].trim()!==""&&J.push(T[B].split("|").map(function(Y){return Y.trim()}));if(M.length<j.length)return A;for(B=0;B<j.length;++B)H.push(S(j[B]));for(B=0;B<M.length;++B)e.helper.isUndefined(H[B])&&(H[B]=""),U.push(w(M[B],H[B]));for(B=0;B<J.length;++B){for(var ae=[],W=0;W<U.length;++W)e.helper.isUndefined(J[B][W]),ae.push(E(J[B][W],H[W]));te.push(ae)}return L(U,te)}return d=m.converter._dispatch("tables.before",d,_,m),d=d.replace(/\\(\|)/g,e.helper.escapeCharactersCallback),d=d.replace(y,I),d=d.replace(x,I),d=m.converter._dispatch("tables.after",d,_,m),d}),e.subParser("underline",function(d,_,m){"use strict";return _.underline&&(d=m.converter._dispatch("underline.before",d,_,m),_.literalMidWordUnderscores?(d=d.replace(/\b___(\S[\s\S]*?)___\b/g,function(y,x){return"<u>"+x+"</u>"}),d=d.replace(/\b__(\S[\s\S]*?)__\b/g,function(y,x){return"<u>"+x+"</u>"})):(d=d.replace(/___(\S[\s\S]*?)___/g,function(y,x){return/\S$/.test(x)?"<u>"+x+"</u>":y}),d=d.replace(/__(\S[\s\S]*?)__/g,function(y,x){return/\S$/.test(x)?"<u>"+x+"</u>":y})),d=d.replace(/(_)/g,e.helper.escapeCharactersCallback),d=m.converter._dispatch("underline.after",d,_,m)),d}),e.subParser("unescapeSpecialChars",function(d,_,m){"use strict";return d=m.converter._dispatch("unescapeSpecialChars.before",d,_,m),d=d.replace(/E(\d+)E/g,function(y,x){var S=parseInt(x);return String.fromCharCode(S)}),d=m.converter._dispatch("unescapeSpecialChars.after",d,_,m),d}),e.subParser("makeMarkdown.blockquote",function(d,_){"use strict";var m="";if(d.hasChildNodes())for(var y=d.childNodes,x=y.length,S=0;S<x;++S){var w=e.subParser("makeMarkdown.node")(y[S],_);w!==""&&(m+=w)}return m=m.trim(),m="> "+m.split(`
`).join(`
> `),m}),e.subParser("makeMarkdown.codeBlock",function(d,_){"use strict";var m=d.getAttribute("language"),y=d.getAttribute("precodenum");return"```"+m+`
`+_.preList[y]+"\n```"}),e.subParser("makeMarkdown.codeSpan",function(d){"use strict";return"`"+d.innerHTML+"`"}),e.subParser("makeMarkdown.emphasis",function(d,_){"use strict";var m="";if(d.hasChildNodes()){m+="*";for(var y=d.childNodes,x=y.length,S=0;S<x;++S)m+=e.subParser("makeMarkdown.node")(y[S],_);m+="*"}return m}),e.subParser("makeMarkdown.header",function(d,_,m){"use strict";var y=new Array(m+1).join("#"),x="";if(d.hasChildNodes()){x=y+" ";for(var S=d.childNodes,w=S.length,E=0;E<w;++E)x+=e.subParser("makeMarkdown.node")(S[E],_)}return x}),e.subParser("makeMarkdown.hr",function(){"use strict";return"---"}),e.subParser("makeMarkdown.image",function(d){"use strict";var _="";return d.hasAttribute("src")&&(_+="!["+d.getAttribute("alt")+"](",_+="<"+d.getAttribute("src")+">",d.hasAttribute("width")&&d.hasAttribute("height")&&(_+=" ="+d.getAttribute("width")+"x"+d.getAttribute("height")),d.hasAttribute("title")&&(_+=' "'+d.getAttribute("title")+'"'),_+=")"),_}),e.subParser("makeMarkdown.links",function(d,_){"use strict";var m="";if(d.hasChildNodes()&&d.hasAttribute("href")){var y=d.childNodes,x=y.length;m="[";for(var S=0;S<x;++S)m+=e.subParser("makeMarkdown.node")(y[S],_);m+="](",m+="<"+d.getAttribute("href")+">",d.hasAttribute("title")&&(m+=' "'+d.getAttribute("title")+'"'),m+=")"}return m}),e.subParser("makeMarkdown.list",function(d,_,m){"use strict";var y="";if(!d.hasChildNodes())return"";for(var x=d.childNodes,S=x.length,w=d.getAttribute("start")||1,E=0;E<S;++E)if(!(typeof x[E].tagName=="undefined"||x[E].tagName.toLowerCase()!=="li")){var L="";m==="ol"?L=w.toString()+". ":L="- ",y+=L+e.subParser("makeMarkdown.listItem")(x[E],_),++w}return y+=`
<!-- -->
`,y.trim()}),e.subParser("makeMarkdown.listItem",function(d,_){"use strict";for(var m="",y=d.childNodes,x=y.length,S=0;S<x;++S)m+=e.subParser("makeMarkdown.node")(y[S],_);return/\n$/.test(m)?m=m.split(`
`).join(`
    `).replace(/^ {4}$/gm,"").replace(/\n\n+/g,`

`):m+=`
`,m}),e.subParser("makeMarkdown.node",function(d,_,m){"use strict";m=m||!1;var y="";if(d.nodeType===3)return e.subParser("makeMarkdown.txt")(d,_);if(d.nodeType===8)return"<!--"+d.data+`-->

`;if(d.nodeType!==1)return"";var x=d.tagName.toLowerCase();switch(x){case"h1":m||(y=e.subParser("makeMarkdown.header")(d,_,1)+`

`);break;case"h2":m||(y=e.subParser("makeMarkdown.header")(d,_,2)+`

`);break;case"h3":m||(y=e.subParser("makeMarkdown.header")(d,_,3)+`

`);break;case"h4":m||(y=e.subParser("makeMarkdown.header")(d,_,4)+`

`);break;case"h5":m||(y=e.subParser("makeMarkdown.header")(d,_,5)+`

`);break;case"h6":m||(y=e.subParser("makeMarkdown.header")(d,_,6)+`

`);break;case"p":m||(y=e.subParser("makeMarkdown.paragraph")(d,_)+`

`);break;case"blockquote":m||(y=e.subParser("makeMarkdown.blockquote")(d,_)+`

`);break;case"hr":m||(y=e.subParser("makeMarkdown.hr")(d,_)+`

`);break;case"ol":m||(y=e.subParser("makeMarkdown.list")(d,_,"ol")+`

`);break;case"ul":m||(y=e.subParser("makeMarkdown.list")(d,_,"ul")+`

`);break;case"precode":m||(y=e.subParser("makeMarkdown.codeBlock")(d,_)+`

`);break;case"pre":m||(y=e.subParser("makeMarkdown.pre")(d,_)+`

`);break;case"table":m||(y=e.subParser("makeMarkdown.table")(d,_)+`

`);break;case"code":y=e.subParser("makeMarkdown.codeSpan")(d,_);break;case"em":case"i":y=e.subParser("makeMarkdown.emphasis")(d,_);break;case"strong":case"b":y=e.subParser("makeMarkdown.strong")(d,_);break;case"del":y=e.subParser("makeMarkdown.strikethrough")(d,_);break;case"a":y=e.subParser("makeMarkdown.links")(d,_);break;case"img":y=e.subParser("makeMarkdown.image")(d,_);break;default:y=d.outerHTML+`

`}return y}),e.subParser("makeMarkdown.paragraph",function(d,_){"use strict";var m="";if(d.hasChildNodes())for(var y=d.childNodes,x=y.length,S=0;S<x;++S)m+=e.subParser("makeMarkdown.node")(y[S],_);return m=m.trim(),m}),e.subParser("makeMarkdown.pre",function(d,_){"use strict";var m=d.getAttribute("prenum");return"<pre>"+_.preList[m]+"</pre>"}),e.subParser("makeMarkdown.strikethrough",function(d,_){"use strict";var m="";if(d.hasChildNodes()){m+="~~";for(var y=d.childNodes,x=y.length,S=0;S<x;++S)m+=e.subParser("makeMarkdown.node")(y[S],_);m+="~~"}return m}),e.subParser("makeMarkdown.strong",function(d,_){"use strict";var m="";if(d.hasChildNodes()){m+="**";for(var y=d.childNodes,x=y.length,S=0;S<x;++S)m+=e.subParser("makeMarkdown.node")(y[S],_);m+="**"}return m}),e.subParser("makeMarkdown.table",function(d,_){"use strict";var m="",y=[[],[]],x=d.querySelectorAll("thead>tr>th"),S=d.querySelectorAll("tbody>tr"),w,E;for(w=0;w<x.length;++w){var L=e.subParser("makeMarkdown.tableCell")(x[w],_),I="---";if(x[w].hasAttribute("style")){var A=x[w].getAttribute("style").toLowerCase().replace(/\s/g,"");switch(A){case"text-align:left;":I=":---";break;case"text-align:right;":I="---:";break;case"text-align:center;":I=":---:";break}}y[0][w]=L.trim(),y[1][w]=I}for(w=0;w<S.length;++w){var B=y.push([])-1,T=S[w].getElementsByTagName("td");for(E=0;E<x.length;++E){var M=" ";typeof T[E]!="undefined"&&(M=e.subParser("makeMarkdown.tableCell")(T[E],_)),y[B].push(M)}}var j=3;for(w=0;w<y.length;++w)for(E=0;E<y[w].length;++E){var J=y[w][E].length;J>j&&(j=J)}for(w=0;w<y.length;++w){for(E=0;E<y[w].length;++E)w===1?y[w][E].slice(-1)===":"?y[w][E]=e.helper.padEnd(y[w][E].slice(-1),j-1,"-")+":":y[w][E]=e.helper.padEnd(y[w][E],j,"-"):y[w][E]=e.helper.padEnd(y[w][E],j);m+="| "+y[w].join(" | ")+` |
`}return m.trim()}),e.subParser("makeMarkdown.tableCell",function(d,_){"use strict";var m="";if(!d.hasChildNodes())return"";for(var y=d.childNodes,x=y.length,S=0;S<x;++S)m+=e.subParser("makeMarkdown.node")(y[S],_,!0);return m.trim()}),e.subParser("makeMarkdown.txt",function(d){"use strict";var _=d.nodeValue;return _=_.replace(/ +/g," "),_=_.replace(/NBSP;/g," "),_=e.helper.unescapeHTMLEntities(_),_=_.replace(/([*_~|`])/g,"\\$1"),_=_.replace(/^(\s*)>/g,"\\$1>"),_=_.replace(/^#/gm,"\\#"),_=_.replace(/^(\s*)([-=]{3,})(\s*)$/,"$1\\$2$3"),_=_.replace(/^( {0,3}\d+)\./gm,"$1\\."),_=_.replace(/^( {0,3})([+-])/gm,"$1\\$2"),_=_.replace(/]([\s]*)\(/g,"\\]$1\\("),_=_.replace(/^ {0,3}\[([\S \t]*?)]:/gm,"\\[$1]:"),_});var O=this;typeof define=="function"&&define.amd?define(function(){"use strict";return e}):typeof on!="undefined"&&on.exports?on.exports=e:O.showdown=e}).call(fd)});var $d=ye((Do,jo)=>{(function(r,t){typeof Do=="object"&&typeof jo!="undefined"?jo.exports=t():typeof define=="function"&&define.amd?define(t):(r=typeof globalThis!="undefined"?globalThis:r||self,r.Cropper=t())})(Do,function(){"use strict";function r(D,R){var P=Object.keys(D);if(Object.getOwnPropertySymbols){var N=Object.getOwnPropertySymbols(D);R&&(N=N.filter(function(X){return Object.getOwnPropertyDescriptor(D,X).enumerable})),P.push.apply(P,N)}return P}function t(D){for(var R=1;R<arguments.length;R++){var P=arguments[R]!=null?arguments[R]:{};R%2?r(Object(P),!0).forEach(function(N){a(D,N,P[N])}):Object.getOwnPropertyDescriptors?Object.defineProperties(D,Object.getOwnPropertyDescriptors(P)):r(Object(P)).forEach(function(N){Object.defineProperty(D,N,Object.getOwnPropertyDescriptor(P,N))})}return D}function e(D){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?e=function(R){return typeof R}:e=function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R},e(D)}function i(D,R){if(!(D instanceof R))throw new TypeError("Cannot call a class as a function")}function n(D,R){for(var P=0;P<R.length;P++){var N=R[P];N.enumerable=N.enumerable||!1,N.configurable=!0,"value"in N&&(N.writable=!0),Object.defineProperty(D,N.key,N)}}function o(D,R,P){return R&&n(D.prototype,R),P&&n(D,P),D}function a(D,R,P){return R in D?Object.defineProperty(D,R,{value:P,enumerable:!0,configurable:!0,writable:!0}):D[R]=P,D}function s(D){return l(D)||u(D)||c(D)||p()}function l(D){if(Array.isArray(D))return h(D)}function u(D){if(typeof Symbol!="undefined"&&D[Symbol.iterator]!=null||D["@@iterator"]!=null)return Array.from(D)}function c(D,R){if(!!D){if(typeof D=="string")return h(D,R);var P=Object.prototype.toString.call(D).slice(8,-1);if(P==="Object"&&D.constructor&&(P=D.constructor.name),P==="Map"||P==="Set")return Array.from(D);if(P==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(P))return h(D,R)}}function h(D,R){(R==null||R>D.length)&&(R=D.length);for(var P=0,N=new Array(R);P<R;P++)N[P]=D[P];return N}function p(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var g=typeof window!="undefined"&&typeof window.document!="undefined",b=g?window:{},v=g&&b.document.documentElement?"ontouchstart"in b.document.documentElement:!1,k=g?"PointerEvent"in b:!1,C="cropper",O="all",d="crop",_="move",m="zoom",y="e",x="w",S="s",w="n",E="ne",L="nw",I="se",A="sw",B="".concat(C,"-crop"),T="".concat(C,"-disabled"),M="".concat(C,"-hidden"),j="".concat(C,"-hide"),J="".concat(C,"-invisible"),U="".concat(C,"-modal"),H="".concat(C,"-move"),te="".concat(C,"Action"),ae="".concat(C,"Preview"),W="crop",Y="move",re="none",ie="crop",Q="cropend",ee="cropmove",pe="cropstart",be="dblclick",we=v?"touchstart":"mousedown",Le=v?"touchmove":"mousemove",fe=v?"touchend touchcancel":"mouseup",xe=k?"pointerdown":we,Ne=k?"pointermove":Le,Be=k?"pointerup pointercancel":fe,Pe="ready",Ze="resize",tt="wheel",Xe="zoom",Ke="image/jpeg",nt=/^e|w|s|n|se|sw|ne|nw|all|crop|move|zoom$/,ot=/^data:/,ce=/^data:image\/jpeg;base64,/,ve=/^img|canvas$/i,Ie=200,He=100,at={viewMode:0,dragMode:W,initialAspectRatio:NaN,aspectRatio:NaN,data:null,preview:"",responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,wheelZoomRatio:.1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:Ie,minContainerHeight:He,ready:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null},vt='<div class="cropper-container" touch-action="none"><div class="cropper-wrap-box"><div class="cropper-canvas"></div></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-cropper-action="e"></span><span class="cropper-line line-n" data-cropper-action="n"></span><span class="cropper-line line-w" data-cropper-action="w"></span><span class="cropper-line line-s" data-cropper-action="s"></span><span class="cropper-point point-e" data-cropper-action="e"></span><span class="cropper-point point-n" data-cropper-action="n"></span><span class="cropper-point point-w" data-cropper-action="w"></span><span class="cropper-point point-s" data-cropper-action="s"></span><span class="cropper-point point-ne" data-cropper-action="ne"></span><span class="cropper-point point-nw" data-cropper-action="nw"></span><span class="cropper-point point-sw" data-cropper-action="sw"></span><span class="cropper-point point-se" data-cropper-action="se"></span></div></div>',bt=Number.isNaN||b.isNaN;function Me(D){return typeof D=="number"&&!bt(D)}var yt=function(R){return R>0&&R<1/0};function Wt(D){return typeof D=="undefined"}function Ft(D){return e(D)==="object"&&D!==null}var Ye=Object.prototype.hasOwnProperty;function Ge(D){if(!Ft(D))return!1;try{var R=D.constructor,P=R.prototype;return R&&P&&Ye.call(P,"isPrototypeOf")}catch(N){return!1}}function Qe(D){return typeof D=="function"}var qe=Array.prototype.slice;function er(D){return Array.from?Array.from(D):qe.call(D)}function dt(D,R){return D&&Qe(R)&&(Array.isArray(D)||Me(D.length)?er(D).forEach(function(P,N){R.call(D,P,N,D)}):Ft(D)&&Object.keys(D).forEach(function(P){R.call(D,D[P],P,D)})),D}var De=Object.assign||function(R){for(var P=arguments.length,N=new Array(P>1?P-1:0),X=1;X<P;X++)N[X-1]=arguments[X];return Ft(R)&&N.length>0&&N.forEach(function(q){Ft(q)&&Object.keys(q).forEach(function(K){R[K]=q[K]})}),R},tr=/\.\d*(?:0|9){12}\d*$/;function et(D){var R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e11;return tr.test(D)?Math.round(D*R)/R:D}var rr=/^width|height|left|top|marginLeft|marginTop$/;function It(D,R){var P=D.style;dt(R,function(N,X){rr.test(X)&&Me(N)&&(N="".concat(N,"px")),P[X]=N})}function dr(D,R){return D.classList?D.classList.contains(R):D.className.indexOf(R)>-1}function pt(D,R){if(!!R){if(Me(D.length)){dt(D,function(N){pt(N,R)});return}if(D.classList){D.classList.add(R);return}var P=D.className.trim();P?P.indexOf(R)<0&&(D.className="".concat(P," ").concat(R)):D.className=R}}function Lt(D,R){if(!!R){if(Me(D.length)){dt(D,function(P){Lt(P,R)});return}if(D.classList){D.classList.remove(R);return}D.className.indexOf(R)>=0&&(D.className=D.className.replace(R,""))}}function Xt(D,R,P){if(!!R){if(Me(D.length)){dt(D,function(N){Xt(N,R,P)});return}P?pt(D,R):Lt(D,R)}}var xr=/([a-z\d])([A-Z])/g;function Nt(D){return D.replace(xr,"$1-$2").toLowerCase()}function ir(D,R){return Ft(D[R])?D[R]:D.dataset?D.dataset[R]:D.getAttribute("data-".concat(Nt(R)))}function Pt(D,R,P){Ft(P)?D[R]=P:D.dataset?D.dataset[R]=P:D.setAttribute("data-".concat(Nt(R)),P)}function hr(D,R){if(Ft(D[R]))try{delete D[R]}catch(P){D[R]=void 0}else if(D.dataset)try{delete D.dataset[R]}catch(P){D.dataset[R]=void 0}else D.removeAttribute("data-".concat(Nt(R)))}var Kt=/\s\s*/,nr=function(){var D=!1;if(g){var R=!1,P=function(){},N=Object.defineProperty({},"once",{get:function(){return D=!0,R},set:function(q){R=q}});b.addEventListener("test",P,N),b.removeEventListener("test",P,N)}return D}();function Tt(D,R,P){var N=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},X=P;R.trim().split(Kt).forEach(function(q){if(!nr){var K=D.listeners;K&&K[q]&&K[q][P]&&(X=K[q][P],delete K[q][P],Object.keys(K[q]).length===0&&delete K[q],Object.keys(K).length===0&&delete D.listeners)}D.removeEventListener(q,X,N)})}function Et(D,R,P){var N=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},X=P;R.trim().split(Kt).forEach(function(q){if(N.once&&!nr){var K=D.listeners,se=K===void 0?{}:K;X=function(){delete se[q][P],D.removeEventListener(q,X,N);for(var me=arguments.length,he=new Array(me),_e=0;_e<me;_e++)he[_e]=arguments[_e];P.apply(D,he)},se[q]||(se[q]={}),se[q][P]&&D.removeEventListener(q,se[q][P],N),se[q][P]=X,D.listeners=se}D.addEventListener(q,X,N)})}function wt(D,R,P){var N;return Qe(Event)&&Qe(CustomEvent)?N=new CustomEvent(R,{detail:P,bubbles:!0,cancelable:!0}):(N=document.createEvent("CustomEvent"),N.initCustomEvent(R,!0,!0,P)),D.dispatchEvent(N)}function Ee(D){var R=D.getBoundingClientRect();return{left:R.left+(window.pageXOffset-document.documentElement.clientLeft),top:R.top+(window.pageYOffset-document.documentElement.clientTop)}}var Te=b.location,ze=/^(\w+:)\/\/([^:/?#]*):?(\d*)/i;function z(D){var R=D.match(ze);return R!==null&&(R[1]!==Te.protocol||R[2]!==Te.hostname||R[3]!==Te.port)}function G(D){var R="timestamp=".concat(new Date().getTime());return D+(D.indexOf("?")===-1?"?":"&")+R}function Z(D){var R=D.rotate,P=D.scaleX,N=D.scaleY,X=D.translateX,q=D.translateY,K=[];Me(X)&&X!==0&&K.push("translateX(".concat(X,"px)")),Me(q)&&q!==0&&K.push("translateY(".concat(q,"px)")),Me(R)&&R!==0&&K.push("rotate(".concat(R,"deg)")),Me(P)&&P!==1&&K.push("scaleX(".concat(P,")")),Me(N)&&N!==1&&K.push("scaleY(".concat(N,")"));var se=K.length?K.join(" "):"none";return{WebkitTransform:se,msTransform:se,transform:se}}function de(D){var R=t({},D),P=0;return dt(D,function(N,X){delete R[X],dt(R,function(q){var K=Math.abs(N.startX-q.startX),se=Math.abs(N.startY-q.startY),ge=Math.abs(N.endX-q.endX),me=Math.abs(N.endY-q.endY),he=Math.sqrt(K*K+se*se),_e=Math.sqrt(ge*ge+me*me),ke=(_e-he)/he;Math.abs(ke)>Math.abs(P)&&(P=ke)})}),P}function le(D,R){var P=D.pageX,N=D.pageY,X={endX:P,endY:N};return R?X:t({startX:P,startY:N},X)}function Ce(D){var R=0,P=0,N=0;return dt(D,function(X){var q=X.startX,K=X.startY;R+=q,P+=K,N+=1}),R/=N,P/=N,{pageX:R,pageY:P}}function Se(D){var R=D.aspectRatio,P=D.height,N=D.width,X=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"contain",q=yt(N),K=yt(P);if(q&&K){var se=P*R;X==="contain"&&se>N||X==="cover"&&se<N?P=N/R:N=P*R}else q?P=N/R:K&&(N=P*R);return{width:N,height:P}}function Re(D){var R=D.width,P=D.height,N=D.degree;if(N=Math.abs(N)%180,N===90)return{width:P,height:R};var X=N%90*Math.PI/180,q=Math.sin(X),K=Math.cos(X),se=R*K+P*q,ge=R*q+P*K;return N>90?{width:ge,height:se}:{width:se,height:ge}}function Ae(D,R,P,N){var X=R.aspectRatio,q=R.naturalWidth,K=R.naturalHeight,se=R.rotate,ge=se===void 0?0:se,me=R.scaleX,he=me===void 0?1:me,_e=R.scaleY,ke=_e===void 0?1:_e,je=P.aspectRatio,Ve=P.naturalWidth,ft=P.naturalHeight,st=N.fillColor,kt=st===void 0?"transparent":st,Ot=N.imageSmoothingEnabled,Ct=Ot===void 0?!0:Ot,or=N.imageSmoothingQuality,Dt=or===void 0?"low":or,Oe=N.maxWidth,ct=Oe===void 0?1/0:Oe,Rt=N.maxHeight,Jt=Rt===void 0?1/0:Rt,_r=N.minWidth,Cr=_r===void 0?0:_r,Sr=N.minHeight,br=Sr===void 0?0:Sr,fr=document.createElement("canvas"),qt=fr.getContext("2d"),Tr=Se({aspectRatio:je,width:ct,height:Jt}),Li=Se({aspectRatio:je,width:Cr,height:br},"cover"),Wn=Math.min(Tr.width,Math.max(Li.width,Ve)),Vn=Math.min(Tr.height,Math.max(Li.height,ft)),ha=Se({aspectRatio:X,width:ct,height:Jt}),_a=Se({aspectRatio:X,width:Cr,height:br},"cover"),ma=Math.min(ha.width,Math.max(_a.width,q)),ga=Math.min(ha.height,Math.max(_a.height,K)),ip=[-ma/2,-ga/2,ma,ga];return fr.width=et(Wn),fr.height=et(Vn),qt.fillStyle=kt,qt.fillRect(0,0,Wn,Vn),qt.save(),qt.translate(Wn/2,Vn/2),qt.rotate(ge*Math.PI/180),qt.scale(he,ke),qt.imageSmoothingEnabled=Ct,qt.imageSmoothingQuality=Dt,qt.drawImage.apply(qt,[D].concat(s(ip.map(function(np){return Math.floor(et(np))})))),qt.restore(),fr}var $e=String.fromCharCode;function We(D,R,P){var N="";P+=R;for(var X=R;X<P;X+=1)N+=$e(D.getUint8(X));return N}var Fe=/^data:.*,/;function rt(D){var R=D.replace(Fe,""),P=atob(R),N=new ArrayBuffer(P.length),X=new Uint8Array(N);return dt(X,function(q,K){X[K]=P.charCodeAt(K)}),N}function mt(D,R){for(var P=[],N=8192,X=new Uint8Array(D);X.length>0;)P.push($e.apply(null,er(X.subarray(0,N)))),X=X.subarray(N);return"data:".concat(R,";base64,").concat(btoa(P.join("")))}function Je(D){var R=new DataView(D),P;try{var N,X,q;if(R.getUint8(0)===255&&R.getUint8(1)===216)for(var K=R.byteLength,se=2;se+1<K;){if(R.getUint8(se)===255&&R.getUint8(se+1)===225){X=se;break}se+=1}if(X){var ge=X+4,me=X+10;if(We(R,ge,4)==="Exif"){var he=R.getUint16(me);if(N=he===18761,(N||he===19789)&&R.getUint16(me+2,N)===42){var _e=R.getUint32(me+4,N);_e>=8&&(q=me+_e)}}}if(q){var ke=R.getUint16(q,N),je,Ve;for(Ve=0;Ve<ke;Ve+=1)if(je=q+Ve*12+2,R.getUint16(je,N)===274){je+=8,P=R.getUint16(je,N),R.setUint16(je,1,N);break}}}catch(ft){P=1}return P}function Ue(D){var R=0,P=1,N=1;switch(D){case 2:P=-1;break;case 3:R=-180;break;case 4:N=-1;break;case 5:R=90,N=-1;break;case 6:R=90;break;case 7:R=90,P=-1;break;case 8:R=-90;break}return{rotate:R,scaleX:P,scaleY:N}}var At={render:function(){this.initContainer(),this.initCanvas(),this.initCropBox(),this.renderCanvas(),this.cropped&&this.renderCropBox()},initContainer:function(){var R=this.element,P=this.options,N=this.container,X=this.cropper,q=Number(P.minContainerWidth),K=Number(P.minContainerHeight);pt(X,M),Lt(R,M);var se={width:Math.max(N.offsetWidth,q>=0?q:Ie),height:Math.max(N.offsetHeight,K>=0?K:He)};this.containerData=se,It(X,{width:se.width,height:se.height}),pt(R,M),Lt(X,M)},initCanvas:function(){var R=this.containerData,P=this.imageData,N=this.options.viewMode,X=Math.abs(P.rotate)%180===90,q=X?P.naturalHeight:P.naturalWidth,K=X?P.naturalWidth:P.naturalHeight,se=q/K,ge=R.width,me=R.height;R.height*se>R.width?N===3?ge=R.height*se:me=R.width/se:N===3?me=R.width/se:ge=R.height*se;var he={aspectRatio:se,naturalWidth:q,naturalHeight:K,width:ge,height:me};this.canvasData=he,this.limited=N===1||N===2,this.limitCanvas(!0,!0),he.width=Math.min(Math.max(he.width,he.minWidth),he.maxWidth),he.height=Math.min(Math.max(he.height,he.minHeight),he.maxHeight),he.left=(R.width-he.width)/2,he.top=(R.height-he.height)/2,he.oldLeft=he.left,he.oldTop=he.top,this.initialCanvasData=De({},he)},limitCanvas:function(R,P){var N=this.options,X=this.containerData,q=this.canvasData,K=this.cropBoxData,se=N.viewMode,ge=q.aspectRatio,me=this.cropped&&K;if(R){var he=Number(N.minCanvasWidth)||0,_e=Number(N.minCanvasHeight)||0;se>1?(he=Math.max(he,X.width),_e=Math.max(_e,X.height),se===3&&(_e*ge>he?he=_e*ge:_e=he/ge)):se>0&&(he?he=Math.max(he,me?K.width:0):_e?_e=Math.max(_e,me?K.height:0):me&&(he=K.width,_e=K.height,_e*ge>he?he=_e*ge:_e=he/ge));var ke=Se({aspectRatio:ge,width:he,height:_e});he=ke.width,_e=ke.height,q.minWidth=he,q.minHeight=_e,q.maxWidth=1/0,q.maxHeight=1/0}if(P)if(se>(me?0:1)){var je=X.width-q.width,Ve=X.height-q.height;q.minLeft=Math.min(0,je),q.minTop=Math.min(0,Ve),q.maxLeft=Math.max(0,je),q.maxTop=Math.max(0,Ve),me&&this.limited&&(q.minLeft=Math.min(K.left,K.left+(K.width-q.width)),q.minTop=Math.min(K.top,K.top+(K.height-q.height)),q.maxLeft=K.left,q.maxTop=K.top,se===2&&(q.width>=X.width&&(q.minLeft=Math.min(0,je),q.maxLeft=Math.max(0,je)),q.height>=X.height&&(q.minTop=Math.min(0,Ve),q.maxTop=Math.max(0,Ve))))}else q.minLeft=-q.width,q.minTop=-q.height,q.maxLeft=X.width,q.maxTop=X.height},renderCanvas:function(R,P){var N=this.canvasData,X=this.imageData;if(P){var q=Re({width:X.naturalWidth*Math.abs(X.scaleX||1),height:X.naturalHeight*Math.abs(X.scaleY||1),degree:X.rotate||0}),K=q.width,se=q.height,ge=N.width*(K/N.naturalWidth),me=N.height*(se/N.naturalHeight);N.left-=(ge-N.width)/2,N.top-=(me-N.height)/2,N.width=ge,N.height=me,N.aspectRatio=K/se,N.naturalWidth=K,N.naturalHeight=se,this.limitCanvas(!0,!1)}(N.width>N.maxWidth||N.width<N.minWidth)&&(N.left=N.oldLeft),(N.height>N.maxHeight||N.height<N.minHeight)&&(N.top=N.oldTop),N.width=Math.min(Math.max(N.width,N.minWidth),N.maxWidth),N.height=Math.min(Math.max(N.height,N.minHeight),N.maxHeight),this.limitCanvas(!1,!0),N.left=Math.min(Math.max(N.left,N.minLeft),N.maxLeft),N.top=Math.min(Math.max(N.top,N.minTop),N.maxTop),N.oldLeft=N.left,N.oldTop=N.top,It(this.canvas,De({width:N.width,height:N.height},Z({translateX:N.left,translateY:N.top}))),this.renderImage(R),this.cropped&&this.limited&&this.limitCropBox(!0,!0)},renderImage:function(R){var P=this.canvasData,N=this.imageData,X=N.naturalWidth*(P.width/P.naturalWidth),q=N.naturalHeight*(P.height/P.naturalHeight);De(N,{width:X,height:q,left:(P.width-X)/2,top:(P.height-q)/2}),It(this.image,De({width:N.width,height:N.height},Z(De({translateX:N.left,translateY:N.top},N)))),R&&this.output()},initCropBox:function(){var R=this.options,P=this.canvasData,N=R.aspectRatio||R.initialAspectRatio,X=Number(R.autoCropArea)||.8,q={width:P.width,height:P.height};N&&(P.height*N>P.width?q.height=q.width/N:q.width=q.height*N),this.cropBoxData=q,this.limitCropBox(!0,!0),q.width=Math.min(Math.max(q.width,q.minWidth),q.maxWidth),q.height=Math.min(Math.max(q.height,q.minHeight),q.maxHeight),q.width=Math.max(q.minWidth,q.width*X),q.height=Math.max(q.minHeight,q.height*X),q.left=P.left+(P.width-q.width)/2,q.top=P.top+(P.height-q.height)/2,q.oldLeft=q.left,q.oldTop=q.top,this.initialCropBoxData=De({},q)},limitCropBox:function(R,P){var N=this.options,X=this.containerData,q=this.canvasData,K=this.cropBoxData,se=this.limited,ge=N.aspectRatio;if(R){var me=Number(N.minCropBoxWidth)||0,he=Number(N.minCropBoxHeight)||0,_e=se?Math.min(X.width,q.width,q.width+q.left,X.width-q.left):X.width,ke=se?Math.min(X.height,q.height,q.height+q.top,X.height-q.top):X.height;me=Math.min(me,X.width),he=Math.min(he,X.height),ge&&(me&&he?he*ge>me?he=me/ge:me=he*ge:me?he=me/ge:he&&(me=he*ge),ke*ge>_e?ke=_e/ge:_e=ke*ge),K.minWidth=Math.min(me,_e),K.minHeight=Math.min(he,ke),K.maxWidth=_e,K.maxHeight=ke}P&&(se?(K.minLeft=Math.max(0,q.left),K.minTop=Math.max(0,q.top),K.maxLeft=Math.min(X.width,q.left+q.width)-K.width,K.maxTop=Math.min(X.height,q.top+q.height)-K.height):(K.minLeft=0,K.minTop=0,K.maxLeft=X.width-K.width,K.maxTop=X.height-K.height))},renderCropBox:function(){var R=this.options,P=this.containerData,N=this.cropBoxData;(N.width>N.maxWidth||N.width<N.minWidth)&&(N.left=N.oldLeft),(N.height>N.maxHeight||N.height<N.minHeight)&&(N.top=N.oldTop),N.width=Math.min(Math.max(N.width,N.minWidth),N.maxWidth),N.height=Math.min(Math.max(N.height,N.minHeight),N.maxHeight),this.limitCropBox(!1,!0),N.left=Math.min(Math.max(N.left,N.minLeft),N.maxLeft),N.top=Math.min(Math.max(N.top,N.minTop),N.maxTop),N.oldLeft=N.left,N.oldTop=N.top,R.movable&&R.cropBoxMovable&&Pt(this.face,te,N.width>=P.width&&N.height>=P.height?_:O),It(this.cropBox,De({width:N.width,height:N.height},Z({translateX:N.left,translateY:N.top}))),this.cropped&&this.limited&&this.limitCanvas(!0,!0),this.disabled||this.output()},output:function(){this.preview(),wt(this.element,ie,this.getData())}},$t={initPreview:function(){var R=this.element,P=this.crossOrigin,N=this.options.preview,X=P?this.crossOriginUrl:this.url,q=R.alt||"The image to preview",K=document.createElement("img");if(P&&(K.crossOrigin=P),K.src=X,K.alt=q,this.viewBox.appendChild(K),this.viewBoxImage=K,!!N){var se=N;typeof N=="string"?se=R.ownerDocument.querySelectorAll(N):N.querySelector&&(se=[N]),this.previews=se,dt(se,function(ge){var me=document.createElement("img");Pt(ge,ae,{width:ge.offsetWidth,height:ge.offsetHeight,html:ge.innerHTML}),P&&(me.crossOrigin=P),me.src=X,me.alt=q,me.style.cssText='display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;"',ge.innerHTML="",ge.appendChild(me)})}},resetPreview:function(){dt(this.previews,function(R){var P=ir(R,ae);It(R,{width:P.width,height:P.height}),R.innerHTML=P.html,hr(R,ae)})},preview:function(){var R=this.imageData,P=this.canvasData,N=this.cropBoxData,X=N.width,q=N.height,K=R.width,se=R.height,ge=N.left-P.left-R.left,me=N.top-P.top-R.top;!this.cropped||this.disabled||(It(this.viewBoxImage,De({width:K,height:se},Z(De({translateX:-ge,translateY:-me},R)))),dt(this.previews,function(he){var _e=ir(he,ae),ke=_e.width,je=_e.height,Ve=ke,ft=je,st=1;X&&(st=ke/X,ft=q*st),q&&ft>je&&(st=je/q,Ve=X*st,ft=je),It(he,{width:Ve,height:ft}),It(he.getElementsByTagName("img")[0],De({width:K*st,height:se*st},Z(De({translateX:-ge*st,translateY:-me*st},R))))}))}},xt={bind:function(){var R=this.element,P=this.options,N=this.cropper;Qe(P.cropstart)&&Et(R,pe,P.cropstart),Qe(P.cropmove)&&Et(R,ee,P.cropmove),Qe(P.cropend)&&Et(R,Q,P.cropend),Qe(P.crop)&&Et(R,ie,P.crop),Qe(P.zoom)&&Et(R,Xe,P.zoom),Et(N,xe,this.onCropStart=this.cropStart.bind(this)),P.zoomable&&P.zoomOnWheel&&Et(N,tt,this.onWheel=this.wheel.bind(this),{passive:!1,capture:!0}),P.toggleDragModeOnDblclick&&Et(N,be,this.onDblclick=this.dblclick.bind(this)),Et(R.ownerDocument,Ne,this.onCropMove=this.cropMove.bind(this)),Et(R.ownerDocument,Be,this.onCropEnd=this.cropEnd.bind(this)),P.responsive&&Et(window,Ze,this.onResize=this.resize.bind(this))},unbind:function(){var R=this.element,P=this.options,N=this.cropper;Qe(P.cropstart)&&Tt(R,pe,P.cropstart),Qe(P.cropmove)&&Tt(R,ee,P.cropmove),Qe(P.cropend)&&Tt(R,Q,P.cropend),Qe(P.crop)&&Tt(R,ie,P.crop),Qe(P.zoom)&&Tt(R,Xe,P.zoom),Tt(N,xe,this.onCropStart),P.zoomable&&P.zoomOnWheel&&Tt(N,tt,this.onWheel,{passive:!1,capture:!0}),P.toggleDragModeOnDblclick&&Tt(N,be,this.onDblclick),Tt(R.ownerDocument,Ne,this.onCropMove),Tt(R.ownerDocument,Be,this.onCropEnd),P.responsive&&Tt(window,Ze,this.onResize)}},St={resize:function(){if(!this.disabled){var R=this.options,P=this.container,N=this.containerData,X=P.offsetWidth/N.width,q=P.offsetHeight/N.height,K=Math.abs(X-1)>Math.abs(q-1)?X:q;if(K!==1){var se,ge;R.restore&&(se=this.getCanvasData(),ge=this.getCropBoxData()),this.render(),R.restore&&(this.setCanvasData(dt(se,function(me,he){se[he]=me*K})),this.setCropBoxData(dt(ge,function(me,he){ge[he]=me*K})))}}},dblclick:function(){this.disabled||this.options.dragMode===re||this.setDragMode(dr(this.dragBox,B)?Y:W)},wheel:function(R){var P=this,N=Number(this.options.wheelZoomRatio)||.1,X=1;this.disabled||(R.preventDefault(),!this.wheeling&&(this.wheeling=!0,setTimeout(function(){P.wheeling=!1},50),R.deltaY?X=R.deltaY>0?1:-1:R.wheelDelta?X=-R.wheelDelta/120:R.detail&&(X=R.detail>0?1:-1),this.zoom(-X*N,R)))},cropStart:function(R){var P=R.buttons,N=R.button;if(!(this.disabled||(R.type==="mousedown"||R.type==="pointerdown"&&R.pointerType==="mouse")&&(Me(P)&&P!==1||Me(N)&&N!==0||R.ctrlKey))){var X=this.options,q=this.pointers,K;R.changedTouches?dt(R.changedTouches,function(se){q[se.identifier]=le(se)}):q[R.pointerId||0]=le(R),Object.keys(q).length>1&&X.zoomable&&X.zoomOnTouch?K=m:K=ir(R.target,te),!!nt.test(K)&&wt(this.element,pe,{originalEvent:R,action:K})!==!1&&(R.preventDefault(),this.action=K,this.cropping=!1,K===d&&(this.cropping=!0,pt(this.dragBox,U)))}},cropMove:function(R){var P=this.action;if(!(this.disabled||!P)){var N=this.pointers;R.preventDefault(),wt(this.element,ee,{originalEvent:R,action:P})!==!1&&(R.changedTouches?dt(R.changedTouches,function(X){De(N[X.identifier]||{},le(X,!0))}):De(N[R.pointerId||0]||{},le(R,!0)),this.change(R))}},cropEnd:function(R){if(!this.disabled){var P=this.action,N=this.pointers;R.changedTouches?dt(R.changedTouches,function(X){delete N[X.identifier]}):delete N[R.pointerId||0],P&&(R.preventDefault(),Object.keys(N).length||(this.action=""),this.cropping&&(this.cropping=!1,Xt(this.dragBox,U,this.cropped&&this.options.modal)),wt(this.element,Q,{originalEvent:R,action:P}))}}},F={change:function(R){var P=this.options,N=this.canvasData,X=this.containerData,q=this.cropBoxData,K=this.pointers,se=this.action,ge=P.aspectRatio,me=q.left,he=q.top,_e=q.width,ke=q.height,je=me+_e,Ve=he+ke,ft=0,st=0,kt=X.width,Ot=X.height,Ct=!0,or;!ge&&R.shiftKey&&(ge=_e&&ke?_e/ke:1),this.limited&&(ft=q.minLeft,st=q.minTop,kt=ft+Math.min(X.width,N.width,N.left+N.width),Ot=st+Math.min(X.height,N.height,N.top+N.height));var Dt=K[Object.keys(K)[0]],Oe={x:Dt.endX-Dt.startX,y:Dt.endY-Dt.startY},ct=function(Jt){switch(Jt){case y:je+Oe.x>kt&&(Oe.x=kt-je);break;case x:me+Oe.x<ft&&(Oe.x=ft-me);break;case w:he+Oe.y<st&&(Oe.y=st-he);break;case S:Ve+Oe.y>Ot&&(Oe.y=Ot-Ve);break}};switch(se){case O:me+=Oe.x,he+=Oe.y;break;case y:if(Oe.x>=0&&(je>=kt||ge&&(he<=st||Ve>=Ot))){Ct=!1;break}ct(y),_e+=Oe.x,_e<0&&(se=x,_e=-_e,me-=_e),ge&&(ke=_e/ge,he+=(q.height-ke)/2);break;case w:if(Oe.y<=0&&(he<=st||ge&&(me<=ft||je>=kt))){Ct=!1;break}ct(w),ke-=Oe.y,he+=Oe.y,ke<0&&(se=S,ke=-ke,he-=ke),ge&&(_e=ke*ge,me+=(q.width-_e)/2);break;case x:if(Oe.x<=0&&(me<=ft||ge&&(he<=st||Ve>=Ot))){Ct=!1;break}ct(x),_e-=Oe.x,me+=Oe.x,_e<0&&(se=y,_e=-_e,me-=_e),ge&&(ke=_e/ge,he+=(q.height-ke)/2);break;case S:if(Oe.y>=0&&(Ve>=Ot||ge&&(me<=ft||je>=kt))){Ct=!1;break}ct(S),ke+=Oe.y,ke<0&&(se=w,ke=-ke,he-=ke),ge&&(_e=ke*ge,me+=(q.width-_e)/2);break;case E:if(ge){if(Oe.y<=0&&(he<=st||je>=kt)){Ct=!1;break}ct(w),ke-=Oe.y,he+=Oe.y,_e=ke*ge}else ct(w),ct(y),Oe.x>=0?je<kt?_e+=Oe.x:Oe.y<=0&&he<=st&&(Ct=!1):_e+=Oe.x,Oe.y<=0?he>st&&(ke-=Oe.y,he+=Oe.y):(ke-=Oe.y,he+=Oe.y);_e<0&&ke<0?(se=A,ke=-ke,_e=-_e,he-=ke,me-=_e):_e<0?(se=L,_e=-_e,me-=_e):ke<0&&(se=I,ke=-ke,he-=ke);break;case L:if(ge){if(Oe.y<=0&&(he<=st||me<=ft)){Ct=!1;break}ct(w),ke-=Oe.y,he+=Oe.y,_e=ke*ge,me+=q.width-_e}else ct(w),ct(x),Oe.x<=0?me>ft?(_e-=Oe.x,me+=Oe.x):Oe.y<=0&&he<=st&&(Ct=!1):(_e-=Oe.x,me+=Oe.x),Oe.y<=0?he>st&&(ke-=Oe.y,he+=Oe.y):(ke-=Oe.y,he+=Oe.y);_e<0&&ke<0?(se=I,ke=-ke,_e=-_e,he-=ke,me-=_e):_e<0?(se=E,_e=-_e,me-=_e):ke<0&&(se=A,ke=-ke,he-=ke);break;case A:if(ge){if(Oe.x<=0&&(me<=ft||Ve>=Ot)){Ct=!1;break}ct(x),_e-=Oe.x,me+=Oe.x,ke=_e/ge}else ct(S),ct(x),Oe.x<=0?me>ft?(_e-=Oe.x,me+=Oe.x):Oe.y>=0&&Ve>=Ot&&(Ct=!1):(_e-=Oe.x,me+=Oe.x),Oe.y>=0?Ve<Ot&&(ke+=Oe.y):ke+=Oe.y;_e<0&&ke<0?(se=E,ke=-ke,_e=-_e,he-=ke,me-=_e):_e<0?(se=I,_e=-_e,me-=_e):ke<0&&(se=L,ke=-ke,he-=ke);break;case I:if(ge){if(Oe.x>=0&&(je>=kt||Ve>=Ot)){Ct=!1;break}ct(y),_e+=Oe.x,ke=_e/ge}else ct(S),ct(y),Oe.x>=0?je<kt?_e+=Oe.x:Oe.y>=0&&Ve>=Ot&&(Ct=!1):_e+=Oe.x,Oe.y>=0?Ve<Ot&&(ke+=Oe.y):ke+=Oe.y;_e<0&&ke<0?(se=L,ke=-ke,_e=-_e,he-=ke,me-=_e):_e<0?(se=A,_e=-_e,me-=_e):ke<0&&(se=E,ke=-ke,he-=ke);break;case _:this.move(Oe.x,Oe.y),Ct=!1;break;case m:this.zoom(de(K),R),Ct=!1;break;case d:if(!Oe.x||!Oe.y){Ct=!1;break}or=Ee(this.cropper),me=Dt.startX-or.left,he=Dt.startY-or.top,_e=q.minWidth,ke=q.minHeight,Oe.x>0?se=Oe.y>0?I:E:Oe.x<0&&(me-=_e,se=Oe.y>0?A:L),Oe.y<0&&(he-=ke),this.cropped||(Lt(this.cropBox,M),this.cropped=!0,this.limited&&this.limitCropBox(!0,!0));break}Ct&&(q.width=_e,q.height=ke,q.left=me,q.top=he,this.action=se,this.renderCropBox()),dt(K,function(Rt){Rt.startX=Rt.endX,Rt.startY=Rt.endY})}},ne={crop:function(){return this.ready&&!this.cropped&&!this.disabled&&(this.cropped=!0,this.limitCropBox(!0,!0),this.options.modal&&pt(this.dragBox,U),Lt(this.cropBox,M),this.setCropBoxData(this.initialCropBoxData)),this},reset:function(){return this.ready&&!this.disabled&&(this.imageData=De({},this.initialImageData),this.canvasData=De({},this.initialCanvasData),this.cropBoxData=De({},this.initialCropBoxData),this.renderCanvas(),this.cropped&&this.renderCropBox()),this},clear:function(){return this.cropped&&!this.disabled&&(De(this.cropBoxData,{left:0,top:0,width:0,height:0}),this.cropped=!1,this.renderCropBox(),this.limitCanvas(!0,!0),this.renderCanvas(),Lt(this.dragBox,U),pt(this.cropBox,M)),this},replace:function(R){var P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return!this.disabled&&R&&(this.isImg&&(this.element.src=R),P?(this.url=R,this.image.src=R,this.ready&&(this.viewBoxImage.src=R,dt(this.previews,function(N){N.getElementsByTagName("img")[0].src=R}))):(this.isImg&&(this.replaced=!0),this.options.data=null,this.uncreate(),this.load(R))),this},enable:function(){return this.ready&&this.disabled&&(this.disabled=!1,Lt(this.cropper,T)),this},disable:function(){return this.ready&&!this.disabled&&(this.disabled=!0,pt(this.cropper,T)),this},destroy:function(){var R=this.element;return R[C]?(R[C]=void 0,this.isImg&&this.replaced&&(R.src=this.originalUrl),this.uncreate(),this):this},move:function(R){var P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:R,N=this.canvasData,X=N.left,q=N.top;return this.moveTo(Wt(R)?R:X+Number(R),Wt(P)?P:q+Number(P))},moveTo:function(R){var P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:R,N=this.canvasData,X=!1;return R=Number(R),P=Number(P),this.ready&&!this.disabled&&this.options.movable&&(Me(R)&&(N.left=R,X=!0),Me(P)&&(N.top=P,X=!0),X&&this.renderCanvas(!0)),this},zoom:function(R,P){var N=this.canvasData;return R=Number(R),R<0?R=1/(1-R):R=1+R,this.zoomTo(N.width*R/N.naturalWidth,null,P)},zoomTo:function(R,P,N){var X=this.options,q=this.canvasData,K=q.width,se=q.height,ge=q.naturalWidth,me=q.naturalHeight;if(R=Number(R),R>=0&&this.ready&&!this.disabled&&X.zoomable){var he=ge*R,_e=me*R;if(wt(this.element,Xe,{ratio:R,oldRatio:K/ge,originalEvent:N})===!1)return this;if(N){var ke=this.pointers,je=Ee(this.cropper),Ve=ke&&Object.keys(ke).length?Ce(ke):{pageX:N.pageX,pageY:N.pageY};q.left-=(he-K)*((Ve.pageX-je.left-q.left)/K),q.top-=(_e-se)*((Ve.pageY-je.top-q.top)/se)}else Ge(P)&&Me(P.x)&&Me(P.y)?(q.left-=(he-K)*((P.x-q.left)/K),q.top-=(_e-se)*((P.y-q.top)/se)):(q.left-=(he-K)/2,q.top-=(_e-se)/2);q.width=he,q.height=_e,this.renderCanvas(!0)}return this},rotate:function(R){return this.rotateTo((this.imageData.rotate||0)+Number(R))},rotateTo:function(R){return R=Number(R),Me(R)&&this.ready&&!this.disabled&&this.options.rotatable&&(this.imageData.rotate=R%360,this.renderCanvas(!0,!0)),this},scaleX:function(R){var P=this.imageData.scaleY;return this.scale(R,Me(P)?P:1)},scaleY:function(R){var P=this.imageData.scaleX;return this.scale(Me(P)?P:1,R)},scale:function(R){var P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:R,N=this.imageData,X=!1;return R=Number(R),P=Number(P),this.ready&&!this.disabled&&this.options.scalable&&(Me(R)&&(N.scaleX=R,X=!0),Me(P)&&(N.scaleY=P,X=!0),X&&this.renderCanvas(!0,!0)),this},getData:function(){var R=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,P=this.options,N=this.imageData,X=this.canvasData,q=this.cropBoxData,K;if(this.ready&&this.cropped){K={x:q.left-X.left,y:q.top-X.top,width:q.width,height:q.height};var se=N.width/N.naturalWidth;if(dt(K,function(he,_e){K[_e]=he/se}),R){var ge=Math.round(K.y+K.height),me=Math.round(K.x+K.width);K.x=Math.round(K.x),K.y=Math.round(K.y),K.width=me-K.x,K.height=ge-K.y}}else K={x:0,y:0,width:0,height:0};return P.rotatable&&(K.rotate=N.rotate||0),P.scalable&&(K.scaleX=N.scaleX||1,K.scaleY=N.scaleY||1),K},setData:function(R){var P=this.options,N=this.imageData,X=this.canvasData,q={};if(this.ready&&!this.disabled&&Ge(R)){var K=!1;P.rotatable&&Me(R.rotate)&&R.rotate!==N.rotate&&(N.rotate=R.rotate,K=!0),P.scalable&&(Me(R.scaleX)&&R.scaleX!==N.scaleX&&(N.scaleX=R.scaleX,K=!0),Me(R.scaleY)&&R.scaleY!==N.scaleY&&(N.scaleY=R.scaleY,K=!0)),K&&this.renderCanvas(!0,!0);var se=N.width/N.naturalWidth;Me(R.x)&&(q.left=R.x*se+X.left),Me(R.y)&&(q.top=R.y*se+X.top),Me(R.width)&&(q.width=R.width*se),Me(R.height)&&(q.height=R.height*se),this.setCropBoxData(q)}return this},getContainerData:function(){return this.ready?De({},this.containerData):{}},getImageData:function(){return this.sized?De({},this.imageData):{}},getCanvasData:function(){var R=this.canvasData,P={};return this.ready&&dt(["left","top","width","height","naturalWidth","naturalHeight"],function(N){P[N]=R[N]}),P},setCanvasData:function(R){var P=this.canvasData,N=P.aspectRatio;return this.ready&&!this.disabled&&Ge(R)&&(Me(R.left)&&(P.left=R.left),Me(R.top)&&(P.top=R.top),Me(R.width)?(P.width=R.width,P.height=R.width/N):Me(R.height)&&(P.height=R.height,P.width=R.height*N),this.renderCanvas(!0)),this},getCropBoxData:function(){var R=this.cropBoxData,P;return this.ready&&this.cropped&&(P={left:R.left,top:R.top,width:R.width,height:R.height}),P||{}},setCropBoxData:function(R){var P=this.cropBoxData,N=this.options.aspectRatio,X,q;return this.ready&&this.cropped&&!this.disabled&&Ge(R)&&(Me(R.left)&&(P.left=R.left),Me(R.top)&&(P.top=R.top),Me(R.width)&&R.width!==P.width&&(X=!0,P.width=R.width),Me(R.height)&&R.height!==P.height&&(q=!0,P.height=R.height),N&&(X?P.height=P.width/N:q&&(P.width=P.height*N)),this.renderCropBox()),this},getCroppedCanvas:function(){var R=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!this.ready||!window.HTMLCanvasElement)return null;var P=this.canvasData,N=Ae(this.image,this.imageData,P,R);if(!this.cropped)return N;var X=this.getData(),q=X.x,K=X.y,se=X.width,ge=X.height,me=N.width/Math.floor(P.naturalWidth);me!==1&&(q*=me,K*=me,se*=me,ge*=me);var he=se/ge,_e=Se({aspectRatio:he,width:R.maxWidth||1/0,height:R.maxHeight||1/0}),ke=Se({aspectRatio:he,width:R.minWidth||0,height:R.minHeight||0},"cover"),je=Se({aspectRatio:he,width:R.width||(me!==1?N.width:se),height:R.height||(me!==1?N.height:ge)}),Ve=je.width,ft=je.height;Ve=Math.min(_e.width,Math.max(ke.width,Ve)),ft=Math.min(_e.height,Math.max(ke.height,ft));var st=document.createElement("canvas"),kt=st.getContext("2d");st.width=et(Ve),st.height=et(ft),kt.fillStyle=R.fillColor||"transparent",kt.fillRect(0,0,Ve,ft);var Ot=R.imageSmoothingEnabled,Ct=Ot===void 0?!0:Ot,or=R.imageSmoothingQuality;kt.imageSmoothingEnabled=Ct,or&&(kt.imageSmoothingQuality=or);var Dt=N.width,Oe=N.height,ct=q,Rt=K,Jt,_r,Cr,Sr,br,fr;ct<=-se||ct>Dt?(ct=0,Jt=0,Cr=0,br=0):ct<=0?(Cr=-ct,ct=0,Jt=Math.min(Dt,se+ct),br=Jt):ct<=Dt&&(Cr=0,Jt=Math.min(se,Dt-ct),br=Jt),Jt<=0||Rt<=-ge||Rt>Oe?(Rt=0,_r=0,Sr=0,fr=0):Rt<=0?(Sr=-Rt,Rt=0,_r=Math.min(Oe,ge+Rt),fr=_r):Rt<=Oe&&(Sr=0,_r=Math.min(ge,Oe-Rt),fr=_r);var qt=[ct,Rt,Jt,_r];if(br>0&&fr>0){var Tr=Ve/se;qt.push(Cr*Tr,Sr*Tr,br*Tr,fr*Tr)}return kt.drawImage.apply(kt,[N].concat(s(qt.map(function(Li){return Math.floor(et(Li))})))),st},setAspectRatio:function(R){var P=this.options;return!this.disabled&&!Wt(R)&&(P.aspectRatio=Math.max(0,R)||NaN,this.ready&&(this.initCropBox(),this.cropped&&this.renderCropBox())),this},setDragMode:function(R){var P=this.options,N=this.dragBox,X=this.face;if(this.ready&&!this.disabled){var q=R===W,K=P.movable&&R===Y;R=q||K?R:re,P.dragMode=R,Pt(N,te,R),Xt(N,B,q),Xt(N,H,K),P.cropBoxMovable||(Pt(X,te,R),Xt(X,B,q),Xt(X,H,K))}return this}},V=b.Cropper,oe=function(){function D(R){var P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(i(this,D),!R||!ve.test(R.tagName))throw new Error("The first argument is required and must be an <img> or <canvas> element.");this.element=R,this.options=De({},at,Ge(P)&&P),this.cropped=!1,this.disabled=!1,this.pointers={},this.ready=!1,this.reloading=!1,this.replaced=!1,this.sized=!1,this.sizing=!1,this.init()}return o(D,[{key:"init",value:function(){var P=this.element,N=P.tagName.toLowerCase(),X;if(!P[C]){if(P[C]=this,N==="img"){if(this.isImg=!0,X=P.getAttribute("src")||"",this.originalUrl=X,!X)return;X=P.src}else N==="canvas"&&window.HTMLCanvasElement&&(X=P.toDataURL());this.load(X)}}},{key:"load",value:function(P){var N=this;if(!!P){this.url=P,this.imageData={};var X=this.element,q=this.options;if(!q.rotatable&&!q.scalable&&(q.checkOrientation=!1),!q.checkOrientation||!window.ArrayBuffer){this.clone();return}if(ot.test(P)){ce.test(P)?this.read(rt(P)):this.clone();return}var K=new XMLHttpRequest,se=this.clone.bind(this);this.reloading=!0,this.xhr=K,K.onabort=se,K.onerror=se,K.ontimeout=se,K.onprogress=function(){K.getResponseHeader("content-type")!==Ke&&K.abort()},K.onload=function(){N.read(K.response)},K.onloadend=function(){N.reloading=!1,N.xhr=null},q.checkCrossOrigin&&z(P)&&X.crossOrigin&&(P=G(P)),K.open("GET",P,!0),K.responseType="arraybuffer",K.withCredentials=X.crossOrigin==="use-credentials",K.send()}}},{key:"read",value:function(P){var N=this.options,X=this.imageData,q=Je(P),K=0,se=1,ge=1;if(q>1){this.url=mt(P,Ke);var me=Ue(q);K=me.rotate,se=me.scaleX,ge=me.scaleY}N.rotatable&&(X.rotate=K),N.scalable&&(X.scaleX=se,X.scaleY=ge),this.clone()}},{key:"clone",value:function(){var P=this.element,N=this.url,X=P.crossOrigin,q=N;this.options.checkCrossOrigin&&z(N)&&(X||(X="anonymous"),q=G(N)),this.crossOrigin=X,this.crossOriginUrl=q;var K=document.createElement("img");X&&(K.crossOrigin=X),K.src=q||N,K.alt=P.alt||"The image to crop",this.image=K,K.onload=this.start.bind(this),K.onerror=this.stop.bind(this),pt(K,j),P.parentNode.insertBefore(K,P.nextSibling)}},{key:"start",value:function(){var P=this,N=this.image;N.onload=null,N.onerror=null,this.sizing=!0;var X=b.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(b.navigator.userAgent),q=function(me,he){De(P.imageData,{naturalWidth:me,naturalHeight:he,aspectRatio:me/he}),P.initialImageData=De({},P.imageData),P.sizing=!1,P.sized=!0,P.build()};if(N.naturalWidth&&!X){q(N.naturalWidth,N.naturalHeight);return}var K=document.createElement("img"),se=document.body||document.documentElement;this.sizingImage=K,K.onload=function(){q(K.width,K.height),X||se.removeChild(K)},K.src=N.src,X||(K.style.cssText="left:0;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;opacity:0;position:absolute;top:0;z-index:-1;",se.appendChild(K))}},{key:"stop",value:function(){var P=this.image;P.onload=null,P.onerror=null,P.parentNode.removeChild(P),this.image=null}},{key:"build",value:function(){if(!(!this.sized||this.ready)){var P=this.element,N=this.options,X=this.image,q=P.parentNode,K=document.createElement("div");K.innerHTML=vt;var se=K.querySelector(".".concat(C,"-container")),ge=se.querySelector(".".concat(C,"-canvas")),me=se.querySelector(".".concat(C,"-drag-box")),he=se.querySelector(".".concat(C,"-crop-box")),_e=he.querySelector(".".concat(C,"-face"));this.container=q,this.cropper=se,this.canvas=ge,this.dragBox=me,this.cropBox=he,this.viewBox=se.querySelector(".".concat(C,"-view-box")),this.face=_e,ge.appendChild(X),pt(P,M),q.insertBefore(se,P.nextSibling),this.isImg||Lt(X,j),this.initPreview(),this.bind(),N.initialAspectRatio=Math.max(0,N.initialAspectRatio)||NaN,N.aspectRatio=Math.max(0,N.aspectRatio)||NaN,N.viewMode=Math.max(0,Math.min(3,Math.round(N.viewMode)))||0,pt(he,M),N.guides||pt(he.getElementsByClassName("".concat(C,"-dashed")),M),N.center||pt(he.getElementsByClassName("".concat(C,"-center")),M),N.background&&pt(se,"".concat(C,"-bg")),N.highlight||pt(_e,J),N.cropBoxMovable&&(pt(_e,H),Pt(_e,te,O)),N.cropBoxResizable||(pt(he.getElementsByClassName("".concat(C,"-line")),M),pt(he.getElementsByClassName("".concat(C,"-point")),M)),this.render(),this.ready=!0,this.setDragMode(N.dragMode),N.autoCrop&&this.crop(),this.setData(N.data),Qe(N.ready)&&Et(P,Pe,N.ready,{once:!0}),wt(P,Pe)}}},{key:"unbuild",value:function(){!this.ready||(this.ready=!1,this.unbind(),this.resetPreview(),this.cropper.parentNode.removeChild(this.cropper),Lt(this.element,M))}},{key:"uncreate",value:function(){this.ready?(this.unbuild(),this.ready=!1,this.cropped=!1):this.sizing?(this.sizingImage.onload=null,this.sizing=!1,this.sized=!1):this.reloading?(this.xhr.onabort=null,this.xhr.abort()):this.image&&this.stop()}}],[{key:"noConflict",value:function(){return window.Cropper=V,D}},{key:"setDefaults",value:function(P){De(at,Ge(P)&&P)}}]),D}();return De(oe.prototype,At,$t,xt,St,F,ne),oe})});var Md=ye((exports,module)=>{frappe.provide("frappe.search");frappe.provide("frappe.tags");frappe.search.AwesomeBar=class{setup(r){var t=this;$(".search-bar").removeClass("hidden");var e=$(r),i=e.get(0);this.options=[],this.global_results=[];var n=new Awesomplete(i,{minChars:0,maxItems:99,autoFirst:!0,list:[],filter:function(a,s){return!0},data:function(a,s){return{label:a.index||"",value:a.value}},item:function(a,s){var l=this.get_item(a.value),u=__(l.label||l.value),c="<span>"+u+"</span>";return l.description&&l.value!==l.description&&(c+='<br><span class="text-muted ellipsis">'+__(l.description)+"</span>"),$("<li></li>").data("item.autocomplete",l).html(`<a style="font-weight:normal">${c}</a>`).get(0)},sort:function(a,s){return s.label-a.label}});i.awesomplete=n,this.awesomplete=n,e.on("input",frappe.utils.debounce(function(a){var s=a.target.value,l=s.trim().replace(/\s\s+/g," "),u=l.lastIndexOf(" ");t.global_results=[],t.options=[],l&&l.length>1?(u!==-1&&t.set_specifics(l.slice(0,u),l.slice(u+1)),t.add_defaults(l),t.options=t.options.concat(t.build_options(l)),t.options=t.options.concat(t.global_results)):(t.options=t.options.concat(t.deduplicate(frappe.search.utils.get_recent_pages(l||""))),t.options=t.options.concat(frappe.search.utils.get_frequent_links())),t.add_help(),n.list=t.deduplicate(t.options)},100));var o=function(){this.autocomplete_open||$(this).trigger("input")};e.on("focus",o),e.on("awesomplete-open",function(a){t.autocomplete_open=a.target}),e.on("awesomplete-close",function(a){t.autocomplete_open=!1}),e.on("awesomplete-select",function(a){var s=a.originalEvent,l=s.text.value,u=n.get_item(l);u.route_options&&(frappe.route_options=u.route_options),u.onclick?u.onclick(u.match):frappe.set_route(u.route),e.val(""),e.trigger("blur")}),e.on("awesomplete-selectcomplete",function(a){e.val("")}),e.on("keydown",a=>{a.key=="Escape"&&e.trigger("blur")}),frappe.search.utils.setup_recent(),frappe.tags.utils.fetch_tags()}add_help(){this.options.push({value:__("Help on Search"),index:-10,default:"Help",onclick:function(){var r='<table class="table table-bordered">					<tr><td style="width: 50%">'+__("Create a new record")+"</td><td>"+__("new type of document")+"</td></tr>					<tr><td>"+__("List a document type")+"</td><td>"+__("document type..., e.g. customer")+"</td></tr>					<tr><td>"+__("Search in a document type")+"</td><td>"+__("text in document type")+"</td></tr>					<tr><td>"+__("Tags")+"</td><td>"+__("tag name..., e.g. #tag")+"</td></tr>					<tr><td>"+__("Open a module or tool")+"</td><td>"+__("module name...")+"</td></tr>					<tr><td>"+__("Calculate")+"</td><td>"+__("e.g. (55 + 434) / 4 or =Math.sin(Math.PI/2)...")+"</td></tr>				</table>";frappe.msgprint(r,__("Search Help"))}})}set_specifics(r,t){var e=this,i=this.build_options(r);i.forEach(function(n){n.type&&n.type.toLowerCase().indexOf(t.toLowerCase())===0&&e.options.push(n)})}add_defaults(r){this.make_global_search(r),this.make_search_in_current(r),this.make_calculator(r),this.make_random(r)}build_options(r){var t=frappe.search.utils.get_creatables(r).concat(frappe.search.utils.get_search_in_list(r),frappe.search.utils.get_doctypes(r),frappe.search.utils.get_reports(r),frappe.search.utils.get_pages(r),frappe.search.utils.get_workspaces(r),frappe.search.utils.get_dashboards(r),frappe.search.utils.get_recent_pages(r||""),frappe.search.utils.get_executables(r));r.charAt(0)==="#"&&(t=frappe.tags.utils.get_tags(r));var e=this.deduplicate(t);return e.sort(function(i,n){return n.index-i.index})}deduplicate(r){var t=[],e=[];return r.forEach(function(i){if(i.route){i.route[0]==="List"&&i.route[2]!=="Report"&&i.route[2]!=="Inbox"&&i.route.splice(2);var n=typeof i.route=="string"?i.route:i.route.join("/");if(e.indexOf(n)===-1)t.push(i),e.push(n);else{var o=e.indexOf(n);t[o].index<i.index&&!i.recent&&(t[o]=i)}}else t.push(i),e.push("")}),t}set_global_results(r,t){this.global_results=this.global_results.concat(r)}make_global_search(r){r.charAt(0)!=="#"&&this.options.push({label:`
				<span class="flex justify-between text-medium">
					<span class="ellipsis">${__("Search for {0}",[frappe.utils.xss_sanitise(r).bold()])}</span>
					<kbd>\u21B5</kbd>
				</span>
			`,value:__("Search for {0}",[r]),match:r,index:100,default:"Search",onclick:function(){frappe.searchdialog.search.init_search(r,"global_search")}})}make_search_in_current(r){var t=frappe.get_route();if(t[0]==="List"&&r.indexOf(" in")===-1){var e=frappe.get_meta(frappe.container.page.list_view.doctype),i=e.title_field||"name",n={};n[i]=["like","%"+r+"%"],this.options.push({label:__("Find {0} in {1}",[r.bold(),__(t[1]).bold()]),value:__("Find {0} in {1}",[r,__(t[1])]),route_options:n,onclick:function(){cur_list.show()},index:90,default:"Current",match:r})}}make_calculator(txt){var first=txt.substr(0,1);if(first==parseInt(first)||first==="("||first==="="){first==="="&&(txt=txt.substr(1));try{var val=eval(txt),formatted_value=__("{0} = {1}",[txt,(val+"").bold()]);this.options.push({label:formatted_value,value:__("{0} = {1}",[txt,val]),match:val,index:80,default:"Calculator",onclick:function(){frappe.msgprint(formatted_value,__("Result"))}})}catch(r){}}}make_random(r){r.toLowerCase().includes("random")&&this.options.push({label:__("Generate Random Password"),value:frappe.utils.get_random(16),onclick:function(){frappe.msgprint(frappe.utils.get_random(16),__("Result"))}})}}});var Fd=ye((zd,Uo)=>{(function(r){if(typeof zd=="object"&&typeof Uo!="undefined")Uo.exports=r();else if(typeof define=="function"&&define.amd)define([],r);else{var t;typeof window!="undefined"?t=window:typeof global!="undefined"?t=global:typeof self!="undefined"?t=self:t=this,t.localforage=r()}})(function(){var r,t,e;return function i(n,o,a){function s(c,h){if(!o[c]){if(!n[c]){var p=typeof ti=="function"&&ti;if(!h&&p)return p(c,!0);if(l)return l(c,!0);var g=new Error("Cannot find module '"+c+"'");throw g.code="MODULE_NOT_FOUND",g}var b=o[c]={exports:{}};n[c][0].call(b.exports,function(v){var k=n[c][1][v];return s(k||v)},b,b.exports,i,n,o,a)}return o[c].exports}for(var l=typeof ti=="function"&&ti,u=0;u<a.length;u++)s(a[u]);return s}({1:[function(i,n,o){(function(a){"use strict";var s=a.MutationObserver||a.WebKitMutationObserver,l;if(s){var u=0,c=new s(v),h=a.document.createTextNode("");c.observe(h,{characterData:!0}),l=function(){h.data=u=++u%2}}else if(!a.setImmediate&&typeof a.MessageChannel!="undefined"){var p=new a.MessageChannel;p.port1.onmessage=v,l=function(){p.port2.postMessage(0)}}else"document"in a&&"onreadystatechange"in a.document.createElement("script")?l=function(){var C=a.document.createElement("script");C.onreadystatechange=function(){v(),C.onreadystatechange=null,C.parentNode.removeChild(C),C=null},a.document.documentElement.appendChild(C)}:l=function(){setTimeout(v,0)};var g,b=[];function v(){g=!0;for(var C,O,d=b.length;d;){for(O=b,b=[],C=-1;++C<d;)O[C]();d=b.length}g=!1}n.exports=k;function k(C){b.push(C)===1&&!g&&l()}}).call(this,typeof global!="undefined"?global:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],2:[function(i,n,o){"use strict";var a=i(1);function s(){}var l={},u=["REJECTED"],c=["FULFILLED"],h=["PENDING"];n.exports=p;function p(y){if(typeof y!="function")throw new TypeError("resolver must be a function");this.state=h,this.queue=[],this.outcome=void 0,y!==s&&k(this,y)}p.prototype.catch=function(y){return this.then(null,y)},p.prototype.then=function(y,x){if(typeof y!="function"&&this.state===c||typeof x!="function"&&this.state===u)return this;var S=new this.constructor(s);if(this.state!==h){var w=this.state===c?y:x;b(S,w,this.outcome)}else this.queue.push(new g(S,y,x));return S};function g(y,x,S){this.promise=y,typeof x=="function"&&(this.onFulfilled=x,this.callFulfilled=this.otherCallFulfilled),typeof S=="function"&&(this.onRejected=S,this.callRejected=this.otherCallRejected)}g.prototype.callFulfilled=function(y){l.resolve(this.promise,y)},g.prototype.otherCallFulfilled=function(y){b(this.promise,this.onFulfilled,y)},g.prototype.callRejected=function(y){l.reject(this.promise,y)},g.prototype.otherCallRejected=function(y){b(this.promise,this.onRejected,y)};function b(y,x,S){a(function(){var w;try{w=x(S)}catch(E){return l.reject(y,E)}w===y?l.reject(y,new TypeError("Cannot resolve promise with itself")):l.resolve(y,w)})}l.resolve=function(y,x){var S=C(v,x);if(S.status==="error")return l.reject(y,S.value);var w=S.value;if(w)k(y,w);else{y.state=c,y.outcome=x;for(var E=-1,L=y.queue.length;++E<L;)y.queue[E].callFulfilled(x)}return y},l.reject=function(y,x){y.state=u,y.outcome=x;for(var S=-1,w=y.queue.length;++S<w;)y.queue[S].callRejected(x);return y};function v(y){var x=y&&y.then;if(y&&(typeof y=="object"||typeof y=="function")&&typeof x=="function")return function(){x.apply(y,arguments)}}function k(y,x){var S=!1;function w(A){S||(S=!0,l.reject(y,A))}function E(A){S||(S=!0,l.resolve(y,A))}function L(){x(E,w)}var I=C(L);I.status==="error"&&w(I.value)}function C(y,x){var S={};try{S.value=y(x),S.status="success"}catch(w){S.status="error",S.value=w}return S}p.resolve=O;function O(y){return y instanceof this?y:l.resolve(new this(s),y)}p.reject=d;function d(y){var x=new this(s);return l.reject(x,y)}p.all=_;function _(y){var x=this;if(Object.prototype.toString.call(y)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=y.length,w=!1;if(!S)return this.resolve([]);for(var E=new Array(S),L=0,I=-1,A=new this(s);++I<S;)B(y[I],I);return A;function B(T,M){x.resolve(T).then(j,function(J){w||(w=!0,l.reject(A,J))});function j(J){E[M]=J,++L===S&&!w&&(w=!0,l.resolve(A,E))}}}p.race=m;function m(y){var x=this;if(Object.prototype.toString.call(y)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=y.length,w=!1;if(!S)return this.resolve([]);for(var E=-1,L=new this(s);++E<S;)I(y[E]);return L;function I(A){x.resolve(A).then(function(B){w||(w=!0,l.resolve(L,B))},function(B){w||(w=!0,l.reject(L,B))})}}},{"1":1}],3:[function(i,n,o){(function(a){"use strict";typeof a.Promise!="function"&&(a.Promise=i(2))}).call(this,typeof global!="undefined"?global:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"2":2}],4:[function(i,n,o){"use strict";var a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(F){return typeof F}:function(F){return F&&typeof Symbol=="function"&&F.constructor===Symbol&&F!==Symbol.prototype?"symbol":typeof F};function s(F,ne){if(!(F instanceof ne))throw new TypeError("Cannot call a class as a function")}function l(){try{if(typeof indexedDB!="undefined")return indexedDB;if(typeof webkitIndexedDB!="undefined")return webkitIndexedDB;if(typeof mozIndexedDB!="undefined")return mozIndexedDB;if(typeof OIndexedDB!="undefined")return OIndexedDB;if(typeof msIndexedDB!="undefined")return msIndexedDB}catch(F){return}}var u=l();function c(){try{if(!u||!u.open)return!1;var F=typeof openDatabase!="undefined"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),ne=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!F||ne)&&typeof indexedDB!="undefined"&&typeof IDBKeyRange!="undefined"}catch(V){return!1}}function h(F,ne){F=F||[],ne=ne||{};try{return new Blob(F,ne)}catch(R){if(R.name!=="TypeError")throw R;for(var V=typeof BlobBuilder!="undefined"?BlobBuilder:typeof MSBlobBuilder!="undefined"?MSBlobBuilder:typeof MozBlobBuilder!="undefined"?MozBlobBuilder:WebKitBlobBuilder,oe=new V,D=0;D<F.length;D+=1)oe.append(F[D]);return oe.getBlob(ne.type)}}typeof Promise=="undefined"&&i(3);var p=Promise;function g(F,ne){ne&&F.then(function(V){ne(null,V)},function(V){ne(V)})}function b(F,ne,V){typeof ne=="function"&&F.then(ne),typeof V=="function"&&F.catch(V)}function v(F){return typeof F!="string"&&(console.warn(F+" used as a key, but it is not a string."),F=String(F)),F}function k(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var C="local-forage-detect-blob-support",O=void 0,d={},_=Object.prototype.toString,m="readonly",y="readwrite";function x(F){for(var ne=F.length,V=new ArrayBuffer(ne),oe=new Uint8Array(V),D=0;D<ne;D++)oe[D]=F.charCodeAt(D);return V}function S(F){return new p(function(ne){var V=F.transaction(C,y),oe=h([""]);V.objectStore(C).put(oe,"key"),V.onabort=function(D){D.preventDefault(),D.stopPropagation(),ne(!1)},V.oncomplete=function(){var D=navigator.userAgent.match(/Chrome\/(\d+)/),R=navigator.userAgent.match(/Edge\//);ne(R||!D||parseInt(D[1],10)>=43)}}).catch(function(){return!1})}function w(F){return typeof O=="boolean"?p.resolve(O):S(F).then(function(ne){return O=ne,O})}function E(F){var ne=d[F.name],V={};V.promise=new p(function(oe,D){V.resolve=oe,V.reject=D}),ne.deferredOperations.push(V),ne.dbReady?ne.dbReady=ne.dbReady.then(function(){return V.promise}):ne.dbReady=V.promise}function L(F){var ne=d[F.name],V=ne.deferredOperations.pop();if(V)return V.resolve(),V.promise}function I(F,ne){var V=d[F.name],oe=V.deferredOperations.pop();if(oe)return oe.reject(ne),oe.promise}function A(F,ne){return new p(function(V,oe){if(d[F.name]=d[F.name]||W(),F.db)if(ne)E(F),F.db.close();else return V(F.db);var D=[F.name];ne&&D.push(F.version);var R=u.open.apply(u,D);ne&&(R.onupgradeneeded=function(P){var N=R.result;try{N.createObjectStore(F.storeName),P.oldVersion<=1&&N.createObjectStore(C)}catch(X){if(X.name==="ConstraintError")console.warn('The database "'+F.name+'" has been upgraded from version '+P.oldVersion+" to version "+P.newVersion+', but the storage "'+F.storeName+'" already exists.');else throw X}}),R.onerror=function(P){P.preventDefault(),oe(R.error)},R.onsuccess=function(){V(R.result),L(F)}})}function B(F){return A(F,!1)}function T(F){return A(F,!0)}function M(F,ne){if(!F.db)return!0;var V=!F.db.objectStoreNames.contains(F.storeName),oe=F.version<F.db.version,D=F.version>F.db.version;if(oe&&(F.version!==ne&&console.warn('The database "'+F.name+`" can't be downgraded from version `+F.db.version+" to version "+F.version+"."),F.version=F.db.version),D||V){if(V){var R=F.db.version+1;R>F.version&&(F.version=R)}return!0}return!1}function j(F){return new p(function(ne,V){var oe=new FileReader;oe.onerror=V,oe.onloadend=function(D){var R=btoa(D.target.result||"");ne({__local_forage_encoded_blob:!0,data:R,type:F.type})},oe.readAsBinaryString(F)})}function J(F){var ne=x(atob(F.data));return h([ne],{type:F.type})}function U(F){return F&&F.__local_forage_encoded_blob}function H(F){var ne=this,V=ne._initReady().then(function(){var oe=d[ne._dbInfo.name];if(oe&&oe.dbReady)return oe.dbReady});return b(V,F,F),V}function te(F){E(F);for(var ne=d[F.name],V=ne.forages,oe=0;oe<V.length;oe++){var D=V[oe];D._dbInfo.db&&(D._dbInfo.db.close(),D._dbInfo.db=null)}return F.db=null,B(F).then(function(R){return F.db=R,M(F)?T(F):R}).then(function(R){F.db=ne.db=R;for(var P=0;P<V.length;P++)V[P]._dbInfo.db=R}).catch(function(R){throw I(F,R),R})}function ae(F,ne,V,oe){oe===void 0&&(oe=1);try{var D=F.db.transaction(F.storeName,ne);V(null,D)}catch(R){if(oe>0&&(!F.db||R.name==="InvalidStateError"||R.name==="NotFoundError"))return p.resolve().then(function(){if(!F.db||R.name==="NotFoundError"&&!F.db.objectStoreNames.contains(F.storeName)&&F.version<=F.db.version)return F.db&&(F.version=F.db.version+1),T(F)}).then(function(){return te(F).then(function(){ae(F,ne,V,oe-1)})}).catch(V);V(R)}}function W(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function Y(F){var ne=this,V={db:null};if(F)for(var oe in F)V[oe]=F[oe];var D=d[V.name];D||(D=W(),d[V.name]=D),D.forages.push(ne),ne._initReady||(ne._initReady=ne.ready,ne.ready=H);var R=[];function P(){return p.resolve()}for(var N=0;N<D.forages.length;N++){var X=D.forages[N];X!==ne&&R.push(X._initReady().catch(P))}var q=D.forages.slice(0);return p.all(R).then(function(){return V.db=D.db,B(V)}).then(function(K){return V.db=K,M(V,ne._defaultConfig.version)?T(V):K}).then(function(K){V.db=D.db=K,ne._dbInfo=V;for(var se=0;se<q.length;se++){var ge=q[se];ge!==ne&&(ge._dbInfo.db=V.db,ge._dbInfo.version=V.version)}})}function re(F,ne){var V=this;F=v(F);var oe=new p(function(D,R){V.ready().then(function(){ae(V._dbInfo,m,function(P,N){if(P)return R(P);try{var X=N.objectStore(V._dbInfo.storeName),q=X.get(F);q.onsuccess=function(){var K=q.result;K===void 0&&(K=null),U(K)&&(K=J(K)),D(K)},q.onerror=function(){R(q.error)}}catch(K){R(K)}})}).catch(R)});return g(oe,ne),oe}function ie(F,ne){var V=this,oe=new p(function(D,R){V.ready().then(function(){ae(V._dbInfo,m,function(P,N){if(P)return R(P);try{var X=N.objectStore(V._dbInfo.storeName),q=X.openCursor(),K=1;q.onsuccess=function(){var se=q.result;if(se){var ge=se.value;U(ge)&&(ge=J(ge));var me=F(ge,se.key,K++);me!==void 0?D(me):se.continue()}else D()},q.onerror=function(){R(q.error)}}catch(se){R(se)}})}).catch(R)});return g(oe,ne),oe}function Q(F,ne,V){var oe=this;F=v(F);var D=new p(function(R,P){var N;oe.ready().then(function(){return N=oe._dbInfo,_.call(ne)==="[object Blob]"?w(N.db).then(function(X){return X?ne:j(ne)}):ne}).then(function(X){ae(oe._dbInfo,y,function(q,K){if(q)return P(q);try{var se=K.objectStore(oe._dbInfo.storeName);X===null&&(X=void 0);var ge=se.put(X,F);K.oncomplete=function(){X===void 0&&(X=null),R(X)},K.onabort=K.onerror=function(){var me=ge.error?ge.error:ge.transaction.error;P(me)}}catch(me){P(me)}})}).catch(P)});return g(D,V),D}function ee(F,ne){var V=this;F=v(F);var oe=new p(function(D,R){V.ready().then(function(){ae(V._dbInfo,y,function(P,N){if(P)return R(P);try{var X=N.objectStore(V._dbInfo.storeName),q=X.delete(F);N.oncomplete=function(){D()},N.onerror=function(){R(q.error)},N.onabort=function(){var K=q.error?q.error:q.transaction.error;R(K)}}catch(K){R(K)}})}).catch(R)});return g(oe,ne),oe}function pe(F){var ne=this,V=new p(function(oe,D){ne.ready().then(function(){ae(ne._dbInfo,y,function(R,P){if(R)return D(R);try{var N=P.objectStore(ne._dbInfo.storeName),X=N.clear();P.oncomplete=function(){oe()},P.onabort=P.onerror=function(){var q=X.error?X.error:X.transaction.error;D(q)}}catch(q){D(q)}})}).catch(D)});return g(V,F),V}function be(F){var ne=this,V=new p(function(oe,D){ne.ready().then(function(){ae(ne._dbInfo,m,function(R,P){if(R)return D(R);try{var N=P.objectStore(ne._dbInfo.storeName),X=N.count();X.onsuccess=function(){oe(X.result)},X.onerror=function(){D(X.error)}}catch(q){D(q)}})}).catch(D)});return g(V,F),V}function we(F,ne){var V=this,oe=new p(function(D,R){if(F<0){D(null);return}V.ready().then(function(){ae(V._dbInfo,m,function(P,N){if(P)return R(P);try{var X=N.objectStore(V._dbInfo.storeName),q=!1,K=X.openKeyCursor();K.onsuccess=function(){var se=K.result;if(!se){D(null);return}F===0||q?D(se.key):(q=!0,se.advance(F))},K.onerror=function(){R(K.error)}}catch(se){R(se)}})}).catch(R)});return g(oe,ne),oe}function Le(F){var ne=this,V=new p(function(oe,D){ne.ready().then(function(){ae(ne._dbInfo,m,function(R,P){if(R)return D(R);try{var N=P.objectStore(ne._dbInfo.storeName),X=N.openKeyCursor(),q=[];X.onsuccess=function(){var K=X.result;if(!K){oe(q);return}q.push(K.key),K.continue()},X.onerror=function(){D(X.error)}}catch(K){D(K)}})}).catch(D)});return g(V,F),V}function fe(F,ne){ne=k.apply(this,arguments);var V=this.config();F=typeof F!="function"&&F||{},F.name||(F.name=F.name||V.name,F.storeName=F.storeName||V.storeName);var oe=this,D;if(!F.name)D=p.reject("Invalid arguments");else{var R=F.name===V.name&&oe._dbInfo.db,P=R?p.resolve(oe._dbInfo.db):B(F).then(function(N){var X=d[F.name],q=X.forages;X.db=N;for(var K=0;K<q.length;K++)q[K]._dbInfo.db=N;return N});F.storeName?D=P.then(function(N){if(!!N.objectStoreNames.contains(F.storeName)){var X=N.version+1;E(F);var q=d[F.name],K=q.forages;N.close();for(var se=0;se<K.length;se++){var ge=K[se];ge._dbInfo.db=null,ge._dbInfo.version=X}var me=new p(function(he,_e){var ke=u.open(F.name,X);ke.onerror=function(je){var Ve=ke.result;Ve.close(),_e(je)},ke.onupgradeneeded=function(){var je=ke.result;je.deleteObjectStore(F.storeName)},ke.onsuccess=function(){var je=ke.result;je.close(),he(je)}});return me.then(function(he){q.db=he;for(var _e=0;_e<K.length;_e++){var ke=K[_e];ke._dbInfo.db=he,L(ke._dbInfo)}}).catch(function(he){throw(I(F,he)||p.resolve()).catch(function(){}),he})}}):D=P.then(function(N){E(F);var X=d[F.name],q=X.forages;N.close();for(var K=0;K<q.length;K++){var se=q[K];se._dbInfo.db=null}var ge=new p(function(me,he){var _e=u.deleteDatabase(F.name);_e.onerror=_e.onblocked=function(ke){var je=_e.result;je&&je.close(),he(ke)},_e.onsuccess=function(){var ke=_e.result;ke&&ke.close(),me(ke)}});return ge.then(function(me){X.db=me;for(var he=0;he<q.length;he++){var _e=q[he];L(_e._dbInfo)}}).catch(function(me){throw(I(F,me)||p.resolve()).catch(function(){}),me})})}return g(D,ne),D}var xe={_driver:"asyncStorage",_initStorage:Y,_support:c(),iterate:ie,getItem:re,setItem:Q,removeItem:ee,clear:pe,length:be,key:we,keys:Le,dropInstance:fe};function Ne(){return typeof openDatabase=="function"}var Be="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Pe="~~local_forage_type~",Ze=/^~~local_forage_type~([^~]+)~/,tt="__lfsc__:",Xe=tt.length,Ke="arbf",nt="blob",ot="si08",ce="ui08",ve="uic8",Ie="si16",He="si32",at="ur16",vt="ui32",bt="fl32",Me="fl64",yt=Xe+Ke.length,Wt=Object.prototype.toString;function Ft(F){var ne=F.length*.75,V=F.length,oe,D=0,R,P,N,X;F[F.length-1]==="="&&(ne--,F[F.length-2]==="="&&ne--);var q=new ArrayBuffer(ne),K=new Uint8Array(q);for(oe=0;oe<V;oe+=4)R=Be.indexOf(F[oe]),P=Be.indexOf(F[oe+1]),N=Be.indexOf(F[oe+2]),X=Be.indexOf(F[oe+3]),K[D++]=R<<2|P>>4,K[D++]=(P&15)<<4|N>>2,K[D++]=(N&3)<<6|X&63;return q}function Ye(F){var ne=new Uint8Array(F),V="",oe;for(oe=0;oe<ne.length;oe+=3)V+=Be[ne[oe]>>2],V+=Be[(ne[oe]&3)<<4|ne[oe+1]>>4],V+=Be[(ne[oe+1]&15)<<2|ne[oe+2]>>6],V+=Be[ne[oe+2]&63];return ne.length%3===2?V=V.substring(0,V.length-1)+"=":ne.length%3===1&&(V=V.substring(0,V.length-2)+"=="),V}function Ge(F,ne){var V="";if(F&&(V=Wt.call(F)),F&&(V==="[object ArrayBuffer]"||F.buffer&&Wt.call(F.buffer)==="[object ArrayBuffer]")){var oe,D=tt;F instanceof ArrayBuffer?(oe=F,D+=Ke):(oe=F.buffer,V==="[object Int8Array]"?D+=ot:V==="[object Uint8Array]"?D+=ce:V==="[object Uint8ClampedArray]"?D+=ve:V==="[object Int16Array]"?D+=Ie:V==="[object Uint16Array]"?D+=at:V==="[object Int32Array]"?D+=He:V==="[object Uint32Array]"?D+=vt:V==="[object Float32Array]"?D+=bt:V==="[object Float64Array]"?D+=Me:ne(new Error("Failed to get type for BinaryArray"))),ne(D+Ye(oe))}else if(V==="[object Blob]"){var R=new FileReader;R.onload=function(){var P=Pe+F.type+"~"+Ye(this.result);ne(tt+nt+P)},R.readAsArrayBuffer(F)}else try{ne(JSON.stringify(F))}catch(P){console.error("Couldn't convert value into a JSON string: ",F),ne(null,P)}}function Qe(F){if(F.substring(0,Xe)!==tt)return JSON.parse(F);var ne=F.substring(yt),V=F.substring(Xe,yt),oe;if(V===nt&&Ze.test(ne)){var D=ne.match(Ze);oe=D[1],ne=ne.substring(D[0].length)}var R=Ft(ne);switch(V){case Ke:return R;case nt:return h([R],{type:oe});case ot:return new Int8Array(R);case ce:return new Uint8Array(R);case ve:return new Uint8ClampedArray(R);case Ie:return new Int16Array(R);case at:return new Uint16Array(R);case He:return new Int32Array(R);case vt:return new Uint32Array(R);case bt:return new Float32Array(R);case Me:return new Float64Array(R);default:throw new Error("Unkown type: "+V)}}var qe={serialize:Ge,deserialize:Qe,stringToBuffer:Ft,bufferToString:Ye};function er(F,ne,V,oe){F.executeSql("CREATE TABLE IF NOT EXISTS "+ne.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],V,oe)}function dt(F){var ne=this,V={db:null};if(F)for(var oe in F)V[oe]=typeof F[oe]!="string"?F[oe].toString():F[oe];var D=new p(function(R,P){try{V.db=openDatabase(V.name,String(V.version),V.description,V.size)}catch(N){return P(N)}V.db.transaction(function(N){er(N,V,function(){ne._dbInfo=V,R()},function(X,q){P(q)})},P)});return V.serializer=qe,D}function De(F,ne,V,oe,D,R){F.executeSql(V,oe,D,function(P,N){N.code===N.SYNTAX_ERR?P.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[ne.storeName],function(X,q){q.rows.length?R(X,N):er(X,ne,function(){X.executeSql(V,oe,D,R)},R)},R):R(P,N)},R)}function tr(F,ne){var V=this;F=v(F);var oe=new p(function(D,R){V.ready().then(function(){var P=V._dbInfo;P.db.transaction(function(N){De(N,P,"SELECT * FROM "+P.storeName+" WHERE key = ? LIMIT 1",[F],function(X,q){var K=q.rows.length?q.rows.item(0).value:null;K&&(K=P.serializer.deserialize(K)),D(K)},function(X,q){R(q)})})}).catch(R)});return g(oe,ne),oe}function et(F,ne){var V=this,oe=new p(function(D,R){V.ready().then(function(){var P=V._dbInfo;P.db.transaction(function(N){De(N,P,"SELECT * FROM "+P.storeName,[],function(X,q){for(var K=q.rows,se=K.length,ge=0;ge<se;ge++){var me=K.item(ge),he=me.value;if(he&&(he=P.serializer.deserialize(he)),he=F(he,me.key,ge+1),he!==void 0){D(he);return}}D()},function(X,q){R(q)})})}).catch(R)});return g(oe,ne),oe}function rr(F,ne,V,oe){var D=this;F=v(F);var R=new p(function(P,N){D.ready().then(function(){ne===void 0&&(ne=null);var X=ne,q=D._dbInfo;q.serializer.serialize(ne,function(K,se){se?N(se):q.db.transaction(function(ge){De(ge,q,"INSERT OR REPLACE INTO "+q.storeName+" (key, value) VALUES (?, ?)",[F,K],function(){P(X)},function(me,he){N(he)})},function(ge){if(ge.code===ge.QUOTA_ERR){if(oe>0){P(rr.apply(D,[F,X,V,oe-1]));return}N(ge)}})})}).catch(N)});return g(R,V),R}function It(F,ne,V){return rr.apply(this,[F,ne,V,1])}function dr(F,ne){var V=this;F=v(F);var oe=new p(function(D,R){V.ready().then(function(){var P=V._dbInfo;P.db.transaction(function(N){De(N,P,"DELETE FROM "+P.storeName+" WHERE key = ?",[F],function(){D()},function(X,q){R(q)})})}).catch(R)});return g(oe,ne),oe}function pt(F){var ne=this,V=new p(function(oe,D){ne.ready().then(function(){var R=ne._dbInfo;R.db.transaction(function(P){De(P,R,"DELETE FROM "+R.storeName,[],function(){oe()},function(N,X){D(X)})})}).catch(D)});return g(V,F),V}function Lt(F){var ne=this,V=new p(function(oe,D){ne.ready().then(function(){var R=ne._dbInfo;R.db.transaction(function(P){De(P,R,"SELECT COUNT(key) as c FROM "+R.storeName,[],function(N,X){var q=X.rows.item(0).c;oe(q)},function(N,X){D(X)})})}).catch(D)});return g(V,F),V}function Xt(F,ne){var V=this,oe=new p(function(D,R){V.ready().then(function(){var P=V._dbInfo;P.db.transaction(function(N){De(N,P,"SELECT key FROM "+P.storeName+" WHERE id = ? LIMIT 1",[F+1],function(X,q){var K=q.rows.length?q.rows.item(0).key:null;D(K)},function(X,q){R(q)})})}).catch(R)});return g(oe,ne),oe}function xr(F){var ne=this,V=new p(function(oe,D){ne.ready().then(function(){var R=ne._dbInfo;R.db.transaction(function(P){De(P,R,"SELECT key FROM "+R.storeName,[],function(N,X){for(var q=[],K=0;K<X.rows.length;K++)q.push(X.rows.item(K).key);oe(q)},function(N,X){D(X)})})}).catch(D)});return g(V,F),V}function Nt(F){return new p(function(ne,V){F.transaction(function(oe){oe.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(D,R){for(var P=[],N=0;N<R.rows.length;N++)P.push(R.rows.item(N).name);ne({db:F,storeNames:P})},function(D,R){V(R)})},function(oe){V(oe)})})}function ir(F,ne){ne=k.apply(this,arguments);var V=this.config();F=typeof F!="function"&&F||{},F.name||(F.name=F.name||V.name,F.storeName=F.storeName||V.storeName);var oe=this,D;return F.name?D=new p(function(R){var P;F.name===V.name?P=oe._dbInfo.db:P=openDatabase(F.name,"","",0),F.storeName?R({db:P,storeNames:[F.storeName]}):R(Nt(P))}).then(function(R){return new p(function(P,N){R.db.transaction(function(X){function q(me){return new p(function(he,_e){X.executeSql("DROP TABLE IF EXISTS "+me,[],function(){he()},function(ke,je){_e(je)})})}for(var K=[],se=0,ge=R.storeNames.length;se<ge;se++)K.push(q(R.storeNames[se]));p.all(K).then(function(){P()}).catch(function(me){N(me)})},function(X){N(X)})})}):D=p.reject("Invalid arguments"),g(D,ne),D}var Pt={_driver:"webSQLStorage",_initStorage:dt,_support:Ne(),iterate:et,getItem:tr,setItem:It,removeItem:dr,clear:pt,length:Lt,key:Xt,keys:xr,dropInstance:ir};function hr(){try{return typeof localStorage!="undefined"&&"setItem"in localStorage&&!!localStorage.setItem}catch(F){return!1}}function Kt(F,ne){var V=F.name+"/";return F.storeName!==ne.storeName&&(V+=F.storeName+"/"),V}function nr(){var F="_localforage_support_test";try{return localStorage.setItem(F,!0),localStorage.removeItem(F),!1}catch(ne){return!0}}function Tt(){return!nr()||localStorage.length>0}function Et(F){var ne=this,V={};if(F)for(var oe in F)V[oe]=F[oe];return V.keyPrefix=Kt(F,ne._defaultConfig),Tt()?(ne._dbInfo=V,V.serializer=qe,p.resolve()):p.reject()}function wt(F){var ne=this,V=ne.ready().then(function(){for(var oe=ne._dbInfo.keyPrefix,D=localStorage.length-1;D>=0;D--){var R=localStorage.key(D);R.indexOf(oe)===0&&localStorage.removeItem(R)}});return g(V,F),V}function Ee(F,ne){var V=this;F=v(F);var oe=V.ready().then(function(){var D=V._dbInfo,R=localStorage.getItem(D.keyPrefix+F);return R&&(R=D.serializer.deserialize(R)),R});return g(oe,ne),oe}function Te(F,ne){var V=this,oe=V.ready().then(function(){for(var D=V._dbInfo,R=D.keyPrefix,P=R.length,N=localStorage.length,X=1,q=0;q<N;q++){var K=localStorage.key(q);if(K.indexOf(R)===0){var se=localStorage.getItem(K);if(se&&(se=D.serializer.deserialize(se)),se=F(se,K.substring(P),X++),se!==void 0)return se}}});return g(oe,ne),oe}function ze(F,ne){var V=this,oe=V.ready().then(function(){var D=V._dbInfo,R;try{R=localStorage.key(F)}catch(P){R=null}return R&&(R=R.substring(D.keyPrefix.length)),R});return g(oe,ne),oe}function z(F){var ne=this,V=ne.ready().then(function(){for(var oe=ne._dbInfo,D=localStorage.length,R=[],P=0;P<D;P++){var N=localStorage.key(P);N.indexOf(oe.keyPrefix)===0&&R.push(N.substring(oe.keyPrefix.length))}return R});return g(V,F),V}function G(F){var ne=this,V=ne.keys().then(function(oe){return oe.length});return g(V,F),V}function Z(F,ne){var V=this;F=v(F);var oe=V.ready().then(function(){var D=V._dbInfo;localStorage.removeItem(D.keyPrefix+F)});return g(oe,ne),oe}function de(F,ne,V){var oe=this;F=v(F);var D=oe.ready().then(function(){ne===void 0&&(ne=null);var R=ne;return new p(function(P,N){var X=oe._dbInfo;X.serializer.serialize(ne,function(q,K){if(K)N(K);else try{localStorage.setItem(X.keyPrefix+F,q),P(R)}catch(se){(se.name==="QuotaExceededError"||se.name==="NS_ERROR_DOM_QUOTA_REACHED")&&N(se),N(se)}})})});return g(D,V),D}function le(F,ne){if(ne=k.apply(this,arguments),F=typeof F!="function"&&F||{},!F.name){var V=this.config();F.name=F.name||V.name,F.storeName=F.storeName||V.storeName}var oe=this,D;return F.name?D=new p(function(R){F.storeName?R(Kt(F,oe._defaultConfig)):R(F.name+"/")}).then(function(R){for(var P=localStorage.length-1;P>=0;P--){var N=localStorage.key(P);N.indexOf(R)===0&&localStorage.removeItem(N)}}):D=p.reject("Invalid arguments"),g(D,ne),D}var Ce={_driver:"localStorageWrapper",_initStorage:Et,_support:hr(),iterate:Te,getItem:Ee,setItem:de,removeItem:Z,clear:wt,length:G,key:ze,keys:z,dropInstance:le},Se=function(ne,V){return ne===V||typeof ne=="number"&&typeof V=="number"&&isNaN(ne)&&isNaN(V)},Re=function(ne,V){for(var oe=ne.length,D=0;D<oe;){if(Se(ne[D],V))return!0;D++}return!1},Ae=Array.isArray||function(F){return Object.prototype.toString.call(F)==="[object Array]"},$e={},We={},Fe={INDEXEDDB:xe,WEBSQL:Pt,LOCALSTORAGE:Ce},rt=[Fe.INDEXEDDB._driver,Fe.WEBSQL._driver,Fe.LOCALSTORAGE._driver],mt=["dropInstance"],Je=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(mt),Ue={description:"",driver:rt.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function At(F,ne){F[ne]=function(){var V=arguments;return F.ready().then(function(){return F[ne].apply(F,V)})}}function $t(){for(var F=1;F<arguments.length;F++){var ne=arguments[F];if(ne)for(var V in ne)ne.hasOwnProperty(V)&&(Ae(ne[V])?arguments[0][V]=ne[V].slice():arguments[0][V]=ne[V])}return arguments[0]}var xt=function(){function F(ne){s(this,F);for(var V in Fe)if(Fe.hasOwnProperty(V)){var oe=Fe[V],D=oe._driver;this[V]=D,$e[D]||this.defineDriver(oe)}this._defaultConfig=$t({},Ue),this._config=$t({},this._defaultConfig,ne),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return F.prototype.config=function(V){if((typeof V=="undefined"?"undefined":a(V))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var oe in V){if(oe==="storeName"&&(V[oe]=V[oe].replace(/\W/g,"_")),oe==="version"&&typeof V[oe]!="number")return new Error("Database version must be a number.");this._config[oe]=V[oe]}return"driver"in V&&V.driver?this.setDriver(this._config.driver):!0}else return typeof V=="string"?this._config[V]:this._config},F.prototype.defineDriver=function(V,oe,D){var R=new p(function(P,N){try{var X=V._driver,q=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!V._driver){N(q);return}for(var K=Je.concat("_initStorage"),se=0,ge=K.length;se<ge;se++){var me=K[se],he=!Re(mt,me);if((he||V[me])&&typeof V[me]!="function"){N(q);return}}var _e=function(){for(var Ve=function(Ct){return function(){var or=new Error("Method "+Ct+" is not implemented by the current driver"),Dt=p.reject(or);return g(Dt,arguments[arguments.length-1]),Dt}},ft=0,st=mt.length;ft<st;ft++){var kt=mt[ft];V[kt]||(V[kt]=Ve(kt))}};_e();var ke=function(Ve){$e[X]&&console.info("Redefining LocalForage driver: "+X),$e[X]=V,We[X]=Ve,P()};"_support"in V?V._support&&typeof V._support=="function"?V._support().then(ke,N):ke(!!V._support):ke(!0)}catch(je){N(je)}});return b(R,oe,D),R},F.prototype.driver=function(){return this._driver||null},F.prototype.getDriver=function(V,oe,D){var R=$e[V]?p.resolve($e[V]):p.reject(new Error("Driver not found."));return b(R,oe,D),R},F.prototype.getSerializer=function(V){var oe=p.resolve(qe);return b(oe,V),oe},F.prototype.ready=function(V){var oe=this,D=oe._driverSet.then(function(){return oe._ready===null&&(oe._ready=oe._initDriver()),oe._ready});return b(D,V,V),D},F.prototype.setDriver=function(V,oe,D){var R=this;Ae(V)||(V=[V]);var P=this._getSupportedDrivers(V);function N(){R._config.driver=R.driver()}function X(se){return R._extend(se),N(),R._ready=R._initStorage(R._config),R._ready}function q(se){return function(){var ge=0;function me(){for(;ge<se.length;){var he=se[ge];return ge++,R._dbInfo=null,R._ready=null,R.getDriver(he).then(X).catch(me)}N();var _e=new Error("No available storage method found.");return R._driverSet=p.reject(_e),R._driverSet}return me()}}var K=this._driverSet!==null?this._driverSet.catch(function(){return p.resolve()}):p.resolve();return this._driverSet=K.then(function(){var se=P[0];return R._dbInfo=null,R._ready=null,R.getDriver(se).then(function(ge){R._driver=ge._driver,N(),R._wrapLibraryMethodsWithReady(),R._initDriver=q(P)})}).catch(function(){N();var se=new Error("No available storage method found.");return R._driverSet=p.reject(se),R._driverSet}),b(this._driverSet,oe,D),this._driverSet},F.prototype.supports=function(V){return!!We[V]},F.prototype._extend=function(V){$t(this,V)},F.prototype._getSupportedDrivers=function(V){for(var oe=[],D=0,R=V.length;D<R;D++){var P=V[D];this.supports(P)&&oe.push(P)}return oe},F.prototype._wrapLibraryMethodsWithReady=function(){for(var V=0,oe=Je.length;V<oe;V++)At(this,Je[V])},F.prototype.createInstance=function(V){return new F(V)},F}(),St=new xt;n.exports=St},{"3":3}]},{},[4])(4)})});var qd=ye((fn,Wo)=>{(function(r,t){typeof fn=="object"&&typeof Wo=="object"?Wo.exports=t():typeof define=="function"&&define.amd?define([],t):typeof fn=="object"?fn.EditorJS=t():r.EditorJS=t()})(window,function(){return function(r){var t={};function e(i){if(t[i])return t[i].exports;var n=t[i]={i,l:!1,exports:{}};return r[i].call(n.exports,n,n.exports,e),n.l=!0,n.exports}return e.m=r,e.c=t,e.d=function(i,n,o){e.o(i,n)||Object.defineProperty(i,n,{enumerable:!0,get:o})},e.r=function(i){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i,"__esModule",{value:!0})},e.t=function(i,n){if(1&n&&(i=e(i)),8&n||4&n&&typeof i=="object"&&i&&i.__esModule)return i;var o=Object.create(null);if(e.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:i}),2&n&&typeof i!="string")for(var a in i)e.d(o,a,function(s){return i[s]}.bind(null,a));return o},e.n=function(i){var n=i&&i.__esModule?function(){return i.default}:function(){return i};return e.d(n,"a",n),n},e.o=function(i,n){return Object.prototype.hasOwnProperty.call(i,n)},e.p="",e(e.s=183)}([function(r,t,e){var i=e(10),n=e(17),o=e(27),a=e(23),s=e(31),l=function(u,c,h){var p,g,b,v,k=u&l.F,C=u&l.G,O=u&l.S,d=u&l.P,_=u&l.B,m=C?i:O?i[c]||(i[c]={}):(i[c]||{}).prototype,y=C?n:n[c]||(n[c]={}),x=y.prototype||(y.prototype={});for(p in C&&(h=c),h)b=((g=!k&&m&&m[p]!==void 0)?m:h)[p],v=_&&g?s(b,i):d&&typeof b=="function"?s(Function.call,b):b,m&&a(m,p,b,u&l.U),y[p]!=b&&o(y,p,v),d&&x[p]!=b&&(x[p]=b)};i.core=n,l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,r.exports=l},function(r,t){r.exports=function(e){return e&&e.__esModule?e:{default:e}}},function(r,t){r.exports=function(e,i){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}},function(r,t){function e(i,n){for(var o=0;o<n.length;o++){var a=n[o];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(i,a.key,a)}}r.exports=function(i,n,o){return n&&e(i.prototype,n),o&&e(i,o),i}},function(r,t){function e(i){return r.exports=e=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},e(i)}r.exports=e},function(r,t,e){var i=e(107);r.exports=function(n,o){if(typeof o!="function"&&o!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(o&&o.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),o&&i(n,o)}},function(r,t,e){var i=e(143),n=e(368);r.exports=function(o,a){return!a||i(a)!=="object"&&typeof a!="function"?n(o):a}},function(r,t,e){var i,n,o;n=[t,e(2),e(3),e(374)],(o=typeof(i=function(a,s,l,u){"use strict";var c=e(1);function h(b){if(typeof Symbol=="undefined"||b[Symbol.iterator]==null){if(Array.isArray(b)||(b=function(m,y){if(m){if(typeof m=="string")return p(m,y);var x=Object.prototype.toString.call(m).slice(8,-1);return x==="Object"&&m.constructor&&(x=m.constructor.name),x==="Map"||x==="Set"?Array.from(x):x==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(x)?p(m,y):void 0}}(b))){var v=0,k=function(){};return{s:k,n:function(){return v>=b.length?{done:!0}:{done:!1,value:b[v++]}},e:function(m){throw m},f:k}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var C,O,d=!0,_=!1;return{s:function(){C=b[Symbol.iterator]()},n:function(){var m=C.next();return d=m.done,m},e:function(m){_=!0,O=m},f:function(){try{d||C.return==null||C.return()}finally{if(_)throw O}}}}function p(b,v){(v==null||v>b.length)&&(v=b.length);for(var k=0,C=new Array(v);k<v;k++)C[k]=b[k];return C}Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,s=c(s),l=c(l),u=c(u);var g=function(){function b(v){var k=this,C=v.config,O=v.eventsDispatcher;if((0,s.default)(this,b),this.nodes={},this.listeners=new u.default,this.readOnlyMutableListeners={on:function(d,_,m){var y=arguments.length>3&&arguments[3]!==void 0&&arguments[3];k.mutableListenerIds.push(k.listeners.on(d,_,m,y))},clearAll:function(){var d,_=h(k.mutableListenerIds);try{for(_.s();!(d=_.n()).done;){var m=d.value;k.listeners.offById(m)}}catch(y){_.e(y)}finally{_.f()}k.mutableListenerIds=[]}},this.mutableListenerIds=[],(this instanceof b?this.constructor:void 0)===b)throw new TypeError("Constructors for abstract class Module are not allowed.");this.config=C,this.eventsDispatcher=O}return(0,l.default)(b,[{key:"removeAllNodes",value:function(){for(var v in this.nodes){var k=this.nodes[v];k instanceof HTMLElement&&k.remove()}}},{key:"state",set:function(v){this.Editor=v}},{key:"isRtl",get:function(){return this.config.i18n.direction==="rtl"}}]),b}();a.default=g,g.displayName="Module",r.exports=t.default})=="function"?i.apply(t,n):i)===void 0||(r.exports=o)},function(r,t,e){var i,n,o;n=[t,e(21),e(367),e(22),e(15)],(o=typeof(i=function(a,s,l,u,c){"use strict";var h,p=e(1);function g(x,S){var w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"log",E=arguments.length>3?arguments[3]:void 0,L=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"color: inherit";if("console"in window&&window.console[w]){var I=["info","log","warn","error"].includes(w),A=[];switch(g.logLevel){case h.ERROR:if(w!=="error")return;break;case h.WARN:if(!["error","warn"].includes(w))return;break;case h.INFO:if(!I||x)return}E&&A.push(E);var B="Editor.js ".concat("2.20.0"),T=`line-height: 1em;
            color: #006FEA;
            display: inline-block;
            font-size: 11px;
            line-height: 1em;
            background-color: #fff;
            padding: 4px 9px;
            border-radius: 30px;
            border: 1px solid rgba(56, 138, 229, 0.16);
            margin: 4px 5px 4px 0;`;x&&(I?(A.unshift(T,L),S="%c".concat(B,"%c ").concat(S)):S="( ".concat(B," )").concat(S));try{if(I)if(E){var M;(M=console)[w].apply(M,["".concat(S," %o")].concat(A))}else{var j;(j=console)[w].apply(j,[S].concat(A))}else console[w](S)}catch(J){}}}Object.defineProperty(a,"__esModule",{value:!0}),a.setLogLevel=function(x){g.logLevel=x},a.typeOf=k,a.isFunction=C,a.isObject=O,a.isString=function(x){return k(x)==="string"},a.isBoolean=function(x){return k(x)==="boolean"},a.isNumber=function(x){return k(x)==="number"},a.isUndefined=d,a.isClass=function(x){return C(x)&&/^\s*class\s+/.test(x.toString())},a.isEmpty=function(x){return!x||Object.keys(x).length===0&&x.constructor===Object},a.isPromise=function(x){return Promise.resolve(x)===x},a.isPrintableKey=function(x){return x>47&&x<58||x===32||x===13||x===229||x>64&&x<91||x>95&&x<112||x>185&&x<193||x>218&&x<223},a.sequence=function(x){return _.apply(this,arguments)},a.array=function(x){return Array.prototype.slice.call(x)},a.delay=function(x,S){return function(){var w=this,E=arguments;window.setTimeout(function(){return x.apply(w,E)},S)}},a.getFileExtension=function(x){return x.name.split(".").pop()},a.isValidMimeType=function(x){return/^[-\w]+\/([-+\w]+|\*)$/.test(x)},a.debounce=function(x,S,w){var E,L=arguments,I=this;return function(){var A=I,B=L,T=w&&!E;window.clearTimeout(E),E=window.setTimeout(function(){E=null,w||x.apply(A,B)},S),T&&x.apply(A,B)}},a.copyTextToClipboard=function(x){var S=c.default.make("div","codex-editor-clipboard",{innerHTML:x});document.body.appendChild(S);var w=window.getSelection(),E=document.createRange();E.selectNode(S),window.getSelection().removeAllRanges(),w.addRange(E),document.execCommand("copy"),document.body.removeChild(S)},a.getUserOS=m,a.capitalize=function(x){return x[0].toUpperCase()+x.slice(1)},a.deepMerge=function x(S){for(var w=arguments.length,E=new Array(w>1?w-1:0),L=1;L<w;L++)E[L-1]=arguments[L];if(!E.length)return S;var I=E.shift();if(O(S)&&O(I))for(var A in I)O(I[A])?(S[A]||Object.assign(S,(0,l.default)({},A,{})),x(S[A],I[A])):Object.assign(S,(0,l.default)({},A,I[A]));return x.apply(void 0,[S].concat(E))},a.beautifyShortcut=function(x){var S=m();return x=x.replace(/shift/gi,"\u21E7").replace(/backspace/gi,"\u232B").replace(/enter/gi,"\u23CE").replace(/up/gi,"\u2191").replace(/left/gi,"\u2192").replace(/down/gi,"\u2193").replace(/right/gi,"\u2190").replace(/escape/gi,"\u238B").replace(/insert/gi,"Ins").replace(/delete/gi,"\u2421").replace(/\+/gi," + "),x=S.mac?x.replace(/ctrl|cmd/gi,"\u2318").replace(/alt/gi,"\u2325"):x.replace(/cmd/gi,"Ctrl").replace(/windows/gi,"WIN")},a.getValidUrl=function(x){try{return new URL(x).href}catch(S){}return x.substring(0,2)==="//"?window.location.protocol+x:window.location.origin+x},a.openTab=function(x){window.open(x,"_blank")},a.generateId=function(){var x=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return"".concat(x).concat(Math.floor(1e8*Math.random()).toString(16))},a.deprecationAssert=function(x,S,w){var E="\xAB".concat(S,"\xBB is deprecated and will be removed in the next major release. Please use the \xAB").concat(w,"\xBB instead.");x&&v(E,"warn")},a.isTouchSupported=a.logLabeled=a.log=a.mouseButtons=a.keyCodes=a.LogLevels=void 0,s=p(s),l=p(l),u=p(u),c=p(c),a.LogLevels=h,function(x){x.VERBOSE="VERBOSE",x.INFO="INFO",x.WARN="WARN",x.ERROR="ERROR"}(h||(a.LogLevels=h={})),a.keyCodes={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESC:27,SPACE:32,LEFT:37,UP:38,DOWN:40,RIGHT:39,DELETE:46,META:91},a.mouseButtons={LEFT:0,WHEEL:1,RIGHT:2,BACKWARD:3,FORWARD:4},g.logLevel=h.VERBOSE;var b=g.bind(window,!1);a.log=b;var v=g.bind(window,!0);function k(x){return Object.prototype.toString.call(x).match(/\s([a-zA-Z]+)/)[1].toLowerCase()}function C(x){return k(x)==="function"}function O(x){return k(x)==="object"}function d(x){return k(x)==="undefined"}function _(){return(_=(0,u.default)(s.default.mark(function x(S){var w,E,L,I,A=arguments;return s.default.wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return I=function(){return(I=(0,u.default)(s.default.mark(function T(M,j,J){return s.default.wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return U.prev=0,U.next=3,M.function(M.data);case 3:return U.next=5,j(d(M.data)?{}:M.data);case 5:U.next=10;break;case 7:U.prev=7,U.t0=U.catch(0),J(d(M.data)?{}:M.data);case 10:case"end":return U.stop()}},T,null,[[0,7]])}))).apply(this,arguments)},L=function(T,M,j){return I.apply(this,arguments)},w=A.length>1&&A[1]!==void 0?A[1]:function(){},E=A.length>2&&A[2]!==void 0?A[2]:function(){},B.abrupt("return",S.reduce(function(){var T=(0,u.default)(s.default.mark(function M(j,J){return s.default.wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return U.next=2,j;case 2:return U.abrupt("return",L(J,w,E));case 3:case"end":return U.stop()}},M)}));return function(M,j){return T.apply(this,arguments)}}(),Promise.resolve()));case 5:case"end":return B.stop()}},x)}))).apply(this,arguments)}function m(){var x={win:!1,mac:!1,x11:!1,linux:!1},S=Object.keys(x).find(function(w){return navigator.appVersion.toLowerCase().indexOf(w)!==-1});return S&&(x[S]=!0),x}a.logLabeled=v;var y="ontouchstart"in document.documentElement;a.isTouchSupported=y})=="function"?i.apply(t,n):i)===void 0||(r.exports=o)},function(r,t,e){var i=e(143);function n(){if(typeof WeakMap!="function")return null;var o=new WeakMap;return n=function(){return o},o}r.exports=function(o){if(o&&o.__esModule)return o;if(o===null||i(o)!=="object"&&typeof o!="function")return{default:o};var a=n();if(a&&a.has(o))return a.get(o);var s={},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in o)if(Object.prototype.hasOwnProperty.call(o,u)){var c=l?Object.getOwnPropertyDescriptor(o,u):null;c&&(c.get||c.set)?Object.defineProperty(s,u,c):s[u]=o[u]}return s.default=o,a&&a.set(o,s),s}},function(r,t){var e=r.exports=typeof window!="undefined"&&window.Math==Math?window:typeof self!="undefined"&&self.Math==Math?self:Function("return this")();typeof __g=="number"&&(__g=e)},function(r,t){r.exports=function(e){try{return!!e()}catch(i){return!0}}},function(r,t,e){var i=e(13);r.exports=function(n){if(!i(n))throw TypeError(n+" is not an object!");return n}},function(r,t){r.exports=function(e){return typeof e=="object"?e!==null:typeof e=="function"}},function(r,t,e){var i=e(67)("wks"),n=e(44),o=e(10).Symbol,a=typeof o=="function";(r.exports=function(s){return i[s]||(i[s]=a&&o[s]||(a?o:n)("Symbol."+s))}).store=i},function(r,t,e){var i,n,o;n=[t,e(42),e(2),e(3),e(8)],(o=typeof(i=function(a,s,l,u,c){"use strict";var h=e(9),p=e(1);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,s=p(s),l=p(l),u=p(u),c=h(c);var g=function(){function b(){(0,l.default)(this,b)}return(0,u.default)(b,null,[{key:"isSingleTag",value:function(v){return v.tagName&&["AREA","BASE","BR","COL","COMMAND","EMBED","HR","IMG","INPUT","KEYGEN","LINK","META","PARAM","SOURCE","TRACK","WBR"].includes(v.tagName)}},{key:"isLineBreakTag",value:function(v){return v&&v.tagName&&["BR","WBR"].includes(v.tagName)}},{key:"make",value:function(v){var k,C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,O=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},d=document.createElement(v);for(var _ in Array.isArray(C)?(k=d.classList).add.apply(k,(0,s.default)(C)):C&&d.classList.add(C),O)Object.prototype.hasOwnProperty.call(O,_)&&(d[_]=O[_]);return d}},{key:"text",value:function(v){return document.createTextNode(v)}},{key:"svg",value:function(v){var k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:14,C=arguments.length>2&&arguments[2]!==void 0?arguments[2]:14,O=document.createElementNS("http://www.w3.org/2000/svg","svg");return O.classList.add("icon","icon--"+v),O.setAttribute("width",k+"px"),O.setAttribute("height",C+"px"),O.innerHTML='<use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#'.concat(v,'"></use>'),O}},{key:"append",value:function(v,k){Array.isArray(k)?k.forEach(function(C){return v.appendChild(C)}):v.appendChild(k)}},{key:"prepend",value:function(v,k){Array.isArray(k)?(k=k.reverse()).forEach(function(C){return v.prepend(C)}):v.prepend(k)}},{key:"swap",value:function(v,k){var C=document.createElement("div"),O=v.parentNode;O.insertBefore(C,v),O.insertBefore(v,k),O.insertBefore(k,C),O.removeChild(C)}},{key:"find",value:function(){var v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,k=arguments.length>1?arguments[1]:void 0;return v.querySelector(k)}},{key:"get",value:function(v){return document.getElementById(v)}},{key:"findAll",value:function(){var v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,k=arguments.length>1?arguments[1]:void 0;return v.querySelectorAll(k)}},{key:"findAllInputs",value:function(v){return c.array(v.querySelectorAll(b.allInputsSelector)).reduce(function(k,C){return b.isNativeInput(C)||b.containsOnlyInlineElements(C)?[].concat((0,s.default)(k),[C]):[].concat((0,s.default)(k),(0,s.default)(b.getDeepestBlockElements(C)))},[])}},{key:"getDeepestNode",value:function(v){var k=arguments.length>1&&arguments[1]!==void 0&&arguments[1],C=k?"lastChild":"firstChild",O=k?"previousSibling":"nextSibling";if(v&&v.nodeType===Node.ELEMENT_NODE&&v[C]){var d=v[C];if(b.isSingleTag(d)&&!b.isNativeInput(d)&&!b.isLineBreakTag(d))if(d[O])d=d[O];else{if(!d.parentNode[O])return d.parentNode;d=d.parentNode[O]}return this.getDeepestNode(d,k)}return v}},{key:"isElement",value:function(v){return!c.isNumber(v)&&v&&v.nodeType&&v.nodeType===Node.ELEMENT_NODE}},{key:"isFragment",value:function(v){return!c.isNumber(v)&&v&&v.nodeType&&v.nodeType===Node.DOCUMENT_FRAGMENT_NODE}},{key:"isContentEditable",value:function(v){return v.contentEditable==="true"}},{key:"isNativeInput",value:function(v){return!(!v||!v.tagName)&&["INPUT","TEXTAREA"].includes(v.tagName)}},{key:"canSetCaret",value:function(v){var k=!0;if(b.isNativeInput(v))switch(v.type){case"file":case"checkbox":case"radio":case"hidden":case"submit":case"button":case"image":case"reset":k=!1}else k=b.isContentEditable(v);return k}},{key:"isNodeEmpty",value:function(v){return!(this.isSingleTag(v)&&!this.isLineBreakTag(v))&&(this.isElement(v)&&this.isNativeInput(v)?v.value:v.textContent.replace("\u200B","")).trim().length===0}},{key:"isLeaf",value:function(v){return!!v&&v.childNodes.length===0}},{key:"isEmpty",value:function(v){v.normalize();for(var k=[v];k.length>0;)if(v=k.shift()){if(this.isLeaf(v)&&!this.isNodeEmpty(v))return!1;v.childNodes&&k.push.apply(k,(0,s.default)(Array.from(v.childNodes)))}return!0}},{key:"isHTMLString",value:function(v){var k=b.make("div");return k.innerHTML=v,k.childElementCount>0}},{key:"getContentLength",value:function(v){return b.isNativeInput(v)?v.value.length:v.nodeType===Node.TEXT_NODE?v.length:v.textContent.length}},{key:"containsOnlyInlineElements",value:function(v){var k;return c.isString(v)?(k=document.createElement("div")).innerHTML=v:k=v,Array.from(k.children).every(function C(O){return!b.blockElements.includes(O.tagName.toLowerCase())&&Array.from(O.children).every(C)})}},{key:"getDeepestBlockElements",value:function(v){return b.containsOnlyInlineElements(v)?[v]:Array.from(v.children).reduce(function(k,C){return[].concat((0,s.default)(k),(0,s.default)(b.getDeepestBlockElements(C)))},[])}},{key:"getHolder",value:function(v){return c.isString(v)?document.getElementById(v):v}},{key:"isExtensionNode",value:function(v){return v&&["GRAMMARLY-EXTENSION"].includes(v.nodeName)}},{key:"isAnchor",value:function(v){return v.tagName.toLowerCase()==="a"}},{key:"allInputsSelector",get:function(){return"[contenteditable], textarea, input:not([type]), "+["text","password","email","number","search","tel","url"].map(function(v){return'input[type="'.concat(v,'"]')}).join(", ")}},{key:"blockElements",get:function(){return["address","article","aside","blockquote","canvas","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","li","main","nav","noscript","ol","output","p","pre","ruby","section","table","tr","tfoot","ul","video"]}}]),b}();a.default=g,g.displayName="Dom",r.exports=t.default})=="function"?i.apply(t,n):i)===void 0||(r.exports=o)},function(r,t,e){var i=e(33),n=Math.min;r.exports=function(o){return o>0?n(i(o),9007199254740991):0}},function(r,t){var e=r.exports={version:"2.6.11"};typeof __e=="number"&&(__e=e)},function(r,t,e){r.exports=!e(11)(function(){return Object.defineProperty({},"a",{get:function(){return 7}}).a!=7})},function(r,t,e){var i=e(12),n=e(109),o=e(40),a=Object.defineProperty;t.f=e(18)?Object.defineProperty:function(s,l,u){if(i(s),l=o(l,!0),i(u),n)try{return a(s,l,u)}catch(c){}if("get"in u||"set"in u)throw TypeError("Accessors not supported!");return"value"in u&&(s[l]=u.value),s}},function(r,t,e){var i=e(38);r.exports=function(n){return Object(i(n))}},function(r,t,e){r.exports=e(140)},function(r,t){function e(i,n,o,a,s,l,u){try{var c=i[l](u),h=c.value}catch(p){return void o(p)}c.done?n(h):Promise.resolve(h).then(a,s)}r.exports=function(i){return function(){var n=this,o=arguments;return new Promise(function(a,s){var l=i.apply(n,o);function u(h){e(l,a,s,u,c,"next",h)}function c(h){e(l,a,s,u,c,"throw",h)}u(void 0)})}}},function(r,t,e){var i=e(10),n=e(27),o=e(26),a=e(44)("src"),s=e(188),l=(""+s).split("toString");e(17).inspectSource=function(u){return s.call(u)},(r.exports=function(u,c,h,p){var g=typeof h=="function";g&&(o(h,"name")||n(h,"name",c)),u[c]!==h&&(g&&(o(h,a)||n(h,a,u[c]?""+u[c]:l.join(String(c)))),u===i?u[c]=h:p?u[c]?u[c]=h:n(u,c,h):(delete u[c],n(u,c,h)))})(Function.prototype,"toString",function(){return typeof this=="function"&&this[a]||s.call(this)})},function(r,t,e){var i=e(0),n=e(11),o=e(38),a=/"/g,s=function(l,u,c,h){var p=String(o(l)),g="<"+u;return c!==""&&(g+=" "+c+'="'+String(h).replace(a,"&quot;")+'"'),g+">"+p+"</"+u+">"};r.exports=function(l,u){var c={};c[l]=u(s),i(i.P+i.F*n(function(){var h=""[l]('"');return h!==h.toLowerCase()||h.split('"').length>3}),"String",c)}},function(r,t,e){var i,n,o;n=[t,e(2),e(3),e(8),e(15)],(o=typeof(i=function(a,s,l,u,c){"use strict";var h=e(9),p=e(1);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,s=p(s),l=p(l),u=h(u),c=p(c);var g=function(){function b(){(0,s.default)(this,b),this.instance=null,this.selection=null,this.savedSelectionRange=null,this.isFakeBackgroundEnabled=!1,this.commandBackground="backColor",this.commandRemoveFormat="removeFormat"}return(0,l.default)(b,[{key:"removeFakeBackground",value:function(){this.isFakeBackgroundEnabled&&(this.isFakeBackgroundEnabled=!1,document.execCommand(this.commandRemoveFormat))}},{key:"setFakeBackground",value:function(){document.execCommand(this.commandBackground,!1,"#a8d6ff"),this.isFakeBackgroundEnabled=!0}},{key:"save",value:function(){this.savedSelectionRange=b.range}},{key:"restore",value:function(){if(this.savedSelectionRange){var v=window.getSelection();v.removeAllRanges(),v.addRange(this.savedSelectionRange)}}},{key:"clearSaved",value:function(){this.savedSelectionRange=null}},{key:"collapseToEnd",value:function(){var v=window.getSelection(),k=document.createRange();k.selectNodeContents(v.focusNode),k.collapse(!1),v.removeAllRanges(),v.addRange(k)}},{key:"findParentTag",value:function(v,k){var C=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10,O=window.getSelection(),d=null;if(!O||!O.anchorNode||!O.focusNode)return null;var _=[O.anchorNode,O.focusNode];return _.forEach(function(m){for(var y=C;y>0&&m.parentNode&&(m.tagName!==v||(d=m,k&&m.classList&&!m.classList.contains(k)&&(d=null),!d));)m=m.parentNode,y--}),d}},{key:"expandToTag",value:function(v){var k=window.getSelection();k.removeAllRanges();var C=document.createRange();C.selectNodeContents(v),k.addRange(C)}}],[{key:"get",value:function(){return window.getSelection()}},{key:"setCursor",value:function(v){var k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,C=document.createRange(),O=window.getSelection();return c.default.isNativeInput(v)?c.default.canSetCaret(v)?(v.focus(),v.selectionStart=v.selectionEnd=k,v.getBoundingClientRect()):void 0:(C.setStart(v,k),C.setEnd(v,k),O.removeAllRanges(),O.addRange(C),C.getBoundingClientRect())}},{key:"CSS",get:function(){return{editorWrapper:"codex-editor",editorZone:"codex-editor__redactor"}}},{key:"anchorNode",get:function(){var v=window.getSelection();return v?v.anchorNode:null}},{key:"anchorElement",get:function(){var v=window.getSelection();if(!v)return null;var k=v.anchorNode;return k?c.default.isElement(k)?k:k.parentElement:null}},{key:"anchorOffset",get:function(){var v=window.getSelection();return v?v.anchorOffset:null}},{key:"isCollapsed",get:function(){var v=window.getSelection();return v?v.isCollapsed:null}},{key:"isAtEditor",get:function(){var v=b.get(),k=v.anchorNode||v.focusNode;k&&k.nodeType===Node.TEXT_NODE&&(k=k.parentNode);var C=null;return k&&(C=k.closest(".".concat(b.CSS.editorZone))),C&&C.nodeType===Node.ELEMENT_NODE}},{key:"isSelectionExists",get:function(){return!!b.get().anchorNode}},{key:"range",get:function(){var v=window.getSelection();return v&&v.rangeCount?v.getRangeAt(0):null}},{key:"rect",get:function(){var v,k=document.selection,C={x:0,y:0,width:0,height:0};if(k&&k.type!=="Control")return v=(k=k).createRange(),C.x=v.boundingLeft,C.y=v.boundingTop,C.width=v.boundingWidth,C.height=v.boundingHeight,C;if(!window.getSelection)return u.log("Method window.getSelection is not supported","warn"),C;if((k=window.getSelection()).rangeCount===null||isNaN(k.rangeCount))return u.log("Method SelectionUtils.rangeCount is not supported","warn"),C;if(k.rangeCount===0)return C;if((v=k.getRangeAt(0).cloneRange()).getBoundingClientRect&&(C=v.getBoundingClientRect()),C.x===0&&C.y===0){var O=document.createElement("span");if(O.getBoundingClientRect){O.appendChild(document.createTextNode("\u200B")),v.insertNode(O),C=O.getBoundingClientRect();var d=O.parentNode;d.removeChild(O),d.normalize()}}return C}},{key:"text",get:function(){return window.getSelection?window.getSelection().toString():""}}]),b}();a.default=g,g.displayName="SelectionUtils",r.exports=t.default})=="function"?i.apply(t,n):i)===void 0||(r.exports=o)},function(r,t){var e={}.hasOwnProperty;r.exports=function(i,n){return e.call(i,n)}},function(r,t,e){var i=e(19),n=e(43);r.exports=e(18)?function(o,a,s){return i.f(o,a,n(1,s))}:function(o,a,s){return o[a]=s,o}},function(r,t,e){var i=e(62),n=e(38);r.exports=function(o){return i(n(o))}},function(r,t,e){var i=e(357),n=e(358),o=e(141),a=e(359);r.exports=function(s,l){return i(s)||n(s,l)||o(s,l)||a()}},function(r,t,e){"use strict";var i=e(11);r.exports=function(n,o){return!!n&&i(function(){o?n.call(null,function(){},1):n.call(null)})}},function(r,t,e){var i=e(32);r.exports=function(n,o,a){if(i(n),o===void 0)return n;switch(a){case 1:return function(s){return n.call(o,s)};case 2:return function(s,l){return n.call(o,s,l)};case 3:return function(s,l,u){return n.call(o,s,l,u)}}return function(){return n.apply(o,arguments)}}},function(r,t){r.exports=function(e){if(typeof e!="function")throw TypeError(e+" is not a function!");return e}},function(r,t){var e=Math.ceil,i=Math.floor;r.exports=function(n){return isNaN(n=+n)?0:(n>0?i:e)(n)}},function(r,t,e){var i=e(63),n=e(43),o=e(28),a=e(40),s=e(26),l=e(109),u=Object.getOwnPropertyDescriptor;t.f=e(18)?u:function(c,h){if(c=o(c),h=a(h,!0),l)try{return u(c,h)}catch(p){}if(s(c,h))return n(!i.f.call(c,h),c[h])}},function(r,t,e){var i=e(0),n=e(17),o=e(11);r.exports=function(a,s){var l=(n.Object||{})[a]||Object[a],u={};u[a]=s(l),i(i.S+i.F*o(function(){l(1)}),"Object",u)}},function(r,t,e){var i=e(31),n=e(62),o=e(20),a=e(16),s=e(125);r.exports=function(l,u){var c=l==1,h=l==2,p=l==3,g=l==4,b=l==6,v=l==5||b,k=u||s;return function(C,O,d){for(var _,m,y=o(C),x=n(y),S=i(O,d,3),w=a(x.length),E=0,L=c?k(C,w):h?k(C,0):void 0;w>E;E++)if((v||E in x)&&(m=S(_=x[E],E,y),l)){if(c)L[E]=m;else if(m)switch(l){case 3:return!0;case 5:return _;case 6:return E;case 2:L.push(_)}else if(g)return!1}return b?-1:p||g?g:L}}},function(r,t){var e={}.toString;r.exports=function(i){return e.call(i).slice(8,-1)}},function(r,t){r.exports=function(e){if(e==null)throw TypeError("Can't call method on  "+e);return e}},function(r,t,e){"use strict";if(e(18)){var i=e(45),n=e(10),o=e(11),a=e(0),s=e(78),l=e(106),u=e(31),c=e(57),h=e(43),p=e(27),g=e(58),b=e(33),v=e(16),k=e(136),C=e(47),O=e(40),d=e(26),_=e(64),m=e(13),y=e(20),x=e(98),S=e(48),w=e(50),E=e(49).f,L=e(100),I=e(44),A=e(14),B=e(36),T=e(68),M=e(65),j=e(102),J=e(55),U=e(71),H=e(56),te=e(101),ae=e(127),W=e(19),Y=e(34),re=W.f,ie=Y.f,Q=n.RangeError,ee=n.TypeError,pe=n.Uint8Array,be=Array.prototype,we=l.ArrayBuffer,Le=l.DataView,fe=B(0),xe=B(2),Ne=B(3),Be=B(4),Pe=B(5),Ze=B(6),tt=T(!0),Xe=T(!1),Ke=j.values,nt=j.keys,ot=j.entries,ce=be.lastIndexOf,ve=be.reduce,Ie=be.reduceRight,He=be.join,at=be.sort,vt=be.slice,bt=be.toString,Me=be.toLocaleString,yt=A("iterator"),Wt=A("toStringTag"),Ft=I("typed_constructor"),Ye=I("def_constructor"),Ge=s.CONSTR,Qe=s.TYPED,qe=s.VIEW,er=B(1,function(Ee,Te){return rr(M(Ee,Ee[Ye]),Te)}),dt=o(function(){return new pe(new Uint16Array([1]).buffer)[0]===1}),De=!!pe&&!!pe.prototype.set&&o(function(){new pe(1).set({})}),tr=function(Ee,Te){var ze=b(Ee);if(ze<0||ze%Te)throw Q("Wrong offset!");return ze},et=function(Ee){if(m(Ee)&&Qe in Ee)return Ee;throw ee(Ee+" is not a typed array!")},rr=function(Ee,Te){if(!m(Ee)||!(Ft in Ee))throw ee("It is not a typed array constructor!");return new Ee(Te)},It=function(Ee,Te){return dr(M(Ee,Ee[Ye]),Te)},dr=function(Ee,Te){for(var ze=0,z=Te.length,G=rr(Ee,z);z>ze;)G[ze]=Te[ze++];return G},pt=function(Ee,Te,ze){re(Ee,Te,{get:function(){return this._d[ze]}})},Lt=function(Ee){var Te,ze,z,G,Z,de,le=y(Ee),Ce=arguments.length,Se=Ce>1?arguments[1]:void 0,Re=Se!==void 0,Ae=L(le);if(Ae!=null&&!x(Ae)){for(de=Ae.call(le),z=[],Te=0;!(Z=de.next()).done;Te++)z.push(Z.value);le=z}for(Re&&Ce>2&&(Se=u(Se,arguments[2],2)),Te=0,ze=v(le.length),G=rr(this,ze);ze>Te;Te++)G[Te]=Re?Se(le[Te],Te):le[Te];return G},Xt=function(){for(var Ee=0,Te=arguments.length,ze=rr(this,Te);Te>Ee;)ze[Ee]=arguments[Ee++];return ze},xr=!!pe&&o(function(){Me.call(new pe(1))}),Nt=function(){return Me.apply(xr?vt.call(et(this)):et(this),arguments)},ir={copyWithin:function(Ee,Te){return ae.call(et(this),Ee,Te,arguments.length>2?arguments[2]:void 0)},every:function(Ee){return Be(et(this),Ee,arguments.length>1?arguments[1]:void 0)},fill:function(Ee){return te.apply(et(this),arguments)},filter:function(Ee){return It(this,xe(et(this),Ee,arguments.length>1?arguments[1]:void 0))},find:function(Ee){return Pe(et(this),Ee,arguments.length>1?arguments[1]:void 0)},findIndex:function(Ee){return Ze(et(this),Ee,arguments.length>1?arguments[1]:void 0)},forEach:function(Ee){fe(et(this),Ee,arguments.length>1?arguments[1]:void 0)},indexOf:function(Ee){return Xe(et(this),Ee,arguments.length>1?arguments[1]:void 0)},includes:function(Ee){return tt(et(this),Ee,arguments.length>1?arguments[1]:void 0)},join:function(Ee){return He.apply(et(this),arguments)},lastIndexOf:function(Ee){return ce.apply(et(this),arguments)},map:function(Ee){return er(et(this),Ee,arguments.length>1?arguments[1]:void 0)},reduce:function(Ee){return ve.apply(et(this),arguments)},reduceRight:function(Ee){return Ie.apply(et(this),arguments)},reverse:function(){for(var Ee,Te=et(this).length,ze=Math.floor(Te/2),z=0;z<ze;)Ee=this[z],this[z++]=this[--Te],this[Te]=Ee;return this},some:function(Ee){return Ne(et(this),Ee,arguments.length>1?arguments[1]:void 0)},sort:function(Ee){return at.call(et(this),Ee)},subarray:function(Ee,Te){var ze=et(this),z=ze.length,G=C(Ee,z);return new(M(ze,ze[Ye]))(ze.buffer,ze.byteOffset+G*ze.BYTES_PER_ELEMENT,v((Te===void 0?z:C(Te,z))-G))}},Pt=function(Ee,Te){return It(this,vt.call(et(this),Ee,Te))},hr=function(Ee){et(this);var Te=tr(arguments[1],1),ze=this.length,z=y(Ee),G=v(z.length),Z=0;if(G+Te>ze)throw Q("Wrong length!");for(;Z<G;)this[Te+Z]=z[Z++]},Kt={entries:function(){return ot.call(et(this))},keys:function(){return nt.call(et(this))},values:function(){return Ke.call(et(this))}},nr=function(Ee,Te){return m(Ee)&&Ee[Qe]&&typeof Te!="symbol"&&Te in Ee&&String(+Te)==String(Te)},Tt=function(Ee,Te){return nr(Ee,Te=O(Te,!0))?h(2,Ee[Te]):ie(Ee,Te)},Et=function(Ee,Te,ze){return!(nr(Ee,Te=O(Te,!0))&&m(ze)&&d(ze,"value"))||d(ze,"get")||d(ze,"set")||ze.configurable||d(ze,"writable")&&!ze.writable||d(ze,"enumerable")&&!ze.enumerable?re(Ee,Te,ze):(Ee[Te]=ze.value,Ee)};Ge||(Y.f=Tt,W.f=Et),a(a.S+a.F*!Ge,"Object",{getOwnPropertyDescriptor:Tt,defineProperty:Et}),o(function(){bt.call({})})&&(bt=Me=function(){return He.call(this)});var wt=g({},ir);g(wt,Kt),p(wt,yt,Kt.values),g(wt,{slice:Pt,set:hr,constructor:function(){},toString:bt,toLocaleString:Nt}),pt(wt,"buffer","b"),pt(wt,"byteOffset","o"),pt(wt,"byteLength","l"),pt(wt,"length","e"),re(wt,Wt,{get:function(){return this[Qe]}}),r.exports=function(Ee,Te,ze,z){var G=Ee+((z=!!z)?"Clamped":"")+"Array",Z="get"+Ee,de="set"+Ee,le=n[G],Ce=le||{},Se=le&&w(le),Re=!le||!s.ABV,Ae={},$e=le&&le.prototype,We=function(Je,Ue){re(Je,Ue,{get:function(){return function(At,$t){var xt=At._d;return xt.v[Z]($t*Te+xt.o,dt)}(this,Ue)},set:function(At){return function($t,xt,St){var F=$t._d;z&&(St=(St=Math.round(St))<0?0:St>255?255:255&St),F.v[de](xt*Te+F.o,St,dt)}(this,Ue,At)},enumerable:!0})};Re?(le=ze(function(Je,Ue,At,$t){c(Je,le,G,"_d");var xt,St,F,ne,V=0,oe=0;if(m(Ue)){if(!(Ue instanceof we||(ne=_(Ue))=="ArrayBuffer"||ne=="SharedArrayBuffer"))return Qe in Ue?dr(le,Ue):Lt.call(le,Ue);xt=Ue,oe=tr(At,Te);var D=Ue.byteLength;if($t===void 0){if(D%Te||(St=D-oe)<0)throw Q("Wrong length!")}else if((St=v($t)*Te)+oe>D)throw Q("Wrong length!");F=St/Te}else F=k(Ue),xt=new we(St=F*Te);for(p(Je,"_d",{b:xt,o:oe,l:St,e:F,v:new Le(xt)});V<F;)We(Je,V++)}),$e=le.prototype=S(wt),p($e,"constructor",le)):o(function(){le(1)})&&o(function(){new le(-1)})&&U(function(Je){new le,new le(null),new le(1.5),new le(Je)},!0)||(le=ze(function(Je,Ue,At,$t){var xt;return c(Je,le,G),m(Ue)?Ue instanceof we||(xt=_(Ue))=="ArrayBuffer"||xt=="SharedArrayBuffer"?$t!==void 0?new Ce(Ue,tr(At,Te),$t):At!==void 0?new Ce(Ue,tr(At,Te)):new Ce(Ue):Qe in Ue?dr(le,Ue):Lt.call(le,Ue):new Ce(k(Ue))}),fe(Se!==Function.prototype?E(Ce).concat(E(Se)):E(Ce),function(Je){Je in le||p(le,Je,Ce[Je])}),le.prototype=$e,i||($e.constructor=le));var Fe=$e[yt],rt=!!Fe&&(Fe.name=="values"||Fe.name==null),mt=Kt.values;p(le,Ft,!0),p($e,Qe,G),p($e,qe,!0),p($e,Ye,le),(z?new le(1)[Wt]==G:Wt in $e)||re($e,Wt,{get:function(){return G}}),Ae[G]=le,a(a.G+a.W+a.F*(le!=Ce),Ae),a(a.S,G,{BYTES_PER_ELEMENT:Te}),a(a.S+a.F*o(function(){Ce.of.call(le,1)}),G,{from:Lt,of:Xt}),"BYTES_PER_ELEMENT"in $e||p($e,"BYTES_PER_ELEMENT",Te),a(a.P,G,ir),H(G),a(a.P+a.F*De,G,{set:hr}),a(a.P+a.F*!rt,G,Kt),i||$e.toString==bt||($e.toString=bt),a(a.P+a.F*o(function(){new le(1).slice()}),G,{slice:Pt}),a(a.P+a.F*(o(function(){return[1,2].toLocaleString()!=new le([1,2]).toLocaleString()})||!o(function(){$e.toLocaleString.call([1,2])})),G,{toLocaleString:Nt}),J[G]=rt?Fe:mt,i||rt||p($e,yt,mt)}}else r.exports=function(){}},function(r,t,e){var i=e(13);r.exports=function(n,o){if(!i(n))return n;var a,s;if(o&&typeof(a=n.toString)=="function"&&!i(s=a.call(n))||typeof(a=n.valueOf)=="function"&&!i(s=a.call(n))||!o&&typeof(a=n.toString)=="function"&&!i(s=a.call(n)))return s;throw TypeError("Can't convert object to primitive value")}},function(r,t,e){var i=e(44)("meta"),n=e(13),o=e(26),a=e(19).f,s=0,l=Object.isExtensible||function(){return!0},u=!e(11)(function(){return l(Object.preventExtensions({}))}),c=function(p){a(p,i,{value:{i:"O"+ ++s,w:{}}})},h=r.exports={KEY:i,NEED:!1,fastKey:function(p,g){if(!n(p))return typeof p=="symbol"?p:(typeof p=="string"?"S":"P")+p;if(!o(p,i)){if(!l(p))return"F";if(!g)return"E";c(p)}return p[i].i},getWeak:function(p,g){if(!o(p,i)){if(!l(p))return!0;if(!g)return!1;c(p)}return p[i].w},onFreeze:function(p){return u&&h.NEED&&l(p)&&!o(p,i)&&c(p),p}}},function(r,t,e){var i=e(364),n=e(365),o=e(141),a=e(366);r.exports=function(s){return i(s)||n(s)||o(s)||a()}},function(r,t){r.exports=function(e,i){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:i}}},function(r,t){var e=0,i=Math.random();r.exports=function(n){return"Symbol(".concat(n===void 0?"":n,")_",(++e+i).toString(36))}},function(r,t){r.exports=!1},function(r,t,e){var i=e(111),n=e(85);r.exports=Object.keys||function(o){return i(o,n)}},function(r,t,e){var i=e(33),n=Math.max,o=Math.min;r.exports=function(a,s){return(a=i(a))<0?n(a+s,0):o(a,s)}},function(r,t,e){var i=e(12),n=e(112),o=e(85),a=e(84)("IE_PROTO"),s=function(){},l=function(){var u,c=e(82)("iframe"),h=o.length;for(c.style.display="none",e(86).appendChild(c),c.src="javascript:",(u=c.contentWindow.document).open(),u.write("<script>document.F=Object<\/script>"),u.close(),l=u.F;h--;)delete l.prototype[o[h]];return l()};r.exports=Object.create||function(u,c){var h;return u!==null?(s.prototype=i(u),h=new s,s.prototype=null,h[a]=u):h=l(),c===void 0?h:n(h,c)}},function(r,t,e){var i=e(111),n=e(85).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(o){return i(o,n)}},function(r,t,e){var i=e(26),n=e(20),o=e(84)("IE_PROTO"),a=Object.prototype;r.exports=Object.getPrototypeOf||function(s){return s=n(s),i(s,o)?s[o]:typeof s.constructor=="function"&&s instanceof s.constructor?s.constructor.prototype:s instanceof Object?a:null}},function(r,t,e){var i=e(14)("unscopables"),n=Array.prototype;n[i]==null&&e(27)(n,i,{}),r.exports=function(o){n[i][o]=!0}},function(r,t,e){var i=e(13);r.exports=function(n,o){if(!i(n)||n._t!==o)throw TypeError("Incompatible receiver, "+o+" required!");return n}},function(r,t,e){var i=e(19).f,n=e(26),o=e(14)("toStringTag");r.exports=function(a,s,l){a&&!n(a=l?a:a.prototype,o)&&i(a,o,{configurable:!0,value:s})}},function(r,t,e){var i=e(0),n=e(38),o=e(11),a=e(88),s="["+a+"]",l=RegExp("^"+s+s+"*"),u=RegExp(s+s+"*$"),c=function(p,g,b){var v={},k=o(function(){return!!a[p]()||"\u200B\x85"[p]()!="\u200B\x85"}),C=v[p]=k?g(h):a[p];b&&(v[b]=C),i(i.P+i.F*k,"String",v)},h=c.trim=function(p,g){return p=String(n(p)),1&g&&(p=p.replace(l,"")),2&g&&(p=p.replace(u,"")),p};r.exports=c},function(r,t){r.exports={}},function(r,t,e){"use strict";var i=e(10),n=e(19),o=e(18),a=e(14)("species");r.exports=function(s){var l=i[s];o&&l&&!l[a]&&n.f(l,a,{configurable:!0,get:function(){return this}})}},function(r,t){r.exports=function(e,i,n,o){if(!(e instanceof i)||o!==void 0&&o in e)throw TypeError(n+": incorrect invocation!");return e}},function(r,t,e){var i=e(23);r.exports=function(n,o,a){for(var s in o)i(n,s,o[s],a);return n}},function(r,t,e){var i,n,o;n=[t,e(2),e(3),e(144)],(o=typeof(i=function(a,s,l,u){"use strict";var c=e(1);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,s=c(s),l=c(l),u=c(u);var h=function(){function p(){(0,s.default)(this,p)}return(0,l.default)(p,null,[{key:"ui",value:function(g,b){return p._t(g,b)}},{key:"t",value:function(g,b){return p._t(g,b)}},{key:"setDictionary",value:function(g){p.currentDictionary=g}},{key:"_t",value:function(g,b){var v=p.getNamespace(g);return v&&v[b]?v[b]:b}},{key:"getNamespace",value:function(g){return g.split(".").reduce(function(b,v){return b&&Object.keys(b).length?b[v]:{}},p.currentDictionary)}}]),p}();a.default=h,h.displayName="I18n",h.currentDictionary=u.default,r.exports=t.default})=="function"?i.apply(t,n):i)===void 0||(r.exports=o)},function(r,t,e){var i,n,o;n=[t,e(2),e(3),e(375),e(8)],(o=typeof(i=function(a,s,l,u,c){"use strict";var h=e(9),p=e(1);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,s=p(s),l=p(l),u=p(u),c=h(c);var g=function(){function b(v){var k=this;(0,s.default)(this,b),this.iterator=null,this.activated=!1,this.allowArrows=!0,this.onKeyDown=function(C){if(k.isEventReadyForHandling(C))switch(b.usedKeys.includes(C.keyCode)&&C.preventDefault(),C.keyCode){case c.keyCodes.TAB:k.handleTabPress(C);break;case c.keyCodes.LEFT:case c.keyCodes.UP:k.flipLeft();break;case c.keyCodes.RIGHT:case c.keyCodes.DOWN:k.flipRight();break;case c.keyCodes.ENTER:k.handleEnterPress(C)}},this.allowArrows=!c.isBoolean(v.allowArrows)||v.allowArrows,this.iterator=new u.default(v.items,v.focusedItemClass),this.activateCallback=v.activateCallback}return(0,l.default)(b,[{key:"activate",value:function(v){this.activated=!0,v&&this.iterator.setItems(v),document.addEventListener("keydown",this.onKeyDown)}},{key:"deactivate",value:function(){this.activated=!1,this.dropCursor(),document.removeEventListener("keydown",this.onKeyDown)}},{key:"focusFirst",value:function(){this.dropCursor(),this.flipRight()}},{key:"flipLeft",value:function(){this.iterator.previous()}},{key:"flipRight",value:function(){this.iterator.next()}},{key:"dropCursor",value:function(){this.iterator.dropCursor()}},{key:"isEventReadyForHandling",value:function(v){var k=[c.keyCodes.TAB,c.keyCodes.ENTER],C=this.iterator.currentItem==document.activeElement;return this.allowArrows&&!C&&k.push(c.keyCodes.LEFT,c.keyCodes.RIGHT,c.keyCodes.UP,c.keyCodes.DOWN),this.activated&&k.indexOf(v.keyCode)!==-1}},{key:"handleTabPress",value:function(v){switch(v.shiftKey?u.default.directions.LEFT:u.default.directions.RIGHT){case u.default.directions.RIGHT:this.flipRight();break;case u.default.directions.LEFT:this.flipLeft()}}},{key:"handleEnterPress",value:function(v){this.activated&&(this.iterator.currentItem&&this.iterator.currentItem.click(),c.isFunction(this.activateCallback)&&this.activateCallback(this.iterator.currentItem),v.preventDefault(),v.stopPropagation())}},{key:"currentItem",get:function(){return this.iterator.currentItem}}],[{key:"usedKeys",get:function(){return[c.keyCodes.TAB,c.keyCodes.LEFT,c.keyCodes.RIGHT,c.keyCodes.ENTER,c.keyCodes.UP,c.keyCodes.DOWN]}}]),b}();a.default=g,g.displayName="Flipper",r.exports=t.default})=="function"?i.apply(t,n):i)===void 0||(r.exports=o)},function(r,t,e){var i,n,o;n=[t,e(29),e(42),e(21),e(22),e(2),e(3),e(15),e(8),e(148),e(25)],(o=typeof(i=function(a,s,l,u,c,h,p,g,b,v,k){"use strict";var C,O=e(9),d=e(1);Object.defineProperty(a,"__esModule",{value:!0}),a.default=a.BlockToolAPI=void 0,s=d(s),l=d(l),u=d(u),c=d(c),h=d(h),p=d(p),g=d(g),b=O(b),v=d(v),k=d(k),a.BlockToolAPI=C,function(m){m.APPEND_CALLBACK="appendCallback",m.RENDERED="rendered",m.MOVED="moved",m.UPDATED="updated",m.REMOVED="removed",m.ON_PASTE="onPaste"}(C||(a.BlockToolAPI=C={}));var _=function(){function m(w){var E=this,L=w.data,I=w.tool,A=w.api,B=w.readOnly,T=w.tunes,M=w.tunesData;(0,h.default)(this,m),this.cachedInputs=[],this.tunesInstances=new Map,this.defaultTunesInstances=new Map,this.unavailableTunesData={},this.inputIndex=0,this.modificationDebounceTimer=450,this.didMutated=b.debounce(function(){E.cachedInputs=[],E.updateCurrentInput(),E.call(C.UPDATED)},this.modificationDebounceTimer),this.handleFocus=function(){E.cachedInputs=[],E.updateCurrentInput()},this.name=I.name,this.settings=I.settings,this.config=I.settings.config||{},this.api=A,this.blockAPI=new v.default(this),this.mutationObserver=new MutationObserver(this.didMutated),this.tool=I,this.toolInstance=I.create(L,this.blockAPI,B),this.tunes=T,this.composeTunes(M),this.holder=this.compose()}var y,x,S;return(0,p.default)(m,[{key:"call",value:function(w,E){if(this.toolInstance[w]&&this.toolInstance[w]instanceof Function){w===C.APPEND_CALLBACK&&b.log("`appendCallback` hook is deprecated and will be removed in the next major release. Use `rendered` hook instead","warn");try{this.toolInstance[w].call(this.toolInstance,E)}catch(L){b.log("Error during '".concat(w,"' call: ").concat(L.message),"error")}}}},{key:"mergeWith",value:(S=(0,c.default)(u.default.mark(function w(E){return u.default.wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return L.next=2,this.toolInstance.merge(E);case 2:case"end":return L.stop()}},w,this)})),function(w){return S.apply(this,arguments)})},{key:"save",value:(x=(0,c.default)(u.default.mark(function w(){var E,L,I,A,B=this;return u.default.wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return T.next=2,this.toolInstance.save(this.pluginsContent);case 2:return E=T.sent,L=this.unavailableTunesData,[].concat((0,l.default)(this.tunesInstances.entries()),(0,l.default)(this.defaultTunesInstances.entries())).forEach(function(M){var j=(0,s.default)(M,2),J=j[0],U=j[1];if(b.isFunction(U.save))try{L[J]=U.save()}catch(H){b.log("Tune ".concat(U.constructor.name," save method throws an Error %o"),"warn",H)}}),I=window.performance.now(),T.abrupt("return",Promise.resolve(E).then(function(M){return A=window.performance.now(),{tool:B.name,data:M,tunes:L,time:A-I}}).catch(function(M){b.log("Saving proccess for ".concat(B.name," tool failed due to the ").concat(M),"log","red")}));case 7:case"end":return T.stop()}},w,this)})),function(){return x.apply(this,arguments)})},{key:"validate",value:(y=(0,c.default)(u.default.mark(function w(E){var L;return u.default.wrap(function(I){for(;;)switch(I.prev=I.next){case 0:if(L=!0,!(this.toolInstance.validate instanceof Function)){I.next=5;break}return I.next=4,this.toolInstance.validate(E);case 4:L=I.sent;case 5:return I.abrupt("return",L);case 6:case"end":return I.stop()}},w,this)})),function(w){return y.apply(this,arguments)})},{key:"renderTunes",value:function(){var w=document.createDocumentFragment(),E=document.createDocumentFragment();return this.tunesInstances.forEach(function(L){g.default.append(w,L.render())}),this.defaultTunesInstances.forEach(function(L){g.default.append(E,L.render())}),[w,E]}},{key:"updateCurrentInput",value:function(){this.currentInput=g.default.isNativeInput(document.activeElement)||!k.default.anchorNode?document.activeElement:k.default.anchorNode}},{key:"willSelect",value:function(){this.mutationObserver.observe(this.holder.firstElementChild,{childList:!0,subtree:!0,characterData:!0,attributes:!0}),this.addInputEvents()}},{key:"willUnselect",value:function(){this.mutationObserver.disconnect(),this.removeInputEvents()}},{key:"destroy",value:function(){b.isFunction(this.toolInstance.destroy)&&this.toolInstance.destroy()}},{key:"renderSettings",value:function(){if(b.isFunction(this.toolInstance.renderSettings))return this.toolInstance.renderSettings()}},{key:"compose",value:function(){var w=g.default.make("div",m.CSS.wrapper),E=g.default.make("div",m.CSS.content),L=this.toolInstance.render();E.appendChild(L);var I=E;return[].concat((0,l.default)(this.tunesInstances.values()),(0,l.default)(this.defaultTunesInstances.values())).forEach(function(A){if(b.isFunction(A.wrap))try{I=A.wrap(I)}catch(B){b.log("Tune ".concat(A.constructor.name," wrap method throws an Error %o"),"warn",B)}}),w.appendChild(I),w}},{key:"composeTunes",value:function(w){var E=this;Array.from(this.tunes.values()).forEach(function(L){(L.isInternal?E.defaultTunesInstances:E.tunesInstances).set(L.name,L.create(w[L.name],E.blockAPI))}),Object.entries(w).forEach(function(L){var I=(0,s.default)(L,2),A=I[0],B=I[1];E.tunesInstances.has(A)||(E.unavailableTunesData[A]=B)})}},{key:"addInputEvents",value:function(){var w=this;this.inputs.forEach(function(E){E.addEventListener("focus",w.handleFocus)})}},{key:"removeInputEvents",value:function(){var w=this;this.inputs.forEach(function(E){E.removeEventListener("focus",w.handleFocus)})}},{key:"inputs",get:function(){if(this.cachedInputs.length!==0)return this.cachedInputs;var w=g.default.findAllInputs(this.holder);return this.inputIndex>w.length-1&&(this.inputIndex=w.length-1),this.cachedInputs=w,w}},{key:"currentInput",get:function(){return this.inputs[this.inputIndex]},set:function(w){var E=this.inputs.findIndex(function(L){return L===w||L.contains(w)});E!==-1&&(this.inputIndex=E)}},{key:"firstInput",get:function(){return this.inputs[0]}},{key:"lastInput",get:function(){var w=this.inputs;return w[w.length-1]}},{key:"nextInput",get:function(){return this.inputs[this.inputIndex+1]}},{key:"previousInput",get:function(){return this.inputs[this.inputIndex-1]}},{key:"data",get:function(){return this.save().then(function(w){return w&&!b.isEmpty(w.data)?w.data:{}})}},{key:"sanitize",get:function(){return this.tool.sanitizeConfig}},{key:"mergeable",get:function(){return b.isFunction(this.toolInstance.merge)}},{key:"isEmpty",get:function(){var w=g.default.isEmpty(this.pluginsContent),E=!this.hasMedia;return w&&E}},{key:"hasMedia",get:function(){return!!this.holder.querySelector(["img","iframe","video","audio","source","input","textarea","twitterwidget"].join(","))}},{key:"focused",set:function(w){this.holder.classList.toggle(m.CSS.focused,w)},get:function(){return this.holder.classList.contains(m.CSS.focused)}},{key:"selected",set:function(w){w?this.holder.classList.add(m.CSS.selected):this.holder.classList.remove(m.CSS.selected)},get:function(){return this.holder.classList.contains(m.CSS.selected)}},{key:"stretched",set:function(w){this.holder.classList.toggle(m.CSS.wrapperStretched,w)},get:function(){return this.holder.classList.contains(m.CSS.wrapperStretched)}},{key:"dropTarget",set:function(w){this.holder.classList.toggle(m.CSS.dropTarget,w)}},{key:"pluginsContent",get:function(){var w=this.holder.querySelector(".".concat(m.CSS.content));if(w&&w.childNodes.length)for(var E=w.childNodes.length-1;E>=0;E--){var L=w.childNodes[E];if(!g.default.isExtensionNode(L))return L}return null}}],[{key:"CSS",get:function(){return{wrapper:"ce-block",wrapperStretched:"ce-block--stretched",content:"ce-block__content",focused:"ce-block--focused",selected:"ce-block--selected",dropTarget:"ce-block--drop-target"}}}]),m}();a.default=_,_.displayName="Block"})=="function"?i.apply(t,n):i)===void 0||(r.exports=o)},function(r,t,e){var i=e(37);r.exports=Object("z").propertyIsEnumerable(0)?Object:function(n){return i(n)=="String"?n.split(""):Object(n)}},function(r,t){t.f={}.propertyIsEnumerable},function(r,t,e){var i=e(37),n=e(14)("toStringTag"),o=i(function(){return arguments}())=="Arguments";r.exports=function(a){var s,l,u;return a===void 0?"Undefined":a===null?"Null":typeof(l=function(c,h){try{return c[h]}catch(p){}}(s=Object(a),n))=="string"?l:o?i(s):(u=i(s))=="Object"&&typeof s.callee=="function"?"Arguments":u}},function(r,t,e){var i=e(12),n=e(32),o=e(14)("species");r.exports=function(a,s){var l,u=i(a).constructor;return u===void 0||(l=i(u)[o])==null?s:n(l)}},function(r,t,e){var i,n,o;n=[t,e(2),e(3),e(8)],(o=typeof(i=function(a,s,l,u){"use strict";var c,h,p,g,b,v,k=e(9),C=e(1);Object.defineProperty(a,"__esModule",{value:!0}),a.default=a.InternalTuneSettings=a.InternalInlineToolSettings=a.InternalBlockToolSettings=a.CommonInternalSettings=a.UserSettings=a.ToolType=void 0,s=C(s),l=C(l),u=k(u),a.ToolType=c,function(d){d[d.Block=0]="Block",d[d.Inline=1]="Inline",d[d.Tune=2]="Tune"}(c||(a.ToolType=c={})),a.UserSettings=h,function(d){d.Shortcut="shortcut",d.Toolbox="toolbox",d.EnabledInlineTools="inlineToolbar",d.EnabledBlockTunes="tunes",d.Config="config"}(h||(a.UserSettings=h={})),a.CommonInternalSettings=p,function(d){d.Shortcut="shortcut",d.SanitizeConfig="sanitize"}(p||(a.CommonInternalSettings=p={})),a.InternalBlockToolSettings=g,function(d){d.IsEnabledLineBreaks="enableLineBreaks",d.Toolbox="toolbox",d.ConversionConfig="conversionConfig",d.IsReadOnlySupported="isReadOnlySupported",d.PasteConfig="pasteConfig"}(g||(a.InternalBlockToolSettings=g={})),a.InternalInlineToolSettings=b,function(d){d.IsInline="isInline",d.Title="title"}(b||(a.InternalInlineToolSettings=b={})),a.InternalTuneSettings=v,function(d){d.IsTune="isTune"}(v||(a.InternalTuneSettings=v={}));var O=function(){function d(_){var m=_.name,y=_.constructable,x=_.config,S=_.api,w=_.isDefault,E=_.isInternal,L=E!==void 0&&E,I=_.defaultPlaceholder;(0,s.default)(this,d),this.api=S,this.name=m,this.constructable=y,this.config=x,this.isDefault=w,this.isInternal=L,this.defaultPlaceholder=I}return(0,l.default)(d,[{key:"reset",value:function(){if(u.isFunction(this.constructable.reset))return this.constructable.reset()}},{key:"prepare",value:function(){if(u.isFunction(this.constructable.prepare))return this.constructable.prepare({toolName:this.name,config:this.settings})}},{key:"isInline",value:function(){return this.type===c.Inline}},{key:"isBlock",value:function(){return this.type===c.Block}},{key:"isTune",value:function(){return this.type===c.Tune}},{key:"settings",get:function(){var _=this.config[h.Config]||{};return this.isDefault&&!("placeholder"in _)&&this.defaultPlaceholder&&(_.placeholder=this.defaultPlaceholder),_}},{key:"shortcut",get:function(){var _=this.constructable[p.Shortcut];return this.config[h.Shortcut]||_}},{key:"sanitizeConfig",get:function(){return this.constructable[p.SanitizeConfig]}}]),d}();a.default=O,O.displayName="BaseTool"})=="function"?i.apply(t,n):i)===void 0||(r.exports=o)},function(r,t,e){var i=e(17),n=e(10),o=n["__core-js_shared__"]||(n["__core-js_shared__"]={});(r.exports=function(a,s){return o[a]||(o[a]=s!==void 0?s:{})})("versions",[]).push({version:i.version,mode:e(45)?"pure":"global",copyright:"\xA9 2019 Denis Pushkarev (zloirock.ru)"})},function(r,t,e){var i=e(28),n=e(16),o=e(47);r.exports=function(a){return function(s,l,u){var c,h=i(s),p=n(h.length),g=o(u,p);if(a&&l!=l){for(;p>g;)if((c=h[g++])!=c)return!0}else for(;p>g;g++)if((a||g in h)&&h[g]===l)return a||g||0;return!a&&-1}}},function(r,t){t.f=Object.getOwnPropertySymbols},function(r,t,e){var i=e(37);r.exports=Array.isArray||function(n){return i(n)=="Array"}},function(r,t,e){var i=e(14)("iterator"),n=!1;try{var o=[7][i]();o.return=function(){n=!0},Array.from(o,function(){throw 2})}catch(a){}r.exports=function(a,s){if(!s&&!n)return!1;var l=!1;try{var u=[7],c=u[i]();c.next=function(){return{done:l=!0}},u[i]=function(){return c},a(u)}catch(h){}return l}},function(r,t,e){"use strict";var i=e(12);r.exports=function(){var n=i(this),o="";return n.global&&(o+="g"),n.ignoreCase&&(o+="i"),n.multiline&&(o+="m"),n.unicode&&(o+="u"),n.sticky&&(o+="y"),o}},function(r,t,e){"use strict";var i=e(64),n=RegExp.prototype.exec;r.exports=function(o,a){var s=o.exec;if(typeof s=="function"){var l=s.call(o,a);if(typeof l!="object")throw new TypeError("RegExp exec method returned something other than an Object or null");return l}if(i(o)!=="RegExp")throw new TypeError("RegExp#exec called on incompatible receiver");return n.call(o,a)}},function(r,t,e){"use strict";e(129);var i=e(23),n=e(27),o=e(11),a=e(38),s=e(14),l=e(103),u=s("species"),c=!o(function(){var p=/./;return p.exec=function(){var g=[];return g.groups={a:"7"},g},"".replace(p,"$<a>")!=="7"}),h=function(){var p=/(?:)/,g=p.exec;p.exec=function(){return g.apply(this,arguments)};var b="ab".split(p);return b.length===2&&b[0]==="a"&&b[1]==="b"}();r.exports=function(p,g,b){var v=s(p),k=!o(function(){var y={};return y[v]=function(){return 7},""[p](y)!=7}),C=k?!o(function(){var y=!1,x=/a/;return x.exec=function(){return y=!0,null},p==="split"&&(x.constructor={},x.constructor[u]=function(){return x}),x[v](""),!y}):void 0;if(!k||!C||p==="replace"&&!c||p==="split"&&!h){var O=/./[v],d=b(a,v,""[p],function(y,x,S,w,E){return x.exec===l?k&&!E?{done:!0,value:O.call(x,S,w)}:{done:!0,value:y.call(S,x,w)}:{done:!1}}),_=d[0],m=d[1];i(String.prototype,p,_),n(RegExp.prototype,v,g==2?function(y,x){return m.call(y,this,x)}:function(y){return m.call(y,this)})}}},function(r,t,e){var i=e(31),n=e(124),o=e(98),a=e(12),s=e(16),l=e(100),u={},c={};(t=r.exports=function(h,p,g,b,v){var k,C,O,d,_=v?function(){return h}:l(h),m=i(g,b,p?2:1),y=0;if(typeof _!="function")throw TypeError(h+" is not iterable!");if(o(_)){for(k=s(h.length);k>y;y++)if((d=p?m(a(C=h[y])[0],C[1]):m(h[y]))===u||d===c)return d}else for(O=_.call(h);!(C=O.next()).done;)if((d=n(O,m,C.value,p))===u||d===c)return d}).BREAK=u,t.RETURN=c},function(r,t,e){var i=e(10).navigator;r.exports=i&&i.userAgent||""},function(r,t,e){"use strict";var i=e(10),n=e(0),o=e(23),a=e(58),s=e(41),l=e(75),u=e(57),c=e(13),h=e(11),p=e(71),g=e(53),b=e(89);r.exports=function(v,k,C,O,d,_){var m=i[v],y=m,x=d?"set":"add",S=y&&y.prototype,w={},E=function(M){var j=S[M];o(S,M,M=="delete"||M=="has"?function(J){return!(_&&!c(J))&&j.call(this,J===0?0:J)}:M=="get"?function(J){return _&&!c(J)?void 0:j.call(this,J===0?0:J)}:M=="add"?function(J){return j.call(this,J===0?0:J),this}:function(J,U){return j.call(this,J===0?0:J,U),this})};if(typeof y=="function"&&(_||S.forEach&&!h(function(){new y().entries().next()}))){var L=new y,I=L[x](_?{}:-0,1)!=L,A=h(function(){L.has(1)}),B=p(function(M){new y(M)}),T=!_&&h(function(){for(var M=new y,j=5;j--;)M[x](j,j);return!M.has(-0)});B||((y=k(function(M,j){u(M,y,v);var J=b(new m,M,y);return j!=null&&l(j,d,J[x],J),J})).prototype=S,S.constructor=y),(A||T)&&(E("delete"),E("has"),d&&E("get")),(T||I)&&E(x),_&&S.clear&&delete S.clear}else y=O.getConstructor(k,v,d,x),a(y.prototype,C),s.NEED=!0;return g(y,v),w[v]=y,n(n.G+n.W+n.F*(y!=m),w),_||O.setStrong(y,v,d),y}},function(r,t,e){for(var i,n=e(10),o=e(27),a=e(44),s=a("typed_array"),l=a("view"),u=!(!n.ArrayBuffer||!n.DataView),c=u,h=0,p="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");h<9;)(i=n[p[h++]])?(o(i.prototype,s,!0),o(i.prototype,l,!0)):c=!1;r.exports={ABV:u,CONSTR:c,TYPED:s,VIEW:l}},function(r,t,e){var i,n,o;n=[t,e(2),e(3),e(5),e(6),e(4),e(7)],(o=typeof(i=function(a,s,l,u,c,h,p){"use strict";var g=e(1);function b(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(k){return!1}}Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,s=g(s),l=g(l),u=g(u),c=g(c),h=g(h);var v=function(k){(0,u.default)(d,k);var C,O=(C=d,function(){var _,m=(0,h.default)(C);if(b()){var y=(0,h.default)(this).constructor;_=Reflect.construct(m,arguments,y)}else _=m.apply(this,arguments);return(0,c.default)(this,_)});function d(){return(0,s.default)(this,d),O.apply(this,arguments)}return(0,l.default)(d,[{key:"getMethodsForTool",value:function(_){return Object.assign(this.methods,{i18n:this.Editor.I18nAPI.getMethodsForTool(_)})}},{key:"methods",get:function(){return{blocks:this.Editor.BlocksAPI.methods,caret:this.Editor.CaretAPI.methods,events:this.Editor.EventsAPI.methods,listeners:this.Editor.ListenersAPI.methods,notifier:this.Editor.NotifierAPI.methods,sanitizer:this.Editor.SanitizerAPI.methods,saver:this.Editor.SaverAPI.methods,selection:this.Editor.SelectionAPI.methods,styles:this.Editor.StylesAPI.classes,toolbar:this.Editor.ToolbarAPI.methods,inlineToolbar:this.Editor.InlineToolbarAPI.methods,tooltip:this.Editor.TooltipAPI.methods,i18n:this.Editor.I18nAPI.methods,readOnly:this.Editor.ReadOnlyAPI.methods}}}]),d}((p=g(p)).default);a.default=v,v.displayName="API",r.exports=t.default})=="function"?i.apply(t,n):i)===void 0||(r.exports=o)},function(r,t,e){var i,n,o;n=[t,e(2),e(3),e(5),e(6),e(4),e(7),e(15),e(8),e(59),e(81)],(o=typeof(i=function(a,s,l,u,c,h,p,g,b,v,k){"use strict";var C=e(9),O=e(1);function d(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(m){return!1}}Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,s=O(s),l=O(l),u=O(u),c=O(c),h=O(h),p=O(p),g=O(g),b=C(b),v=O(v);var _=function(m){(0,u.default)(S,m);var y,x=(y=S,function(){var w,E=(0,h.default)(y);if(d()){var L=(0,h.default)(this).constructor;w=Reflect.construct(E,arguments,L)}else w=E.apply(this,arguments);return(0,c.default)(this,w)});function S(){return(0,s.default)(this,S),x.apply(this,arguments)}return(0,l.default)(S,[{key:"toggleReadOnly",value:function(w){w?(this.destroy(),this.Editor.Toolbox.destroy(),this.Editor.BlockSettings.destroy(),this.disableModuleBindings()):(this.drawUI(),this.enableModuleBindings())}},{key:"move",value:function(){var w=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];w&&(this.Editor.Toolbox.close(),this.Editor.BlockSettings.close());var E=this.Editor.BlockManager.currentBlock.holder;if(E){var L=this.Editor.UI.isMobile,I=E.offsetHeight,A=E.offsetTop;if(L)A+=I;else{var B=Math.floor(I/2);this.nodes.plusButton.style.transform="translate3d(0, calc(".concat(B,"px - 50%), 0)"),this.Editor.Toolbox.nodes.toolbox.style.transform="translate3d(0, calc(".concat(B,"px - 50%), 0)")}this.nodes.wrapper.style.transform="translate3D(0, ".concat(Math.floor(A),"px, 0)")}}},{key:"open",value:function(){var w=this,E=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0],L=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];b.delay(function(){w.move(L),w.nodes.wrapper.classList.add(w.CSS.toolbarOpened),E?w.blockActions.show():w.blockActions.hide()},50)()}},{key:"close",value:function(){this.nodes.wrapper.classList.remove(this.CSS.toolbarOpened),this.blockActions.hide(),this.Editor.Toolbox.close(),this.Editor.BlockSettings.close()}},{key:"make",value:function(){var w=this;this.nodes.wrapper=g.default.make("div",this.CSS.toolbar),["content","actions"].forEach(function(I){w.nodes[I]=g.default.make("div",w.CSS[I])}),g.default.append(this.nodes.wrapper,this.nodes.content),g.default.append(this.nodes.content,this.nodes.actions),this.nodes.plusButton=g.default.make("div",this.CSS.plusButton),g.default.append(this.nodes.plusButton,g.default.svg("plus",14,14)),g.default.append(this.nodes.content,this.nodes.plusButton),this.readOnlyMutableListeners.on(this.nodes.plusButton,"click",function(){w.plusButtonClicked()},!1);var E=g.default.make("div");E.appendChild(document.createTextNode(v.default.ui(k.I18nInternalNS.ui.toolbar.toolbox,"Add"))),E.appendChild(g.default.make("div",this.CSS.plusButtonShortcut,{textContent:"\u21E5 Tab"})),this.Editor.Tooltip.onHover(this.nodes.plusButton,E),this.nodes.blockActionsButtons=g.default.make("div",this.CSS.blockActionsButtons),this.nodes.settingsToggler=g.default.make("span",this.CSS.settingsToggler);var L=g.default.svg("dots",8,8);g.default.append(this.nodes.settingsToggler,L),g.default.append(this.nodes.blockActionsButtons,this.nodes.settingsToggler),g.default.append(this.nodes.actions,this.nodes.blockActionsButtons),this.Editor.Tooltip.onHover(this.nodes.settingsToggler,v.default.ui(k.I18nInternalNS.ui.blockTunes.toggler,"Click to tune"),{placement:"top"}),g.default.append(this.nodes.content,this.Editor.Toolbox.nodes.toolbox),g.default.append(this.nodes.actions,this.Editor.BlockSettings.nodes.wrapper),g.default.append(this.Editor.UI.nodes.wrapper,this.nodes.wrapper)}},{key:"plusButtonClicked",value:function(){this.Editor.Toolbox.toggle()}},{key:"enableModuleBindings",value:function(){var w=this;this.readOnlyMutableListeners.on(this.nodes.settingsToggler,"click",function(){w.settingsTogglerClicked()})}},{key:"disableModuleBindings",value:function(){this.readOnlyMutableListeners.clearAll()}},{key:"settingsTogglerClicked",value:function(){this.Editor.BlockSettings.opened?this.Editor.BlockSettings.close():this.Editor.BlockSettings.open()}},{key:"drawUI",value:function(){this.Editor.BlockSettings.make(),this.Editor.Toolbox.make(),this.make()}},{key:"destroy",value:function(){this.removeAllNodes()}},{key:"CSS",get:function(){return{toolbar:"ce-toolbar",content:"ce-toolbar__content",actions:"ce-toolbar__actions",actionsOpened:"ce-toolbar__actions--opened",toolbarOpened:"ce-toolbar--opened",plusButton:"ce-toolbar__plus",plusButtonShortcut:"ce-toolbar__plus-shortcut",plusButtonHidden:"ce-toolbar__plus--hidden",blockActionsButtons:"ce-toolbar__actions-buttons",settingsToggler:"ce-toolbar__settings-btn"}}},{key:"opened",get:function(){return this.nodes.wrapper.classList.contains(this.CSS.toolbarOpened)}},{key:"plusButton",get:function(){var w=this;return{hide:function(){return w.nodes.plusButton.classList.add(w.CSS.plusButtonHidden)},show:function(){w.Editor.Toolbox.isEmpty||w.nodes.plusButton.classList.remove(w.CSS.plusButtonHidden)}}}},{key:"blockActions",get:function(){var w=this;return{hide:function(){w.nodes.actions.classList.remove(w.CSS.actionsOpened)},show:function(){w.nodes.actions.classList.add(w.CSS.actionsOpened)}}}}]),S}(p.default);a.default=_,_.displayName="Toolbar",r.exports=t.default})=="function"?i.apply(t,n):i)===void 0||(r.exports=o)},function(r,t,e){var i,n,o;n=[t,e(29),e(144),e(8)],(o=typeof(i=function(a,s,l,u){"use strict";var c=e(1);Object.defineProperty(a,"__esModule",{value:!0}),a.I18nInternalNS=void 0,s=c(s);var h=function p(g,b){var v={};return Object.entries(g).forEach(function(k){var C=(0,s.default)(k,2),O=C[0],d=C[1];if((0,u.isObject)(d)){var _=b?"".concat(b,".").concat(O):O,m=Object.values(d).every(function(y){return(0,u.isString)(y)});v[O]=m?_:p(d,_)}else v[O]=d}),v}((l=c(l)).default);a.I18nInternalNS=h})=="function"?i.apply(t,n):i)===void 0||(r.exports=o)},function(r,t,e){var i=e(13),n=e(10).document,o=i(n)&&i(n.createElement);r.exports=function(a){return o?n.createElement(a):{}}},function(r,t,e){t.f=e(14)},function(r,t,e){var i=e(67)("keys"),n=e(44);r.exports=function(o){return i[o]||(i[o]=n(o))}},function(r,t){r.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(r,t,e){var i=e(10).document;r.exports=i&&i.documentElement},function(r,t,e){var i=e(13),n=e(12),o=function(a,s){if(n(a),!i(s)&&s!==null)throw TypeError(s+": can't set as prototype!")};r.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(a,s,l){try{(l=e(31)(Function.call,e(34).f(Object.prototype,"__proto__").set,2))(a,[]),s=!(a instanceof Array)}catch(u){s=!0}return function(u,c){return o(u,c),s?u.__proto__=c:l(u,c),u}}({},!1):void 0),check:o}},function(r,t){r.exports=`	
\v\f\r \xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF`},function(r,t,e){var i=e(13),n=e(87).set;r.exports=function(o,a,s){var l,u=a.constructor;return u!==s&&typeof u=="function"&&(l=u.prototype)!==s.prototype&&i(l)&&n&&n(o,l),o}},function(r,t,e){"use strict";var i=e(33),n=e(38);r.exports=function(o){var a=String(n(this)),s="",l=i(o);if(l<0||l==1/0)throw RangeError("Count can't be negative");for(;l>0;(l>>>=1)&&(a+=a))1&l&&(s+=a);return s}},function(r,t){r.exports=Math.sign||function(e){return(e=+e)==0||e!=e?e:e<0?-1:1}},function(r,t){var e=Math.expm1;r.exports=!e||e(10)>22025.465794806718||e(10)<22025.465794806718||e(-2e-17)!=-2e-17?function(i){return(i=+i)==0?i:i>-1e-6&&i<1e-6?i+i*i/2:Math.exp(i)-1}:e},function(r,t,e){var i=e(33),n=e(38);r.exports=function(o){return function(a,s){var l,u,c=String(n(a)),h=i(s),p=c.length;return h<0||h>=p?o?"":void 0:(l=c.charCodeAt(h))<55296||l>56319||h+1===p||(u=c.charCodeAt(h+1))<56320||u>57343?o?c.charAt(h):l:o?c.slice(h,h+2):u-56320+(l-55296<<10)+65536}}},function(r,t,e){"use strict";var i=e(45),n=e(0),o=e(23),a=e(27),s=e(55),l=e(123),u=e(53),c=e(50),h=e(14)("iterator"),p=!([].keys&&"next"in[].keys()),g=function(){return this};r.exports=function(b,v,k,C,O,d,_){l(k,v,C);var m,y,x,S=function(j){if(!p&&j in I)return I[j];switch(j){case"keys":case"values":return function(){return new k(this,j)}}return function(){return new k(this,j)}},w=v+" Iterator",E=O=="values",L=!1,I=b.prototype,A=I[h]||I["@@iterator"]||O&&I[O],B=A||S(O),T=O?E?S("entries"):B:void 0,M=v=="Array"&&I.entries||A;if(M&&(x=c(M.call(new b)))!==Object.prototype&&x.next&&(u(x,w,!0),i||typeof x[h]=="function"||a(x,h,g)),E&&A&&A.name!=="values"&&(L=!0,B=function(){return A.call(this)}),i&&!_||!p&&!L&&I[h]||a(I,h,B),s[v]=B,s[w]=g,O)if(m={values:E?B:S("values"),keys:d?B:S("keys"),entries:T},_)for(y in m)y in I||o(I,y,m[y]);else n(n.P+n.F*(p||L),v,m);return m}},function(r,t,e){var i=e(96),n=e(38);r.exports=function(o,a,s){if(i(a))throw TypeError("String#"+s+" doesn't accept regex!");return String(n(o))}},function(r,t,e){var i=e(13),n=e(37),o=e(14)("match");r.exports=function(a){var s;return i(a)&&((s=a[o])!==void 0?!!s:n(a)=="RegExp")}},function(r,t,e){var i=e(14)("match");r.exports=function(n){var o=/./;try{"/./"[n](o)}catch(a){try{return o[i]=!1,!"/./"[n](o)}catch(s){}}return!0}},function(r,t,e){var i=e(55),n=e(14)("iterator"),o=Array.prototype;r.exports=function(a){return a!==void 0&&(i.Array===a||o[n]===a)}},function(r,t,e){"use strict";var i=e(19),n=e(43);r.exports=function(o,a,s){a in o?i.f(o,a,n(0,s)):o[a]=s}},function(r,t,e){var i=e(64),n=e(14)("iterator"),o=e(55);r.exports=e(17).getIteratorMethod=function(a){if(a!=null)return a[n]||a["@@iterator"]||o[i(a)]}},function(r,t,e){"use strict";var i=e(20),n=e(47),o=e(16);r.exports=function(a){for(var s=i(this),l=o(s.length),u=arguments.length,c=n(u>1?arguments[1]:void 0,l),h=u>2?arguments[2]:void 0,p=h===void 0?l:n(h,l);p>c;)s[c++]=a;return s}},function(r,t,e){"use strict";var i=e(51),n=e(128),o=e(55),a=e(28);r.exports=e(94)(Array,"Array",function(s,l){this._t=a(s),this._i=0,this._k=l},function(){var s=this._t,l=this._k,u=this._i++;return!s||u>=s.length?(this._t=void 0,n(1)):n(0,l=="keys"?u:l=="values"?s[u]:[u,s[u]])},"values"),o.Arguments=o.Array,i("keys"),i("values"),i("entries")},function(r,t,e){"use strict";var i,n,o=e(72),a=RegExp.prototype.exec,s=String.prototype.replace,l=a,u=(i=/a/,n=/b*/g,a.call(i,"a"),a.call(n,"a"),i.lastIndex!==0||n.lastIndex!==0),c=/()??/.exec("")[1]!==void 0;(u||c)&&(l=function(h){var p,g,b,v,k=this;return c&&(g=new RegExp("^"+k.source+"$(?!\\s)",o.call(k))),u&&(p=k.lastIndex),b=a.call(k,h),u&&b&&(k.lastIndex=k.global?b.index+b[0].length:p),c&&b&&b.length>1&&s.call(b[0],g,function(){for(v=1;v<arguments.length-2;v++)arguments[v]===void 0&&(b[v]=void 0)}),b}),r.exports=l},function(r,t,e){"use strict";var i=e(93)(!0);r.exports=function(n,o,a){return o+(a?i(n,o).length:1)}},function(r,t,e){var i,n,o,a=e(31),s=e(117),l=e(86),u=e(82),c=e(10),h=c.process,p=c.setImmediate,g=c.clearImmediate,b=c.MessageChannel,v=c.Dispatch,k=0,C={},O=function(){var _=+this;if(C.hasOwnProperty(_)){var m=C[_];delete C[_],m()}},d=function(_){O.call(_.data)};p&&g||(p=function(_){for(var m=[],y=1;arguments.length>y;)m.push(arguments[y++]);return C[++k]=function(){s(typeof _=="function"?_:Function(_),m)},i(k),k},g=function(_){delete C[_]},e(37)(h)=="process"?i=function(_){h.nextTick(a(O,_,1))}:v&&v.now?i=function(_){v.now(a(O,_,1))}:b?(o=(n=new b).port2,n.port1.onmessage=d,i=a(o.postMessage,o,1)):c.addEventListener&&typeof postMessage=="function"&&!c.importScripts?(i=function(_){c.postMessage(_+"","*")},c.addEventListener("message",d,!1)):i="onreadystatechange"in u("script")?function(_){l.appendChild(u("script")).onreadystatechange=function(){l.removeChild(this),O.call(_)}}:function(_){setTimeout(a(O,_,1),0)}),r.exports={set:p,clear:g}},function(r,t,e){"use strict";var i=e(10),n=e(18),o=e(45),a=e(78),s=e(27),l=e(58),u=e(11),c=e(57),h=e(33),p=e(16),g=e(136),b=e(49).f,v=e(19).f,k=e(101),C=e(53),O=i.ArrayBuffer,d=i.DataView,_=i.Math,m=i.RangeError,y=i.Infinity,x=O,S=_.abs,w=_.pow,E=_.floor,L=_.log,I=_.LN2,A=n?"_b":"buffer",B=n?"_l":"byteLength",T=n?"_o":"byteOffset";function M(fe,xe,Ne){var Be,Pe,Ze,tt=new Array(Ne),Xe=8*Ne-xe-1,Ke=(1<<Xe)-1,nt=Ke>>1,ot=xe===23?w(2,-24)-w(2,-77):0,ce=0,ve=fe<0||fe===0&&1/fe<0?1:0;for((fe=S(fe))!=fe||fe===y?(Pe=fe!=fe?1:0,Be=Ke):(Be=E(L(fe)/I),fe*(Ze=w(2,-Be))<1&&(Be--,Ze*=2),(fe+=Be+nt>=1?ot/Ze:ot*w(2,1-nt))*Ze>=2&&(Be++,Ze/=2),Be+nt>=Ke?(Pe=0,Be=Ke):Be+nt>=1?(Pe=(fe*Ze-1)*w(2,xe),Be+=nt):(Pe=fe*w(2,nt-1)*w(2,xe),Be=0));xe>=8;tt[ce++]=255&Pe,Pe/=256,xe-=8);for(Be=Be<<xe|Pe,Xe+=xe;Xe>0;tt[ce++]=255&Be,Be/=256,Xe-=8);return tt[--ce]|=128*ve,tt}function j(fe,xe,Ne){var Be,Pe=8*Ne-xe-1,Ze=(1<<Pe)-1,tt=Ze>>1,Xe=Pe-7,Ke=Ne-1,nt=fe[Ke--],ot=127&nt;for(nt>>=7;Xe>0;ot=256*ot+fe[Ke],Ke--,Xe-=8);for(Be=ot&(1<<-Xe)-1,ot>>=-Xe,Xe+=xe;Xe>0;Be=256*Be+fe[Ke],Ke--,Xe-=8);if(ot===0)ot=1-tt;else{if(ot===Ze)return Be?NaN:nt?-y:y;Be+=w(2,xe),ot-=tt}return(nt?-1:1)*Be*w(2,ot-xe)}function J(fe){return fe[3]<<24|fe[2]<<16|fe[1]<<8|fe[0]}function U(fe){return[255&fe]}function H(fe){return[255&fe,fe>>8&255]}function te(fe){return[255&fe,fe>>8&255,fe>>16&255,fe>>24&255]}function ae(fe){return M(fe,52,8)}function W(fe){return M(fe,23,4)}function Y(fe,xe,Ne){v(fe.prototype,xe,{get:function(){return this[Ne]}})}function re(fe,xe,Ne,Be){var Pe=g(+Ne);if(Pe+xe>fe[B])throw m("Wrong index!");var Ze=fe[A]._b,tt=Pe+fe[T],Xe=Ze.slice(tt,tt+xe);return Be?Xe:Xe.reverse()}function ie(fe,xe,Ne,Be,Pe,Ze){var tt=g(+Ne);if(tt+xe>fe[B])throw m("Wrong index!");for(var Xe=fe[A]._b,Ke=tt+fe[T],nt=Be(+Pe),ot=0;ot<xe;ot++)Xe[Ke+ot]=nt[Ze?ot:xe-ot-1]}if(a.ABV){if(!u(function(){O(1)})||!u(function(){new O(-1)})||u(function(){return new O,new O(1.5),new O(NaN),O.name!="ArrayBuffer"})){for(var Q,ee=(O=function(fe){return c(this,O),new x(g(fe))}).prototype=x.prototype,pe=b(x),be=0;pe.length>be;)(Q=pe[be++])in O||s(O,Q,x[Q]);o||(ee.constructor=O)}var we=new d(new O(2)),Le=d.prototype.setInt8;we.setInt8(0,2147483648),we.setInt8(1,2147483649),!we.getInt8(0)&&we.getInt8(1)||l(d.prototype,{setInt8:function(fe,xe){Le.call(this,fe,xe<<24>>24)},setUint8:function(fe,xe){Le.call(this,fe,xe<<24>>24)}},!0)}else O=function(fe){c(this,O,"ArrayBuffer");var xe=g(fe);this._b=k.call(new Array(xe),0),this[B]=xe},d=function(fe,xe,Ne){c(this,d,"DataView"),c(fe,O,"DataView");var Be=fe[B],Pe=h(xe);if(Pe<0||Pe>Be)throw m("Wrong offset!");if(Pe+(Ne=Ne===void 0?Be-Pe:p(Ne))>Be)throw m("Wrong length!");this[A]=fe,this[T]=Pe,this[B]=Ne},n&&(Y(O,"byteLength","_l"),Y(d,"buffer","_b"),Y(d,"byteLength","_l"),Y(d,"byteOffset","_o")),l(d.prototype,{getInt8:function(fe){return re(this,1,fe)[0]<<24>>24},getUint8:function(fe){return re(this,1,fe)[0]},getInt16:function(fe){var xe=re(this,2,fe,arguments[1]);return(xe[1]<<8|xe[0])<<16>>16},getUint16:function(fe){var xe=re(this,2,fe,arguments[1]);return xe[1]<<8|xe[0]},getInt32:function(fe){return J(re(this,4,fe,arguments[1]))},getUint32:function(fe){return J(re(this,4,fe,arguments[1]))>>>0},getFloat32:function(fe){return j(re(this,4,fe,arguments[1]),23,4)},getFloat64:function(fe){return j(re(this,8,fe,arguments[1]),52,8)},setInt8:function(fe,xe){ie(this,1,fe,U,xe)},setUint8:function(fe,xe){ie(this,1,fe,U,xe)},setInt16:function(fe,xe){ie(this,2,fe,H,xe,arguments[2])},setUint16:function(fe,xe){ie(this,2,fe,H,xe,arguments[2])},setInt32:function(fe,xe){ie(this,4,fe,te,xe,arguments[2])},setUint32:function(fe,xe){ie(this,4,fe,te,xe,arguments[2])},setFloat32:function(fe,xe){ie(this,4,fe,W,xe,arguments[2])},setFloat64:function(fe,xe){ie(this,8,fe,ae,xe,arguments[2])}});C(O,"ArrayBuffer"),C(d,"DataView"),s(d.prototype,a.VIEW,!0),t.ArrayBuffer=O,t.DataView=d},function(r,t){function e(i,n){return r.exports=e=Object.setPrototypeOf||function(o,a){return o.__proto__=a,o},e(i,n)}r.exports=e},function(r,t,e){var i,n,o;n=[t,e(42),e(2),e(3),e(377)],(o=typeof(i=function(a,s,l,u,c){"use strict";var h=e(1);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,s=h(s),l=h(l),u=h(u),c=h(c);var p=function(){function b(){(0,l.default)(this,b),this.registeredShortcuts=new Map}return(0,u.default)(b,[{key:"add",value:function(v){if(this.findShortcut(v.on,v.name))throw Error("Shortcut ".concat(v.name," is already registered for ").concat(v.on,". Please remove it before add a new handler."));var k=new c.default({name:v.name,on:v.on,callback:v.handler}),C=this.registeredShortcuts.get(v.on)||[];this.registeredShortcuts.set(v.on,[].concat((0,s.default)(C),[k]))}},{key:"remove",value:function(v,k){var C=this.findShortcut(v,k);if(C){C.remove();var O=this.registeredShortcuts.get(v);this.registeredShortcuts.set(v,O.filter(function(d){return d!==C}))}}},{key:"findShortcut",value:function(v,k){return(this.registeredShortcuts.get(v)||[]).find(function(C){return C.name===k})}}]),b}();p.displayName="Shortcuts";var g=new p;a.default=g,r.exports=t.default})=="function"?i.apply(t,n):i)===void 0||(r.exports=o)},function(r,t,e){r.exports=!e(18)&&!e(11)(function(){return Object.defineProperty(e(82)("div"),"a",{get:function(){return 7}}).a!=7})},function(r,t,e){var i=e(10),n=e(17),o=e(45),a=e(83),s=e(19).f;r.exports=function(l){var u=n.Symbol||(n.Symbol=o?{}:i.Symbol||{});l.charAt(0)=="_"||l in u||s(u,l,{value:a.f(l)})}},function(r,t,e){var i=e(26),n=e(28),o=e(68)(!1),a=e(84)("IE_PROTO");r.exports=function(s,l){var u,c=n(s),h=0,p=[];for(u in c)u!=a&&i(c,u)&&p.push(u);for(;l.length>h;)i(c,u=l[h++])&&(~o(p,u)||p.push(u));return p}},function(r,t,e){var i=e(19),n=e(12),o=e(46);r.exports=e(18)?Object.defineProperties:function(a,s){n(a);for(var l,u=o(s),c=u.length,h=0;c>h;)i.f(a,l=u[h++],s[l]);return a}},function(r,t,e){var i=e(28),n=e(49).f,o={}.toString,a=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];r.exports.f=function(s){return a&&o.call(s)=="[object Window]"?function(l){try{return n(l)}catch(u){return a.slice()}}(s):n(i(s))}},function(r,t,e){"use strict";var i=e(18),n=e(46),o=e(69),a=e(63),s=e(20),l=e(62),u=Object.assign;r.exports=!u||e(11)(function(){var c={},h={},p=Symbol(),g="abcdefghijklmnopqrst";return c[p]=7,g.split("").forEach(function(b){h[b]=b}),u({},c)[p]!=7||Object.keys(u({},h)).join("")!=g})?function(c,h){for(var p=s(c),g=arguments.length,b=1,v=o.f,k=a.f;g>b;)for(var C,O=l(arguments[b++]),d=v?n(O).concat(v(O)):n(O),_=d.length,m=0;_>m;)C=d[m++],i&&!k.call(O,C)||(p[C]=O[C]);return p}:u},function(r,t){r.exports=Object.is||function(e,i){return e===i?e!==0||1/e==1/i:e!=e&&i!=i}},function(r,t,e){"use strict";var i=e(32),n=e(13),o=e(117),a=[].slice,s={},l=function(u,c,h){if(!(c in s)){for(var p=[],g=0;g<c;g++)p[g]="a["+g+"]";s[c]=Function("F,a","return new F("+p.join(",")+")")}return s[c](u,h)};r.exports=Function.bind||function(u){var c=i(this),h=a.call(arguments,1),p=function(){var g=h.concat(a.call(arguments));return this instanceof p?l(c,g.length,g):o(c,g,u)};return n(c.prototype)&&(p.prototype=c.prototype),p}},function(r,t){r.exports=function(e,i,n){var o=n===void 0;switch(i.length){case 0:return o?e():e.call(n);case 1:return o?e(i[0]):e.call(n,i[0]);case 2:return o?e(i[0],i[1]):e.call(n,i[0],i[1]);case 3:return o?e(i[0],i[1],i[2]):e.call(n,i[0],i[1],i[2]);case 4:return o?e(i[0],i[1],i[2],i[3]):e.call(n,i[0],i[1],i[2],i[3])}return e.apply(n,i)}},function(r,t,e){var i=e(10).parseInt,n=e(54).trim,o=e(88),a=/^[-+]?0[xX]/;r.exports=i(o+"08")!==8||i(o+"0x16")!==22?function(s,l){var u=n(String(s),3);return i(u,l>>>0||(a.test(u)?16:10))}:i},function(r,t,e){var i=e(10).parseFloat,n=e(54).trim;r.exports=1/i(e(88)+"-0")!=-1/0?function(o){var a=n(String(o),3),s=i(a);return s===0&&a.charAt(0)=="-"?-0:s}:i},function(r,t,e){var i=e(37);r.exports=function(n,o){if(typeof n!="number"&&i(n)!="Number")throw TypeError(o);return+n}},function(r,t,e){var i=e(13),n=Math.floor;r.exports=function(o){return!i(o)&&isFinite(o)&&n(o)===o}},function(r,t){r.exports=Math.log1p||function(e){return(e=+e)>-1e-8&&e<1e-8?e-e*e/2:Math.log(1+e)}},function(r,t,e){"use strict";var i=e(48),n=e(43),o=e(53),a={};e(27)(a,e(14)("iterator"),function(){return this}),r.exports=function(s,l,u){s.prototype=i(a,{next:n(1,u)}),o(s,l+" Iterator")}},function(r,t,e){var i=e(12);r.exports=function(n,o,a,s){try{return s?o(i(a)[0],a[1]):o(a)}catch(u){var l=n.return;throw l!==void 0&&i(l.call(n)),u}}},function(r,t,e){var i=e(278);r.exports=function(n,o){return new(i(n))(o)}},function(r,t,e){var i=e(32),n=e(20),o=e(62),a=e(16);r.exports=function(s,l,u,c,h){i(l);var p=n(s),g=o(p),b=a(p.length),v=h?b-1:0,k=h?-1:1;if(u<2)for(;;){if(v in g){c=g[v],v+=k;break}if(v+=k,h?v<0:b<=v)throw TypeError("Reduce of empty array with no initial value")}for(;h?v>=0:b>v;v+=k)v in g&&(c=l(c,g[v],v,p));return c}},function(r,t,e){"use strict";var i=e(20),n=e(47),o=e(16);r.exports=[].copyWithin||function(a,s){var l=i(this),u=o(l.length),c=n(a,u),h=n(s,u),p=arguments.length>2?arguments[2]:void 0,g=Math.min((p===void 0?u:n(p,u))-h,u-c),b=1;for(h<c&&c<h+g&&(b=-1,h+=g-1,c+=g-1);g-- >0;)h in l?l[c]=l[h]:delete l[c],c+=b,h+=b;return l}},function(r,t){r.exports=function(e,i){return{value:i,done:!!e}}},function(r,t,e){"use strict";var i=e(103);e(0)({target:"RegExp",proto:!0,forced:i!==/./.exec},{exec:i})},function(r,t,e){e(18)&&/./g.flags!="g"&&e(19).f(RegExp.prototype,"flags",{configurable:!0,get:e(72)})},function(r,t,e){"use strict";var i,n,o,a,s=e(45),l=e(10),u=e(31),c=e(64),h=e(0),p=e(13),g=e(32),b=e(57),v=e(75),k=e(65),C=e(105).set,O=e(298)(),d=e(132),_=e(299),m=e(76),y=e(133),x=l.TypeError,S=l.process,w=S&&S.versions,E=w&&w.v8||"",L=l.Promise,I=c(S)=="process",A=function(){},B=n=d.f,T=!!function(){try{var W=L.resolve(1),Y=(W.constructor={})[e(14)("species")]=function(re){re(A,A)};return(I||typeof PromiseRejectionEvent=="function")&&W.then(A)instanceof Y&&E.indexOf("6.6")!==0&&m.indexOf("Chrome/66")===-1}catch(re){}}(),M=function(W){var Y;return!(!p(W)||typeof(Y=W.then)!="function")&&Y},j=function(W,Y){if(!W._n){W._n=!0;var re=W._c;O(function(){for(var ie=W._v,Q=W._s==1,ee=0,pe=function(be){var we,Le,fe,xe=Q?be.ok:be.fail,Ne=be.resolve,Be=be.reject,Pe=be.domain;try{xe?(Q||(W._h==2&&H(W),W._h=1),xe===!0?we=ie:(Pe&&Pe.enter(),we=xe(ie),Pe&&(Pe.exit(),fe=!0)),we===be.promise?Be(x("Promise-chain cycle")):(Le=M(we))?Le.call(we,Ne,Be):Ne(we)):Be(ie)}catch(Ze){Pe&&!fe&&Pe.exit(),Be(Ze)}};re.length>ee;)pe(re[ee++]);W._c=[],W._n=!1,Y&&!W._h&&J(W)})}},J=function(W){C.call(l,function(){var Y,re,ie,Q=W._v,ee=U(W);if(ee&&(Y=_(function(){I?S.emit("unhandledRejection",Q,W):(re=l.onunhandledrejection)?re({promise:W,reason:Q}):(ie=l.console)&&ie.error&&ie.error("Unhandled promise rejection",Q)}),W._h=I||U(W)?2:1),W._a=void 0,ee&&Y.e)throw Y.v})},U=function(W){return W._h!==1&&(W._a||W._c).length===0},H=function(W){C.call(l,function(){var Y;I?S.emit("rejectionHandled",W):(Y=l.onrejectionhandled)&&Y({promise:W,reason:W._v})})},te=function(W){var Y=this;Y._d||(Y._d=!0,(Y=Y._w||Y)._v=W,Y._s=2,Y._a||(Y._a=Y._c.slice()),j(Y,!0))},ae=function(W){var Y,re=this;if(!re._d){re._d=!0,re=re._w||re;try{if(re===W)throw x("Promise can't be resolved itself");(Y=M(W))?O(function(){var ie={_w:re,_d:!1};try{Y.call(W,u(ae,ie,1),u(te,ie,1))}catch(Q){te.call(ie,Q)}}):(re._v=W,re._s=1,j(re,!1))}catch(ie){te.call({_w:re,_d:!1},ie)}}};T||(L=function(W){b(this,L,"Promise","_h"),g(W),i.call(this);try{W(u(ae,this,1),u(te,this,1))}catch(Y){te.call(this,Y)}},(i=function(W){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=e(58)(L.prototype,{then:function(W,Y){var re=B(k(this,L));return re.ok=typeof W!="function"||W,re.fail=typeof Y=="function"&&Y,re.domain=I?S.domain:void 0,this._c.push(re),this._a&&this._a.push(re),this._s&&j(this,!1),re.promise},catch:function(W){return this.then(void 0,W)}}),o=function(){var W=new i;this.promise=W,this.resolve=u(ae,W,1),this.reject=u(te,W,1)},d.f=B=function(W){return W===L||W===a?new o(W):n(W)}),h(h.G+h.W+h.F*!T,{Promise:L}),e(53)(L,"Promise"),e(56)("Promise"),a=e(17).Promise,h(h.S+h.F*!T,"Promise",{reject:function(W){var Y=B(this);return(0,Y.reject)(W),Y.promise}}),h(h.S+h.F*(s||!T),"Promise",{resolve:function(W){return y(s&&this===a?L:this,W)}}),h(h.S+h.F*!(T&&e(71)(function(W){L.all(W).catch(A)})),"Promise",{all:function(W){var Y=this,re=B(Y),ie=re.resolve,Q=re.reject,ee=_(function(){var pe=[],be=0,we=1;v(W,!1,function(Le){var fe=be++,xe=!1;pe.push(void 0),we++,Y.resolve(Le).then(function(Ne){xe||(xe=!0,pe[fe]=Ne,--we||ie(pe))},Q)}),--we||ie(pe)});return ee.e&&Q(ee.v),re.promise},race:function(W){var Y=this,re=B(Y),ie=re.reject,Q=_(function(){v(W,!1,function(ee){Y.resolve(ee).then(re.resolve,ie)})});return Q.e&&ie(Q.v),re.promise}})},function(r,t,e){"use strict";var i=e(32);function n(o){var a,s;this.promise=new o(function(l,u){if(a!==void 0||s!==void 0)throw TypeError("Bad Promise constructor");a=l,s=u}),this.resolve=i(a),this.reject=i(s)}r.exports.f=function(o){return new n(o)}},function(r,t,e){var i=e(12),n=e(13),o=e(132);r.exports=function(a,s){if(i(a),n(s)&&s.constructor===a)return s;var l=o.f(a);return(0,l.resolve)(s),l.promise}},function(r,t,e){"use strict";var i=e(19).f,n=e(48),o=e(58),a=e(31),s=e(57),l=e(75),u=e(94),c=e(128),h=e(56),p=e(18),g=e(41).fastKey,b=e(52),v=p?"_s":"size",k=function(C,O){var d,_=g(O);if(_!=="F")return C._i[_];for(d=C._f;d;d=d.n)if(d.k==O)return d};r.exports={getConstructor:function(C,O,d,_){var m=C(function(y,x){s(y,m,O,"_i"),y._t=O,y._i=n(null),y._f=void 0,y._l=void 0,y[v]=0,x!=null&&l(x,d,y[_],y)});return o(m.prototype,{clear:function(){for(var y=b(this,O),x=y._i,S=y._f;S;S=S.n)S.r=!0,S.p&&(S.p=S.p.n=void 0),delete x[S.i];y._f=y._l=void 0,y[v]=0},delete:function(y){var x=b(this,O),S=k(x,y);if(S){var w=S.n,E=S.p;delete x._i[S.i],S.r=!0,E&&(E.n=w),w&&(w.p=E),x._f==S&&(x._f=w),x._l==S&&(x._l=E),x[v]--}return!!S},forEach:function(y){b(this,O);for(var x,S=a(y,arguments.length>1?arguments[1]:void 0,3);x=x?x.n:this._f;)for(S(x.v,x.k,this);x&&x.r;)x=x.p},has:function(y){return!!k(b(this,O),y)}}),p&&i(m.prototype,"size",{get:function(){return b(this,O)[v]}}),m},def:function(C,O,d){var _,m,y=k(C,O);return y?y.v=d:(C._l=y={i:m=g(O,!0),k:O,v:d,p:_=C._l,n:void 0,r:!1},C._f||(C._f=y),_&&(_.n=y),C[v]++,m!=="F"&&(C._i[m]=y)),C},getEntry:k,setStrong:function(C,O,d){u(C,O,function(_,m){this._t=b(_,O),this._k=m,this._l=void 0},function(){for(var _=this._k,m=this._l;m&&m.r;)m=m.p;return this._t&&(this._l=m=m?m.n:this._t._f)?c(0,_=="keys"?m.k:_=="values"?m.v:[m.k,m.v]):(this._t=void 0,c(1))},d?"entries":"values",!d,!0),h(O)}}},function(r,t,e){"use strict";var i=e(58),n=e(41).getWeak,o=e(12),a=e(13),s=e(57),l=e(75),u=e(36),c=e(26),h=e(52),p=u(5),g=u(6),b=0,v=function(O){return O._l||(O._l=new k)},k=function(){this.a=[]},C=function(O,d){return p(O.a,function(_){return _[0]===d})};k.prototype={get:function(O){var d=C(this,O);if(d)return d[1]},has:function(O){return!!C(this,O)},set:function(O,d){var _=C(this,O);_?_[1]=d:this.a.push([O,d])},delete:function(O){var d=g(this.a,function(_){return _[0]===O});return~d&&this.a.splice(d,1),!!~d}},r.exports={getConstructor:function(O,d,_,m){var y=O(function(x,S){s(x,y,d,"_i"),x._t=d,x._i=b++,x._l=void 0,S!=null&&l(S,_,x[m],x)});return i(y.prototype,{delete:function(x){if(!a(x))return!1;var S=n(x);return S===!0?v(h(this,d)).delete(x):S&&c(S,this._i)&&delete S[this._i]},has:function(x){if(!a(x))return!1;var S=n(x);return S===!0?v(h(this,d)).has(x):S&&c(S,this._i)}}),y},def:function(O,d,_){var m=n(o(d),!0);return m===!0?v(O).set(d,_):m[O._i]=_,O},ufstore:v}},function(r,t,e){var i=e(33),n=e(16);r.exports=function(o){if(o===void 0)return 0;var a=i(o),s=n(a);if(a!==s)throw RangeError("Wrong length!");return s}},function(r,t,e){var i=e(49),n=e(69),o=e(12),a=e(10).Reflect;r.exports=a&&a.ownKeys||function(s){var l=i.f(o(s)),u=n.f;return u?l.concat(u(s)):l}},function(r,t,e){var i=e(16),n=e(90),o=e(38);r.exports=function(a,s,l,u){var c=String(o(a)),h=c.length,p=l===void 0?" ":String(l),g=i(s);if(g<=h||p=="")return c;var b=g-h,v=n.call(p,Math.ceil(b/p.length));return v.length>b&&(v=v.slice(0,b)),u?v+c:c+v}},function(r,t,e){var i=e(18),n=e(46),o=e(28),a=e(63).f;r.exports=function(s){return function(l){for(var u,c=o(l),h=n(c),p=h.length,g=0,b=[];p>g;)u=h[g++],i&&!a.call(c,u)||b.push(s?[u,c[u]]:c[u]);return b}}},function(r,t,e){var i=function(n){"use strict";var o=Object.prototype,a=o.hasOwnProperty,s=typeof Symbol=="function"?Symbol:{},l=s.iterator||"@@iterator",u=s.asyncIterator||"@@asyncIterator",c=s.toStringTag||"@@toStringTag";function h(A,B,T,M){var j=B&&B.prototype instanceof b?B:b,J=Object.create(j.prototype),U=new E(M||[]);return J._invoke=function(H,te,ae){var W="suspendedStart";return function(Y,re){if(W==="executing")throw new Error("Generator is already running");if(W==="completed"){if(Y==="throw")throw re;return I()}for(ae.method=Y,ae.arg=re;;){var ie=ae.delegate;if(ie){var Q=x(ie,ae);if(Q){if(Q===g)continue;return Q}}if(ae.method==="next")ae.sent=ae._sent=ae.arg;else if(ae.method==="throw"){if(W==="suspendedStart")throw W="completed",ae.arg;ae.dispatchException(ae.arg)}else ae.method==="return"&&ae.abrupt("return",ae.arg);W="executing";var ee=p(H,te,ae);if(ee.type==="normal"){if(W=ae.done?"completed":"suspendedYield",ee.arg===g)continue;return{value:ee.arg,done:ae.done}}ee.type==="throw"&&(W="completed",ae.method="throw",ae.arg=ee.arg)}}}(A,T,U),J}function p(A,B,T){try{return{type:"normal",arg:A.call(B,T)}}catch(M){return{type:"throw",arg:M}}}n.wrap=h;var g={};function b(){}function v(){}function k(){}var C={};C[l]=function(){return this};var O=Object.getPrototypeOf,d=O&&O(O(L([])));d&&d!==o&&a.call(d,l)&&(C=d);var _=k.prototype=b.prototype=Object.create(C);function m(A){["next","throw","return"].forEach(function(B){A[B]=function(T){return this._invoke(B,T)}})}function y(A,B){var T;this._invoke=function(M,j){function J(){return new B(function(U,H){(function te(ae,W,Y,re){var ie=p(A[ae],A,W);if(ie.type!=="throw"){var Q=ie.arg,ee=Q.value;return ee&&typeof ee=="object"&&a.call(ee,"__await")?B.resolve(ee.__await).then(function(pe){te("next",pe,Y,re)},function(pe){te("throw",pe,Y,re)}):B.resolve(ee).then(function(pe){Q.value=pe,Y(Q)},function(pe){return te("throw",pe,Y,re)})}re(ie.arg)})(M,j,U,H)})}return T=T?T.then(J,J):J()}}function x(A,B){var T=A.iterator[B.method];if(T===void 0){if(B.delegate=null,B.method==="throw"){if(A.iterator.return&&(B.method="return",B.arg=void 0,x(A,B),B.method==="throw"))return g;B.method="throw",B.arg=new TypeError("The iterator does not provide a 'throw' method")}return g}var M=p(T,A.iterator,B.arg);if(M.type==="throw")return B.method="throw",B.arg=M.arg,B.delegate=null,g;var j=M.arg;return j?j.done?(B[A.resultName]=j.value,B.next=A.nextLoc,B.method!=="return"&&(B.method="next",B.arg=void 0),B.delegate=null,g):j:(B.method="throw",B.arg=new TypeError("iterator result is not an object"),B.delegate=null,g)}function S(A){var B={tryLoc:A[0]};1 in A&&(B.catchLoc=A[1]),2 in A&&(B.finallyLoc=A[2],B.afterLoc=A[3]),this.tryEntries.push(B)}function w(A){var B=A.completion||{};B.type="normal",delete B.arg,A.completion=B}function E(A){this.tryEntries=[{tryLoc:"root"}],A.forEach(S,this),this.reset(!0)}function L(A){if(A){var B=A[l];if(B)return B.call(A);if(typeof A.next=="function")return A;if(!isNaN(A.length)){var T=-1,M=function j(){for(;++T<A.length;)if(a.call(A,T))return j.value=A[T],j.done=!1,j;return j.value=void 0,j.done=!0,j};return M.next=M}}return{next:I}}function I(){return{value:void 0,done:!0}}return v.prototype=_.constructor=k,k.constructor=v,k[c]=v.displayName="GeneratorFunction",n.isGeneratorFunction=function(A){var B=typeof A=="function"&&A.constructor;return!!B&&(B===v||(B.displayName||B.name)==="GeneratorFunction")},n.mark=function(A){return Object.setPrototypeOf?Object.setPrototypeOf(A,k):(A.__proto__=k,c in A||(A[c]="GeneratorFunction")),A.prototype=Object.create(_),A},n.awrap=function(A){return{__await:A}},m(y.prototype),y.prototype[u]=function(){return this},n.AsyncIterator=y,n.async=function(A,B,T,M,j){j===void 0&&(j=Promise);var J=new y(h(A,B,T,M),j);return n.isGeneratorFunction(B)?J:J.next().then(function(U){return U.done?U.value:J.next()})},m(_),_[c]="Generator",_[l]=function(){return this},_.toString=function(){return"[object Generator]"},n.keys=function(A){var B=[];for(var T in A)B.push(T);return B.reverse(),function M(){for(;B.length;){var j=B.pop();if(j in A)return M.value=j,M.done=!1,M}return M.done=!0,M}},n.values=L,E.prototype={constructor:E,reset:function(A){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(w),!A)for(var B in this)B.charAt(0)==="t"&&a.call(this,B)&&!isNaN(+B.slice(1))&&(this[B]=void 0)},stop:function(){this.done=!0;var A=this.tryEntries[0].completion;if(A.type==="throw")throw A.arg;return this.rval},dispatchException:function(A){if(this.done)throw A;var B=this;function T(te,ae){return J.type="throw",J.arg=A,B.next=te,ae&&(B.method="next",B.arg=void 0),!!ae}for(var M=this.tryEntries.length-1;M>=0;--M){var j=this.tryEntries[M],J=j.completion;if(j.tryLoc==="root")return T("end");if(j.tryLoc<=this.prev){var U=a.call(j,"catchLoc"),H=a.call(j,"finallyLoc");if(U&&H){if(this.prev<j.catchLoc)return T(j.catchLoc,!0);if(this.prev<j.finallyLoc)return T(j.finallyLoc)}else if(U){if(this.prev<j.catchLoc)return T(j.catchLoc,!0)}else{if(!H)throw new Error("try statement without catch or finally");if(this.prev<j.finallyLoc)return T(j.finallyLoc)}}}},abrupt:function(A,B){for(var T=this.tryEntries.length-1;T>=0;--T){var M=this.tryEntries[T];if(M.tryLoc<=this.prev&&a.call(M,"finallyLoc")&&this.prev<M.finallyLoc){var j=M;break}}j&&(A==="break"||A==="continue")&&j.tryLoc<=B&&B<=j.finallyLoc&&(j=null);var J=j?j.completion:{};return J.type=A,J.arg=B,j?(this.method="next",this.next=j.finallyLoc,g):this.complete(J)},complete:function(A,B){if(A.type==="throw")throw A.arg;return A.type==="break"||A.type==="continue"?this.next=A.arg:A.type==="return"?(this.rval=this.arg=A.arg,this.method="return",this.next="end"):A.type==="normal"&&B&&(this.next=B),g},finish:function(A){for(var B=this.tryEntries.length-1;B>=0;--B){var T=this.tryEntries[B];if(T.finallyLoc===A)return this.complete(T.completion,T.afterLoc),w(T),g}},catch:function(A){for(var B=this.tryEntries.length-1;B>=0;--B){var T=this.tryEntries[B];if(T.tryLoc===A){var M=T.completion;if(M.type==="throw"){var j=M.arg;w(T)}return j}}throw new Error("illegal catch attempt")},delegateYield:function(A,B,T){return this.delegate={iterator:L(A),resultName:B,nextLoc:T},this.method==="next"&&(this.arg=void 0),g}},n}(r.exports);try{regeneratorRuntime=i}catch(n){Function("r","regeneratorRuntime = r")(i)}},function(r,t,e){var i=e(142);r.exports=function(n,o){if(n){if(typeof n=="string")return i(n,o);var a=Object.prototype.toString.call(n).slice(8,-1);return a==="Object"&&n.constructor&&(a=n.constructor.name),a==="Map"||a==="Set"?Array.from(a):a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?i(n,o):void 0}}},function(r,t){r.exports=function(e,i){(i==null||i>e.length)&&(i=e.length);for(var n=0,o=new Array(i);n<i;n++)o[n]=e[n];return o}},function(r,t){function e(i){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?r.exports=e=function(n){return typeof n}:r.exports=e=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},e(i)}r.exports=e},function(r){r.exports=JSON.parse('{"ui":{"blockTunes":{"toggler":{"Click to tune":"","or drag to move":""}},"inlineToolbar":{"converter":{"Convert to":""}},"toolbar":{"toolbox":{"Add":""}}},"toolNames":{"Text":"","Link":"","Bold":"","Italic":""},"tools":{"link":{"Add a link":""},"stub":{"The block can not be displayed correctly.":""}},"blockTunes":{"delete":{"Delete":""},"moveUp":{"Move up":""},"moveDown":{"Move down":""}}}')},function(r,t,e){var i,n,o;n=[t,e(2),e(5),e(6),e(4),e(146)],(o=typeof(i=function(a,s,l,u,c,h){"use strict";var p=e(1);function g(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(v){return!1}}Object.defineProperty(a,"__esModule",{value:!0}),a.CriticalError=void 0,s=p(s),l=p(l),u=p(u),c=p(c);var b=function(v){(0,l.default)(O,v);var k,C=(k=O,function(){var d,_=(0,c.default)(k);if(g()){var m=(0,c.default)(this).constructor;d=Reflect.construct(_,arguments,m)}else d=_.apply(this,arguments);return(0,u.default)(this,d)});function O(){return(0,s.default)(this,O),C.apply(this,arguments)}return O}((0,(h=p(h)).default)(Error));a.CriticalError=b,b.displayName="CriticalError"})=="function"?i.apply(t,n):i)===void 0||(r.exports=o)},function(r,t,e){var i=e(4),n=e(107),o=e(369),a=e(370);function s(l){var u=typeof Map=="function"?new Map:void 0;return r.exports=s=function(c){if(c===null||!o(c))return c;if(typeof c!="function")throw new TypeError("Super expression must either be null or a function");if(u!==void 0){if(u.has(c))return u.get(c);u.set(c,h)}function h(){return a(c,arguments,i(this).constructor)}return h.prototype=Object.create(c.prototype,{constructor:{value:h,enumerable:!1,writable:!0,configurable:!0}}),n(h,c)},s(l)}r.exports=s},function(r,t,e){var i,n,o;n=[t,e(2),e(3),e(5),e(6),e(4),e(8),e(148),e(7)],(o=typeof(i=function(a,s,l,u,c,h,p,g,b){"use strict";var v=e(9),k=e(1);function C(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,s=k(s),l=k(l),u=k(u),c=k(c),h=k(h),p=v(p),g=k(g);var O=function(d){(0,u.default)(y,d);var _,m=(_=y,function(){var x,S=(0,h.default)(_);if(C()){var w=(0,h.default)(this).constructor;x=Reflect.construct(S,arguments,w)}else x=S.apply(this,arguments);return(0,c.default)(this,x)});function y(){var x;return(0,s.default)(this,y),(x=m.apply(this,arguments)).insert=function(){var S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:x.config.defaultBlock,w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},E=(arguments.length>2&&arguments[2]!==void 0&&arguments[2],arguments.length>3?arguments[3]:void 0),L=arguments.length>4?arguments[4]:void 0;x.Editor.BlockManager.insert({tool:S,data:w,index:E,needToFocus:L})},x}return(0,l.default)(y,[{key:"getBlocksCount",value:function(){return this.Editor.BlockManager.blocks.length}},{key:"getCurrentBlockIndex",value:function(){return this.Editor.BlockManager.currentBlockIndex}},{key:"getBlockByIndex",value:function(x){var S=this.Editor.BlockManager.getBlockByIndex(x);if(S!==void 0)return new g.default(S);p.logLabeled("There is no block at index `"+x+"`","warn")}},{key:"swap",value:function(x,S){p.log("`blocks.swap()` method is deprecated and will be removed in the next major release. Use `block.move()` method instead","info"),this.Editor.BlockManager.swap(x,S),this.Editor.Toolbar.move(!1)}},{key:"move",value:function(x,S){this.Editor.BlockManager.move(x,S),this.Editor.Toolbar.move(!1)}},{key:"delete",value:function(x){try{this.Editor.BlockManager.removeBlock(x)}catch(S){return void p.logLabeled(S,"warn")}this.Editor.BlockManager.blocks.length===0&&this.Editor.BlockManager.insert(),this.Editor.BlockManager.currentBlock&&this.Editor.Caret.setToBlock(this.Editor.BlockManager.currentBlock,this.Editor.Caret.positions.END),this.Editor.Toolbar.close()}},{key:"clear",value:function(){this.Editor.BlockManager.clear(!0),this.Editor.InlineToolbar.close()}},{key:"render",value:function(x){return this.Editor.BlockManager.clear(),this.Editor.Renderer.render(x.blocks)}},{key:"renderFromHTML",value:function(x){return this.Editor.BlockManager.clear(),this.Editor.Paste.processText(x,!0)}},{key:"stretchBlock",value:function(x){var S=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];p.deprecationAssert(!0,"blocks.stretchBlock()","BlockAPI");var w=this.Editor.BlockManager.getBlockByIndex(x);w&&(w.stretched=S)}},{key:"insertNewBlock",value:function(){p.log("Method blocks.insertNewBlock() is deprecated and it will be removed in the next major release. Use blocks.insert() instead.","warn"),this.insert()}},{key:"methods",get:function(){var x=this;return{clear:function(){return x.clear()},render:function(S){return x.render(S)},renderFromHTML:function(S){return x.renderFromHTML(S)},delete:function(S){return x.delete(S)},swap:function(S,w){return x.swap(S,w)},move:function(S,w){return x.move(S,w)},getBlockByIndex:function(S){return x.getBlockByIndex(S)},getCurrentBlockIndex:function(){return x.getCurrentBlockIndex()},getBlocksCount:function(){return x.getBlocksCount()},stretchBlock:function(S){var w=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];return x.stretchBlock(S,w)},insertNewBlock:function(){return x.insertNewBlock()},insert:this.insert}}}]),y}((b=k(b)).default);a.default=O,O.displayName="BlocksAPI",r.exports=t.default})=="function"?i.apply(t,n):i)===void 0||(r.exports=o)},function(r,t,e){var i,n,o;n=[t],(o=typeof(i=function(a){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var s=function(l){var u={get name(){return l.name},get config(){return l.config},get holder(){return l.holder},get isEmpty(){return l.isEmpty},get selected(){return l.selected},set stretched(c){l.stretched=c},get stretched(){return l.stretched},call:function(c,h){return l.call(c,h)},save:function(){return l.save()},validate:function(c){return l.validate(c)}};Object.setPrototypeOf(this,u)};a.default=s,r.exports=t.default})=="function"?i.apply(t,n):i)===void 0||(r.exports=o)},function(r,t,e){var i,n,o;n=[t,e(2),e(3),e(5),e(6),e(4),e(7)],(o=typeof(i=function(a,s,l,u,c,h,p){"use strict";var g=e(1);function b(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(k){return!1}}Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,s=g(s),l=g(l),u=g(u),c=g(c),h=g(h);var v=function(k){(0,u.default)(d,k);var C,O=(C=d,function(){var _,m=(0,h.default)(C);if(b()){var y=(0,h.default)(this).constructor;_=Reflect.construct(m,arguments,y)}else _=m.apply(this,arguments);return(0,c.default)(this,_)});function d(){var _;return(0,s.default)(this,d),(_=O.apply(this,arguments)).setToFirstBlock=function(){var m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:_.Editor.Caret.positions.DEFAULT,y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return!!_.Editor.BlockManager.firstBlock&&(_.Editor.Caret.setToBlock(_.Editor.BlockManager.firstBlock,m,y),!0)},_.setToLastBlock=function(){var m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:_.Editor.Caret.positions.DEFAULT,y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return!!_.Editor.BlockManager.lastBlock&&(_.Editor.Caret.setToBlock(_.Editor.BlockManager.lastBlock,m,y),!0)},_.setToPreviousBlock=function(){var m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:_.Editor.Caret.positions.DEFAULT,y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return!!_.Editor.BlockManager.previousBlock&&(_.Editor.Caret.setToBlock(_.Editor.BlockManager.previousBlock,m,y),!0)},_.setToNextBlock=function(){var m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:_.Editor.Caret.positions.DEFAULT,y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return!!_.Editor.BlockManager.nextBlock&&(_.Editor.Caret.setToBlock(_.Editor.BlockManager.nextBlock,m,y),!0)},_.setToBlock=function(m){var y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_.Editor.Caret.positions.DEFAULT,x=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return!!_.Editor.BlockManager.blocks[m]&&(_.Editor.Caret.setToBlock(_.Editor.BlockManager.blocks[m],y,x),!0)},_.focus=function(){var m=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return m?_.setToLastBlock(_.Editor.Caret.positions.END):_.setToFirstBlock(_.Editor.Caret.positions.START)},_}return(0,l.default)(d,[{key:"methods",get:function(){return{setToFirstBlock:this.setToFirstBlock,setToLastBlock:this.setToLastBlock,setToPreviousBlock:this.setToPreviousBlock,setToNextBlock:this.setToNextBlock,setToBlock:this.setToBlock,focus:this.focus}}}]),d}((p=g(p)).default);a.default=v,v.displayName="CaretAPI",r.exports=t.default})=="function"?i.apply(t,n):i)===void 0||(r.exports=o)},function(r,t,e){var i,n,o;n=[t,e(2),e(3),e(5),e(6),e(4),e(7)],(o=typeof(i=function(a,s,l,u,c,h,p){"use strict";var g=e(1);function b(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(k){return!1}}Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,s=g(s),l=g(l),u=g(u),c=g(c),h=g(h);var v=function(k){(0,u.default)(d,k);var C,O=(C=d,function(){var _,m=(0,h.default)(C);if(b()){var y=(0,h.default)(this).constructor;_=Reflect.construct(m,arguments,y)}else _=m.apply(this,arguments);return(0,c.default)(this,_)});function d(){return(0,s.default)(this,d),O.apply(this,arguments)}return(0,l.default)(d,[{key:"on",value:function(_,m){this.eventsDispatcher.on(_,m)}},{key:"emit",value:function(_,m){this.eventsDispatcher.emit(_,m)}},{key:"off",value:function(_,m){this.eventsDispatcher.off(_,m)}},{key:"methods",get:function(){var _=this;return{emit:function(m,y){return _.emit(m,y)},off:function(m,y){return _.off(m,y)},on:function(m,y){return _.on(m,y)}}}}]),d}((p=g(p)).default);a.default=v,v.displayName="EventsAPI",r.exports=t.default})=="function"?i.apply(t,n):i)===void 0||(r.exports=o)},function(r,t,e){var i,n,o;n=[t,e(2),e(3),e(5),e(6),e(4),e(59),e(8),e(7)],(o=typeof(i=function(a,s,l,u,c,h,p,g,b){"use strict";var v=e(1);function k(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(O){return!1}}Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,s=v(s),l=v(l),u=v(u),c=v(c),h=v(h),p=v(p);var C=function(O){(0,u.default)(m,O);var d,_=(d=m,function(){var y,x=(0,h.default)(d);if(k()){var S=(0,h.default)(this).constructor;y=Reflect.construct(x,arguments,S)}else y=x.apply(this,arguments);return(0,c.default)(this,y)});function m(){return(0,s.default)(this,m),_.apply(this,arguments)}return(0,l.default)(m,[{key:"getMethodsForTool",value:function(y){return Object.assign(this.methods,{t:function(x){return p.default.t(m.getNamespace(y),x)}})}},{key:"methods",get:function(){return{t:function(){(0,g.logLabeled)("I18n.t() method can be accessed only from Tools","warn")}}}}],[{key:"getNamespace",value:function(y){return y.isTune?"blockTunes.".concat(y.name):"tools.".concat(y.name)}}]),m}((b=v(b)).default);a.default=C,C.displayName="I18nAPI",r.exports=t.default})=="function"?i.apply(t,n):i)===void 0||(r.exports=o)},function(r,t,e){var i,n,o;n=[t,e(2),e(3),e(5),e(6),e(4),e(7)],(o=typeof(i=function(a,s,l,u,c,h,p){"use strict";var g=e(1);function b(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(k){return!1}}Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,s=g(s),l=g(l),u=g(u),c=g(c),h=g(h);var v=function(k){(0,u.default)(d,k);var C,O=(C=d,function(){var _,m=(0,h.default)(C);if(b()){var y=(0,h.default)(this).constructor;_=Reflect.construct(m,arguments,y)}else _=m.apply(this,arguments);return(0,c.default)(this,_)});function d(){return(0,s.default)(this,d),O.apply(this,arguments)}return(0,l.default)(d,[{key:"open",value:function(){this.Editor.InlineToolbar.tryToShow()}},{key:"close",value:function(){this.Editor.InlineToolbar.close()}},{key:"methods",get:function(){var _=this;return{close:function(){return _.close()},open:function(){return _.open()}}}}]),d}((p=g(p)).default);a.default=v,v.displayName="InlineToolbarAPI",r.exports=t.default})=="function"?i.apply(t,n):i)===void 0||(r.exports=o)},function(r,t,e){var i,n,o;n=[t,e(2),e(3),e(5),e(6),e(4),e(7)],(o=typeof(i=function(a,s,l,u,c,h,p){"use strict";var g=e(1);function b(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(k){return!1}}Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,s=g(s),l=g(l),u=g(u),c=g(c),h=g(h);var v=function(k){(0,u.default)(d,k);var C,O=(C=d,function(){var _,m=(0,h.default)(C);if(b()){var y=(0,h.default)(this).constructor;_=Reflect.construct(m,arguments,y)}else _=m.apply(this,arguments);return(0,c.default)(this,_)});function d(){return(0,s.default)(this,d),O.apply(this,arguments)}return(0,l.default)(d,[{key:"on",value:function(_,m,y,x){this.listeners.on(_,m,y,x)}},{key:"off",value:function(_,m,y,x){this.listeners.off(_,m,y,x)}},{key:"methods",get:function(){var _=this;return{on:function(m,y,x,S){return _.on(m,y,x,S)},off:function(m,y,x,S){return _.off(m,y,x,S)}}}}]),d}((p=g(p)).default);a.default=v,v.displayName="ListenersAPI",r.exports=t.default})=="function"?i.apply(t,n):i)===void 0||(r.exports=o)},function(r,t,e){var i,n,o;n=[t,e(2),e(3),e(5),e(6),e(4),e(7)],(o=typeof(i=function(a,s,l,u,c,h,p){"use strict";var g=e(1);function b(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(k){return!1}}Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,s=g(s),l=g(l),u=g(u),c=g(c),h=g(h);var v=function(k){(0,u.default)(d,k);var C,O=(C=d,function(){var _,m=(0,h.default)(C);if(b()){var y=(0,h.default)(this).constructor;_=Reflect.construct(m,arguments,y)}else _=m.apply(this,arguments);return(0,c.default)(this,_)});function d(){return(0,s.default)(this,d),O.apply(this,arguments)}return(0,l.default)(d,[{key:"show",value:function(_){return this.Editor.Notifier.show(_)}},{key:"methods",get:function(){var _=this;return{show:function(m){return _.show(m)}}}}]),d}((p=g(p)).default);a.default=v,v.displayName="NotifierAPI",r.exports=t.default})=="function"?i.apply(t,n):i)===void 0||(r.exports=o)},function(r,t,e){var i,n,o;n=[t,e(2),e(3),e(5),e(6),e(4),e(7)],(o=typeof(i=function(a,s,l,u,c,h,p){"use strict";var g=e(1);function b(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(k){return!1}}Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,s=g(s),l=g(l),u=g(u),c=g(c),h=g(h);var v=function(k){(0,u.default)(d,k);var C,O=(C=d,function(){var _,m=(0,h.default)(C);if(b()){var y=(0,h.default)(this).constructor;_=Reflect.construct(m,arguments,y)}else _=m.apply(this,arguments);return(0,c.default)(this,_)});function d(){return(0,s.default)(this,d),O.apply(this,arguments)}return(0,l.default)(d,[{key:"toggle",value:function(_){return this.Editor.ReadOnly.toggle(_)}},{key:"methods",get:function(){var _=this;return{toggle:function(m){return _.toggle(m)}}}}]),d}((p=g(p)).default);a.default=v,v.displayName="ReadOnlyAPI",r.exports=t.default})=="function"?i.apply(t,n):i)===void 0||(r.exports=o)},function(r,t,e){var i,n,o;n=[t,e(2),e(3),e(5),e(6),e(4),e(7)],(o=typeof(i=function(a,s,l,u,c,h,p){"use strict";var g=e(1);function b(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(k){return!1}}Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,s=g(s),l=g(l),u=g(u),c=g(c),h=g(h);var v=function(k){(0,u.default)(d,k);var C,O=(C=d,function(){var _,m=(0,h.default)(C);if(b()){var y=(0,h.default)(this).constructor;_=Reflect.construct(m,arguments,y)}else _=m.apply(this,arguments);return(0,c.default)(this,_)});function d(){return(0,s.default)(this,d),O.apply(this,arguments)}return(0,l.default)(d,[{key:"clean",value:function(_,m){return this.Editor.Sanitizer.clean(_,m)}},{key:"methods",get:function(){var _=this;return{clean:function(m,y){return _.clean(m,y)}}}}]),d}((p=g(p)).default);a.default=v,v.displayName="SanitizerAPI",r.exports=t.default})=="function"?i.apply(t,n):i)===void 0||(r.exports=o)},function(r,t,e){var i,n,o;n=[t,e(2),e(3),e(5),e(6),e(4),e(8),e(7)],(o=typeof(i=function(a,s,l,u,c,h,p,g){"use strict";var b=e(9),v=e(1);function k(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(O){return!1}}Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,s=v(s),l=v(l),u=v(u),c=v(c),h=v(h),p=b(p);var C=function(O){(0,u.default)(m,O);var d,_=(d=m,function(){var y,x=(0,h.default)(d);if(k()){var S=(0,h.default)(this).constructor;y=Reflect.construct(x,arguments,S)}else y=x.apply(this,arguments);return(0,c.default)(this,y)});function m(){return(0,s.default)(this,m),_.apply(this,arguments)}return(0,l.default)(m,[{key:"save",value:function(){var y="Editor's content can not be saved in read-only mode";return this.Editor.ReadOnly.isEnabled?(p.logLabeled(y,"warn"),Promise.reject(new Error(y))):this.Editor.Saver.save()}},{key:"methods",get:function(){var y=this;return{save:function(){return y.save()}}}}]),m}((g=v(g)).default);a.default=C,C.displayName="SaverAPI",r.exports=t.default})=="function"?i.apply(t,n):i)===void 0||(r.exports=o)},function(r,t,e){var i,n,o;n=[t,e(2),e(3),e(5),e(6),e(4),e(25),e(7)],(o=typeof(i=function(a,s,l,u,c,h,p,g){"use strict";var b=e(1);function v(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(C){return!1}}Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,s=b(s),l=b(l),u=b(u),c=b(c),h=b(h),p=b(p);var k=function(C){(0,u.default)(_,C);var O,d=(O=_,function(){var m,y=(0,h.default)(O);if(v()){var x=(0,h.default)(this).constructor;m=Reflect.construct(y,arguments,x)}else m=y.apply(this,arguments);return(0,c.default)(this,m)});function _(){return(0,s.default)(this,_),d.apply(this,arguments)}return(0,l.default)(_,[{key:"findParentTag",value:function(m,y){return new p.default().findParentTag(m,y)}},{key:"expandToTag",value:function(m){new p.default().expandToTag(m)}},{key:"methods",get:function(){var m=this;return{findParentTag:function(y,x){return m.findParentTag(y,x)},expandToTag:function(y){return m.expandToTag(y)}}}}]),_}((g=b(g)).default);a.default=k,k.displayName="SelectionAPI",r.exports=t.default})=="function"?i.apply(t,n):i)===void 0||(r.exports=o)},function(r,t,e){var i,n,o;n=[t,e(2),e(3),e(5),e(6),e(4),e(7)],(o=typeof(i=function(a,s,l,u,c,h,p){"use strict";var g=e(1);function b(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(k){return!1}}Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,s=g(s),l=g(l),u=g(u),c=g(c),h=g(h);var v=function(k){(0,u.default)(d,k);var C,O=(C=d,function(){var _,m=(0,h.default)(C);if(b()){var y=(0,h.default)(this).constructor;_=Reflect.construct(m,arguments,y)}else _=m.apply(this,arguments);return(0,c.default)(this,_)});function d(){return(0,s.default)(this,d),O.apply(this,arguments)}return(0,l.default)(d,[{key:"classes",get:function(){return{block:"cdx-block",inlineToolButton:"ce-inline-tool",inlineToolButtonActive:"ce-inline-tool--active",input:"cdx-input",loader:"cdx-loader",button:"cdx-button",settingsButton:"cdx-settings-button",settingsButtonActive:"cdx-settings-button--active"}}}]),d}((p=g(p)).default);a.default=v,v.displayName="StylesAPI",r.exports=t.default})=="function"?i.apply(t,n):i)===void 0||(r.exports=o)},function(r,t,e){var i,n,o;n=[t,e(2),e(3),e(5),e(6),e(4),e(7),e(8)],(o=typeof(i=function(a,s,l,u,c,h,p,g){"use strict";var b=e(9),v=e(1);function k(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(O){return!1}}Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,s=v(s),l=v(l),u=v(u),c=v(c),h=v(h),p=v(p),g=b(g);var C=function(O){(0,u.default)(m,O);var d,_=(d=m,function(){var y,x=(0,h.default)(d);if(k()){var S=(0,h.default)(this).constructor;y=Reflect.construct(x,arguments,S)}else y=x.apply(this,arguments);return(0,c.default)(this,y)});function m(){return(0,s.default)(this,m),_.apply(this,arguments)}return(0,l.default)(m,[{key:"open",value:function(){this.Editor.Toolbar.open()}},{key:"close",value:function(){this.Editor.Toolbar.close()}},{key:"toggleBlockSettings",value:function(y){if(this.Editor.BlockManager.currentBlockIndex!==-1){var x=y!=null?y:!this.Editor.BlockSettings.opened;y!==this.Editor.BlockSettings.opened&&(x?(this.Editor.Toolbar.opened||(this.Editor.Toolbar.open(!0,!1),this.Editor.Toolbar.plusButton.hide()),this.Editor.BlockSettings.open()):this.Editor.BlockSettings.close())}else g.logLabeled("Could't toggle the Toolbar because there is no block selected ","warn")}},{key:"methods",get:function(){var y=this;return{close:function(){return y.close()},open:function(){return y.open()},toggleBlockSettings:function(x){return y.toggleBlockSettings(x)}}}}]),m}(p.default);a.default=C,C.displayName="ToolbarAPI",r.exports=t.default})=="function"?i.apply(t,n):i)===void 0||(r.exports=o)},function(r,t,e){var i,n,o;n=[t,e(2),e(3),e(5),e(6),e(4),e(7)],(o=typeof(i=function(a,s,l,u,c,h,p){"use strict";var g=e(1);function b(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(k){return!1}}Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,s=g(s),l=g(l),u=g(u),c=g(c),h=g(h);var v=function(k){(0,u.default)(d,k);var C,O=(C=d,function(){var _,m=(0,h.default)(C);if(b()){var y=(0,h.default)(this).constructor;_=Reflect.construct(m,arguments,y)}else _=m.apply(this,arguments);return(0,c.default)(this,_)});function d(){return(0,s.default)(this,d),O.apply(this,arguments)}return(0,l.default)(d,[{key:"show",value:function(_,m,y){this.Editor.Tooltip.show(_,m,y)}},{key:"hide",value:function(){this.Editor.Tooltip.hide()}},{key:"onHover",value:function(_,m,y){this.Editor.Tooltip.onHover(_,m,y)}},{key:"methods",get:function(){var _=this;return{show:function(m,y,x){return _.show(m,y,x)},hide:function(){return _.hide()},onHover:function(m,y,x){return _.onHover(m,y,x)}}}}]),d}((p=g(p)).default);a.default=v,v.displayName="TooltipAPI",r.exports=t.default})=="function"?i.apply(t,n):i)===void 0||(r.exports=o)},function(r,t,e){var i,n,o;n=[t,e(21),e(22),e(2),e(3),e(5),e(6),e(4),e(7),e(8),e(25),e(60)],(o=typeof(i=function(a,s,l,u,c,h,p,g,b,v,k,C){"use strict";var O=e(9),d=e(1);function _(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(y){return!1}}Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,s=d(s),l=d(l),u=d(u),c=d(c),h=d(h),p=d(p),g=d(g),b=d(b),v=O(v),k=d(k),C=d(C);var m=function(y){(0,h.default)(E,y);var x,S,w=(x=E,function(){var L,I=(0,g.default)(x);if(_()){var A=(0,g.default)(this).constructor;L=Reflect.construct(I,arguments,A)}else L=I.apply(this,arguments);return(0,p.default)(this,L)});function E(){return(0,u.default)(this,E),w.apply(this,arguments)}return(0,c.default)(E,[{key:"keydown",value:function(L){switch(this.beforeKeydownProcessing(L),L.keyCode){case v.keyCodes.BACKSPACE:this.backspace(L);break;case v.keyCodes.ENTER:this.enter(L);break;case v.keyCodes.DOWN:case v.keyCodes.RIGHT:this.arrowRightAndDown(L);break;case v.keyCodes.UP:case v.keyCodes.LEFT:this.arrowLeftAndUp(L);break;case v.keyCodes.TAB:this.tabPressed(L)}}},{key:"beforeKeydownProcessing",value:function(L){this.needToolbarClosing(L)&&v.isPrintableKey(L.keyCode)&&(this.Editor.Toolbar.close(),this.Editor.ConversionToolbar.close(),L.ctrlKey||L.metaKey||L.altKey||L.shiftKey||(this.Editor.BlockManager.clearFocused(),this.Editor.BlockSelection.clearSelection(L)))}},{key:"keyup",value:function(L){L.shiftKey||this.Editor.UI.checkEmptiness()}},{key:"tabPressed",value:function(L){this.Editor.BlockSelection.clearSelection(L);var I=this.Editor,A=I.BlockManager,B=I.InlineToolbar,T=I.ConversionToolbar,M=A.currentBlock;if(M){var j=M.tool.isDefault&&M.isEmpty,J=!M.isEmpty&&T.opened,U=!M.isEmpty&&!k.default.isCollapsed&&B.opened;j?this.activateToolbox():J||U||this.activateBlockSettings()}}},{key:"dragOver",value:function(L){this.Editor.BlockManager.getBlockByChildNode(L.target).dropTarget=!0}},{key:"dragLeave",value:function(L){this.Editor.BlockManager.getBlockByChildNode(L.target).dropTarget=!1}},{key:"handleCommandC",value:function(L){var I=this.Editor.BlockSelection;if(I.anyBlockSelected)return I.copySelectedBlocks(L)}},{key:"handleCommandX",value:(S=(0,l.default)(s.default.mark(function L(I){var A,B,T,M,j;return s.default.wrap(function(J){for(;;)switch(J.prev=J.next){case 0:if(A=this.Editor,B=A.BlockSelection,T=A.BlockManager,M=A.Caret,B.anyBlockSelected){J.next=3;break}return J.abrupt("return");case 3:return J.next=5,B.copySelectedBlocks(I);case 5:j=T.removeSelectedBlocks(),M.setToBlock(T.insertDefaultBlockAtIndex(j,!0),M.positions.START),B.clearSelection(I);case 8:case"end":return J.stop()}},L,this)})),function(L){return S.apply(this,arguments)})},{key:"enter",value:function(L){var I=this.Editor,A=I.BlockManager,B=I.UI;if(!A.currentBlock.tool.isLineBreaksEnabled&&!(B.someToolbarOpened&&B.someFlipperButtonFocused||L.shiftKey)){var T=this.Editor.BlockManager.currentBlock;this.Editor.Caret.isAtStart&&!this.Editor.BlockManager.currentBlock.hasMedia?this.Editor.BlockManager.insertDefaultBlockAtIndex(this.Editor.BlockManager.currentBlockIndex):T=this.Editor.BlockManager.split(),this.Editor.Caret.setToBlock(T),T.tool.isDefault&&T.isEmpty&&(this.Editor.Toolbar.open(!1),this.Editor.Toolbar.plusButton.show()),L.preventDefault()}}},{key:"backspace",value:function(L){var I=this.Editor,A=I.BlockManager,B=I.BlockSelection,T=I.Caret,M=A.currentBlock,j=M.tool;if(M.selected||M.isEmpty&&M.currentInput===M.firstInput){L.preventDefault();var J=A.currentBlockIndex;return A.previousBlock&&A.previousBlock.inputs.length===0?A.removeBlock(J-1):A.removeBlock(),T.setToBlock(A.currentBlock,J?T.positions.END:T.positions.START),this.Editor.Toolbar.close(),void B.clearSelection(L)}if(!j.isLineBreaksEnabled||T.isAtStart){var U=A.currentBlockIndex===0;T.isAtStart&&k.default.isCollapsed&&M.currentInput===M.firstInput&&!U&&(L.preventDefault(),this.mergeBlocks())}}},{key:"mergeBlocks",value:function(){var L=this.Editor,I=L.BlockManager,A=L.Caret,B=L.Toolbar,T=I.previousBlock,M=I.currentBlock;if(M.name!==T.name||!T.mergeable)return T.inputs.length===0||T.isEmpty?(I.removeBlock(I.currentBlockIndex-1),A.setToBlock(I.currentBlock),void B.close()):void(A.navigatePrevious()&&B.close());A.createShadow(T.pluginsContent),I.mergeBlocks(T,M).then(function(){A.restoreCaret(T.pluginsContent),T.pluginsContent.normalize(),B.close()})}},{key:"arrowRightAndDown",value:function(L){var I=this,A=C.default.usedKeys.includes(L.keyCode)&&(!L.shiftKey||L.keyCode===v.keyCodes.TAB);if(!this.Editor.UI.someToolbarOpened||!A){this.Editor.BlockManager.clearFocused(),this.Editor.Toolbar.close();var B=this.Editor.Caret.isAtEnd||this.Editor.BlockSelection.anyBlockSelected;L.shiftKey&&L.keyCode===v.keyCodes.DOWN&&B?this.Editor.CrossBlockSelection.toggleBlockSelectedState():((L.keyCode===v.keyCodes.DOWN||L.keyCode===v.keyCodes.RIGHT&&!this.isRtl?this.Editor.Caret.navigateNext():this.Editor.Caret.navigatePrevious())?L.preventDefault():v.delay(function(){I.Editor.BlockManager.currentBlock&&I.Editor.BlockManager.currentBlock.updateCurrentInput()},20)(),this.Editor.BlockSelection.clearSelection(L))}}},{key:"arrowLeftAndUp",value:function(L){var I=this;if(this.Editor.UI.someToolbarOpened){if(C.default.usedKeys.includes(L.keyCode)&&(!L.shiftKey||L.keyCode===v.keyCodes.TAB))return;this.Editor.UI.closeAllToolbars()}this.Editor.BlockManager.clearFocused(),this.Editor.Toolbar.close();var A=this.Editor.Caret.isAtStart||this.Editor.BlockSelection.anyBlockSelected;L.shiftKey&&L.keyCode===v.keyCodes.UP&&A?this.Editor.CrossBlockSelection.toggleBlockSelectedState(!1):((L.keyCode===v.keyCodes.UP||L.keyCode===v.keyCodes.LEFT&&!this.isRtl?this.Editor.Caret.navigatePrevious():this.Editor.Caret.navigateNext())?L.preventDefault():v.delay(function(){I.Editor.BlockManager.currentBlock&&I.Editor.BlockManager.currentBlock.updateCurrentInput()},20)(),this.Editor.BlockSelection.clearSelection(L))}},{key:"needToolbarClosing",value:function(L){var I=L.keyCode===v.keyCodes.ENTER&&this.Editor.Toolbox.opened,A=L.keyCode===v.keyCodes.ENTER&&this.Editor.BlockSettings.opened,B=L.keyCode===v.keyCodes.ENTER&&this.Editor.InlineToolbar.opened,T=L.keyCode===v.keyCodes.ENTER&&this.Editor.ConversionToolbar.opened,M=L.keyCode===v.keyCodes.TAB;return!(L.shiftKey||M||I||A||B||T)}},{key:"activateToolbox",value:function(){this.Editor.Toolbar.opened||(this.Editor.Toolbar.open(!1,!1),this.Editor.Toolbar.plusButton.show()),this.Editor.Toolbox.open()}},{key:"activateBlockSettings",value:function(){this.Editor.Toolbar.opened||(this.Editor.BlockManager.currentBlock.focused=!0,this.Editor.Toolbar.open(!0,!1),this.Editor.Toolbar.plusButton.hide()),this.Editor.BlockSettings.opened||this.Editor.BlockSettings.open()}}]),E}(b.default);a.default=m,m.displayName="BlockEvents",r.exports=t.default})=="function"?i.apply(t,n):i)===void 0||(r.exports=o)},function(r,t,e){var i,n,o;n=[t,e(21),e(22),e(2),e(3),e(5),e(6),e(4),e(61),e(7),e(15),e(8),e(376)],(o=typeof(i=function(a,s,l,u,c,h,p,g,b,v,k,C,O){"use strict";var d=e(9),_=e(1);function m(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(x){return!1}}Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,s=_(s),l=_(l),u=_(u),c=_(c),h=_(h),p=_(p),g=_(g),b=d(b),v=_(v),k=_(k),C=d(C),O=_(O);var y=function(x){(0,h.default)(I,x);var S,w,E,L=(S=I,function(){var A,B=(0,g.default)(S);if(m()){var T=(0,g.default)(this).constructor;A=Reflect.construct(B,arguments,T)}else A=B.apply(this,arguments);return(0,p.default)(this,A)});function I(){var A;return(0,u.default)(this,I),(A=L.apply(this,arguments))._currentBlockIndex=-1,A._blocks=null,A}return(0,c.default)(I,[{key:"prepare",value:function(){var A=this,B=new O.default(this.Editor.UI.nodes.redactor);this._blocks=new Proxy(B,{set:O.default.set,get:O.default.get}),this.listeners.on(document,"copy",function(T){return A.Editor.BlockEvents.handleCommandC(T)})}},{key:"toggleReadOnly",value:function(A){A?this.disableModuleBindings():this.enableModuleBindings()}},{key:"composeBlock",value:function(A){var B=A.tool,T=A.data,M=T===void 0?{}:T,j=A.tunes,J=j===void 0?{}:j,U=this.Editor.ReadOnly.isEnabled,H=this.Editor.Tools.blockTools.get(B),te=this.Editor.Tools.getTunesForTool(H),ae=new b.default({data:M,tool:H,api:this.Editor.API,readOnly:U,tunes:te,tunesData:J});return U||this.bindBlockEvents(ae),ae}},{key:"insert",value:function(){var A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},B=A.tool,T=B===void 0?this.config.defaultBlock:B,M=A.data,j=M===void 0?{}:M,J=A.index,U=A.needToFocus,H=U===void 0||U,te=A.replace,ae=te!==void 0&&te,W=A.tunes,Y=W===void 0?{}:W,re=J;re===void 0&&(re=this.currentBlockIndex+(ae?0:1));var ie=this.composeBlock({tool:T,data:j,tunes:Y});return this._blocks.insert(re,ie,ae),H?this.currentBlockIndex=re:re<=this.currentBlockIndex&&this.currentBlockIndex++,ie}},{key:"replace",value:function(A){var B=A.tool,T=B===void 0?this.config.defaultBlock:B,M=A.data,j=M===void 0?{}:M;return this.insert({tool:T,data:j,index:this.currentBlockIndex,replace:!0})}},{key:"paste",value:function(A,B){var T=arguments.length>2&&arguments[2]!==void 0&&arguments[2],M=this.insert({tool:A,replace:T});try{M.call(b.BlockToolAPI.ON_PASTE,B)}catch(j){C.log("".concat(A,": onPaste callback call is failed"),"error",j)}return M}},{key:"insertDefaultBlockAtIndex",value:function(A){var B=arguments.length>1&&arguments[1]!==void 0&&arguments[1],T=this.composeBlock({tool:this.config.defaultBlock});return this._blocks[A]=T,B?this.currentBlockIndex=A:A<=this.currentBlockIndex&&this.currentBlockIndex++,T}},{key:"insertAtEnd",value:function(){return this.currentBlockIndex=this.blocks.length-1,this.insert()}},{key:"mergeBlocks",value:(E=(0,l.default)(s.default.mark(function A(B,T){var M,j;return s.default.wrap(function(J){for(;;)switch(J.prev=J.next){case 0:if(M=this._blocks.indexOf(T),!T.isEmpty){J.next=3;break}return J.abrupt("return");case 3:return J.next=5,T.data;case 5:if(j=J.sent,C.isEmpty(j)){J.next=9;break}return J.next=9,B.mergeWith(j);case 9:this.removeBlock(M),this.currentBlockIndex=this._blocks.indexOf(B);case 11:case"end":return J.stop()}},A,this)})),function(A,B){return E.apply(this,arguments)})},{key:"removeBlock",value:function(){var A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.currentBlockIndex;if(!this.validateIndex(A))throw new Error("Can't find a Block to remove");this._blocks.remove(A),this.currentBlockIndex>=A&&this.currentBlockIndex--,this.blocks.length?A===0&&(this.currentBlockIndex=0):(this.currentBlockIndex=-1,this.insert())}},{key:"removeSelectedBlocks",value:function(){for(var A,B=this.blocks.length-1;B>=0;B--)this.blocks[B].selected&&(this.removeBlock(B),A=B);return A}},{key:"removeAllBlocks",value:function(){for(var A=this.blocks.length-1;A>=0;A--)this._blocks.remove(A);this.currentBlockIndex=-1,this.insert(),this.currentBlock.firstInput.focus()}},{key:"split",value:function(){var A=this.Editor.Caret.extractFragmentFromCaretPosition(),B=k.default.make("div");B.appendChild(A);var T={text:k.default.isEmpty(B)?"":B.innerHTML};return this.insert({data:T})}},{key:"getBlockByIndex",value:function(A){return this._blocks[A]}},{key:"getBlock",value:function(A){k.default.isElement(A)||(A=A.parentNode);var B=this._blocks.nodes,T=A.closest(".".concat(b.default.CSS.wrapper)),M=B.indexOf(T);if(M>=0)return this._blocks[M]}},{key:"highlightCurrentNode",value:function(){this.clearFocused(),this.currentBlock.focused=!0}},{key:"clearFocused",value:function(){this.blocks.forEach(function(A){A.focused=!1})}},{key:"setCurrentBlockByChildNode",value:function(A){k.default.isElement(A)||(A=A.parentNode);var B=A.closest(".".concat(b.default.CSS.wrapper));if(B){var T=B.closest(".".concat(this.Editor.UI.CSS.editorWrapper));if(T!=null&&T.isEqualNode(this.Editor.UI.nodes.wrapper))return this.currentBlockIndex=this._blocks.nodes.indexOf(B),this.currentBlock.updateCurrentInput(),this.currentBlock}}},{key:"getBlockByChildNode",value:function(A){k.default.isElement(A)||(A=A.parentNode);var B=A.closest(".".concat(b.default.CSS.wrapper));return this.blocks.find(function(T){return T.holder===B})}},{key:"swap",value:function(A,B){this._blocks.swap(A,B),this.currentBlockIndex=B}},{key:"move",value:function(A){var B=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.currentBlockIndex;isNaN(A)||isNaN(B)?C.log("Warning during 'move' call: incorrect indices provided.","warn"):this.validateIndex(A)&&this.validateIndex(B)?(this._blocks.move(A,B),this.currentBlockIndex=A):C.log("Warning during 'move' call: indices cannot be lower than 0 or greater than the amount of blocks.","warn")}},{key:"dropPointer",value:function(){this.currentBlockIndex=-1,this.clearFocused()}},{key:"clear",value:function(){var A=arguments.length>0&&arguments[0]!==void 0&&arguments[0];this._blocks.removeAll(),this.dropPointer(),A&&this.insert(),this.Editor.UI.checkEmptiness()}},{key:"destroy",value:(w=(0,l.default)(s.default.mark(function A(){return s.default.wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return B.next=2,Promise.all(this.blocks.map(function(T){return T.destroy()}));case 2:case"end":return B.stop()}},A,this)})),function(){return w.apply(this,arguments)})},{key:"bindBlockEvents",value:function(A){var B=this.Editor.BlockEvents;this.readOnlyMutableListeners.on(A.holder,"keydown",function(T){B.keydown(T)}),this.readOnlyMutableListeners.on(A.holder,"keyup",function(T){B.keyup(T)}),this.readOnlyMutableListeners.on(A.holder,"dragover",function(T){B.dragOver(T)}),this.readOnlyMutableListeners.on(A.holder,"dragleave",function(T){B.dragLeave(T)})}},{key:"disableModuleBindings",value:function(){this.readOnlyMutableListeners.clearAll()}},{key:"enableModuleBindings",value:function(){var A=this;this.readOnlyMutableListeners.on(document,"cut",function(B){return A.Editor.BlockEvents.handleCommandX(B)}),this.blocks.forEach(function(B){A.bindBlockEvents(B)})}},{key:"validateIndex",value:function(A){return!(A<0||A>=this._blocks.length)}},{key:"currentBlockIndex",get:function(){return this._currentBlockIndex},set:function(A){this._blocks[this._currentBlockIndex]&&this._blocks[this._currentBlockIndex].willUnselect(),this._blocks[A]&&this._blocks[A].willSelect(),this._currentBlockIndex=A}},{key:"firstBlock",get:function(){return this._blocks[0]}},{key:"lastBlock",get:function(){return this._blocks[this._blocks.length-1]}},{key:"currentBlock",get:function(){return this._blocks[this.currentBlockIndex]}},{key:"nextBlock",get:function(){return this.currentBlockIndex===this._blocks.length-1?null:this._blocks[this.currentBlockIndex+1]}},{key:"nextContentfulBlock",get:function(){return this.blocks.slice(this.currentBlockIndex+1).find(function(A){return!!A.inputs.length})}},{key:"previousContentfulBlock",get:function(){return this.blocks.slice(0,this.currentBlockIndex).reverse().find(function(A){return!!A.inputs.length})}},{key:"previousBlock",get:function(){return this.currentBlockIndex===0?null:this._blocks[this.currentBlockIndex-1]}},{key:"blocks",get:function(){return this._blocks.array}},{key:"isEditorEmpty",get:function(){return this.blocks.every(function(A){return A.isEmpty})}}]),I}(v.default);a.default=y,y.displayName="BlockManager",r.exports=t.default})=="function"?i.apply(t,n):i)===void 0||(r.exports=o)},function(r,t,e){var i,n,o;n=[t,e(21),e(22),e(2),e(3),e(5),e(6),e(4),e(7),e(8),e(15),e(108),e(25)],(o=typeof(i=function(a,s,l,u,c,h,p,g,b,v,k,C,O){"use strict";var d=e(9),_=e(1);function m(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(x){return!1}}Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,s=_(s),l=_(l),u=_(u),c=_(c),h=_(h),p=_(p),g=_(g),b=_(b),v=d(v),k=_(k),C=_(C),O=_(O);var y=function(x){(0,h.default)(L,x);var S,w,E=(S=L,function(){var I,A=(0,g.default)(S);if(m()){var B=(0,g.default)(this).constructor;I=Reflect.construct(A,arguments,B)}else I=A.apply(this,arguments);return(0,p.default)(this,I)});function L(){var I;return(0,u.default)(this,L),(I=E.apply(this,arguments)).anyBlockSelectedCache=null,I.needToSelectAll=!1,I.nativeInputSelected=!1,I.readyToBlockSelection=!1,I}return(0,c.default)(L,[{key:"prepare",value:function(){var I=this;this.selection=new O.default,C.default.add({name:"CMD+A",handler:function(A){var B=I.Editor,T=B.BlockManager;if(B.ReadOnly.isEnabled)return A.preventDefault(),void I.selectAllBlocks();T.currentBlock&&I.handleCommandA(A)},on:this.Editor.UI.nodes.redactor})}},{key:"toggleReadOnly",value:function(I){O.default.get().removeAllRanges(),this.allBlocksSelected=!1}},{key:"unSelectBlockByIndex",value:function(I){var A=this.Editor.BlockManager;(isNaN(I)?A.currentBlock:A.getBlockByIndex(I)).selected=!1,this.clearCache()}},{key:"clearSelection",value:function(I){var A=arguments.length>1&&arguments[1]!==void 0&&arguments[1],B=this.Editor,T=B.BlockManager,M=B.Caret,j=B.RectangleSelection;this.needToSelectAll=!1,this.nativeInputSelected=!1,this.readyToBlockSelection=!1;var J=I&&I instanceof KeyboardEvent,U=J&&v.isPrintableKey(I.keyCode);if(this.anyBlockSelected&&J&&U&&!O.default.isSelectionExists){var H=T.removeSelectedBlocks();T.insertDefaultBlockAtIndex(H,!0),M.setToBlock(T.currentBlock),v.delay(function(){var te=I.key;M.insertContentAtCaretPosition(te.length>1?"":te)},20)()}this.Editor.CrossBlockSelection.clear(I),this.anyBlockSelected&&!j.isRectActivated()?(A&&this.selection.restore(),this.allBlocksSelected=!1):this.Editor.RectangleSelection.clearSelection()}},{key:"copySelectedBlocks",value:(w=(0,l.default)(s.default.mark(function I(A){var B,T,M,j,J=this;return s.default.wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return A.preventDefault(),B=k.default.make("div"),this.selectedBlocks.forEach(function(H){var te=J.Editor.Sanitizer.clean(H.holder.innerHTML,J.sanitizerConfig),ae=k.default.make("p");ae.innerHTML=te,B.appendChild(ae)}),U.next=5,Promise.all(this.selectedBlocks.map(function(H){return H.save()}));case 5:T=U.sent,M=Array.from(B.childNodes).map(function(H){return H.textContent}).join(`

`),j=B.innerHTML,A.clipboardData.setData("text/plain",M),A.clipboardData.setData("text/html",j),A.clipboardData.setData(this.Editor.Paste.MIME_TYPE,JSON.stringify(T));case 11:case"end":return U.stop()}},I,this)})),function(I){return w.apply(this,arguments)})},{key:"selectBlockByIndex",value:function(I){var A,B=this.Editor.BlockManager;B.clearFocused(),A=isNaN(I)?B.currentBlock:B.getBlockByIndex(I),this.selection.save(),O.default.get().removeAllRanges(),A.selected=!0,this.clearCache(),this.Editor.InlineToolbar.close()}},{key:"clearCache",value:function(){this.anyBlockSelectedCache=null}},{key:"destroy",value:function(){C.default.remove(this.Editor.UI.nodes.redactor,"CMD+A")}},{key:"handleCommandA",value:function(I){if(this.Editor.RectangleSelection.clearSelection(),!k.default.isNativeInput(I.target)||this.readyToBlockSelection){var A=this.Editor.BlockManager.getBlock(I.target).inputs;A.length>1&&!this.readyToBlockSelection?this.readyToBlockSelection=!0:A.length!==1||this.needToSelectAll?this.needToSelectAll?(I.preventDefault(),this.selectAllBlocks(),this.needToSelectAll=!1,this.readyToBlockSelection=!1,this.Editor.ConversionToolbar.close()):this.readyToBlockSelection&&(I.preventDefault(),this.selectBlockByIndex(),this.needToSelectAll=!0):this.needToSelectAll=!0}else this.readyToBlockSelection=!0}},{key:"selectAllBlocks",value:function(){this.selection.save(),O.default.get().removeAllRanges(),this.allBlocksSelected=!0,this.Editor.InlineToolbar.close()}},{key:"sanitizerConfig",get:function(){return{p:{},h1:{},h2:{},h3:{},h4:{},h5:{},h6:{},ol:{},ul:{},li:{},br:!0,img:{src:!0,width:!0,height:!0},a:{href:!0},b:{},i:{},u:{}}}},{key:"allBlocksSelected",get:function(){return this.Editor.BlockManager.blocks.every(function(I){return I.selected===!0})},set:function(I){this.Editor.BlockManager.blocks.forEach(function(A){A.selected=I}),this.clearCache()}},{key:"anyBlockSelected",get:function(){var I=this.Editor.BlockManager;return this.anyBlockSelectedCache===null&&(this.anyBlockSelectedCache=I.blocks.some(function(A){return A.selected===!0})),this.anyBlockSelectedCache}},{key:"selectedBlocks",get:function(){return this.Editor.BlockManager.blocks.filter(function(I){return I.selected})}}]),L}(b.default);a.default=y,y.displayName="BlockSelection",r.exports=t.default})=="function"?i.apply(t,n):i)===void 0||(r.exports=o)},function(r,t,e){var i,n,o;n=[t,e(2),e(3),e(5),e(6),e(4),e(25),e(7),e(15),e(8)],(o=typeof(i=function(a,s,l,u,c,h,p,g,b,v){"use strict";var k=e(9),C=e(1);function O(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(_){return!1}}Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,s=C(s),l=C(l),u=C(u),c=C(c),h=C(h),p=C(p),g=C(g),b=C(b),v=k(v);var d=function(_){(0,u.default)(x,_);var m,y=(m=x,function(){var S,w=(0,h.default)(m);if(O()){var E=(0,h.default)(this).constructor;S=Reflect.construct(w,arguments,E)}else S=w.apply(this,arguments);return(0,c.default)(this,S)});function x(){return(0,s.default)(this,x),y.apply(this,arguments)}return(0,l.default)(x,[{key:"setToBlock",value:function(S){var w,E=this,L=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.positions.DEFAULT,I=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,A=this.Editor.BlockManager;switch(L){case this.positions.START:w=S.firstInput;break;case this.positions.END:w=S.lastInput;break;default:w=S.currentInput}if(w){var B=b.default.getDeepestNode(w,L===this.positions.END),T=b.default.getContentLength(B);switch(!0){case L===this.positions.START:I=0;break;case L===this.positions.END:case I>T:I=T}v.delay(function(){E.set(B,I)},20)(),A.setCurrentBlockByChildNode(S.holder),A.currentBlock.currentInput=w}}},{key:"setToInput",value:function(S){var w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.positions.DEFAULT,E=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,L=this.Editor.BlockManager.currentBlock,I=b.default.getDeepestNode(S);switch(w){case this.positions.START:this.set(I,0);break;case this.positions.END:this.set(I,b.default.getContentLength(I));break;default:E&&this.set(I,E)}L.currentInput=S}},{key:"set",value:function(S){var w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,E=p.default.setCursor(S,w),L=E.top,I=E.bottom,A=window,B=A.innerHeight;L<0&&window.scrollBy(0,L),I>B&&window.scrollBy(0,I-B)}},{key:"setToTheLastBlock",value:function(){var S=this.Editor.BlockManager.lastBlock;if(S)if(S.tool.isDefault&&S.isEmpty)this.setToBlock(S);else{var w=this.Editor.BlockManager.insertAtEnd();this.setToBlock(w)}}},{key:"extractFragmentFromCaretPosition",value:function(){var S=p.default.get();if(S.rangeCount){var w=S.getRangeAt(0),E=this.Editor.BlockManager.currentBlock.currentInput;if(w.deleteContents(),E){if(b.default.isNativeInput(E)){var L=E,I=document.createDocumentFragment(),A=L.value.substring(0,L.selectionStart),B=L.value.substring(L.selectionStart);return I.textContent=B,L.value=A,I}var T=w.cloneRange();return T.selectNodeContents(E),T.setStart(w.endContainer,w.endOffset),T.extractContents()}}}},{key:"navigateNext",value:function(){var S=this.Editor,w=S.BlockManager,E=(S.Tools,w.currentBlock),L=w.nextContentfulBlock,I=E.nextInput,A=this.isAtEnd,B=L;if(!B&&!I){if(E.tool.isDefault||!A)return!1;B=w.insertAtEnd()}return!!A&&(I?this.setToInput(I,this.positions.START):this.setToBlock(B,this.positions.START),!0)}},{key:"navigatePrevious",value:function(){var S=this.Editor.BlockManager,w=S.currentBlock,E=S.previousContentfulBlock;if(!w)return!1;var L=w.previousInput;return!(!E&&!L||!this.isAtStart||(L?this.setToInput(L,this.positions.END):this.setToBlock(E,this.positions.END),0))}},{key:"createShadow",value:function(S){var w=document.createElement("span");w.classList.add(x.CSS.shadowCaret),S.insertAdjacentElement("beforeend",w)}},{key:"restoreCaret",value:function(S){var w=S.querySelector(".".concat(x.CSS.shadowCaret));w&&(new p.default().expandToTag(w),setTimeout(function(){var E=document.createRange();E.selectNode(w),E.extractContents()},50))}},{key:"insertContentAtCaretPosition",value:function(S){var w=document.createDocumentFragment(),E=document.createElement("div"),L=p.default.get(),I=p.default.range;E.innerHTML=S,Array.from(E.childNodes).forEach(function(T){return w.appendChild(T)}),w.childNodes.length===0&&w.appendChild(new Text(""));var A=w.lastChild;I.deleteContents(),I.insertNode(w);var B=document.createRange();B.setStart(A,A.textContent.length),L.removeAllRanges(),L.addRange(B)}},{key:"getHigherLevelSiblings",value:function(S,w){for(var E=S,L=[];E.parentNode&&E.parentNode.contentEditable!=="true";)E=E.parentNode;for(var I=w==="left"?"previousSibling":"nextSibling";E[I];)E=E[I],L.push(E);return L}},{key:"positions",get:function(){return{START:"start",END:"end",DEFAULT:"default"}}},{key:"isAtStart",get:function(){var S=p.default.get(),w=b.default.getDeepestNode(this.Editor.BlockManager.currentBlock.currentInput),E=S.focusNode;if(b.default.isNativeInput(w))return w.selectionEnd===0;if(!S.anchorNode)return!1;var L=E.textContent.search(/\S/);L===-1&&(L=0);var I=S.focusOffset;return E.nodeType!==Node.TEXT_NODE&&E.childNodes.length&&(E.childNodes[I]?(E=E.childNodes[I],I=0):I=(E=E.childNodes[I-1]).textContent.length),!(!b.default.isLineBreakTag(w)&&!b.default.isEmpty(w)||!this.getHigherLevelSiblings(E,"left").every(function(A){var B=b.default.isLineBreakTag(A),T=A.children.length===1&&b.default.isLineBreakTag(A.children[0]),M=B||T;return b.default.isEmpty(A)&&!M})||I!==L)||w===null||E===w&&I<=L}},{key:"isAtEnd",get:function(){var S=p.default.get(),w=S.focusNode,E=b.default.getDeepestNode(this.Editor.BlockManager.currentBlock.currentInput,!0);if(b.default.isNativeInput(E))return E.selectionEnd===E.value.length;if(!S.focusNode)return!1;var L=S.focusOffset;if(w.nodeType!==Node.TEXT_NODE&&w.childNodes.length&&(w.childNodes[L-1]?L=(w=w.childNodes[L-1]).textContent.length:(w=w.childNodes[0],L=0)),b.default.isLineBreakTag(E)||b.default.isEmpty(E)){var I=this.getHigherLevelSiblings(w,"right");if(I.every(function(B,T){return T===I.length-1&&b.default.isLineBreakTag(B)||b.default.isEmpty(B)&&!b.default.isLineBreakTag(B)})&&L===w.textContent.length)return!0}var A=E.textContent.replace(/\s+$/,"");return w===E&&L>=A.length}}],[{key:"CSS",get:function(){return{shadowCaret:"cdx-shadow-caret"}}}]),x}(g.default);a.default=d,d.displayName="Caret",r.exports=t.default})=="function"?i.apply(t,n):i)===void 0||(r.exports=o)},function(r,t,e){var i,n,o;n=[t,e(21),e(22),e(2),e(3),e(5),e(6),e(4),e(7),e(25),e(8)],(o=typeof(i=function(a,s,l,u,c,h,p,g,b,v,k){"use strict";var C=e(9),O=e(1);function d(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(m){return!1}}Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,s=O(s),l=O(l),u=O(u),c=O(c),h=O(h),p=O(p),g=O(g),b=O(b),v=O(v),k=C(k);var _=function(m){(0,h.default)(w,m);var y,x,S=(y=w,function(){var E,L=(0,g.default)(y);if(d()){var I=(0,g.default)(this).constructor;E=Reflect.construct(L,arguments,I)}else E=L.apply(this,arguments);return(0,p.default)(this,E)});function w(){var E;return(0,u.default)(this,w),(E=S.apply(this,arguments)).onMouseUp=function(){E.listeners.off(document,"mouseover",E.onMouseOver),E.listeners.off(document,"mouseup",E.onMouseUp)},E.onMouseOver=function(L){var I=E.Editor,A=I.BlockManager,B=I.BlockSelection,T=A.getBlockByChildNode(L.relatedTarget)||E.lastSelectedBlock,M=A.getBlockByChildNode(L.target);if(T&&M&&M!==T){if(T===E.firstSelectedBlock)return v.default.get().removeAllRanges(),T.selected=!0,M.selected=!0,void B.clearCache();if(M===E.firstSelectedBlock)return T.selected=!1,M.selected=!1,void B.clearCache();E.Editor.InlineToolbar.close(),E.toggleBlocksSelectedState(T,M),E.lastSelectedBlock=M}},E}return(0,c.default)(w,[{key:"prepare",value:(x=(0,l.default)(s.default.mark(function E(){var L=this;return s.default.wrap(function(I){for(;;)switch(I.prev=I.next){case 0:this.listeners.on(document,"mousedown",function(A){L.enableCrossBlockSelection(A)});case 1:case"end":return I.stop()}},E,this)})),function(){return x.apply(this,arguments)})},{key:"watchSelection",value:function(E){if(E.button===k.mouseButtons.LEFT){var L=this.Editor.BlockManager;this.firstSelectedBlock=L.getBlock(E.target),this.lastSelectedBlock=this.firstSelectedBlock,this.listeners.on(document,"mouseover",this.onMouseOver),this.listeners.on(document,"mouseup",this.onMouseUp)}}},{key:"toggleBlockSelectedState",value:function(){var E=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0],L=this.Editor,I=L.BlockManager,A=L.BlockSelection;this.lastSelectedBlock||(this.lastSelectedBlock=this.firstSelectedBlock=I.currentBlock),this.firstSelectedBlock===this.lastSelectedBlock&&(this.firstSelectedBlock.selected=!0,A.clearCache(),v.default.get().removeAllRanges());var B=I.blocks.indexOf(this.lastSelectedBlock)+(E?1:-1),T=I.blocks[B];T&&(this.lastSelectedBlock.selected!==T.selected?(T.selected=!0,A.clearCache()):(this.lastSelectedBlock.selected=!1,A.clearCache()),this.lastSelectedBlock=T,this.Editor.InlineToolbar.close(),T.holder.scrollIntoView({block:"nearest"}))}},{key:"clear",value:function(E){var L=this.Editor,I=L.BlockManager,A=L.BlockSelection,B=L.Caret,T=I.blocks.indexOf(this.firstSelectedBlock),M=I.blocks.indexOf(this.lastSelectedBlock);if(A.anyBlockSelected&&T>-1&&M>-1)if(E&&E instanceof KeyboardEvent)switch(E.keyCode){case k.keyCodes.DOWN:case k.keyCodes.RIGHT:B.setToBlock(I.blocks[Math.max(T,M)],B.positions.END);break;case k.keyCodes.UP:case k.keyCodes.LEFT:B.setToBlock(I.blocks[Math.min(T,M)],B.positions.START);break;default:B.setToBlock(I.blocks[Math.max(T,M)],B.positions.END)}else B.setToBlock(I.blocks[Math.max(T,M)],B.positions.END);this.firstSelectedBlock=this.lastSelectedBlock=null}},{key:"enableCrossBlockSelection",value:function(E){var L=this.Editor.UI;v.default.isCollapsed||this.Editor.BlockSelection.clearSelection(E),L.nodes.redactor.contains(E.target)?this.watchSelection(E):this.Editor.BlockSelection.clearSelection(E)}},{key:"toggleBlocksSelectedState",value:function(E,L){for(var I=this.Editor,A=I.BlockManager,B=I.BlockSelection,T=A.blocks.indexOf(E),M=A.blocks.indexOf(L),j=E.selected!==L.selected,J=Math.min(T,M);J<=Math.max(T,M);J++){var U=A.blocks[J];U!==this.firstSelectedBlock&&U!==(j?E:L)&&(A.blocks[J].selected=!A.blocks[J].selected,B.clearCache())}}},{key:"isCrossBlockSelectionStarted",get:function(){return!!this.firstSelectedBlock&&!!this.lastSelectedBlock}}]),w}(b.default);a.default=_,_.displayName="CrossBlockSelection",r.exports=t.default})=="function"?i.apply(t,n):i)===void 0||(r.exports=o)},function(r,t,e){var i,n,o;n=[t,e(21),e(22),e(2),e(3),e(5),e(6),e(4),e(25),e(7)],(o=typeof(i=function(a,s,l,u,c,h,p,g,b,v){"use strict";var k=e(1);function C(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,s=k(s),l=k(l),u=k(u),c=k(c),h=k(h),p=k(p),g=k(g),b=k(b);var O=function(d){(0,h.default)(x,d);var _,m,y=(_=x,function(){var S,w=(0,g.default)(_);if(C()){var E=(0,g.default)(this).constructor;S=Reflect.construct(w,arguments,E)}else S=w.apply(this,arguments);return(0,p.default)(this,S)});function x(){var S;return(0,u.default)(this,x),(S=y.apply(this,arguments)).isStartedAtEditor=!1,S}return(0,c.default)(x,[{key:"toggleReadOnly",value:function(S){S?this.disableModuleBindings():this.enableModuleBindings()}},{key:"enableModuleBindings",value:function(){var S=this,w=this.Editor.UI;this.readOnlyMutableListeners.on(w.nodes.holder,"drop",function(){var E=(0,l.default)(s.default.mark(function L(I){return s.default.wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return A.next=2,S.processDrop(I);case 2:case"end":return A.stop()}},L)}));return function(L){return E.apply(this,arguments)}}(),!0),this.readOnlyMutableListeners.on(w.nodes.holder,"dragstart",function(){S.processDragStart()}),this.readOnlyMutableListeners.on(w.nodes.holder,"dragover",function(E){S.processDragOver(E)},!0)}},{key:"disableModuleBindings",value:function(){this.readOnlyMutableListeners.clearAll()}},{key:"processDrop",value:(m=(0,l.default)(s.default.mark(function S(w){var E,L,I,A,B,T;return s.default.wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return E=this.Editor,L=E.BlockManager,I=E.Caret,A=E.Paste,w.preventDefault(),L.blocks.forEach(function(j){j.dropTarget=!1}),b.default.isAtEditor&&!b.default.isCollapsed&&this.isStartedAtEditor&&document.execCommand("delete"),this.isStartedAtEditor=!1,(B=L.setCurrentBlockByChildNode(w.target))?this.Editor.Caret.setToBlock(B,I.positions.END):(T=L.setCurrentBlockByChildNode(L.lastBlock.holder),this.Editor.Caret.setToBlock(T,I.positions.END)),M.next=9,A.processDataTransfer(w.dataTransfer,!0);case 9:case"end":return M.stop()}},S,this)})),function(S){return m.apply(this,arguments)})},{key:"processDragStart",value:function(){b.default.isAtEditor&&!b.default.isCollapsed&&(this.isStartedAtEditor=!0),this.Editor.InlineToolbar.close()}},{key:"processDragOver",value:function(S){S.preventDefault()}}]),x}((v=k(v)).default);a.default=O,O.displayName="DragNDrop",r.exports=t.default})=="function"?i.apply(t,n):i)===void 0||(r.exports=o)},function(r,t,e){var i,n,o;n=[t,e(2),e(3),e(5),e(6),e(4),e(7),e(8),e(61)],(o=typeof(i=function(a,s,l,u,c,h,p,g,b){"use strict";var v=e(9),k=e(1);function C(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,s=k(s),l=k(l),u=k(u),c=k(c),h=k(h),p=k(p),g=v(g),b=k(b);var O=function(d){(0,u.default)(y,d);var _,m=(_=y,function(){var x,S=(0,h.default)(_);if(C()){var w=(0,h.default)(this).constructor;x=Reflect.construct(S,arguments,w)}else x=S.apply(this,arguments);return(0,c.default)(this,x)});function y(){var x;return(0,s.default)(this,y),(x=m.apply(this,arguments)).disabled=!1,x.mutationDebouncer=g.debounce(function(){x.updateNativeInputs(),g.isFunction(x.config.onChange)&&x.config.onChange(x.Editor.API.methods)},y.DebounceTimer),x.nativeInputs=[],x}return(0,l.default)(y,[{key:"destroy",value:function(){var x=this;this.mutationDebouncer=null,this.observer&&this.observer.disconnect(),this.observer=null,this.nativeInputs.forEach(function(S){return x.listeners.off(S,"input",x.mutationDebouncer)}),this.mutationDebouncer=null}},{key:"toggleReadOnly",value:function(x){x?this.disableModule():this.enableModule()}},{key:"disable",value:function(){this.disabled=!0}},{key:"enable",value:function(){this.disabled=!1}},{key:"setObserver",value:function(){var x=this,S=this.Editor.UI;this.observer=new MutationObserver(function(w,E){x.mutationHandler(w,E)}),this.observer.observe(S.nodes.redactor,{childList:!0,attributes:!0,subtree:!0,characterData:!0,characterDataOldValue:!0})}},{key:"mutationHandler",value:function(x,S){if(!this.disabled){var w=!1;x.forEach(function(E){switch(E.type){case"childList":case"characterData":w=!0;break;case"attributes":E.target.classList.contains(b.default.CSS.wrapper)||(w=!0)}}),w&&this.mutationDebouncer()}}},{key:"updateNativeInputs",value:function(){var x=this;this.nativeInputs&&this.nativeInputs.forEach(function(S){x.listeners.off(S,"input")}),this.nativeInputs=Array.from(this.Editor.UI.nodes.redactor.querySelectorAll("textarea, input, select")),this.nativeInputs.forEach(function(S){return x.listeners.on(S,"input",x.mutationDebouncer)})}},{key:"enableModule",value:function(){var x=this;window.setTimeout(function(){x.setObserver(),x.updateNativeInputs(),x.enable()},1e3)}},{key:"disableModule",value:function(){this.disable()}}]),y}(p.default);a.default=O,O.displayName="ModificationsObserver",O.DebounceTimer=450,r.exports=t.default})=="function"?i.apply(t,n):i)===void 0||(r.exports=o)},function(r,t,e){var i,n,o;n=[t,e(2),e(3),e(5),e(6),e(4),e(7),e(378)],(o=typeof(i=function(a,s,l,u,c,h,p,g){"use strict";var b=e(1);function v(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(C){return!1}}Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,s=b(s),l=b(l),u=b(u),c=b(c),h=b(h),p=b(p),g=b(g);var k=function(C){(0,u.default)(_,C);var O,d=(O=_,function(){var m,y=(0,h.default)(O);if(v()){var x=(0,h.default)(this).constructor;m=Reflect.construct(y,arguments,x)}else m=y.apply(this,arguments);return(0,c.default)(this,m)});function _(){return(0,s.default)(this,_),d.apply(this,arguments)}return(0,l.default)(_,[{key:"show",value:function(m){g.default.show(m)}}]),_}(p.default);a.default=k,k.displayName="Notifier",r.exports=t.default})=="function"?i.apply(t,n):i)===void 0||(r.exports=o)},function(r,t,e){var i,n,o;n=[t,e(42),e(29),e(21),e(22),e(2),e(3),e(5),e(6),e(4),e(7),e(15),e(8)],(o=typeof(i=function(a,s,l,u,c,h,p,g,b,v,k,C,O){"use strict";var d=e(9),_=e(1);function m(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(x){return!1}}Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,s=_(s),l=_(l),u=_(u),c=_(c),h=_(h),p=_(p),g=_(g),b=_(b),v=_(v),k=_(k),C=_(C),O=d(O);var y=function(x){(0,g.default)(J,x);var S,w,E,L,I,A,B,T,M,j=(S=J,function(){var U,H=(0,v.default)(S);if(m()){var te=(0,v.default)(this).constructor;U=Reflect.construct(H,arguments,te)}else U=H.apply(this,arguments);return(0,b.default)(this,U)});function J(){var U;return(0,h.default)(this,J),(U=j.apply(this,arguments)).MIME_TYPE="application/x-editor-js",U.toolsTags={},U.tagsByTool={},U.toolsPatterns=[],U.toolsFiles={},U.exceptionList=[],U.processTool=function(H){try{var te=H.create({},{},!1);if(H.pasteConfig===!1)return void U.exceptionList.push(H.name);if(!O.isFunction(te.onPaste))return;U.getTagsConfig(H),U.getFilesConfig(H),U.getPatternsConfig(H)}catch(ae){O.log("Paste handling for \xAB".concat(H.name,"\xBB Tool hasn't been set up because of the error"),"warn",ae)}},U.handlePasteEvent=function(){var H=(0,c.default)(u.default.mark(function te(ae){var W,Y,re;return u.default.wrap(function(ie){for(;;)switch(ie.prev=ie.next){case 0:if(W=U.Editor,Y=W.BlockManager,re=W.Toolbar,Y.currentBlock&&(!U.isNativeBehaviour(ae.target)||ae.clipboardData.types.includes("Files"))){ie.next=3;break}return ie.abrupt("return");case 3:if(!Y.currentBlock||!U.exceptionList.includes(Y.currentBlock.name)){ie.next=5;break}return ie.abrupt("return");case 5:ae.preventDefault(),U.processDataTransfer(ae.clipboardData),Y.clearFocused(),re.close();case 9:case"end":return ie.stop()}},te)}));return function(te){return H.apply(this,arguments)}}(),U}return(0,p.default)(J,[{key:"prepare",value:(M=(0,c.default)(u.default.mark(function U(){return u.default.wrap(function(H){for(;;)switch(H.prev=H.next){case 0:this.processTools();case 1:case"end":return H.stop()}},U,this)})),function(){return M.apply(this,arguments)})},{key:"toggleReadOnly",value:function(U){U?this.unsetCallback():this.setCallback()}},{key:"processDataTransfer",value:(T=(0,c.default)(u.default.mark(function U(H){var te,ae,W,Y,re,ie,Q,ee,pe,be=arguments;return u.default.wrap(function(we){for(;;)switch(we.prev=we.next){case 0:if(te=be.length>1&&be[1]!==void 0&&be[1],ae=this.Editor.Sanitizer,!((W=H.types).includes?W.includes("Files"):W.contains("Files"))){we.next=8;break}return we.next=7,this.processFiles(H.files);case 7:return we.abrupt("return");case 8:if(Y=H.getData(this.MIME_TYPE),re=H.getData("text/plain"),ie=H.getData("text/html"),!Y){we.next=19;break}return we.prev=12,this.insertEditorJSData(JSON.parse(Y)),we.abrupt("return");case 17:we.prev=17,we.t0=we.catch(12);case 19:if(te&&re.trim()&&ie.trim()&&(ie="<p>"+(ie.trim()?ie:re)+"</p>"),Q=Object.keys(this.toolsTags).reduce(function(Le,fe){return Le[fe.toLowerCase()]=!0,Le},{}),ee=Object.assign({},Q,ae.getAllInlineToolsConfig(),{br:{}}),(pe=ae.clean(ie,ee)).trim()&&pe.trim()!==re&&C.default.isHTMLString(pe)){we.next=28;break}return we.next=26,this.processText(re);case 26:we.next=30;break;case 28:return we.next=30,this.processText(pe,!0);case 30:case"end":return we.stop()}},U,this,[[12,17]])})),function(U){return T.apply(this,arguments)})},{key:"processText",value:(B=(0,c.default)(u.default.mark(function U(H){var te,ae,W,Y,re,ie,Q,ee=this,pe=arguments;return u.default.wrap(function(be){for(;;)switch(be.prev=be.next){case 0:if(te=pe.length>1&&pe[1]!==void 0&&pe[1],ae=this.Editor,W=ae.Caret,Y=ae.BlockManager,(re=te?this.processHTML(H):this.processPlain(H)).length){be.next=5;break}return be.abrupt("return");case 5:if(re.length!==1){be.next=8;break}return re[0].isBlock?this.processSingleBlock(re.pop()):this.processInlinePaste(re.pop()),be.abrupt("return");case 8:ie=Y.currentBlock&&Y.currentBlock.tool.isDefault,Q=ie&&Y.currentBlock.isEmpty,re.map(function(){var we=(0,c.default)(u.default.mark(function Le(fe,xe){return u.default.wrap(function(Ne){for(;;)switch(Ne.prev=Ne.next){case 0:return Ne.abrupt("return",ee.insertBlock(fe,xe===0&&Q));case 1:case"end":return Ne.stop()}},Le)}));return function(Le,fe){return we.apply(this,arguments)}}()),Y.currentBlock&&W.setToBlock(Y.currentBlock,W.positions.END);case 12:case"end":return be.stop()}},U,this)})),function(U){return B.apply(this,arguments)})},{key:"setCallback",value:function(){this.listeners.on(this.Editor.UI.nodes.holder,"paste",this.handlePasteEvent)}},{key:"unsetCallback",value:function(){this.listeners.off(this.Editor.UI.nodes.holder,"paste",this.handlePasteEvent)}},{key:"processTools",value:function(){var U=this.Editor.Tools.blockTools;Array.from(U.values()).forEach(this.processTool)}},{key:"getTagsConfig",value:function(U){var H=this,te=U.pasteConfig.tags||[];te.forEach(function(ae){Object.prototype.hasOwnProperty.call(H.toolsTags,ae)?O.log("Paste handler for \xAB".concat(U.name,"\xBB Tool on \xAB").concat(ae,"\xBB tag is skipped ")+"because it is already used by \xAB".concat(H.toolsTags[ae].tool.name,"\xBB Tool."),"warn"):H.toolsTags[ae.toUpperCase()]={tool:U}}),this.tagsByTool[U.name]=te.map(function(ae){return ae.toUpperCase()})}},{key:"getFilesConfig",value:function(U){var H=U.pasteConfig.files,te=H===void 0?{}:H,ae=te.extensions,W=te.mimeTypes;(ae||W)&&(ae&&!Array.isArray(ae)&&(O.log("\xABextensions\xBB property of the onDrop config for \xAB".concat(U.name,"\xBB Tool should be an array")),ae=[]),W&&!Array.isArray(W)&&(O.log("\xABmimeTypes\xBB property of the onDrop config for \xAB".concat(U.name,"\xBB Tool should be an array")),W=[]),W&&(W=W.filter(function(Y){return!!O.isValidMimeType(Y)||(O.log("MIME type value \xAB".concat(Y,"\xBB for the \xAB").concat(U.name,"\xBB Tool is not a valid MIME type"),"warn"),!1)})),this.toolsFiles[U.name]={extensions:ae||[],mimeTypes:W||[]})}},{key:"getPatternsConfig",value:function(U){var H=this;U.pasteConfig.patterns&&!O.isEmpty(U.pasteConfig.patterns)&&Object.entries(U.pasteConfig.patterns).forEach(function(te){var ae=(0,l.default)(te,2),W=ae[0],Y=ae[1];Y instanceof RegExp||O.log("Pattern ".concat(Y," for \xAB").concat(U.name,"\xBB Tool is skipped because it should be a Regexp instance."),"warn"),H.toolsPatterns.push({key:W,pattern:Y,tool:U})})}},{key:"isNativeBehaviour",value:function(U){return C.default.isNativeInput(U)}},{key:"processFiles",value:(A=(0,c.default)(u.default.mark(function U(H){var te,ae,W,Y,re=this;return u.default.wrap(function(ie){for(;;)switch(ie.prev=ie.next){case 0:return te=this.Editor.BlockManager,ie.next=3,Promise.all(Array.from(H).map(function(Q){return re.processFile(Q)}));case 3:ae=(ae=ie.sent).filter(function(Q){return!!Q}),W=te.currentBlock.tool.isDefault,Y=W&&te.currentBlock.isEmpty,ae.forEach(function(Q,ee){te.paste(Q.type,Q.event,ee===0&&Y)});case 8:case"end":return ie.stop()}},U,this)})),function(U){return A.apply(this,arguments)})},{key:"processFile",value:(I=(0,c.default)(u.default.mark(function U(H){var te,ae,W,Y,re;return u.default.wrap(function(ie){for(;;)switch(ie.prev=ie.next){case 0:if(te=O.getFileExtension(H),ae=Object.entries(this.toolsFiles).find(function(Q){var ee=(0,l.default)(Q,2),pe=(ee[0],ee[1]),be=pe.mimeTypes,we=pe.extensions,Le=H.type.split("/"),fe=(0,l.default)(Le,2),xe=fe[0],Ne=fe[1],Be=we.find(function(Ze){return Ze.toLowerCase()===te.toLowerCase()}),Pe=be.find(function(Ze){var tt=Ze.split("/"),Xe=(0,l.default)(tt,2),Ke=Xe[0],nt=Xe[1];return Ke===xe&&(nt===Ne||nt==="*")});return!!Be||!!Pe})){ie.next=4;break}return ie.abrupt("return");case 4:return W=(0,l.default)(ae,1),Y=W[0],re=this.composePasteEvent("file",{file:H}),ie.abrupt("return",{event:re,type:Y});case 7:case"end":return ie.stop()}},U,this)})),function(U){return I.apply(this,arguments)})},{key:"processHTML",value:function(U){var H=this,te=this.Editor,ae=te.Tools,W=te.Sanitizer,Y=C.default.make("DIV");return Y.innerHTML=U,this.getNodes(Y).map(function(re){var ie,Q=ae.defaultTool,ee=!1;switch(re.nodeType){case Node.DOCUMENT_FRAGMENT_NODE:(ie=C.default.make("div")).appendChild(re);break;case Node.ELEMENT_NODE:ie=re,ee=!0,H.toolsTags[ie.tagName]&&(Q=H.toolsTags[ie.tagName].tool)}var pe=Q.pasteConfig.tags.reduce(function(Le,fe){return Le[fe.toLowerCase()]={},Le},{}),be=Object.assign({},pe,W.getInlineToolsConfig(Q));ie.innerHTML=W.clean(ie.innerHTML,be);var we=H.composePasteEvent("tag",{data:ie});return{content:ie,isBlock:ee,tool:Q.name,event:we}}).filter(function(re){return!C.default.isNodeEmpty(re.content)||C.default.isSingleTag(re.content)})}},{key:"processPlain",value:function(U){var H=this,te=this.config.defaultBlock;if(!U)return[];var ae=te;return U.split(/\r?\n/).filter(function(W){return W.trim()}).map(function(W){var Y=C.default.make("div");Y.textContent=W;var re=H.composePasteEvent("tag",{data:Y});return{content:Y,tool:ae,isBlock:!1,event:re}})}},{key:"processSingleBlock",value:(L=(0,c.default)(u.default.mark(function U(H){var te,ae,W,Y;return u.default.wrap(function(re){for(;;)switch(re.prev=re.next){case 0:if(te=this.Editor,ae=te.Caret,W=te.BlockManager,(Y=W.currentBlock)&&H.tool===Y.name&&C.default.containsOnlyInlineElements(H.content.innerHTML)){re.next=5;break}return this.insertBlock(H,(Y==null?void 0:Y.tool.isDefault)&&Y.isEmpty),re.abrupt("return");case 5:ae.insertContentAtCaretPosition(H.content.innerHTML);case 6:case"end":return re.stop()}},U,this)})),function(U){return L.apply(this,arguments)})},{key:"processInlinePaste",value:(E=(0,c.default)(u.default.mark(function U(H){var te,ae,W,Y,re,ie,Q,ee,pe;return u.default.wrap(function(be){for(;;)switch(be.prev=be.next){case 0:if(te=this.Editor,ae=te.BlockManager,W=te.Caret,Y=te.Sanitizer,re=H.content,!(ae.currentBlock&&ae.currentBlock.tool.isDefault&&re.textContent.length<J.PATTERN_PROCESSING_MAX_LENGTH)){be.next=12;break}return be.next=6,this.processPattern(re.textContent);case 6:if(!(ie=be.sent)){be.next=12;break}return Q=ae.currentBlock&&ae.currentBlock.tool.isDefault&&ae.currentBlock.isEmpty,ee=ae.paste(ie.tool,ie.event,Q),W.setToBlock(ee,W.positions.END),be.abrupt("return");case 12:ae.currentBlock&&ae.currentBlock.currentInput?(pe=Y.getInlineToolsConfig(ae.currentBlock.tool),document.execCommand("insertHTML",!1,Y.clean(re.innerHTML,pe))):this.insertBlock(H);case 13:case"end":return be.stop()}},U,this)})),function(U){return E.apply(this,arguments)})},{key:"processPattern",value:(w=(0,c.default)(u.default.mark(function U(H){var te,ae;return u.default.wrap(function(W){for(;;)switch(W.prev=W.next){case 0:if(te=this.toolsPatterns.find(function(Y){var re=Y.pattern.exec(H);return!!re&&H===re.shift()})){W.next=3;break}return W.abrupt("return");case 3:return ae=this.composePasteEvent("pattern",{key:te.key,data:H}),W.abrupt("return",{event:ae,tool:te.tool.name});case 5:case"end":return W.stop()}},U,this)})),function(U){return w.apply(this,arguments)})},{key:"insertBlock",value:function(U){var H,te=arguments.length>1&&arguments[1]!==void 0&&arguments[1],ae=this.Editor,W=ae.BlockManager,Y=ae.Caret,re=W.currentBlock;if(te&&re&&re.isEmpty)return H=W.paste(U.tool,U.event,!0),void Y.setToBlock(H,Y.positions.END);H=W.paste(U.tool,U.event),Y.setToBlock(H,Y.positions.END)}},{key:"insertEditorJSData",value:function(U){var H=this.Editor,te=H.BlockManager,ae=H.Caret;H.Sanitizer.sanitizeBlocks(U).forEach(function(W,Y){var re=W.tool,ie=W.data,Q=!1;Y===0&&(Q=te.currentBlock&&te.currentBlock.tool.isDefault&&te.currentBlock.isEmpty);var ee=te.insert({tool:re,data:ie,replace:Q});ae.setToBlock(ee,ae.positions.END)})}},{key:"processElementNode",value:function(U,H,te){var ae=Object.keys(this.toolsTags),W=U,Y=(this.toolsTags[W.tagName]||{}).tool,re=this.tagsByTool[Y==null?void 0:Y.name]||[],ie=ae.includes(W.tagName),Q=C.default.blockElements.includes(W.tagName.toLowerCase()),ee=Array.from(W.children).some(function(be){var we=be.tagName;return ae.includes(we)&&!re.includes(we)}),pe=Array.from(W.children).some(function(be){var we=be.tagName;return C.default.blockElements.includes(we.toLowerCase())});return Q||ie||ee?ie&&!ee||Q&&!pe&&!ee?[].concat((0,s.default)(H),[te,W]):void 0:(te.appendChild(W),[].concat((0,s.default)(H),[te]))}},{key:"getNodes",value:function(U){var H,te=this;return Array.from(U.childNodes).reduce(function ae(W,Y){if(C.default.isEmpty(Y)&&!C.default.isSingleTag(Y))return W;var re=W[W.length-1],ie=new DocumentFragment;switch(re&&C.default.isFragment(re)&&(ie=W.pop()),Y.nodeType){case Node.ELEMENT_NODE:if(H=te.processElementNode(Y,W,ie))return H;break;case Node.TEXT_NODE:return ie.appendChild(Y),[].concat((0,s.default)(W),[ie]);default:return[].concat((0,s.default)(W),[ie])}return[].concat((0,s.default)(W),(0,s.default)(Array.from(Y.childNodes).reduce(ae,[])))},[])}},{key:"composePasteEvent",value:function(U,H){return new CustomEvent(U,{detail:H})}}]),J}(k.default);a.default=y,y.displayName="Paste",y.PATTERN_PROCESSING_MAX_LENGTH=450,r.exports=t.default})=="function"?i.apply(t,n):i)===void 0||(r.exports=o)},function(r,t,e){var i,n,o;n=[t,e(21),e(29),e(22),e(2),e(3),e(5),e(6),e(4),e(7),e(145)],(o=typeof(i=function(a,s,l,u,c,h,p,g,b,v,k){"use strict";var C=e(1);function O(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(_){return!1}}Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,s=C(s),l=C(l),u=C(u),c=C(c),h=C(h),p=C(p),g=C(g),b=C(b);var d=function(_){(0,p.default)(w,_);var m,y,x,S=(m=w,function(){var E,L=(0,b.default)(m);if(O()){var I=(0,b.default)(this).constructor;E=Reflect.construct(L,arguments,I)}else E=L.apply(this,arguments);return(0,g.default)(this,E)});function w(){var E;return(0,c.default)(this,w),(E=S.apply(this,arguments)).toolsDontSupportReadOnly=[],E.readOnlyEnabled=!1,E}return(0,h.default)(w,[{key:"prepare",value:(x=(0,u.default)(s.default.mark(function E(){var L,I,A;return s.default.wrap(function(B){for(;;)switch(B.prev=B.next){case 0:L=this.Editor.Tools,I=L.blockTools,A=[],Array.from(I.entries()).forEach(function(T){var M=(0,l.default)(T,2),j=M[0];M[1].isReadOnlySupported||A.push(j)}),this.toolsDontSupportReadOnly=A,this.config.readOnly&&A.length>0&&this.throwCriticalError(),this.toggle(this.config.readOnly);case 7:case"end":return B.stop()}},E,this)})),function(){return x.apply(this,arguments)})},{key:"toggle",value:(y=(0,u.default)(s.default.mark(function E(){var L,I,A,B,T=arguments;return s.default.wrap(function(M){for(;;)switch(M.prev=M.next){case 0:(L=T.length>0&&T[0]!==void 0?T[0]:!this.readOnlyEnabled)&&this.toolsDontSupportReadOnly.length>0&&this.throwCriticalError(),I=this.readOnlyEnabled,this.readOnlyEnabled=L,M.t0=s.default.keys(this.Editor);case 5:if((M.t1=M.t0()).done){M.next=12;break}if(A=M.t1.value,this.Editor[A].toggleReadOnly){M.next=9;break}return M.abrupt("continue",5);case 9:this.Editor[A].toggleReadOnly(L),M.next=5;break;case 12:if(I!==L){M.next=14;break}return M.abrupt("return",this.readOnlyEnabled);case 14:return M.next=16,this.Editor.Saver.save();case 16:return B=M.sent,M.next=19,this.Editor.BlockManager.clear();case 19:return M.next=21,this.Editor.Renderer.render(B.blocks);case 21:return M.abrupt("return",this.readOnlyEnabled);case 22:case"end":return M.stop()}},E,this)})),function(){return y.apply(this,arguments)})},{key:"throwCriticalError",value:function(){throw new k.CriticalError("To enable read-only mode all connected tools should support it. Tools ".concat(this.toolsDontSupportReadOnly.join(", ")," don't support read-only mode."))}},{key:"isEnabled",get:function(){return this.readOnlyEnabled}}]),w}((v=C(v)).default);a.default=d,d.displayName="ReadOnly",r.exports=t.default})=="function"?i.apply(t,n):i)===void 0||(r.exports=o)},function(r,t,e){var i,n,o;n=[t,e(2),e(3),e(5),e(6),e(4),e(7),e(15),e(25),e(61)],(o=typeof(i=function(a,s,l,u,c,h,p,g,b,v){"use strict";var k=e(1);function C(m){if(typeof Symbol=="undefined"||m[Symbol.iterator]==null){if(Array.isArray(m)||(m=function(I,A){if(I){if(typeof I=="string")return O(I,A);var B=Object.prototype.toString.call(I).slice(8,-1);return B==="Object"&&I.constructor&&(B=I.constructor.name),B==="Map"||B==="Set"?Array.from(B):B==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(B)?O(I,A):void 0}}(m))){var y=0,x=function(){};return{s:x,n:function(){return y>=m.length?{done:!0}:{done:!1,value:m[y++]}},e:function(I){throw I},f:x}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var S,w,E=!0,L=!1;return{s:function(){S=m[Symbol.iterator]()},n:function(){var I=S.next();return E=I.done,I},e:function(I){L=!0,w=I},f:function(){try{E||S.return==null||S.return()}finally{if(L)throw w}}}}function O(m,y){(y==null||y>m.length)&&(y=m.length);for(var x=0,S=new Array(y);x<y;x++)S[x]=m[x];return S}function d(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(m){return!1}}Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,s=k(s),l=k(l),u=k(u),c=k(c),h=k(h),p=k(p),g=k(g),b=k(b),v=k(v);var _=function(m){(0,u.default)(S,m);var y,x=(y=S,function(){var w,E=(0,h.default)(y);if(d()){var L=(0,h.default)(this).constructor;w=Reflect.construct(E,arguments,L)}else w=E.apply(this,arguments);return(0,c.default)(this,w)});function S(){var w;return(0,s.default)(this,S),(w=x.apply(this,arguments)).isRectSelectionActivated=!1,w.SCROLL_SPEED=3,w.HEIGHT_OF_SCROLL_ZONE=40,w.BOTTOM_SCROLL_ZONE=1,w.TOP_SCROLL_ZONE=2,w.MAIN_MOUSE_BUTTON=0,w.mousedown=!1,w.isScrolling=!1,w.inScrollZone=null,w.startX=0,w.startY=0,w.mouseX=0,w.mouseY=0,w.stackOfSelected=[],w.listenerIds=[],w}return(0,l.default)(S,[{key:"prepare",value:function(){this.enableModuleBindings()}},{key:"startSelection",value:function(w,E){var L=document.elementFromPoint(w-window.pageXOffset,E-window.pageYOffset);L.closest(".".concat(this.Editor.Toolbar.CSS.toolbar))||(this.Editor.BlockSelection.allBlocksSelected=!1,this.clearSelection(),this.stackOfSelected=[]);var I=[".".concat(v.default.CSS.content),".".concat(this.Editor.Toolbar.CSS.toolbar),".".concat(this.Editor.InlineToolbar.CSS.inlineToolbar)],A=L.closest("."+this.Editor.UI.CSS.editorWrapper),B=I.some(function(T){return!!L.closest(T)});A&&!B&&(this.mousedown=!0,this.startX=w,this.startY=E)}},{key:"endSelection",value:function(){this.mousedown=!1,this.startX=0,this.startY=0,this.overlayRectangle.style.display="none"}},{key:"isRectActivated",value:function(){return this.isRectSelectionActivated}},{key:"clearSelection",value:function(){this.isRectSelectionActivated=!1}},{key:"enableModuleBindings",value:function(){var w=this,E=this.genHTML().container;this.listeners.on(E,"mousedown",function(L){w.processMouseDown(L)},!1),this.listeners.on(document.body,"mousemove",function(L){w.processMouseMove(L)},!1),this.listeners.on(document.body,"mouseleave",function(){w.processMouseLeave()}),this.listeners.on(window,"scroll",function(L){w.processScroll(L)},!1),this.listeners.on(document.body,"mouseup",function(){w.processMouseUp()},!1)}},{key:"processMouseDown",value:function(w){w.button===this.MAIN_MOUSE_BUTTON&&this.startSelection(w.pageX,w.pageY)}},{key:"processMouseMove",value:function(w){this.changingRectangle(w),this.scrollByZones(w.clientY)}},{key:"processMouseLeave",value:function(){this.clearSelection(),this.endSelection()}},{key:"processScroll",value:function(w){this.changingRectangle(w)}},{key:"processMouseUp",value:function(){this.endSelection()}},{key:"scrollByZones",value:function(w){this.inScrollZone=null,w<=this.HEIGHT_OF_SCROLL_ZONE&&(this.inScrollZone=this.TOP_SCROLL_ZONE),document.documentElement.clientHeight-w<=this.HEIGHT_OF_SCROLL_ZONE&&(this.inScrollZone=this.BOTTOM_SCROLL_ZONE),this.inScrollZone?this.isScrolling||(this.scrollVertical(this.inScrollZone===this.TOP_SCROLL_ZONE?-this.SCROLL_SPEED:this.SCROLL_SPEED),this.isScrolling=!0):this.isScrolling=!1}},{key:"genHTML",value:function(){var w=this.Editor.UI,E=w.nodes.holder.querySelector("."+w.CSS.editorWrapper),L=g.default.make("div",S.CSS.overlay,{}),I=g.default.make("div",S.CSS.overlayContainer,{}),A=g.default.make("div",S.CSS.rect,{});return I.appendChild(A),L.appendChild(I),E.appendChild(L),this.overlayRectangle=A,{container:E,overlay:L}}},{key:"scrollVertical",value:function(w){var E=this;if(this.inScrollZone&&this.mousedown){var L=window.pageYOffset;window.scrollBy(0,w),this.mouseY+=window.pageYOffset-L,setTimeout(function(){E.scrollVertical(w)},0)}}},{key:"changingRectangle",value:function(w){if(this.mousedown){w.pageY!==void 0&&(this.mouseX=w.pageX,this.mouseY=w.pageY);var E=this.genInfoForMouseSelection(),L=E.rightPos,I=E.leftPos,A=E.index,B=this.startX>L&&this.mouseX>L,T=this.startX<I&&this.mouseX<I;this.rectCrossesBlocks=!(B||T),this.isRectSelectionActivated||(this.rectCrossesBlocks=!1,this.isRectSelectionActivated=!0,this.shrinkRectangleToPoint(),this.overlayRectangle.style.display="block"),this.updateRectangleSize(),A!==void 0&&(this.trySelectNextBlock(A),this.inverseSelection(),b.default.get().removeAllRanges(),w.preventDefault())}}},{key:"shrinkRectangleToPoint",value:function(){this.overlayRectangle.style.left="".concat(this.startX-window.pageXOffset,"px"),this.overlayRectangle.style.top="".concat(this.startY-window.pageYOffset,"px"),this.overlayRectangle.style.bottom="calc(100% - ".concat(this.startY-window.pageYOffset,"px"),this.overlayRectangle.style.right="calc(100% - ".concat(this.startX-window.pageXOffset,"px")}},{key:"inverseSelection",value:function(){var w=this.Editor.BlockManager.getBlockByIndex(this.stackOfSelected[0]).selected;if(this.rectCrossesBlocks&&!w){var E,L=C(this.stackOfSelected);try{for(L.s();!(E=L.n()).done;){var I=E.value;this.Editor.BlockSelection.selectBlockByIndex(I)}}catch(M){L.e(M)}finally{L.f()}}if(!this.rectCrossesBlocks&&w){var A,B=C(this.stackOfSelected);try{for(B.s();!(A=B.n()).done;){var T=A.value;this.Editor.BlockSelection.unSelectBlockByIndex(T)}}catch(M){B.e(M)}finally{B.f()}}}},{key:"updateRectangleSize",value:function(){this.mouseY>=this.startY?(this.overlayRectangle.style.top="".concat(this.startY-window.pageYOffset,"px"),this.overlayRectangle.style.bottom="calc(100% - ".concat(this.mouseY-window.pageYOffset,"px")):(this.overlayRectangle.style.bottom="calc(100% - ".concat(this.startY-window.pageYOffset,"px"),this.overlayRectangle.style.top="".concat(this.mouseY-window.pageYOffset,"px")),this.mouseX>=this.startX?(this.overlayRectangle.style.left="".concat(this.startX-window.pageXOffset,"px"),this.overlayRectangle.style.right="calc(100% - ".concat(this.mouseX-window.pageXOffset,"px")):(this.overlayRectangle.style.right="calc(100% - ".concat(this.startX-window.pageXOffset,"px"),this.overlayRectangle.style.left="".concat(this.mouseX-window.pageXOffset,"px"))}},{key:"genInfoForMouseSelection",value:function(){var w,E=document.body.offsetWidth/2,L=this.mouseY-window.pageYOffset,I=document.elementFromPoint(E,L),A=this.Editor.BlockManager.getBlockByChildNode(I);A!==void 0&&(w=this.Editor.BlockManager.blocks.findIndex(function(M){return M.holder===A.holder}));var B=this.Editor.BlockManager.lastBlock.holder.querySelector("."+v.default.CSS.content),T=Number.parseInt(window.getComputedStyle(B).width,10)/2;return{index:w,leftPos:E-T,rightPos:E+T}}},{key:"addBlockInSelection",value:function(w){this.rectCrossesBlocks&&this.Editor.BlockSelection.selectBlockByIndex(w),this.stackOfSelected.push(w)}},{key:"trySelectNextBlock",value:function(w){var E=this,L=this.stackOfSelected[this.stackOfSelected.length-1]===w,I=this.stackOfSelected.length;if(!L){var A=this.stackOfSelected[I-1]-this.stackOfSelected[I-2]>0,B=0;I>1&&(B=A?1:-1);var T=w>this.stackOfSelected[I-1]&&B===1,M=w<this.stackOfSelected[I-1]&&B===-1,j=!(T||M||B===0);if(j||!(w>this.stackOfSelected[I-1]||this.stackOfSelected[I-1]===void 0)){if(!j&&w<this.stackOfSelected[I-1])for(var J=this.stackOfSelected[I-1]-1;J>=w;J--)this.addBlockInSelection(J);else if(j){var U,H=I-1;for(U=w>this.stackOfSelected[I-1]?function(){return w>E.stackOfSelected[H]}:function(){return w<E.stackOfSelected[H]};U();)this.rectCrossesBlocks&&this.Editor.BlockSelection.unSelectBlockByIndex(this.stackOfSelected[H]),this.stackOfSelected.pop(),H--}}else for(var te=this.stackOfSelected[I-1]+1||w;te<=w;te++)this.addBlockInSelection(te)}}}],[{key:"CSS",get:function(){return{overlay:"codex-editor-overlay",overlayContainer:"codex-editor-overlay__container",rect:"codex-editor-overlay__rectangle",topScrollZone:"codex-editor-overlay__scroll-zone--top",bottomScrollZone:"codex-editor-overlay__scroll-zone--bottom"}}}]),S}(p.default);a.default=_,_.displayName="RectangleSelection",r.exports=t.default})=="function"?i.apply(t,n):i)===void 0||(r.exports=o)},function(r,t,e){var i,n,o;n=[t,e(21),e(22),e(2),e(3),e(5),e(6),e(4),e(7),e(8)],(o=typeof(i=function(a,s,l,u,c,h,p,g,b,v){"use strict";var k=e(9),C=e(1);function O(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(_){return!1}}Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,s=C(s),l=C(l),u=C(u),c=C(c),h=C(h),p=C(p),g=C(g),b=C(b),v=k(v);var d=function(_){(0,h.default)(w,_);var m,y,x,S=(m=w,function(){var E,L=(0,g.default)(m);if(O()){var I=(0,g.default)(this).constructor;E=Reflect.construct(L,arguments,I)}else E=L.apply(this,arguments);return(0,p.default)(this,E)});function w(){return(0,u.default)(this,w),S.apply(this,arguments)}return(0,c.default)(w,[{key:"render",value:(x=(0,l.default)(s.default.mark(function E(L){var I,A,B=this;return s.default.wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return I=L.map(function(M){return{function:function(){return B.insertBlock(M)}}}),T.next=3,v.sequence(I);case 3:return A=T.sent,this.Editor.UI.checkEmptiness(),T.abrupt("return",A);case 6:case"end":return T.stop()}},E,this)})),function(E){return x.apply(this,arguments)})},{key:"insertBlock",value:(y=(0,l.default)(s.default.mark(function E(L){var I,A,B,T,M,j,J,U;return s.default.wrap(function(H){for(;;)switch(H.prev=H.next){case 0:if(I=this.Editor,A=I.Tools,B=I.BlockManager,T=L.type,M=L.data,j=L.tunes,!A.available.has(T)){H.next=13;break}H.prev=3,B.insert({tool:T,data:M,tunes:j}),H.next=11;break;case 7:throw H.prev=7,H.t0=H.catch(3),v.log("Block \xAB".concat(T,"\xBB skipped because of plugins error"),"warn",M),Error(H.t0);case 11:H.next=18;break;case 13:J={savedData:{type:T,data:M},title:T},A.unavailable.has(T)&&(U=A.unavailable.get(T).toolbox,J.title=(U==null?void 0:U.title)||J.title),B.insert({tool:A.stubTool,data:J}).stretched=!0,v.log("Tool \xAB".concat(T,"\xBB is not found. Check 'tools' property at your initial Editor.js config."),"warn");case 18:case"end":return H.stop()}},E,this,[[3,7]])})),function(E){return y.apply(this,arguments)})}]),w}(b.default);a.default=d,d.displayName="Renderer",r.exports=t.default})=="function"?i.apply(t,n):i)===void 0||(r.exports=o)},function(r,t,e){var i,n,o;n=[t,e(29),e(2),e(3),e(5),e(6),e(4),e(7),e(8),e(379)],(o=typeof(i=function(a,s,l,u,c,h,p,g,b,v){"use strict";var k=e(9),C=e(1);function O(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(_){return!1}}Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,s=C(s),l=C(l),u=C(u),c=C(c),h=C(h),p=C(p),g=C(g),b=k(b),v=C(v);var d=function(_){(0,c.default)(x,_);var m,y=(m=x,function(){var S,w=(0,p.default)(m);if(O()){var E=(0,p.default)(this).constructor;S=Reflect.construct(w,arguments,E)}else S=w.apply(this,arguments);return(0,h.default)(this,S)});function x(){var S;return(0,l.default)(this,x),(S=y.apply(this,arguments)).configCache={},S.inlineToolsConfigCache=null,S}return(0,u.default)(x,[{key:"sanitizeBlocks",value:function(S){var w=this;return S.map(function(E){var L=w.composeToolConfig(E.tool);return b.isEmpty(L)||(E.data=w.deepSanitize(E.data,L)),E})}},{key:"deepSanitize",value:function(S,w){return Array.isArray(S)?this.cleanArray(S,w):b.isObject(S)?this.cleanObject(S,w):b.isString(S)?this.cleanOneItem(S,w):S}},{key:"clean",value:function(S){var w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},E={tags:w},L=this.createHTMLJanitorInstance(E);return L.clean(S)}},{key:"composeToolConfig",value:function(S){if(this.configCache[S])return this.configCache[S];var w=this.Editor.Tools.available.get(S),E=this.getInlineToolsConfig(w);if(!w.sanitizeConfig||w.sanitizeConfig&&b.isEmpty(w.sanitizeConfig))return E;var L=w.sanitizeConfig,I={};for(var A in L)if(Object.prototype.hasOwnProperty.call(L,A)){var B=L[A];b.isObject(B)?I[A]=Object.assign({},E,B):I[A]=B}return this.configCache[S]=I,I}},{key:"getInlineToolsConfig",value:function(S){var w=this.Editor.Tools,E=S.enabledInlineTools||[],L={};return b.isBoolean(E)&&E?L=this.getAllInlineToolsConfig():E.map(function(I){L=Object.assign(L,w.inlineTools.get(I).sanitizeConfig)}),L.br=!0,L.wbr=!0,L}},{key:"getAllInlineToolsConfig",value:function(){var S=this.Editor.Tools;if(this.inlineToolsConfigCache)return this.inlineToolsConfigCache;var w={};return Object.entries(S.inlineTools).forEach(function(E){var L=(0,s.default)(E,2)[1];Object.assign(w,L.sanitizeConfig)}),this.inlineToolsConfigCache=w,this.inlineToolsConfigCache}},{key:"cleanArray",value:function(S,w){var E=this;return S.map(function(L){return E.deepSanitize(L,w)})}},{key:"cleanObject",value:function(S,w){var E={};for(var L in S)if(Object.prototype.hasOwnProperty.call(S,L)){var I=S[L],A=this.isRule(w[L])?w[L]:w;E[L]=this.deepSanitize(I,A)}return E}},{key:"cleanOneItem",value:function(S,w){return b.isObject(w)?this.clean(S,w):w===!1?this.clean(S,{}):S}},{key:"isRule",value:function(S){return b.isObject(S)||b.isBoolean(S)||b.isFunction(S)}},{key:"createHTMLJanitorInstance",value:function(S){return S?new v.default(S):null}}]),x}(g.default);a.default=d,d.displayName="Sanitizer",r.exports=t.default})=="function"?i.apply(t,n):i)===void 0||(r.exports=o)},function(r,t,e){var i,n,o;n=[t,e(21),e(22),e(2),e(3),e(5),e(6),e(4),e(7),e(8)],(o=typeof(i=function(a,s,l,u,c,h,p,g,b,v){"use strict";var k=e(9),C=e(1);function O(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(_){return!1}}Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,s=C(s),l=C(l),u=C(u),c=C(c),h=C(h),p=C(p),g=C(g),b=C(b),v=k(v);var d=function(_){(0,h.default)(w,_);var m,y,x,S=(m=w,function(){var E,L=(0,g.default)(m);if(O()){var I=(0,g.default)(this).constructor;E=Reflect.construct(L,arguments,I)}else E=L.apply(this,arguments);return(0,p.default)(this,E)});function w(){return(0,u.default)(this,w),S.apply(this,arguments)}return(0,c.default)(w,[{key:"save",value:(x=(0,l.default)(s.default.mark(function E(){var L,I,A,B,T,M,j,J,U=this;return s.default.wrap(function(H){for(;;)switch(H.prev=H.next){case 0:return L=this.Editor,I=L.BlockManager,A=L.Sanitizer,B=L.ModificationsObserver,T=I.blocks,M=[],B.disable(),H.prev=3,T.forEach(function(te){M.push(U.getSavedData(te))}),H.next=7,Promise.all(M);case 7:return j=H.sent,H.next=10,A.sanitizeBlocks(j);case 10:return J=H.sent,H.abrupt("return",this.makeOutput(J));case 12:return H.prev=12,B.enable(),H.finish(12);case 15:case"end":return H.stop()}},E,this,[[3,,12,15]])})),function(){return x.apply(this,arguments)})},{key:"getSavedData",value:(y=(0,l.default)(s.default.mark(function E(L){var I,A;return s.default.wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return B.next=2,L.save();case 2:if(I=B.sent,B.t0=I,!B.t0){B.next=8;break}return B.next=7,L.validate(I.data);case 7:B.t0=B.sent;case 8:return A=B.t0,B.abrupt("return",Object.assign(Object.assign({},I),{isValid:A}));case 10:case"end":return B.stop()}},E)})),function(E){return y.apply(this,arguments)})},{key:"makeOutput",value:function(E){var L=this,I=0,A=[];return v.log("[Editor.js saving]:","groupCollapsed"),E.forEach(function(B){var T=B.tool,M=B.data,j=B.tunes,J=B.time,U=B.isValid;if(I+=J,v.log("".concat(T.charAt(0).toUpperCase()+T.slice(1)),"group"),!U)return v.log("Block \xAB".concat(T,"\xBB skipped because saved data is invalid")),void v.log(void 0,"groupEnd");if(v.log(M),v.log(void 0,"groupEnd"),T!==L.Editor.Tools.stubTool){var H={type:T,data:M};v.isEmpty(j)||(H.tunes=j),A.push(H)}else A.push(M)}),v.log("Total","log",I),v.log(void 0,"groupEnd"),{time:+new Date,blocks:A,version:"2.20.0"}}}]),w}(b.default);a.default=d,d.displayName="Saver",r.exports=t.default})=="function"?i.apply(t,n):i)===void 0||(r.exports=o)},function(r,t,e){var i,n,o;n=[t,e(29),e(2),e(3),e(5),e(6),e(4),e(7),e(15),e(60),e(8),e(25)],(o=typeof(i=function(a,s,l,u,c,h,p,g,b,v,k,C){"use strict";var O=e(9),d=e(1);function _(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(y){return!1}}Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,s=d(s),l=d(l),u=d(u),c=d(c),h=d(h),p=d(p),g=d(g),b=d(b),v=d(v),k=O(k),C=d(C);var m=function(y){(0,c.default)(w,y);var x,S=(x=w,function(){var E,L=(0,p.default)(x);if(_()){var I=(0,p.default)(this).constructor;E=Reflect.construct(L,arguments,I)}else E=L.apply(this,arguments);return(0,h.default)(this,E)});function w(){var E;return(0,l.default)(this,w),(E=S.apply(this,arguments)).buttons=[],E.flipper=null,E.selection=new C.default,E}return(0,u.default)(w,[{key:"make",value:function(){this.nodes.wrapper=b.default.make("div",this.CSS.wrapper),this.nodes.toolSettings=b.default.make("div",this.CSS.toolSettings),this.nodes.defaultSettings=b.default.make("div",this.CSS.defaultSettings),b.default.append(this.nodes.wrapper,[this.nodes.toolSettings,this.nodes.defaultSettings]),this.enableFlipper()}},{key:"destroy",value:function(){this.flipper&&(this.flipper.deactivate(),this.flipper=null),this.removeAllNodes()}},{key:"open",value:function(){this.nodes.wrapper.classList.add(this.CSS.wrapperOpened),this.selection.save(),this.Editor.BlockManager.currentBlock.selected=!0,this.Editor.BlockSelection.clearCache(),this.addToolSettings(),this.addTunes(),this.eventsDispatcher.emit(this.events.opened),this.flipper.activate(this.blockTunesButtons)}},{key:"close",value:function(){this.nodes.wrapper.classList.remove(this.CSS.wrapperOpened),C.default.isAtEditor||this.selection.restore(),this.selection.clearSaved(),!this.Editor.CrossBlockSelection.isCrossBlockSelectionStarted&&this.Editor.BlockManager.currentBlock&&(this.Editor.BlockManager.currentBlock.selected=!1),this.nodes.toolSettings.innerHTML="",this.nodes.defaultSettings.innerHTML="",this.eventsDispatcher.emit(this.events.closed),this.buttons=[],this.flipper.deactivate()}},{key:"addToolSettings",value:function(){var E=this.Editor.BlockManager.currentBlock.renderSettings();E&&b.default.append(this.nodes.toolSettings,E)}},{key:"addTunes",value:function(){var E=this.Editor.BlockManager.currentBlock.renderTunes(),L=(0,s.default)(E,2),I=L[0],A=L[1];b.default.append(this.nodes.toolSettings,I),b.default.append(this.nodes.defaultSettings,A)}},{key:"enableFlipper",value:function(){var E=this;this.flipper=new v.default({focusedItemClass:this.CSS.focusedButton,activateCallback:function(L){L&&b.default.canSetCaret(L)?E.close():k.delay(function(){E.Editor.Caret.setToBlock(E.Editor.BlockManager.currentBlock)},50)()}})}},{key:"events",get:function(){return{opened:"block-settings-opened",closed:"block-settings-closed"}}},{key:"CSS",get:function(){return{wrapper:"ce-settings",wrapperOpened:"ce-settings--opened",toolSettings:"ce-settings__plugin-zone",defaultSettings:"ce-settings__default-zone",button:"ce-settings__button",focusedButton:"ce-settings__button--focused",focusedButtonAnimated:"ce-settings__button--focused-animated"}}},{key:"opened",get:function(){return this.nodes.wrapper.classList.contains(this.CSS.wrapperOpened)}},{key:"blockTunesButtons",get:function(){var E=this,L=this.Editor.StylesAPI;if(this.buttons.length!==0)return this.buttons;var I=this.nodes.toolSettings.querySelectorAll(".".concat(L.classes.settingsButton,", ").concat(b.default.allInputsSelector)),A=this.nodes.defaultSettings.querySelectorAll(".".concat(this.CSS.button));return I.forEach(function(B){E.buttons.push(B)}),A.forEach(function(B){E.buttons.push(B)}),this.buttons}}]),w}(g.default);a.default=m,m.displayName="BlockSettings",r.exports=t.default})=="function"?i.apply(t,n):i)===void 0||(r.exports=o)},function(r,t,e){var i,n,o;n=[t,e(29),e(21),e(22),e(42),e(2),e(3),e(5),e(6),e(4),e(7),e(15),e(8),e(60),e(59),e(81)],(o=typeof(i=function(a,s,l,u,c,h,p,g,b,v,k,C,O,d,_,m){"use strict";var y=e(9),x=e(1);function S(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(E){return!1}}Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,s=x(s),l=x(l),u=x(u),c=x(c),h=x(h),p=x(p),g=x(g),b=x(b),v=x(v),k=x(k),C=x(C),O=y(O),d=x(d),_=x(_);var w=function(E){(0,g.default)(B,E);var L,I,A=(L=B,function(){var T,M=(0,v.default)(L);if(S()){var j=(0,v.default)(this).constructor;T=Reflect.construct(M,arguments,j)}else T=M.apply(this,arguments);return(0,b.default)(this,T)});function B(){var T;return(0,h.default)(this,B),(T=A.apply(this,arguments)).opened=!1,T.tools={},T.flipper=null,T.togglingCallback=null,T}return(0,p.default)(B,[{key:"make",value:function(){this.nodes.wrapper=C.default.make("div",[B.CSS.conversionToolbarWrapper].concat((0,c.default)(this.isRtl?[this.Editor.UI.CSS.editorRtlFix]:[]))),this.nodes.tools=C.default.make("div",B.CSS.conversionToolbarTools);var T=C.default.make("div",B.CSS.conversionToolbarLabel,{textContent:_.default.ui(m.I18nInternalNS.ui.inlineToolbar.converter,"Convert to")});return this.addTools(),this.enableFlipper(),C.default.append(this.nodes.wrapper,T),C.default.append(this.nodes.wrapper,this.nodes.tools),this.nodes.wrapper}},{key:"destroy",value:function(){this.flipper&&(this.flipper.deactivate(),this.flipper=null),this.removeAllNodes()}},{key:"toggle",value:function(T){this.opened?this.close():this.open(),O.isFunction(T)&&(this.togglingCallback=T)}},{key:"open",value:function(){var T=this;this.filterTools(),this.opened=!0,this.nodes.wrapper.classList.add(B.CSS.conversionToolbarShowed),setTimeout(function(){T.flipper.activate(Object.values(T.tools).filter(function(M){return!M.classList.contains(B.CSS.conversionToolHidden)})),T.flipper.focusFirst(),O.isFunction(T.togglingCallback)&&T.togglingCallback(!0)},50)}},{key:"close",value:function(){this.opened=!1,this.flipper.deactivate(),this.nodes.wrapper.classList.remove(B.CSS.conversionToolbarShowed),O.isFunction(this.togglingCallback)&&this.togglingCallback(!1)}},{key:"hasTools",value:function(){var T=Object.keys(this.tools);return!(T.length===1&&T.shift()===this.config.defaultBlock)}},{key:"replaceWithBlock",value:(I=(0,u.default)(l.default.mark(function T(M){var j,J,U,H,te,ae,W,Y,re,ie,Q=this;return l.default.wrap(function(ee){for(;;)switch(ee.prev=ee.next){case 0:return j=this.Editor.BlockManager.currentBlock.tool,J=this.Editor.BlockManager.currentBlock.name,ee.next=4,this.Editor.BlockManager.currentBlock.save();case 4:if(U=ee.sent,H=U.data,J===M&&(M=this.config.defaultBlock),te=this.Editor.Tools.blockTools.get(M),ae="",W=j.conversionConfig.export,!O.isFunction(W)){ee.next=14;break}ae=W(H),ee.next=20;break;case 14:if(!O.isString(W)){ee.next=18;break}ae=H[W],ee.next=20;break;case 18:return O.log("Conversion \xABexport\xBB property must be a string or function. String means key of saved data object to export. Function should export processed string to export."),ee.abrupt("return");case 20:if(Y=this.Editor.Sanitizer.clean(ae,te.sanitizeConfig),re={},ie=te.conversionConfig.import,!O.isFunction(ie)){ee.next=27;break}re=ie(Y),ee.next=33;break;case 27:if(!O.isString(ie)){ee.next=31;break}re[ie]=Y,ee.next=33;break;case 31:return O.log("Conversion \xABimport\xBB property must be a string or function. String means key of tool data to import. Function accepts a imported string and return composed tool data."),ee.abrupt("return");case 33:this.Editor.BlockManager.replace({tool:M,data:re}),this.Editor.BlockSelection.clearSelection(),this.close(),this.Editor.InlineToolbar.close(),O.delay(function(){Q.Editor.Caret.setToBlock(Q.Editor.BlockManager.currentBlock)},10)();case 38:case"end":return ee.stop()}},T,this)})),function(T){return I.apply(this,arguments)})},{key:"addTools",value:function(){var T=this,M=this.Editor.Tools.blockTools;Array.from(M.entries()).forEach(function(j){var J=(0,s.default)(j,2),U=J[0],H=J[1],te=H.toolbox,ae=H.conversionConfig;!O.isEmpty(te)&&te.icon&&ae&&ae.import&&T.addTool(U,te.icon,te.title)})}},{key:"addTool",value:function(T,M,j){var J=this,U=C.default.make("div",[B.CSS.conversionTool]),H=C.default.make("div",[B.CSS.conversionToolIcon]);U.dataset.tool=T,H.innerHTML=M,C.default.append(U,H),C.default.append(U,C.default.text(_.default.t(m.I18nInternalNS.toolNames,j||O.capitalize(T)))),C.default.append(this.nodes.tools,U),this.tools[T]=U,this.listeners.on(U,"click",(0,u.default)(l.default.mark(function te(){return l.default.wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return ae.next=2,J.replaceWithBlock(T);case 2:case"end":return ae.stop()}},te)})))}},{key:"filterTools",value:function(){var T=this.Editor.BlockManager.currentBlock;Object.entries(this.tools).forEach(function(M){var j=(0,s.default)(M,2),J=j[0],U=j[1];U.hidden=!1,U.classList.toggle(B.CSS.conversionToolHidden,J===T.name)})}},{key:"enableFlipper",value:function(){this.flipper=new d.default({focusedItemClass:B.CSS.conversionToolFocused})}}],[{key:"CSS",get:function(){return{conversionToolbarWrapper:"ce-conversion-toolbar",conversionToolbarShowed:"ce-conversion-toolbar--showed",conversionToolbarTools:"ce-conversion-toolbar__tools",conversionToolbarLabel:"ce-conversion-toolbar__label",conversionTool:"ce-conversion-tool",conversionToolHidden:"ce-conversion-tool--hidden",conversionToolIcon:"ce-conversion-tool__icon",conversionToolFocused:"ce-conversion-tool--focused",conversionToolActive:"ce-conversion-tool--active"}}}]),B}(k.default);a.default=w,w.displayName="ConversionToolbar",r.exports=t.default})=="function"?i.apply(t,n):i)===void 0||(r.exports=o)},function(r,t,e){var i,n,o;n=[t,e(42),e(29),e(2),e(3),e(5),e(6),e(4),e(7),e(15),e(25),e(8),e(60),e(59),e(81),e(108),e(66)],(o=typeof(i=function(a,s,l,u,c,h,p,g,b,v,k,C,O,d,_,m,y){"use strict";var x=e(9),S=e(1);function w(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(L){return!1}}Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,s=S(s),l=S(l),u=S(u),c=S(c),h=S(h),p=S(p),g=S(g),b=S(b),v=S(v),k=S(k),C=x(C),O=S(O),d=S(d),m=S(m);var E=function(L){(0,h.default)(B,L);var I,A=(I=B,function(){var T,M=(0,g.default)(I);if(w()){var j=(0,g.default)(this).constructor;T=Reflect.construct(M,arguments,j)}else T=M.apply(this,arguments);return(0,p.default)(this,T)});function B(){var T;return(0,u.default)(this,B),(T=A.apply(this,arguments)).CSS={inlineToolbar:"ce-inline-toolbar",inlineToolbarShowed:"ce-inline-toolbar--showed",inlineToolbarLeftOriented:"ce-inline-toolbar--left-oriented",inlineToolbarRightOriented:"ce-inline-toolbar--right-oriented",inlineToolbarShortcut:"ce-inline-toolbar__shortcut",buttonsWrapper:"ce-inline-toolbar__buttons",actionsWrapper:"ce-inline-toolbar__actions",inlineToolButton:"ce-inline-tool",inputField:"cdx-input",focusedButton:"ce-inline-tool--focused",conversionToggler:"ce-inline-toolbar__dropdown",conversionTogglerHidden:"ce-inline-toolbar__dropdown--hidden",conversionTogglerContent:"ce-inline-toolbar__dropdown-content",togglerAndButtonsWrapper:"ce-inline-toolbar__toggler-and-button-wrapper"},T.opened=!1,T.toolbarVerticalMargin=5,T.buttonsList=null,T.width=0,T.flipper=null,T}return(0,c.default)(B,[{key:"toggleReadOnly",value:function(T){T?(this.destroy(),this.Editor.ConversionToolbar.destroy()):this.make()}},{key:"tryToShow",value:function(){var T=arguments.length>0&&arguments[0]!==void 0&&arguments[0];this.allowedToShow()?(this.move(),this.open(),this.Editor.Toolbar.close()):T&&this.close()}},{key:"move",value:function(){var T=k.default.rect,M=this.Editor.UI.nodes.wrapper.getBoundingClientRect(),j={x:T.x-M.left,y:T.y+T.height-M.top+this.toolbarVerticalMargin};T.width&&(j.x+=Math.floor(T.width/2));var J=j.x-this.width/2,U=j.x+this.width/2;this.nodes.wrapper.classList.toggle(this.CSS.inlineToolbarLeftOriented,J<this.Editor.UI.contentRect.left),this.nodes.wrapper.classList.toggle(this.CSS.inlineToolbarRightOriented,U>this.Editor.UI.contentRect.right),this.nodes.wrapper.style.left=Math.floor(j.x)+"px",this.nodes.wrapper.style.top=Math.floor(j.y)+"px"}},{key:"close",value:function(){var T=this;this.opened&&(this.Editor.ReadOnly.isEnabled||(this.nodes.wrapper.classList.remove(this.CSS.inlineToolbarShowed),Array.from(this.toolsInstances.entries()).forEach(function(M){var j=(0,l.default)(M,2),J=j[0],U=j[1],H=T.getToolShortcut(J);H&&m.default.remove(T.Editor.UI.nodes.redactor,H),C.isFunction(U.clear)&&U.clear()}),this.opened=!1,this.flipper.deactivate(),this.Editor.ConversionToolbar.close()))}},{key:"open",value:function(){if(!this.opened){this.addToolsFiltered(),this.nodes.wrapper.classList.add(this.CSS.inlineToolbarShowed),this.buttonsList=this.nodes.buttons.querySelectorAll(".".concat(this.CSS.inlineToolButton)),this.opened=!0,this.Editor.ConversionToolbar.hasTools()?this.setConversionTogglerContent():this.nodes.conversionToggler.hidden=!0;var T=Array.from(this.buttonsList);T.unshift(this.nodes.conversionToggler),T=T.filter(function(M){return!M.hidden}),this.flipper.activate(T)}}},{key:"containsNode",value:function(T){return this.nodes.wrapper.contains(T)}},{key:"destroy",value:function(){this.flipper&&(this.flipper.deactivate(),this.flipper=null),this.removeAllNodes()}},{key:"getInlineToolbarSettings",value:function(T){var M=T.enabledInlineTools;if(M!==!0&&!Array.isArray(M))return!1;if(Array.isArray(M))return M;var j=this.config.inlineToolbar;return Array.isArray(j)?j:j===!0&&Array.from(this.Editor.Tools.inlineTools.keys())}},{key:"make",value:function(){var T=this;this.nodes.wrapper=v.default.make("div",[this.CSS.inlineToolbar].concat((0,s.default)(this.isRtl?[this.Editor.UI.CSS.editorRtlFix]:[]))),this.nodes.togglerAndButtonsWrapper=v.default.make("div",this.CSS.togglerAndButtonsWrapper),this.nodes.buttons=v.default.make("div",this.CSS.buttonsWrapper),this.nodes.actions=v.default.make("div",this.CSS.actionsWrapper),this.listeners.on(this.nodes.wrapper,"mousedown",function(M){M.target.closest(".".concat(T.CSS.actionsWrapper))||M.preventDefault()}),v.default.append(this.nodes.wrapper,[this.nodes.togglerAndButtonsWrapper,this.nodes.actions]),v.default.append(this.Editor.UI.nodes.wrapper,this.nodes.wrapper),this.addConversionToggler(),v.default.append(this.nodes.togglerAndButtonsWrapper,this.nodes.buttons),this.prepareConversionToolbar(),this.recalculateWidth(),this.enableFlipper()}},{key:"allowedToShow",value:function(){var T=k.default.get(),M=k.default.text;if(!T||!T.anchorNode||T.isCollapsed||M.length<1)return!1;var j=v.default.isElement(T.anchorNode)?T.anchorNode:T.anchorNode.parentElement;if(T&&["IMG","INPUT"].includes(j.tagName)||j.closest('[contenteditable="true"]')===null)return!1;var J=this.Editor.BlockManager.getBlock(T.anchorNode);return!!J&&this.getInlineToolbarSettings(J.tool)!==!1}},{key:"recalculateWidth",value:function(){this.width=this.nodes.wrapper.offsetWidth}},{key:"addConversionToggler",value:function(){var T=this;this.nodes.conversionToggler=v.default.make("div",this.CSS.conversionToggler),this.nodes.conversionTogglerContent=v.default.make("div",this.CSS.conversionTogglerContent);var M=v.default.svg("toggler-down",13,13);this.nodes.conversionToggler.appendChild(this.nodes.conversionTogglerContent),this.nodes.conversionToggler.appendChild(M),this.nodes.togglerAndButtonsWrapper.appendChild(this.nodes.conversionToggler),this.listeners.on(this.nodes.conversionToggler,"click",function(){T.Editor.ConversionToolbar.toggle(function(j){!j&&T.opened?T.flipper.activate():T.opened&&T.flipper.deactivate()})}),this.Editor.Tooltip.onHover(this.nodes.conversionToggler,d.default.ui(_.I18nInternalNS.ui.inlineToolbar.converter,"Convert to"),{placement:"top",hidingDelay:100})}},{key:"setConversionTogglerContent",value:function(){var T=this.Editor.BlockManager.currentBlock,M=T.name,j=T.tool.conversionConfig,J=j&&j.export;this.nodes.conversionToggler.hidden=!J,this.nodes.conversionToggler.classList.toggle(this.CSS.conversionTogglerHidden,!J);var U=T.tool.toolbox||{};this.nodes.conversionTogglerContent.innerHTML=U.icon||U.title||C.capitalize(M)}},{key:"prepareConversionToolbar",value:function(){var T=this.Editor.ConversionToolbar.make();v.default.append(this.nodes.wrapper,T)}},{key:"addToolsFiltered",value:function(){var T=this,M=k.default.get(),j=this.Editor.BlockManager.getBlock(M.anchorNode);this.nodes.buttons.innerHTML="",this.nodes.actions.innerHTML="",this.toolsInstances=new Map,this.getInlineToolbarSettings(j.tool).forEach(function(J){var U=T.Editor.Tools.inlineTools.get(J);T.addTool(U)}),this.recalculateWidth()}},{key:"addTool",value:function(T){var M=this,j=this.Editor.Tooltip,J=T.create(),U=J.render();if(U){if(U.dataset.tool=T.name,this.nodes.buttons.appendChild(U),this.toolsInstances.set(T.name,J),C.isFunction(J.renderActions)){var H=J.renderActions();this.nodes.actions.appendChild(H)}this.listeners.on(U,"click",function(Y){M.toolClicked(J),Y.preventDefault()});var te=this.getToolShortcut(T.name);if(te)try{this.enableShortcuts(J,te)}catch(Y){}var ae=v.default.make("div"),W=d.default.t(_.I18nInternalNS.toolNames,T.title||C.capitalize(T.name));ae.appendChild(v.default.text(W)),te&&ae.appendChild(v.default.make("div",this.CSS.inlineToolbarShortcut,{textContent:C.beautifyShortcut(te)})),j.onHover(U,ae,{placement:"top",hidingDelay:100}),J.checkState(k.default.get())}else C.log("Render method must return an instance of Node","warn",T.name)}},{key:"getToolShortcut",value:function(T){var M=this.Editor.Tools,j=M.inlineTools.get(T),J=M.internal.inlineTools;return Array.from(J.keys()).includes(T)?this.inlineTools[T][y.CommonInternalSettings.Shortcut]:j.shortcut}},{key:"enableShortcuts",value:function(T,M){var j=this;m.default.add({name:M,handler:function(J){var U=j.Editor.BlockManager.currentBlock;U&&U.tool.enabledInlineTools&&(J.preventDefault(),j.toolClicked(T))},on:this.Editor.UI.nodes.redactor})}},{key:"toolClicked",value:function(T){var M=k.default.range;T.surround(M),this.checkToolsState()}},{key:"checkToolsState",value:function(){this.toolsInstances.forEach(function(T){T.checkState(k.default.get())})}},{key:"enableFlipper",value:function(){this.flipper=new O.default({focusedItemClass:this.CSS.focusedButton,allowArrows:!1})}},{key:"inlineTools",get:function(){var T={};return Array.from(this.Editor.Tools.inlineTools.entries()).forEach(function(M){var j=(0,l.default)(M,2),J=j[0],U=j[1];T[J]=U.create()}),T}}]),B}(b.default);a.default=E,E.displayName="InlineToolbar",r.exports=t.default})=="function"?i.apply(t,n):i)===void 0||(r.exports=o)},function(r,t,e){var i,n,o;n=[t,e(2),e(3),e(5),e(6),e(4),e(7),e(15),e(8),e(60),e(61),e(59),e(81),e(108)],(o=typeof(i=function(a,s,l,u,c,h,p,g,b,v,k,C,O,d){"use strict";var _=e(9),m=e(1);function y(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(S){return!1}}Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,s=m(s),l=m(l),u=m(u),c=m(c),h=m(h),p=m(p),g=m(g),b=_(b),v=m(v),C=m(C),d=m(d);var x=function(S){(0,u.default)(L,S);var w,E=(w=L,function(){var I,A=(0,h.default)(w);if(y()){var B=(0,h.default)(this).constructor;I=Reflect.construct(A,arguments,B)}else I=A.apply(this,arguments);return(0,c.default)(this,I)});function L(){var I;return(0,s.default)(this,L),(I=E.apply(this,arguments)).nodes={toolbox:null,buttons:[]},I.opened=!1,I.displayedToolsCount=0,I.flipper=null,I}return(0,l.default)(L,[{key:"make",value:function(){this.nodes.toolbox=g.default.make("div",this.CSS.toolbox),this.addTools(),this.enableFlipper()}},{key:"destroy",value:function(){this.flipper&&(this.flipper.deactivate(),this.flipper=null),this.removeAllNodes(),this.removeAllShortcuts()}},{key:"toolButtonActivate",value:function(I,A){this.insertNewBlock(A)}},{key:"open",value:function(){this.isEmpty||(this.Editor.UI.nodes.wrapper.classList.add(this.CSS.openedToolbarHolderModifier),this.nodes.toolbox.classList.add(this.CSS.toolboxOpened),this.opened=!0,this.flipper.activate())}},{key:"close",value:function(){this.nodes.toolbox.classList.remove(this.CSS.toolboxOpened),this.Editor.UI.nodes.wrapper.classList.remove(this.CSS.openedToolbarHolderModifier),this.opened=!1,this.flipper.deactivate()}},{key:"toggle",value:function(){this.opened?this.close():this.open()}},{key:"addTools",value:function(){var I=this,A=this.Editor.Tools.blockTools;Array.from(A.values()).forEach(function(B){return I.addTool(B)})}},{key:"addTool",value:function(I){var A=this,B=I.toolbox;if(B)if(!B||B.icon){var T=g.default.make("li",[this.CSS.toolboxButton]);T.dataset.tool=I.name,T.innerHTML=B.icon,g.default.append(this.nodes.toolbox,T),this.nodes.toolbox.appendChild(T),this.nodes.buttons.push(T),this.listeners.on(T,"click",function(J){A.toolButtonActivate(J,I.name)});var M=this.drawTooltip(I);this.Editor.Tooltip.onHover(T,M,{placement:"bottom",hidingDelay:200});var j=I.shortcut;j&&this.enableShortcut(I.name,j),this.displayedToolsCount++}else b.log("Toolbar icon is missed. Tool %o skipped","warn",I.name)}},{key:"drawTooltip",value:function(I){var A=I.toolbox||{},B=C.default.t(O.I18nInternalNS.toolNames,A.title||I.name),T=I.shortcut,M=g.default.make("div",this.CSS.buttonTooltip),j=document.createTextNode(b.capitalize(B));return M.appendChild(j),T&&(T=b.beautifyShortcut(T),M.appendChild(g.default.make("div",this.CSS.buttonShortcut,{textContent:T}))),M}},{key:"enableShortcut",value:function(I,A){var B=this;d.default.add({name:A,handler:function(T){T.preventDefault(),B.insertNewBlock(I)},on:this.Editor.UI.nodes.redactor})}},{key:"removeAllShortcuts",value:function(){var I=this,A=this.Editor.Tools.blockTools;Array.from(A.values()).forEach(function(B){var T=B.shortcut;T&&d.default.remove(I.Editor.UI.nodes.redactor,T)})}},{key:"enableFlipper",value:function(){var I=Array.from(this.nodes.toolbox.childNodes);this.flipper=new v.default({items:I,focusedItemClass:this.CSS.toolboxButtonActive})}},{key:"insertNewBlock",value:function(I){var A=this.Editor,B=A.BlockManager,T=A.Caret,M=B.currentBlock,j=B.insert({tool:I,replace:M.isEmpty});j.call(k.BlockToolAPI.APPEND_CALLBACK),this.Editor.Caret.setToBlock(j),j.inputs.length===0&&(j===B.lastBlock?(B.insertAtEnd(),T.setToBlock(B.lastBlock)):T.setToBlock(B.nextBlock)),this.Editor.Toolbar.close()}},{key:"CSS",get:function(){return{toolbox:"ce-toolbox",toolboxButton:"ce-toolbox__button",toolboxButtonActive:"ce-toolbox__button--active",toolboxOpened:"ce-toolbox--opened",openedToolbarHolderModifier:"codex-editor--toolbox-opened",buttonTooltip:"ce-toolbox-button-tooltip",buttonShortcut:"ce-toolbox-button-tooltip__shortcut"}}},{key:"isEmpty",get:function(){return this.displayedToolsCount===0}}]),L}(p.default);a.default=x,x.displayName="Toolbox",r.exports=t.default})=="function"?i.apply(t,n):i)===void 0||(r.exports=o)},function(r,t,e){var i,n,o;n=[t,e(21),e(22),e(42),e(29),e(2),e(3),e(5),e(6),e(4),e(380),e(7),e(8),e(381),e(382),e(383),e(384),e(385),e(389),e(390),e(391),e(392)],(o=typeof(i=function(a,s,l,u,c,h,p,g,b,v,k,C,O,d,_,m,y,x,S,w,E,L){"use strict";var I=e(9),A=e(1);function B(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(M){return!1}}Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,s=A(s),l=A(l),u=A(u),c=A(c),h=A(h),p=A(p),g=A(g),b=A(b),v=A(v),k=A(k),C=A(C),O=I(O),d=A(d),_=A(_),m=A(m),y=A(y),x=A(x),S=A(S),w=A(w),E=A(E),L=A(L);var T=function(M){(0,g.default)(U,M);var j,J=(j=U,function(){var H,te=(0,v.default)(j);if(B()){var ae=(0,v.default)(this).constructor;H=Reflect.construct(te,arguments,ae)}else H=te.apply(this,arguments);return(0,b.default)(this,H)});function U(){var H;return(0,h.default)(this,U),(H=J.apply(this,arguments)).stubTool="stub",H.toolsAvailable=new L.default,H.toolsUnavailable=new L.default,H}return(0,p.default)(U,[{key:"prepare",value:function(){var H=this;if(this.validateTools(),this.config.tools=O.deepMerge({},this.internalTools,this.config.tools),!Object.prototype.hasOwnProperty.call(this.config,"tools")||Object.keys(this.config.tools).length===0)throw Error("Can't start without tools");var te=this.prepareConfig();this.factory=new x.default(te,this.config,this.Editor.API);var ae=this.getListOfPrepareFunctions(te);return ae.length===0?Promise.resolve():O.sequence(ae,function(W){H.toolPrepareMethodSuccess(W)},function(W){H.toolPrepareMethodFallback(W)})}},{key:"getTunesForTool",value:function(H){var te=H.enabledBlockTunes;if(te===!1)return new L.default;if(Array.isArray(te))return new L.default(Array.from(this.blockTunes.entries()).filter(function(W){var Y=(0,c.default)(W,2)[1];return te.includes(Y.name)}).concat((0,u.default)(this.blockTunes.internalTools.entries())));var ae=this.config.tunes;return Array.isArray(ae)?new L.default(Array.from(this.blockTunes.entries()).filter(function(W){var Y=(0,c.default)(W,2)[1];return ae.includes(Y.name)}).concat((0,u.default)(this.blockTunes.internalTools.entries()))):this.blockTunes.internalTools}},{key:"destroy",value:function(){Object.values(this.available).forEach(function(){var H=(0,l.default)(s.default.mark(function te(ae){return s.default.wrap(function(W){for(;;)switch(W.prev=W.next){case 0:if(!O.isFunction(ae.reset)){W.next=3;break}return W.next=3,ae.reset();case 3:case"end":return W.stop()}},te)}));return function(te){return H.apply(this,arguments)}}())}},{key:"toolPrepareMethodSuccess",value:function(H){var te=this.factory.get(H.toolName);if(te.isInline()){var ae=["render","surround","checkState"].filter(function(W){return!te.create()[W]});if(ae.length)return O.log("Incorrect Inline Tool: ".concat(te.name,". Some of required methods is not implemented %o"),"warn",ae),void this.toolsUnavailable.set(te.name,te)}this.toolsAvailable.set(te.name,te)}},{key:"toolPrepareMethodFallback",value:function(H){this.toolsUnavailable.set(H.toolName,this.factory.get(H.toolName))}},{key:"getListOfPrepareFunctions",value:function(H){var te=[];return Object.entries(H).forEach(function(ae){var W=(0,c.default)(ae,2),Y=W[0],re=W[1];te.push({function:O.isFunction(re.class.prepare)?re.class.prepare:function(){},data:{toolName:Y}})}),te}},{key:"validateTools",value:function(){for(var H in this.config.tools)if(Object.prototype.hasOwnProperty.call(this.config.tools,H)){if(H in this.internalTools)return;var te=this.config.tools[H];if(!O.isFunction(te)&&!O.isFunction(te.class))throw Error("Tool \xAB".concat(H,"\xBB must be a constructor function or an object with function in the \xABclass\xBB property"))}}},{key:"prepareConfig",value:function(){var H={};for(var te in this.config.tools)O.isObject(this.config.tools[te])?H[te]=this.config.tools[te]:H[te]={class:this.config.tools[te]};return H}},{key:"available",get:function(){return this.toolsAvailable}},{key:"unavailable",get:function(){return this.toolsUnavailable}},{key:"inlineTools",get:function(){return this.available.inlineTools}},{key:"blockTools",get:function(){return this.available.blockTools}},{key:"blockTunes",get:function(){return this.available.blockTunes}},{key:"defaultTool",get:function(){return this.blockTools.get(this.config.defaultBlock)}},{key:"internal",get:function(){return this.available.internalTools}},{key:"internalTools",get:function(){return{bold:{class:d.default,isInternal:!0},italic:{class:_.default,isInternal:!0},link:{class:m.default,isInternal:!0},paragraph:{class:k.default,inlineToolbar:!0,isInternal:!0},stub:{class:y.default,isInternal:!0},moveUpTune:{class:E.default,isInternal:!0},deleteTune:{class:w.default,isInternal:!0},moveDownTune:{class:S.default,isInternal:!0}}}}]),U}(C.default);a.default=T,T.displayName="Tools",r.exports=t.default})=="function"?i.apply(t,n):i)===void 0||(r.exports=o)},function(r,t,e){var i,n,o;n=[t,e(2),e(3),e(5),e(6),e(4),e(7),e(393)],(o=typeof(i=function(a,s,l,u,c,h,p,g){"use strict";var b=e(1);function v(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(C){return!1}}Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,s=b(s),l=b(l),u=b(u),c=b(c),h=b(h),p=b(p),g=b(g);var k=function(C){(0,u.default)(_,C);var O,d=(O=_,function(){var m,y=(0,h.default)(O);if(v()){var x=(0,h.default)(this).constructor;m=Reflect.construct(y,arguments,x)}else m=y.apply(this,arguments);return(0,c.default)(this,m)});function _(){var m;return(0,s.default)(this,_),(m=d.apply(this,arguments)).lib=new g.default,m}return(0,l.default)(_,[{key:"show",value:function(m,y,x){this.lib.show(m,y,x)}},{key:"hide",value:function(){this.lib.hide()}},{key:"onHover",value:function(m,y,x){this.lib.onHover(m,y,x)}}]),_}(p.default);a.default=k,k.displayName="Tooltip",r.exports=t.default})=="function"?i.apply(t,n):i)===void 0||(r.exports=o)},function(r,t,e){var i,n,o;n=[t,e(29),e(42),e(21),e(22),e(2),e(3),e(5),e(6),e(4),e(394),e(7),e(15),e(8),e(25),e(61),e(60)],(o=typeof(i=function(a,s,l,u,c,h,p,g,b,v,k,C,O,d,_,m,y){"use strict";var x=e(9),S=e(1);function w(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(L){return!1}}Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,s=S(s),l=S(l),u=S(u),c=S(c),h=S(h),p=S(p),g=S(g),b=S(b),v=S(v),k=S(k),C=S(C),O=S(O),d=x(d),_=S(_),m=S(m),y=S(y);var E=function(L){(0,g.default)(T,L);var I,A,B=(I=T,function(){var M,j=(0,v.default)(I);if(w()){var J=(0,v.default)(this).constructor;M=Reflect.construct(j,arguments,J)}else M=j.apply(this,arguments);return(0,b.default)(this,M)});function T(){var M;return(0,h.default)(this,T),(M=B.apply(this,arguments)).isMobile=!1,M.contentRectCache=void 0,M.resizeDebouncer=d.debounce(function(){M.windowResize()},200),M}return(0,p.default)(T,[{key:"addLoader",value:function(){this.nodes.loader=O.default.make("div",this.CSS.editorLoader),this.nodes.wrapper.prepend(this.nodes.loader),this.nodes.redactor.classList.add(this.CSS.editorZoneHidden)}},{key:"removeLoader",value:function(){this.nodes.loader.remove(),this.nodes.redactor.classList.remove(this.CSS.editorZoneHidden)}},{key:"prepare",value:(A=(0,c.default)(u.default.mark(function M(){return u.default.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:this.checkIsMobile(),this.make(),this.addLoader(),this.appendSVGSprite(),this.loadStyles();case 5:case"end":return j.stop()}},M,this)})),function(){return A.apply(this,arguments)})},{key:"toggleReadOnly",value:function(M){M?this.disableModuleBindings():this.enableModuleBindings()}},{key:"checkEmptiness",value:function(){var M=this.Editor.BlockManager;this.nodes.wrapper.classList.toggle(this.CSS.editorEmpty,M.isEditorEmpty)}},{key:"destroy",value:function(){this.nodes.holder.innerHTML=""}},{key:"closeAllToolbars",value:function(){var M=this.Editor,j=M.Toolbox,J=M.BlockSettings,U=M.InlineToolbar,H=M.ConversionToolbar;J.close(),U.close(),H.close(),j.close()}},{key:"checkIsMobile",value:function(){this.isMobile=window.innerWidth<650}},{key:"make",value:function(){this.nodes.holder=O.default.getHolder(this.config.holder),this.nodes.wrapper=O.default.make("div",[this.CSS.editorWrapper].concat((0,l.default)(this.isRtl?[this.CSS.editorRtlFix]:[]))),this.nodes.redactor=O.default.make("div",this.CSS.editorZone),this.nodes.holder.offsetWidth<this.contentRect.width&&this.nodes.wrapper.classList.add(this.CSS.editorWrapperNarrow),this.nodes.redactor.style.paddingBottom=this.config.minHeight+"px",this.nodes.wrapper.appendChild(this.nodes.redactor),this.nodes.holder.appendChild(this.nodes.wrapper)}},{key:"loadStyles",value:function(){var M=e(395);if(!O.default.get("editor-js-styles")){var j=O.default.make("style",null,{id:"editor-js-styles",textContent:M.toString()});O.default.prepend(document.head,j)}}},{key:"enableModuleBindings",value:function(){var M=this;this.readOnlyMutableListeners.on(this.nodes.redactor,"click",function(j){M.redactorClicked(j)},!1),this.readOnlyMutableListeners.on(this.nodes.redactor,"mousedown",function(j){M.documentTouched(j)},!0),this.readOnlyMutableListeners.on(this.nodes.redactor,"touchstart",function(j){M.documentTouched(j)},!0),this.readOnlyMutableListeners.on(document,"keydown",function(j){M.documentKeydown(j)},!0),this.readOnlyMutableListeners.on(document,"click",function(j){M.documentClicked(j)},!0),this.readOnlyMutableListeners.on(document,"selectionchange",function(j){M.selectionChanged(j)},!0),this.readOnlyMutableListeners.on(window,"resize",function(){M.resizeDebouncer()},{passive:!0})}},{key:"disableModuleBindings",value:function(){this.readOnlyMutableListeners.clearAll()}},{key:"windowResize",value:function(){this.contentRectCache=null,this.checkIsMobile()}},{key:"documentKeydown",value:function(M){switch(M.keyCode){case d.keyCodes.ENTER:this.enterPressed(M);break;case d.keyCodes.BACKSPACE:this.backspacePressed(M);break;case d.keyCodes.ESC:this.escapePressed(M);break;default:this.defaultBehaviour(M)}}},{key:"defaultBehaviour",value:function(M){var j=this.Editor.BlockManager.currentBlock,J=M.target.closest(".".concat(this.CSS.editorWrapper)),U=M.altKey||M.ctrlKey||M.metaKey||M.shiftKey;j===void 0||J!==null?J||j&&U||(this.Editor.BlockManager.dropPointer(),this.Editor.Toolbar.close()):this.Editor.BlockEvents.keydown(M)}},{key:"backspacePressed",value:function(M){var j=this.Editor,J=j.BlockManager,U=j.BlockSelection,H=j.Caret;if(U.anyBlockSelected&&!_.default.isSelectionExists){var te=J.removeSelectedBlocks();H.setToBlock(J.insertDefaultBlockAtIndex(te,!0),H.positions.START),U.clearSelection(M),M.preventDefault(),M.stopPropagation(),M.stopImmediatePropagation()}}},{key:"escapePressed",value:function(M){this.Editor.BlockSelection.clearSelection(M),this.Editor.Toolbox.opened?this.Editor.Toolbox.close():this.Editor.BlockSettings.opened?this.Editor.BlockSettings.close():this.Editor.ConversionToolbar.opened?this.Editor.ConversionToolbar.close():this.Editor.InlineToolbar.opened?this.Editor.InlineToolbar.close():this.Editor.Toolbar.close()}},{key:"enterPressed",value:function(M){var j=this.Editor,J=j.BlockManager,U=j.BlockSelection,H=J.currentBlockIndex>=0;if(U.anyBlockSelected&&!_.default.isSelectionExists)return U.clearSelection(M),M.preventDefault(),M.stopImmediatePropagation(),void M.stopPropagation();if(!this.someToolbarOpened&&H&&M.target.tagName==="BODY"){var te=this.Editor.BlockManager.insert();this.Editor.Caret.setToBlock(te),this.Editor.BlockManager.highlightCurrentNode(),this.Editor.Toolbar.move(),this.Editor.Toolbar.plusButton.show()}this.Editor.BlockSelection.clearSelection(M)}},{key:"documentClicked",value:function(M){if(M.isTrusted){var j=M.target;this.nodes.holder.contains(j)||_.default.isAtEditor||(this.Editor.BlockManager.dropPointer(),this.Editor.InlineToolbar.close(),this.Editor.Toolbar.close(),this.Editor.ConversionToolbar.close()),this.Editor.CrossBlockSelection.isCrossBlockSelectionStarted||this.Editor.BlockSelection.clearSelection(M)}}},{key:"documentTouched",value:function(M){var j=M.target;if(j===this.nodes.redactor){var J=M instanceof MouseEvent?M.clientX:M.touches[0].clientX,U=M instanceof MouseEvent?M.clientY:M.touches[0].clientY;j=document.elementFromPoint(J,U)}try{this.Editor.BlockManager.setCurrentBlockByChildNode(j),this.Editor.BlockManager.highlightCurrentNode()}catch(H){this.Editor.RectangleSelection.isRectActivated()||this.Editor.Caret.setToTheLastBlock()}this.Editor.Toolbar.open(),this.Editor.Toolbar.plusButton.hide()}},{key:"redactorClicked",value:function(M){if(_.default.isCollapsed){var j=function(){M.stopImmediatePropagation(),M.stopPropagation()},J=M.target,U=M.metaKey||M.ctrlKey;if(O.default.isAnchor(J)&&U){j();var H=J.getAttribute("href"),te=d.getValidUrl(H);d.openTab(te)}else this.Editor.BlockManager.currentBlock||(j(),this.Editor.BlockManager.insert()),this.Editor.BlockManager.currentBlock.tool.isDefault&&(j(),this.Editor.BlockManager.currentBlock.isEmpty&&this.Editor.Toolbar.plusButton.show())}}},{key:"selectionChanged",value:function(M){var j=this.Editor,J=j.CrossBlockSelection,U=j.BlockSelection,H=_.default.anchorElement;J.isCrossBlockSelectionStarted&&U.anyBlockSelected&&_.default.get().removeAllRanges(),H&&H.closest(".".concat(m.default.CSS.content))?(this.Editor.BlockManager.currentBlock||this.Editor.BlockManager.setCurrentBlockByChildNode(H),this.Editor.InlineToolbar.tryToShow(!0)):this.Editor.InlineToolbar.containsNode(H)||this.Editor.InlineToolbar.close()}},{key:"appendSVGSprite",value:function(){var M=O.default.make("div");M.hidden=!0,M.style.display="none",M.innerHTML=k.default,O.default.append(this.nodes.wrapper,M)}},{key:"CSS",get:function(){return{editorWrapper:"codex-editor",editorWrapperNarrow:"codex-editor--narrow",editorZone:"codex-editor__redactor",editorZoneHidden:"codex-editor__redactor--hidden",editorLoader:"codex-editor__loader",editorEmpty:"codex-editor--empty",editorRtlFix:"codex-editor--rtl"}}},{key:"contentRect",get:function(){if(this.contentRectCache)return this.contentRectCache;var M=this.nodes.wrapper.querySelector(".".concat(m.default.CSS.content));return M?(this.contentRectCache=M.getBoundingClientRect(),this.contentRectCache):{width:650,left:0,right:0}}},{key:"someToolbarOpened",get:function(){var M=this.Editor,j=M.Toolbox,J=M.BlockSettings,U=M.InlineToolbar,H=M.ConversionToolbar;return J.opened||U.opened||H.opened||j.opened}},{key:"someFlipperButtonFocused",get:function(){return Object.entries(this.Editor).filter(function(M){var j=(0,s.default)(M,2);return j[0],j[1].flipper instanceof y.default}).some(function(M){var j=(0,s.default)(M,2);return j[0],j[1].flipper.currentItem})}}]),T}(C.default);a.default=E,E.displayName="UI",r.exports=t.default})=="function"?i.apply(t,n):i)===void 0||(r.exports=o)},function(r,t,e){e(184),r.exports=e(356)},function(r,t,e){e(185)},function(r,t,e){"use strict";e(186),e(329),e(331),e(334),e(336),e(338),e(340),e(342),e(344),e(346),e(348),e(350),e(352),e(140)},function(r,t,e){e(187),e(190),e(191),e(192),e(193),e(194),e(195),e(196),e(197),e(198),e(199),e(200),e(201),e(202),e(203),e(204),e(205),e(206),e(207),e(208),e(209),e(210),e(211),e(212),e(213),e(214),e(215),e(216),e(217),e(218),e(219),e(220),e(221),e(222),e(223),e(224),e(225),e(226),e(227),e(228),e(229),e(230),e(231),e(233),e(234),e(235),e(236),e(237),e(238),e(239),e(240),e(241),e(242),e(243),e(244),e(245),e(246),e(247),e(248),e(249),e(250),e(251),e(252),e(253),e(254),e(255),e(256),e(257),e(258),e(259),e(260),e(261),e(262),e(263),e(264),e(265),e(266),e(268),e(269),e(271),e(272),e(273),e(274),e(275),e(276),e(277),e(279),e(280),e(281),e(282),e(283),e(284),e(285),e(286),e(287),e(288),e(289),e(290),e(291),e(102),e(292),e(129),e(293),e(130),e(294),e(295),e(296),e(297),e(131),e(300),e(301),e(302),e(303),e(304),e(305),e(306),e(307),e(308),e(309),e(310),e(311),e(312),e(313),e(314),e(315),e(316),e(317),e(318),e(319),e(320),e(321),e(322),e(323),e(324),e(325),e(326),e(327),e(328),r.exports=e(17)},function(r,t,e){"use strict";var i=e(10),n=e(26),o=e(18),a=e(0),s=e(23),l=e(41).KEY,u=e(11),c=e(67),h=e(53),p=e(44),g=e(14),b=e(83),v=e(110),k=e(189),C=e(70),O=e(12),d=e(13),_=e(20),m=e(28),y=e(40),x=e(43),S=e(48),w=e(113),E=e(34),L=e(69),I=e(19),A=e(46),B=E.f,T=I.f,M=w.f,j=i.Symbol,J=i.JSON,U=J&&J.stringify,H=g("_hidden"),te=g("toPrimitive"),ae={}.propertyIsEnumerable,W=c("symbol-registry"),Y=c("symbols"),re=c("op-symbols"),ie=Object.prototype,Q=typeof j=="function"&&!!L.f,ee=i.QObject,pe=!ee||!ee.prototype||!ee.prototype.findChild,be=o&&u(function(){return S(T({},"a",{get:function(){return T(this,"a",{value:7}).a}})).a!=7})?function(ce,ve,Ie){var He=B(ie,ve);He&&delete ie[ve],T(ce,ve,Ie),He&&ce!==ie&&T(ie,ve,He)}:T,we=function(ce){var ve=Y[ce]=S(j.prototype);return ve._k=ce,ve},Le=Q&&typeof j.iterator=="symbol"?function(ce){return typeof ce=="symbol"}:function(ce){return ce instanceof j},fe=function(ce,ve,Ie){return ce===ie&&fe(re,ve,Ie),O(ce),ve=y(ve,!0),O(Ie),n(Y,ve)?(Ie.enumerable?(n(ce,H)&&ce[H][ve]&&(ce[H][ve]=!1),Ie=S(Ie,{enumerable:x(0,!1)})):(n(ce,H)||T(ce,H,x(1,{})),ce[H][ve]=!0),be(ce,ve,Ie)):T(ce,ve,Ie)},xe=function(ce,ve){O(ce);for(var Ie,He=k(ve=m(ve)),at=0,vt=He.length;vt>at;)fe(ce,Ie=He[at++],ve[Ie]);return ce},Ne=function(ce){var ve=ae.call(this,ce=y(ce,!0));return!(this===ie&&n(Y,ce)&&!n(re,ce))&&(!(ve||!n(this,ce)||!n(Y,ce)||n(this,H)&&this[H][ce])||ve)},Be=function(ce,ve){if(ce=m(ce),ve=y(ve,!0),ce!==ie||!n(Y,ve)||n(re,ve)){var Ie=B(ce,ve);return!Ie||!n(Y,ve)||n(ce,H)&&ce[H][ve]||(Ie.enumerable=!0),Ie}},Pe=function(ce){for(var ve,Ie=M(m(ce)),He=[],at=0;Ie.length>at;)n(Y,ve=Ie[at++])||ve==H||ve==l||He.push(ve);return He},Ze=function(ce){for(var ve,Ie=ce===ie,He=M(Ie?re:m(ce)),at=[],vt=0;He.length>vt;)!n(Y,ve=He[vt++])||Ie&&!n(ie,ve)||at.push(Y[ve]);return at};Q||(s((j=function(){if(this instanceof j)throw TypeError("Symbol is not a constructor!");var ce=p(arguments.length>0?arguments[0]:void 0),ve=function(Ie){this===ie&&ve.call(re,Ie),n(this,H)&&n(this[H],ce)&&(this[H][ce]=!1),be(this,ce,x(1,Ie))};return o&&pe&&be(ie,ce,{configurable:!0,set:ve}),we(ce)}).prototype,"toString",function(){return this._k}),E.f=Be,I.f=fe,e(49).f=w.f=Pe,e(63).f=Ne,L.f=Ze,o&&!e(45)&&s(ie,"propertyIsEnumerable",Ne,!0),b.f=function(ce){return we(g(ce))}),a(a.G+a.W+a.F*!Q,{Symbol:j});for(var tt="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),Xe=0;tt.length>Xe;)g(tt[Xe++]);for(var Ke=A(g.store),nt=0;Ke.length>nt;)v(Ke[nt++]);a(a.S+a.F*!Q,"Symbol",{for:function(ce){return n(W,ce+="")?W[ce]:W[ce]=j(ce)},keyFor:function(ce){if(!Le(ce))throw TypeError(ce+" is not a symbol!");for(var ve in W)if(W[ve]===ce)return ve},useSetter:function(){pe=!0},useSimple:function(){pe=!1}}),a(a.S+a.F*!Q,"Object",{create:function(ce,ve){return ve===void 0?S(ce):xe(S(ce),ve)},defineProperty:fe,defineProperties:xe,getOwnPropertyDescriptor:Be,getOwnPropertyNames:Pe,getOwnPropertySymbols:Ze});var ot=u(function(){L.f(1)});a(a.S+a.F*ot,"Object",{getOwnPropertySymbols:function(ce){return L.f(_(ce))}}),J&&a(a.S+a.F*(!Q||u(function(){var ce=j();return U([ce])!="[null]"||U({a:ce})!="{}"||U(Object(ce))!="{}"})),"JSON",{stringify:function(ce){for(var ve,Ie,He=[ce],at=1;arguments.length>at;)He.push(arguments[at++]);if(Ie=ve=He[1],(d(ve)||ce!==void 0)&&!Le(ce))return C(ve)||(ve=function(vt,bt){if(typeof Ie=="function"&&(bt=Ie.call(this,vt,bt)),!Le(bt))return bt}),He[1]=ve,U.apply(J,He)}}),j.prototype[te]||e(27)(j.prototype,te,j.prototype.valueOf),h(j,"Symbol"),h(Math,"Math",!0),h(i.JSON,"JSON",!0)},function(r,t,e){r.exports=e(67)("native-function-to-string",Function.toString)},function(r,t,e){var i=e(46),n=e(69),o=e(63);r.exports=function(a){var s=i(a),l=n.f;if(l)for(var u,c=l(a),h=o.f,p=0;c.length>p;)h.call(a,u=c[p++])&&s.push(u);return s}},function(r,t,e){var i=e(0);i(i.S,"Object",{create:e(48)})},function(r,t,e){var i=e(0);i(i.S+i.F*!e(18),"Object",{defineProperty:e(19).f})},function(r,t,e){var i=e(0);i(i.S+i.F*!e(18),"Object",{defineProperties:e(112)})},function(r,t,e){var i=e(28),n=e(34).f;e(35)("getOwnPropertyDescriptor",function(){return function(o,a){return n(i(o),a)}})},function(r,t,e){var i=e(20),n=e(50);e(35)("getPrototypeOf",function(){return function(o){return n(i(o))}})},function(r,t,e){var i=e(20),n=e(46);e(35)("keys",function(){return function(o){return n(i(o))}})},function(r,t,e){e(35)("getOwnPropertyNames",function(){return e(113).f})},function(r,t,e){var i=e(13),n=e(41).onFreeze;e(35)("freeze",function(o){return function(a){return o&&i(a)?o(n(a)):a}})},function(r,t,e){var i=e(13),n=e(41).onFreeze;e(35)("seal",function(o){return function(a){return o&&i(a)?o(n(a)):a}})},function(r,t,e){var i=e(13),n=e(41).onFreeze;e(35)("preventExtensions",function(o){return function(a){return o&&i(a)?o(n(a)):a}})},function(r,t,e){var i=e(13);e(35)("isFrozen",function(n){return function(o){return!i(o)||!!n&&n(o)}})},function(r,t,e){var i=e(13);e(35)("isSealed",function(n){return function(o){return!i(o)||!!n&&n(o)}})},function(r,t,e){var i=e(13);e(35)("isExtensible",function(n){return function(o){return!!i(o)&&(!n||n(o))}})},function(r,t,e){var i=e(0);i(i.S+i.F,"Object",{assign:e(114)})},function(r,t,e){var i=e(0);i(i.S,"Object",{is:e(115)})},function(r,t,e){var i=e(0);i(i.S,"Object",{setPrototypeOf:e(87).set})},function(r,t,e){"use strict";var i=e(64),n={};n[e(14)("toStringTag")]="z",n+""!="[object z]"&&e(23)(Object.prototype,"toString",function(){return"[object "+i(this)+"]"},!0)},function(r,t,e){var i=e(0);i(i.P,"Function",{bind:e(116)})},function(r,t,e){var i=e(19).f,n=Function.prototype,o=/^\s*function ([^ (]*)/;"name"in n||e(18)&&i(n,"name",{configurable:!0,get:function(){try{return(""+this).match(o)[1]}catch(a){return""}}})},function(r,t,e){"use strict";var i=e(13),n=e(50),o=e(14)("hasInstance"),a=Function.prototype;o in a||e(19).f(a,o,{value:function(s){if(typeof this!="function"||!i(s))return!1;if(!i(this.prototype))return s instanceof this;for(;s=n(s);)if(this.prototype===s)return!0;return!1}})},function(r,t,e){var i=e(0),n=e(118);i(i.G+i.F*(parseInt!=n),{parseInt:n})},function(r,t,e){var i=e(0),n=e(119);i(i.G+i.F*(parseFloat!=n),{parseFloat:n})},function(r,t,e){"use strict";var i=e(10),n=e(26),o=e(37),a=e(89),s=e(40),l=e(11),u=e(49).f,c=e(34).f,h=e(19).f,p=e(54).trim,g=i.Number,b=g,v=g.prototype,k=o(e(48)(v))=="Number",C="trim"in String.prototype,O=function(y){var x=s(y,!1);if(typeof x=="string"&&x.length>2){var S,w,E,L=(x=C?x.trim():p(x,3)).charCodeAt(0);if(L===43||L===45){if((S=x.charCodeAt(2))===88||S===120)return NaN}else if(L===48){switch(x.charCodeAt(1)){case 66:case 98:w=2,E=49;break;case 79:case 111:w=8,E=55;break;default:return+x}for(var I,A=x.slice(2),B=0,T=A.length;B<T;B++)if((I=A.charCodeAt(B))<48||I>E)return NaN;return parseInt(A,w)}}return+x};if(!g(" 0o1")||!g("0b1")||g("+0x1")){g=function(y){var x=arguments.length<1?0:y,S=this;return S instanceof g&&(k?l(function(){v.valueOf.call(S)}):o(S)!="Number")?a(new b(O(x)),S,g):O(x)};for(var d,_=e(18)?u(b):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),m=0;_.length>m;m++)n(b,d=_[m])&&!n(g,d)&&h(g,d,c(b,d));g.prototype=v,v.constructor=g,e(23)(i,"Number",g)}},function(r,t,e){"use strict";var i=e(0),n=e(33),o=e(120),a=e(90),s=1 .toFixed,l=Math.floor,u=[0,0,0,0,0,0],c="Number.toFixed: incorrect invocation!",h=function(v,k){for(var C=-1,O=k;++C<6;)O+=v*u[C],u[C]=O%1e7,O=l(O/1e7)},p=function(v){for(var k=6,C=0;--k>=0;)C+=u[k],u[k]=l(C/v),C=C%v*1e7},g=function(){for(var v=6,k="";--v>=0;)if(k!==""||v===0||u[v]!==0){var C=String(u[v]);k=k===""?C:k+a.call("0",7-C.length)+C}return k},b=function(v,k,C){return k===0?C:k%2==1?b(v,k-1,C*v):b(v*v,k/2,C)};i(i.P+i.F*(!!s&&(8e-5 .toFixed(3)!=="0.000"||.9 .toFixed(0)!=="1"||1.255 .toFixed(2)!=="1.25"||1000000000000000100 .toFixed(0)!=="1000000000000000128")||!e(11)(function(){s.call({})})),"Number",{toFixed:function(v){var k,C,O,d,_=o(this,c),m=n(v),y="",x="0";if(m<0||m>20)throw RangeError(c);if(_!=_)return"NaN";if(_<=-1e21||_>=1e21)return String(_);if(_<0&&(y="-",_=-_),_>1e-21)if(C=(k=function(S){for(var w=0,E=S;E>=4096;)w+=12,E/=4096;for(;E>=2;)w+=1,E/=2;return w}(_*b(2,69,1))-69)<0?_*b(2,-k,1):_/b(2,k,1),C*=4503599627370496,(k=52-k)>0){for(h(0,C),O=m;O>=7;)h(1e7,0),O-=7;for(h(b(10,O,1),0),O=k-1;O>=23;)p(1<<23),O-=23;p(1<<O),h(1,1),p(2),x=g()}else h(0,C),h(1<<-k,0),x=g()+a.call("0",m);return x=m>0?y+((d=x.length)<=m?"0."+a.call("0",m-d)+x:x.slice(0,d-m)+"."+x.slice(d-m)):y+x}})},function(r,t,e){"use strict";var i=e(0),n=e(11),o=e(120),a=1 .toPrecision;i(i.P+i.F*(n(function(){return a.call(1,void 0)!=="1"})||!n(function(){a.call({})})),"Number",{toPrecision:function(s){var l=o(this,"Number#toPrecision: incorrect invocation!");return s===void 0?a.call(l):a.call(l,s)}})},function(r,t,e){var i=e(0);i(i.S,"Number",{EPSILON:Math.pow(2,-52)})},function(r,t,e){var i=e(0),n=e(10).isFinite;i(i.S,"Number",{isFinite:function(o){return typeof o=="number"&&n(o)}})},function(r,t,e){var i=e(0);i(i.S,"Number",{isInteger:e(121)})},function(r,t,e){var i=e(0);i(i.S,"Number",{isNaN:function(n){return n!=n}})},function(r,t,e){var i=e(0),n=e(121),o=Math.abs;i(i.S,"Number",{isSafeInteger:function(a){return n(a)&&o(a)<=9007199254740991}})},function(r,t,e){var i=e(0);i(i.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(r,t,e){var i=e(0);i(i.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},function(r,t,e){var i=e(0),n=e(119);i(i.S+i.F*(Number.parseFloat!=n),"Number",{parseFloat:n})},function(r,t,e){var i=e(0),n=e(118);i(i.S+i.F*(Number.parseInt!=n),"Number",{parseInt:n})},function(r,t,e){var i=e(0),n=e(122),o=Math.sqrt,a=Math.acosh;i(i.S+i.F*!(a&&Math.floor(a(Number.MAX_VALUE))==710&&a(1/0)==1/0),"Math",{acosh:function(s){return(s=+s)<1?NaN:s>9490626562425156e-8?Math.log(s)+Math.LN2:n(s-1+o(s-1)*o(s+1))}})},function(r,t,e){var i=e(0),n=Math.asinh;i(i.S+i.F*!(n&&1/n(0)>0),"Math",{asinh:function o(a){return isFinite(a=+a)&&a!=0?a<0?-o(-a):Math.log(a+Math.sqrt(a*a+1)):a}})},function(r,t,e){var i=e(0),n=Math.atanh;i(i.S+i.F*!(n&&1/n(-0)<0),"Math",{atanh:function(o){return(o=+o)==0?o:Math.log((1+o)/(1-o))/2}})},function(r,t,e){var i=e(0),n=e(91);i(i.S,"Math",{cbrt:function(o){return n(o=+o)*Math.pow(Math.abs(o),1/3)}})},function(r,t,e){var i=e(0);i(i.S,"Math",{clz32:function(n){return(n>>>=0)?31-Math.floor(Math.log(n+.5)*Math.LOG2E):32}})},function(r,t,e){var i=e(0),n=Math.exp;i(i.S,"Math",{cosh:function(o){return(n(o=+o)+n(-o))/2}})},function(r,t,e){var i=e(0),n=e(92);i(i.S+i.F*(n!=Math.expm1),"Math",{expm1:n})},function(r,t,e){var i=e(0);i(i.S,"Math",{fround:e(232)})},function(r,t,e){var i=e(91),n=Math.pow,o=n(2,-52),a=n(2,-23),s=n(2,127)*(2-a),l=n(2,-126);r.exports=Math.fround||function(u){var c,h,p=Math.abs(u),g=i(u);return p<l?g*(p/l/a+1/o-1/o)*l*a:(h=(c=(1+a/o)*p)-(c-p))>s||h!=h?g*(1/0):g*h}},function(r,t,e){var i=e(0),n=Math.abs;i(i.S,"Math",{hypot:function(o,a){for(var s,l,u=0,c=0,h=arguments.length,p=0;c<h;)p<(s=n(arguments[c++]))?(u=u*(l=p/s)*l+1,p=s):u+=s>0?(l=s/p)*l:s;return p===1/0?1/0:p*Math.sqrt(u)}})},function(r,t,e){var i=e(0),n=Math.imul;i(i.S+i.F*e(11)(function(){return n(4294967295,5)!=-5||n.length!=2}),"Math",{imul:function(o,a){var s=+o,l=+a,u=65535&s,c=65535&l;return 0|u*c+((65535&s>>>16)*c+u*(65535&l>>>16)<<16>>>0)}})},function(r,t,e){var i=e(0);i(i.S,"Math",{log10:function(n){return Math.log(n)*Math.LOG10E}})},function(r,t,e){var i=e(0);i(i.S,"Math",{log1p:e(122)})},function(r,t,e){var i=e(0);i(i.S,"Math",{log2:function(n){return Math.log(n)/Math.LN2}})},function(r,t,e){var i=e(0);i(i.S,"Math",{sign:e(91)})},function(r,t,e){var i=e(0),n=e(92),o=Math.exp;i(i.S+i.F*e(11)(function(){return!Math.sinh(-2e-17)!=-2e-17}),"Math",{sinh:function(a){return Math.abs(a=+a)<1?(n(a)-n(-a))/2:(o(a-1)-o(-a-1))*(Math.E/2)}})},function(r,t,e){var i=e(0),n=e(92),o=Math.exp;i(i.S,"Math",{tanh:function(a){var s=n(a=+a),l=n(-a);return s==1/0?1:l==1/0?-1:(s-l)/(o(a)+o(-a))}})},function(r,t,e){var i=e(0);i(i.S,"Math",{trunc:function(n){return(n>0?Math.floor:Math.ceil)(n)}})},function(r,t,e){var i=e(0),n=e(47),o=String.fromCharCode,a=String.fromCodePoint;i(i.S+i.F*(!!a&&a.length!=1),"String",{fromCodePoint:function(s){for(var l,u=[],c=arguments.length,h=0;c>h;){if(l=+arguments[h++],n(l,1114111)!==l)throw RangeError(l+" is not a valid code point");u.push(l<65536?o(l):o(55296+((l-=65536)>>10),l%1024+56320))}return u.join("")}})},function(r,t,e){var i=e(0),n=e(28),o=e(16);i(i.S,"String",{raw:function(a){for(var s=n(a.raw),l=o(s.length),u=arguments.length,c=[],h=0;l>h;)c.push(String(s[h++])),h<u&&c.push(String(arguments[h]));return c.join("")}})},function(r,t,e){"use strict";e(54)("trim",function(i){return function(){return i(this,3)}})},function(r,t,e){"use strict";var i=e(93)(!0);e(94)(String,"String",function(n){this._t=String(n),this._i=0},function(){var n,o=this._t,a=this._i;return a>=o.length?{value:void 0,done:!0}:(n=i(o,a),this._i+=n.length,{value:n,done:!1})})},function(r,t,e){"use strict";var i=e(0),n=e(93)(!1);i(i.P,"String",{codePointAt:function(o){return n(this,o)}})},function(r,t,e){"use strict";var i=e(0),n=e(16),o=e(95),a="".endsWith;i(i.P+i.F*e(97)("endsWith"),"String",{endsWith:function(s){var l=o(this,s,"endsWith"),u=arguments.length>1?arguments[1]:void 0,c=n(l.length),h=u===void 0?c:Math.min(n(u),c),p=String(s);return a?a.call(l,p,h):l.slice(h-p.length,h)===p}})},function(r,t,e){"use strict";var i=e(0),n=e(95);i(i.P+i.F*e(97)("includes"),"String",{includes:function(o){return!!~n(this,o,"includes").indexOf(o,arguments.length>1?arguments[1]:void 0)}})},function(r,t,e){var i=e(0);i(i.P,"String",{repeat:e(90)})},function(r,t,e){"use strict";var i=e(0),n=e(16),o=e(95),a="".startsWith;i(i.P+i.F*e(97)("startsWith"),"String",{startsWith:function(s){var l=o(this,s,"startsWith"),u=n(Math.min(arguments.length>1?arguments[1]:void 0,l.length)),c=String(s);return a?a.call(l,c,u):l.slice(u,u+c.length)===c}})},function(r,t,e){"use strict";e(24)("anchor",function(i){return function(n){return i(this,"a","name",n)}})},function(r,t,e){"use strict";e(24)("big",function(i){return function(){return i(this,"big","","")}})},function(r,t,e){"use strict";e(24)("blink",function(i){return function(){return i(this,"blink","","")}})},function(r,t,e){"use strict";e(24)("bold",function(i){return function(){return i(this,"b","","")}})},function(r,t,e){"use strict";e(24)("fixed",function(i){return function(){return i(this,"tt","","")}})},function(r,t,e){"use strict";e(24)("fontcolor",function(i){return function(n){return i(this,"font","color",n)}})},function(r,t,e){"use strict";e(24)("fontsize",function(i){return function(n){return i(this,"font","size",n)}})},function(r,t,e){"use strict";e(24)("italics",function(i){return function(){return i(this,"i","","")}})},function(r,t,e){"use strict";e(24)("link",function(i){return function(n){return i(this,"a","href",n)}})},function(r,t,e){"use strict";e(24)("small",function(i){return function(){return i(this,"small","","")}})},function(r,t,e){"use strict";e(24)("strike",function(i){return function(){return i(this,"strike","","")}})},function(r,t,e){"use strict";e(24)("sub",function(i){return function(){return i(this,"sub","","")}})},function(r,t,e){"use strict";e(24)("sup",function(i){return function(){return i(this,"sup","","")}})},function(r,t,e){var i=e(0);i(i.S,"Date",{now:function(){return new Date().getTime()}})},function(r,t,e){"use strict";var i=e(0),n=e(20),o=e(40);i(i.P+i.F*e(11)(function(){return new Date(NaN).toJSON()!==null||Date.prototype.toJSON.call({toISOString:function(){return 1}})!==1}),"Date",{toJSON:function(a){var s=n(this),l=o(s);return typeof l!="number"||isFinite(l)?s.toISOString():null}})},function(r,t,e){var i=e(0),n=e(267);i(i.P+i.F*(Date.prototype.toISOString!==n),"Date",{toISOString:n})},function(r,t,e){"use strict";var i=e(11),n=Date.prototype.getTime,o=Date.prototype.toISOString,a=function(s){return s>9?s:"0"+s};r.exports=i(function(){return o.call(new Date(-50000000000001))!="0385-07-25T07:06:39.999Z"})||!i(function(){o.call(new Date(NaN))})?function(){if(!isFinite(n.call(this)))throw RangeError("Invalid time value");var s=this,l=s.getUTCFullYear(),u=s.getUTCMilliseconds(),c=l<0?"-":l>9999?"+":"";return c+("00000"+Math.abs(l)).slice(c?-6:-4)+"-"+a(s.getUTCMonth()+1)+"-"+a(s.getUTCDate())+"T"+a(s.getUTCHours())+":"+a(s.getUTCMinutes())+":"+a(s.getUTCSeconds())+"."+(u>99?u:"0"+a(u))+"Z"}:o},function(r,t,e){var i=Date.prototype,n=i.toString,o=i.getTime;new Date(NaN)+""!="Invalid Date"&&e(23)(i,"toString",function(){var a=o.call(this);return a==a?n.call(this):"Invalid Date"})},function(r,t,e){var i=e(14)("toPrimitive"),n=Date.prototype;i in n||e(27)(n,i,e(270))},function(r,t,e){"use strict";var i=e(12),n=e(40);r.exports=function(o){if(o!=="string"&&o!=="number"&&o!=="default")throw TypeError("Incorrect hint");return n(i(this),o!="number")}},function(r,t,e){var i=e(0);i(i.S,"Array",{isArray:e(70)})},function(r,t,e){"use strict";var i=e(31),n=e(0),o=e(20),a=e(124),s=e(98),l=e(16),u=e(99),c=e(100);n(n.S+n.F*!e(71)(function(h){Array.from(h)}),"Array",{from:function(h){var p,g,b,v,k=o(h),C=typeof this=="function"?this:Array,O=arguments.length,d=O>1?arguments[1]:void 0,_=d!==void 0,m=0,y=c(k);if(_&&(d=i(d,O>2?arguments[2]:void 0,2)),y==null||C==Array&&s(y))for(g=new C(p=l(k.length));p>m;m++)u(g,m,_?d(k[m],m):k[m]);else for(v=y.call(k),g=new C;!(b=v.next()).done;m++)u(g,m,_?a(v,d,[b.value,m],!0):b.value);return g.length=m,g}})},function(r,t,e){"use strict";var i=e(0),n=e(99);i(i.S+i.F*e(11)(function(){function o(){}return!(Array.of.call(o)instanceof o)}),"Array",{of:function(){for(var o=0,a=arguments.length,s=new(typeof this=="function"?this:Array)(a);a>o;)n(s,o,arguments[o++]);return s.length=a,s}})},function(r,t,e){"use strict";var i=e(0),n=e(28),o=[].join;i(i.P+i.F*(e(62)!=Object||!e(30)(o)),"Array",{join:function(a){return o.call(n(this),a===void 0?",":a)}})},function(r,t,e){"use strict";var i=e(0),n=e(86),o=e(37),a=e(47),s=e(16),l=[].slice;i(i.P+i.F*e(11)(function(){n&&l.call(n)}),"Array",{slice:function(u,c){var h=s(this.length),p=o(this);if(c=c===void 0?h:c,p=="Array")return l.call(this,u,c);for(var g=a(u,h),b=a(c,h),v=s(b-g),k=new Array(v),C=0;C<v;C++)k[C]=p=="String"?this.charAt(g+C):this[g+C];return k}})},function(r,t,e){"use strict";var i=e(0),n=e(32),o=e(20),a=e(11),s=[].sort,l=[1,2,3];i(i.P+i.F*(a(function(){l.sort(void 0)})||!a(function(){l.sort(null)})||!e(30)(s)),"Array",{sort:function(u){return u===void 0?s.call(o(this)):s.call(o(this),n(u))}})},function(r,t,e){"use strict";var i=e(0),n=e(36)(0),o=e(30)([].forEach,!0);i(i.P+i.F*!o,"Array",{forEach:function(a){return n(this,a,arguments[1])}})},function(r,t,e){var i=e(13),n=e(70),o=e(14)("species");r.exports=function(a){var s;return n(a)&&(typeof(s=a.constructor)!="function"||s!==Array&&!n(s.prototype)||(s=void 0),i(s)&&(s=s[o])===null&&(s=void 0)),s===void 0?Array:s}},function(r,t,e){"use strict";var i=e(0),n=e(36)(1);i(i.P+i.F*!e(30)([].map,!0),"Array",{map:function(o){return n(this,o,arguments[1])}})},function(r,t,e){"use strict";var i=e(0),n=e(36)(2);i(i.P+i.F*!e(30)([].filter,!0),"Array",{filter:function(o){return n(this,o,arguments[1])}})},function(r,t,e){"use strict";var i=e(0),n=e(36)(3);i(i.P+i.F*!e(30)([].some,!0),"Array",{some:function(o){return n(this,o,arguments[1])}})},function(r,t,e){"use strict";var i=e(0),n=e(36)(4);i(i.P+i.F*!e(30)([].every,!0),"Array",{every:function(o){return n(this,o,arguments[1])}})},function(r,t,e){"use strict";var i=e(0),n=e(126);i(i.P+i.F*!e(30)([].reduce,!0),"Array",{reduce:function(o){return n(this,o,arguments.length,arguments[1],!1)}})},function(r,t,e){"use strict";var i=e(0),n=e(126);i(i.P+i.F*!e(30)([].reduceRight,!0),"Array",{reduceRight:function(o){return n(this,o,arguments.length,arguments[1],!0)}})},function(r,t,e){"use strict";var i=e(0),n=e(68)(!1),o=[].indexOf,a=!!o&&1/[1].indexOf(1,-0)<0;i(i.P+i.F*(a||!e(30)(o)),"Array",{indexOf:function(s){return a?o.apply(this,arguments)||0:n(this,s,arguments[1])}})},function(r,t,e){"use strict";var i=e(0),n=e(28),o=e(33),a=e(16),s=[].lastIndexOf,l=!!s&&1/[1].lastIndexOf(1,-0)<0;i(i.P+i.F*(l||!e(30)(s)),"Array",{lastIndexOf:function(u){if(l)return s.apply(this,arguments)||0;var c=n(this),h=a(c.length),p=h-1;for(arguments.length>1&&(p=Math.min(p,o(arguments[1]))),p<0&&(p=h+p);p>=0;p--)if(p in c&&c[p]===u)return p||0;return-1}})},function(r,t,e){var i=e(0);i(i.P,"Array",{copyWithin:e(127)}),e(51)("copyWithin")},function(r,t,e){var i=e(0);i(i.P,"Array",{fill:e(101)}),e(51)("fill")},function(r,t,e){"use strict";var i=e(0),n=e(36)(5),o=!0;"find"in[]&&Array(1).find(function(){o=!1}),i(i.P+i.F*o,"Array",{find:function(a){return n(this,a,arguments.length>1?arguments[1]:void 0)}}),e(51)("find")},function(r,t,e){"use strict";var i=e(0),n=e(36)(6),o="findIndex",a=!0;o in[]&&Array(1)[o](function(){a=!1}),i(i.P+i.F*a,"Array",{findIndex:function(s){return n(this,s,arguments.length>1?arguments[1]:void 0)}}),e(51)(o)},function(r,t,e){e(56)("Array")},function(r,t,e){var i=e(10),n=e(89),o=e(19).f,a=e(49).f,s=e(96),l=e(72),u=i.RegExp,c=u,h=u.prototype,p=/a/g,g=/a/g,b=new u(p)!==p;if(e(18)&&(!b||e(11)(function(){return g[e(14)("match")]=!1,u(p)!=p||u(g)==g||u(p,"i")!="/a/i"}))){u=function(O,d){var _=this instanceof u,m=s(O),y=d===void 0;return!_&&m&&O.constructor===u&&y?O:n(b?new c(m&&!y?O.source:O,d):c((m=O instanceof u)?O.source:O,m&&y?l.call(O):d),_?this:h,u)};for(var v=function(O){O in u||o(u,O,{configurable:!0,get:function(){return c[O]},set:function(d){c[O]=d}})},k=a(c),C=0;k.length>C;)v(k[C++]);h.constructor=u,u.prototype=h,e(23)(i,"RegExp",u)}e(56)("RegExp")},function(r,t,e){"use strict";e(130);var i=e(12),n=e(72),o=e(18),a=/./.toString,s=function(l){e(23)(RegExp.prototype,"toString",l,!0)};e(11)(function(){return a.call({source:"a",flags:"b"})!="/a/b"})?s(function(){var l=i(this);return"/".concat(l.source,"/","flags"in l?l.flags:!o&&l instanceof RegExp?n.call(l):void 0)}):a.name!="toString"&&s(function(){return a.call(this)})},function(r,t,e){"use strict";var i=e(12),n=e(16),o=e(104),a=e(73);e(74)("match",1,function(s,l,u,c){return[function(h){var p=s(this),g=h==null?void 0:h[l];return g!==void 0?g.call(h,p):new RegExp(h)[l](String(p))},function(h){var p=c(u,h,this);if(p.done)return p.value;var g=i(h),b=String(this);if(!g.global)return a(g,b);var v=g.unicode;g.lastIndex=0;for(var k,C=[],O=0;(k=a(g,b))!==null;){var d=String(k[0]);C[O]=d,d===""&&(g.lastIndex=o(b,n(g.lastIndex),v)),O++}return O===0?null:C}]})},function(r,t,e){"use strict";var i=e(12),n=e(20),o=e(16),a=e(33),s=e(104),l=e(73),u=Math.max,c=Math.min,h=Math.floor,p=/\$([$&`']|\d\d?|<[^>]*>)/g,g=/\$([$&`']|\d\d?)/g;e(74)("replace",2,function(b,v,k,C){return[function(d,_){var m=b(this),y=d==null?void 0:d[v];return y!==void 0?y.call(d,m,_):k.call(String(m),d,_)},function(d,_){var m=C(k,d,this,_);if(m.done)return m.value;var y=i(d),x=String(this),S=typeof _=="function";S||(_=String(_));var w=y.global;if(w){var E=y.unicode;y.lastIndex=0}for(var L=[];;){var I=l(y,x);if(I===null||(L.push(I),!w))break;String(I[0])===""&&(y.lastIndex=s(x,o(y.lastIndex),E))}for(var A,B="",T=0,M=0;M<L.length;M++){I=L[M];for(var j=String(I[0]),J=u(c(a(I.index),x.length),0),U=[],H=1;H<I.length;H++)U.push((A=I[H])===void 0?A:String(A));var te=I.groups;if(S){var ae=[j].concat(U,J,x);te!==void 0&&ae.push(te);var W=String(_.apply(void 0,ae))}else W=O(j,x,J,U,te,_);J>=T&&(B+=x.slice(T,J)+W,T=J+j.length)}return B+x.slice(T)}];function O(d,_,m,y,x,S){var w=m+d.length,E=y.length,L=g;return x!==void 0&&(x=n(x),L=p),k.call(S,L,function(I,A){var B;switch(A.charAt(0)){case"$":return"$";case"&":return d;case"`":return _.slice(0,m);case"'":return _.slice(w);case"<":B=x[A.slice(1,-1)];break;default:var T=+A;if(T===0)return I;if(T>E){var M=h(T/10);return M===0?I:M<=E?y[M-1]===void 0?A.charAt(1):y[M-1]+A.charAt(1):I}B=y[T-1]}return B===void 0?"":B})}})},function(r,t,e){"use strict";var i=e(12),n=e(115),o=e(73);e(74)("search",1,function(a,s,l,u){return[function(c){var h=a(this),p=c==null?void 0:c[s];return p!==void 0?p.call(c,h):new RegExp(c)[s](String(h))},function(c){var h=u(l,c,this);if(h.done)return h.value;var p=i(c),g=String(this),b=p.lastIndex;n(b,0)||(p.lastIndex=0);var v=o(p,g);return n(p.lastIndex,b)||(p.lastIndex=b),v===null?-1:v.index}]})},function(r,t,e){"use strict";var i=e(96),n=e(12),o=e(65),a=e(104),s=e(16),l=e(73),u=e(103),c=e(11),h=Math.min,p=[].push,g="length",b=!c(function(){RegExp(4294967295,"y")});e(74)("split",2,function(v,k,C,O){var d;return d="abbc".split(/(b)*/)[1]=="c"||"test".split(/(?:)/,-1)[g]!=4||"ab".split(/(?:ab)*/)[g]!=2||".".split(/(.?)(.?)/)[g]!=4||".".split(/()()/)[g]>1||"".split(/.?/)[g]?function(_,m){var y=String(this);if(_===void 0&&m===0)return[];if(!i(_))return C.call(y,_,m);for(var x,S,w,E=[],L=(_.ignoreCase?"i":"")+(_.multiline?"m":"")+(_.unicode?"u":"")+(_.sticky?"y":""),I=0,A=m===void 0?4294967295:m>>>0,B=new RegExp(_.source,L+"g");(x=u.call(B,y))&&!((S=B.lastIndex)>I&&(E.push(y.slice(I,x.index)),x[g]>1&&x.index<y[g]&&p.apply(E,x.slice(1)),w=x[0][g],I=S,E[g]>=A));)B.lastIndex===x.index&&B.lastIndex++;return I===y[g]?!w&&B.test("")||E.push(""):E.push(y.slice(I)),E[g]>A?E.slice(0,A):E}:"0".split(void 0,0)[g]?function(_,m){return _===void 0&&m===0?[]:C.call(this,_,m)}:C,[function(_,m){var y=v(this),x=_==null?void 0:_[k];return x!==void 0?x.call(_,y,m):d.call(String(y),_,m)},function(_,m){var y=O(d,_,this,m,d!==C);if(y.done)return y.value;var x=n(_),S=String(this),w=o(x,RegExp),E=x.unicode,L=(x.ignoreCase?"i":"")+(x.multiline?"m":"")+(x.unicode?"u":"")+(b?"y":"g"),I=new w(b?x:"^(?:"+x.source+")",L),A=m===void 0?4294967295:m>>>0;if(A===0)return[];if(S.length===0)return l(I,S)===null?[S]:[];for(var B=0,T=0,M=[];T<S.length;){I.lastIndex=b?T:0;var j,J=l(I,b?S:S.slice(T));if(J===null||(j=h(s(I.lastIndex+(b?0:T)),S.length))===B)T=a(S,T,E);else{if(M.push(S.slice(B,T)),M.length===A)return M;for(var U=1;U<=J.length-1;U++)if(M.push(J[U]),M.length===A)return M;T=B=j}}return M.push(S.slice(B)),M}]})},function(r,t,e){var i=e(10),n=e(105).set,o=i.MutationObserver||i.WebKitMutationObserver,a=i.process,s=i.Promise,l=e(37)(a)=="process";r.exports=function(){var u,c,h,p=function(){var k,C;for(l&&(k=a.domain)&&k.exit();u;){C=u.fn,u=u.next;try{C()}catch(O){throw u?h():c=void 0,O}}c=void 0,k&&k.enter()};if(l)h=function(){a.nextTick(p)};else if(!o||i.navigator&&i.navigator.standalone)if(s&&s.resolve){var g=s.resolve(void 0);h=function(){g.then(p)}}else h=function(){n.call(i,p)};else{var b=!0,v=document.createTextNode("");new o(p).observe(v,{characterData:!0}),h=function(){v.data=b=!b}}return function(k){var C={fn:k,next:void 0};c&&(c.next=C),u||(u=C,h()),c=C}}},function(r,t){r.exports=function(e){try{return{e:!1,v:e()}}catch(i){return{e:!0,v:i}}}},function(r,t,e){"use strict";var i=e(134),n=e(52);r.exports=e(77)("Map",function(o){return function(){return o(this,arguments.length>0?arguments[0]:void 0)}},{get:function(o){var a=i.getEntry(n(this,"Map"),o);return a&&a.v},set:function(o,a){return i.def(n(this,"Map"),o===0?0:o,a)}},i,!0)},function(r,t,e){"use strict";var i=e(134),n=e(52);r.exports=e(77)("Set",function(o){return function(){return o(this,arguments.length>0?arguments[0]:void 0)}},{add:function(o){return i.def(n(this,"Set"),o=o===0?0:o,o)}},i)},function(r,t,e){"use strict";var i,n=e(10),o=e(36)(0),a=e(23),s=e(41),l=e(114),u=e(135),c=e(13),h=e(52),p=e(52),g=!n.ActiveXObject&&"ActiveXObject"in n,b=s.getWeak,v=Object.isExtensible,k=u.ufstore,C=function(_){return function(){return _(this,arguments.length>0?arguments[0]:void 0)}},O={get:function(_){if(c(_)){var m=b(_);return m===!0?k(h(this,"WeakMap")).get(_):m?m[this._i]:void 0}},set:function(_,m){return u.def(h(this,"WeakMap"),_,m)}},d=r.exports=e(77)("WeakMap",C,O,u,!0,!0);p&&g&&(l((i=u.getConstructor(C,"WeakMap")).prototype,O),s.NEED=!0,o(["delete","has","get","set"],function(_){var m=d.prototype,y=m[_];a(m,_,function(x,S){if(c(x)&&!v(x)){this._f||(this._f=new i);var w=this._f[_](x,S);return _=="set"?this:w}return y.call(this,x,S)})}))},function(r,t,e){"use strict";var i=e(135),n=e(52);e(77)("WeakSet",function(o){return function(){return o(this,arguments.length>0?arguments[0]:void 0)}},{add:function(o){return i.def(n(this,"WeakSet"),o,!0)}},i,!1,!0)},function(r,t,e){"use strict";var i=e(0),n=e(78),o=e(106),a=e(12),s=e(47),l=e(16),u=e(13),c=e(10).ArrayBuffer,h=e(65),p=o.ArrayBuffer,g=o.DataView,b=n.ABV&&c.isView,v=p.prototype.slice,k=n.VIEW;i(i.G+i.W+i.F*(c!==p),{ArrayBuffer:p}),i(i.S+i.F*!n.CONSTR,"ArrayBuffer",{isView:function(C){return b&&b(C)||u(C)&&k in C}}),i(i.P+i.U+i.F*e(11)(function(){return!new p(2).slice(1,void 0).byteLength}),"ArrayBuffer",{slice:function(C,O){if(v!==void 0&&O===void 0)return v.call(a(this),C);for(var d=a(this).byteLength,_=s(C,d),m=s(O===void 0?d:O,d),y=new(h(this,p))(l(m-_)),x=new g(this),S=new g(y),w=0;_<m;)S.setUint8(w++,x.getUint8(_++));return y}}),e(56)("ArrayBuffer")},function(r,t,e){var i=e(0);i(i.G+i.W+i.F*!e(78).ABV,{DataView:e(106).DataView})},function(r,t,e){e(39)("Int8",1,function(i){return function(n,o,a){return i(this,n,o,a)}})},function(r,t,e){e(39)("Uint8",1,function(i){return function(n,o,a){return i(this,n,o,a)}})},function(r,t,e){e(39)("Uint8",1,function(i){return function(n,o,a){return i(this,n,o,a)}},!0)},function(r,t,e){e(39)("Int16",2,function(i){return function(n,o,a){return i(this,n,o,a)}})},function(r,t,e){e(39)("Uint16",2,function(i){return function(n,o,a){return i(this,n,o,a)}})},function(r,t,e){e(39)("Int32",4,function(i){return function(n,o,a){return i(this,n,o,a)}})},function(r,t,e){e(39)("Uint32",4,function(i){return function(n,o,a){return i(this,n,o,a)}})},function(r,t,e){e(39)("Float32",4,function(i){return function(n,o,a){return i(this,n,o,a)}})},function(r,t,e){e(39)("Float64",8,function(i){return function(n,o,a){return i(this,n,o,a)}})},function(r,t,e){var i=e(0),n=e(32),o=e(12),a=(e(10).Reflect||{}).apply,s=Function.apply;i(i.S+i.F*!e(11)(function(){a(function(){})}),"Reflect",{apply:function(l,u,c){var h=n(l),p=o(c);return a?a(h,u,p):s.call(h,u,p)}})},function(r,t,e){var i=e(0),n=e(48),o=e(32),a=e(12),s=e(13),l=e(11),u=e(116),c=(e(10).Reflect||{}).construct,h=l(function(){function g(){}return!(c(function(){},[],g)instanceof g)}),p=!l(function(){c(function(){})});i(i.S+i.F*(h||p),"Reflect",{construct:function(g,b){o(g),a(b);var v=arguments.length<3?g:o(arguments[2]);if(p&&!h)return c(g,b,v);if(g==v){switch(b.length){case 0:return new g;case 1:return new g(b[0]);case 2:return new g(b[0],b[1]);case 3:return new g(b[0],b[1],b[2]);case 4:return new g(b[0],b[1],b[2],b[3])}var k=[null];return k.push.apply(k,b),new(u.apply(g,k))}var C=v.prototype,O=n(s(C)?C:Object.prototype),d=Function.apply.call(g,O,b);return s(d)?d:O}})},function(r,t,e){var i=e(19),n=e(0),o=e(12),a=e(40);n(n.S+n.F*e(11)(function(){Reflect.defineProperty(i.f({},1,{value:1}),1,{value:2})}),"Reflect",{defineProperty:function(s,l,u){o(s),l=a(l,!0),o(u);try{return i.f(s,l,u),!0}catch(c){return!1}}})},function(r,t,e){var i=e(0),n=e(34).f,o=e(12);i(i.S,"Reflect",{deleteProperty:function(a,s){var l=n(o(a),s);return!(l&&!l.configurable)&&delete a[s]}})},function(r,t,e){"use strict";var i=e(0),n=e(12),o=function(a){this._t=n(a),this._i=0;var s,l=this._k=[];for(s in a)l.push(s)};e(123)(o,"Object",function(){var a,s=this._k;do if(this._i>=s.length)return{value:void 0,done:!0};while(!((a=s[this._i++])in this._t));return{value:a,done:!1}}),i(i.S,"Reflect",{enumerate:function(a){return new o(a)}})},function(r,t,e){var i=e(34),n=e(50),o=e(26),a=e(0),s=e(13),l=e(12);a(a.S,"Reflect",{get:function u(c,h){var p,g,b=arguments.length<3?c:arguments[2];return l(c)===b?c[h]:(p=i.f(c,h))?o(p,"value")?p.value:p.get!==void 0?p.get.call(b):void 0:s(g=n(c))?u(g,h,b):void 0}})},function(r,t,e){var i=e(34),n=e(0),o=e(12);n(n.S,"Reflect",{getOwnPropertyDescriptor:function(a,s){return i.f(o(a),s)}})},function(r,t,e){var i=e(0),n=e(50),o=e(12);i(i.S,"Reflect",{getPrototypeOf:function(a){return n(o(a))}})},function(r,t,e){var i=e(0);i(i.S,"Reflect",{has:function(n,o){return o in n}})},function(r,t,e){var i=e(0),n=e(12),o=Object.isExtensible;i(i.S,"Reflect",{isExtensible:function(a){return n(a),!o||o(a)}})},function(r,t,e){var i=e(0);i(i.S,"Reflect",{ownKeys:e(137)})},function(r,t,e){var i=e(0),n=e(12),o=Object.preventExtensions;i(i.S,"Reflect",{preventExtensions:function(a){n(a);try{return o&&o(a),!0}catch(s){return!1}}})},function(r,t,e){var i=e(19),n=e(34),o=e(50),a=e(26),s=e(0),l=e(43),u=e(12),c=e(13);s(s.S,"Reflect",{set:function h(p,g,b){var v,k,C=arguments.length<4?p:arguments[3],O=n.f(u(p),g);if(!O){if(c(k=o(p)))return h(k,g,b,C);O=l(0)}if(a(O,"value")){if(O.writable===!1||!c(C))return!1;if(v=n.f(C,g)){if(v.get||v.set||v.writable===!1)return!1;v.value=b,i.f(C,g,v)}else i.f(C,g,l(0,b));return!0}return O.set!==void 0&&(O.set.call(C,b),!0)}})},function(r,t,e){var i=e(0),n=e(87);n&&i(i.S,"Reflect",{setPrototypeOf:function(o,a){n.check(o,a);try{return n.set(o,a),!0}catch(s){return!1}}})},function(r,t,e){e(330),r.exports=e(17).Array.includes},function(r,t,e){"use strict";var i=e(0),n=e(68)(!0);i(i.P,"Array",{includes:function(o){return n(this,o,arguments.length>1?arguments[1]:void 0)}}),e(51)("includes")},function(r,t,e){e(332),r.exports=e(17).Array.flatMap},function(r,t,e){"use strict";var i=e(0),n=e(333),o=e(20),a=e(16),s=e(32),l=e(125);i(i.P,"Array",{flatMap:function(u){var c,h,p=o(this);return s(u),c=a(p.length),h=l(p,0),n(h,p,p,c,0,1,u,arguments[1]),h}}),e(51)("flatMap")},function(r,t,e){"use strict";var i=e(70),n=e(13),o=e(16),a=e(31),s=e(14)("isConcatSpreadable");r.exports=function l(u,c,h,p,g,b,v,k){for(var C,O,d=g,_=0,m=!!v&&a(v,k,3);_<p;){if(_ in h){if(C=m?m(h[_],_,c):h[_],O=!1,n(C)&&(O=(O=C[s])!==void 0?!!O:i(C)),O&&b>0)d=l(u,c,C,o(C.length),d,b-1)-1;else{if(d>=9007199254740991)throw TypeError();u[d]=C}d++}_++}return d}},function(r,t,e){e(335),r.exports=e(17).String.padStart},function(r,t,e){"use strict";var i=e(0),n=e(138),o=e(76),a=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(o);i(i.P+i.F*a,"String",{padStart:function(s){return n(this,s,arguments.length>1?arguments[1]:void 0,!0)}})},function(r,t,e){e(337),r.exports=e(17).String.padEnd},function(r,t,e){"use strict";var i=e(0),n=e(138),o=e(76),a=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(o);i(i.P+i.F*a,"String",{padEnd:function(s){return n(this,s,arguments.length>1?arguments[1]:void 0,!1)}})},function(r,t,e){e(339),r.exports=e(17).String.trimLeft},function(r,t,e){"use strict";e(54)("trimLeft",function(i){return function(){return i(this,1)}},"trimStart")},function(r,t,e){e(341),r.exports=e(17).String.trimRight},function(r,t,e){"use strict";e(54)("trimRight",function(i){return function(){return i(this,2)}},"trimEnd")},function(r,t,e){e(343),r.exports=e(83).f("asyncIterator")},function(r,t,e){e(110)("asyncIterator")},function(r,t,e){e(345),r.exports=e(17).Object.getOwnPropertyDescriptors},function(r,t,e){var i=e(0),n=e(137),o=e(28),a=e(34),s=e(99);i(i.S,"Object",{getOwnPropertyDescriptors:function(l){for(var u,c,h=o(l),p=a.f,g=n(h),b={},v=0;g.length>v;)(c=p(h,u=g[v++]))!==void 0&&s(b,u,c);return b}})},function(r,t,e){e(347),r.exports=e(17).Object.values},function(r,t,e){var i=e(0),n=e(139)(!1);i(i.S,"Object",{values:function(o){return n(o)}})},function(r,t,e){e(349),r.exports=e(17).Object.entries},function(r,t,e){var i=e(0),n=e(139)(!0);i(i.S,"Object",{entries:function(o){return n(o)}})},function(r,t,e){"use strict";e(131),e(351),r.exports=e(17).Promise.finally},function(r,t,e){"use strict";var i=e(0),n=e(17),o=e(10),a=e(65),s=e(133);i(i.P+i.R,"Promise",{finally:function(l){var u=a(this,n.Promise||o.Promise),c=typeof l=="function";return this.then(c?function(h){return s(u,l()).then(function(){return h})}:l,c?function(h){return s(u,l()).then(function(){throw h})}:l)}})},function(r,t,e){e(353),e(354),e(355),r.exports=e(17)},function(r,t,e){var i=e(10),n=e(0),o=e(76),a=[].slice,s=/MSIE .\./.test(o),l=function(u){return function(c,h){var p=arguments.length>2,g=!!p&&a.call(arguments,2);return u(p?function(){(typeof c=="function"?c:Function(c)).apply(this,g)}:c,h)}};n(n.G+n.B+n.F*s,{setTimeout:l(i.setTimeout),setInterval:l(i.setInterval)})},function(r,t,e){var i=e(0),n=e(105);i(i.G+i.B,{setImmediate:n.set,clearImmediate:n.clear})},function(r,t,e){for(var i=e(102),n=e(46),o=e(23),a=e(10),s=e(27),l=e(55),u=e(14),c=u("iterator"),h=u("toStringTag"),p=l.Array,g={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},b=n(g),v=0;v<b.length;v++){var k,C=b[v],O=g[C],d=a[C],_=d&&d.prototype;if(_&&(_[c]||s(_,c,p),_[h]||s(_,h,C),l[C]=p,O))for(k in i)_[k]||o(_,k,i[k],!0)}},function(r,t,e){var i,n,o;n=[t,e(29),e(2),e(3),e(360),e(362),e(363),e(8)],(o=typeof(i=function(a,s,l,u,c,h,p,g){"use strict";var b=e(9),v=e(1);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,s=v(s),l=v(l),u=v(u),p=v(p),g=b(g);var k=function(){function C(O){var d=this;(0,l.default)(this,C);var _=function(){};g.isObject(O)&&g.isFunction(O.onReady)&&(_=O.onReady);var m=new p.default(O);this.isReady=m.isReady.then(function(){d.exportAPI(m),_()})}return(0,u.default)(C,[{key:"exportAPI",value:function(O){var d=this;["configuration"].forEach(function(_){d[_]=O[_]}),this.destroy=function(){for(var _ in Object.values(O.moduleInstances).forEach(function(m){g.isFunction(m.destroy)&&m.destroy(),m.listeners.removeAll()}),O=null,d)Object.prototype.hasOwnProperty.call(d,_)&&delete d[_];Object.setPrototypeOf(d,null)},Object.setPrototypeOf(this,O.moduleInstances.API.methods),delete this.exportAPI,Object.entries({blocks:{clear:"clear",render:"render"},caret:{focus:"focus"},events:{on:"on",off:"off",emit:"emit"},saver:{save:"save"}}).forEach(function(_){var m=(0,s.default)(_,2),y=m[0],x=m[1];Object.entries(x).forEach(function(S){var w=(0,s.default)(S,2),E=w[0],L=w[1];d[L]=O.moduleInstances.API.methods[y][E]})})}}],[{key:"version",get:function(){return"2.20.0"}}]),C}();a.default=k,k.displayName="EditorJS",r.exports=t.default})=="function"?i.apply(t,n):i)===void 0||(r.exports=o)},function(r,t){r.exports=function(e){if(Array.isArray(e))return e}},function(r,t){r.exports=function(e,i){if(typeof Symbol!="undefined"&&Symbol.iterator in Object(e)){var n=[],o=!0,a=!1,s=void 0;try{for(var l,u=e[Symbol.iterator]();!(o=(l=u.next()).done)&&(n.push(l.value),!i||n.length!==i);o=!0);}catch(c){a=!0,s=c}finally{try{o||u.return==null||u.return()}finally{if(a)throw s}}return n}}},function(r,t){r.exports=function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}},function(r,t,e){(t=r.exports=function(...o){return n(...o)}).__esModule=!0;let i=e(361),n=i.default;Object.assign(t,i)},function(r,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){},t.revert=function(){}},function(r,t,e){var i,n,o;n=[],(o=typeof(i=function(){"use strict";Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(a){for(var s=(this.document||this.ownerDocument).querySelectorAll(a),l=s.length;--l>=0&&s.item(l)!==this;);return l>-1}),Element.prototype.closest||(Element.prototype.closest=function(a){var s=this;if(!document.documentElement.contains(s))return null;do{if(s.matches(a))return s;s=s.parentElement||s.parentNode}while(s!==null);return null}),Element.prototype.prepend||(Element.prototype.prepend=function(a){var s=document.createDocumentFragment();Array.isArray(a)||(a=[a]),a.forEach(function(l){var u=l instanceof Node;s.appendChild(u?l:document.createTextNode(l))}),this.insertBefore(s,this.firstChild)})})=="function"?i.apply(t,n):i)===void 0||(r.exports=o)},function(r,t,e){var i,n,o;n=[t,e(21),e(22),e(2),e(3),e(15),e(8),e(59),e(145),e(372)],(o=typeof(i=function(a,s,l,u,c,h,p,g,b,v){"use strict";var k=e(9),C=e(1);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,s=C(s),l=C(l),u=C(u),c=C(c),h=C(h),p=k(p),g=C(g),v=C(v);var O=e(373),d=[];O.keys().forEach(function(m){m.match(/^\.\/[^_][\w/]*\.([tj])s$/)&&d.push(O(m))});var _=function(){function m(S){var w,E,L=this;(0,u.default)(this,m),this.moduleInstances={},this.eventsDispatcher=new v.default,this.isReady=new Promise(function(I,A){w=I,E=A}),Promise.resolve().then((0,l.default)(s.default.mark(function I(){return s.default.wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return L.configuration=S,A.next=3,L.validate();case 3:return A.next=5,L.init();case 5:return A.next=7,L.start();case 7:p.logLabeled("I'm ready! (\uFF89\u25D5\u30EE\u25D5)\uFF89*:\uFF65\uFF9F\u2727","log","","color: #E24A75"),setTimeout((0,l.default)(s.default.mark(function B(){var T,M,j;return s.default.wrap(function(J){for(;;)switch(J.prev=J.next){case 0:return J.next=2,L.render();case 2:L.configuration.autofocus&&(T=L.moduleInstances,M=T.BlockManager,(j=T.Caret).setToBlock(M.blocks[0],j.positions.START),M.highlightCurrentNode()),L.moduleInstances.UI.removeLoader(),w();case 5:case"end":return J.stop()}},B)})),500);case 9:case"end":return A.stop()}},I)}))).catch(function(I){p.log("Editor.js is not ready because of ".concat(I),"error"),E(I)})}var y,x;return(0,c.default)(m,[{key:"validate",value:(x=(0,l.default)(s.default.mark(function S(){var w,E,L;return s.default.wrap(function(I){for(;;)switch(I.prev=I.next){case 0:if(w=this.config,E=w.holderId,L=w.holder,!E||!L){I.next=3;break}throw Error("\xABholderId\xBB and \xABholder\xBB param can't assign at the same time.");case 3:if(!p.isString(L)||h.default.get(L)){I.next=5;break}throw Error("element with ID \xAB".concat(L,"\xBB is missing. Pass correct holder's ID."));case 5:if(!L||!p.isObject(L)||h.default.isElement(L)){I.next=7;break}throw Error("\xABholder\xBB value must be an Element node");case 7:case"end":return I.stop()}},S,this)})),function(){return x.apply(this,arguments)})},{key:"init",value:function(){this.constructModules(),this.configureModules()}},{key:"start",value:(y=(0,l.default)(s.default.mark(function S(){var w,E=this;return s.default.wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return w=["Tools","UI","BlockManager","Paste","BlockSelection","RectangleSelection","CrossBlockSelection","ReadOnly"],L.next=3,w.reduce(function(I,A){return I.then((0,l.default)(s.default.mark(function B(){return s.default.wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return T.prev=0,T.next=3,E.moduleInstances[A].prepare();case 3:T.next=10;break;case 5:if(T.prev=5,T.t0=T.catch(0),!(T.t0 instanceof b.CriticalError)){T.next=9;break}throw new Error(T.t0.message);case 9:p.log("Module ".concat(A," was skipped because of %o"),"warn",T.t0);case 10:case"end":return T.stop()}},B,null,[[0,5]])})))},Promise.resolve());case 3:case"end":return L.stop()}},S)})),function(){return y.apply(this,arguments)})},{key:"render",value:function(){return this.moduleInstances.Renderer.render(this.config.data.blocks)}},{key:"constructModules",value:function(){var S=this;d.forEach(function(w){var E=p.isFunction(w)?w:w.default;try{S.moduleInstances[E.displayName]=new E({config:S.configuration,eventsDispatcher:S.eventsDispatcher})}catch(L){p.log("Module ".concat(E.displayName," skipped because"),"warn",L)}})}},{key:"configureModules",value:function(){for(var S in this.moduleInstances)Object.prototype.hasOwnProperty.call(this.moduleInstances,S)&&(this.moduleInstances[S].state=this.getModulesDiff(S))}},{key:"getModulesDiff",value:function(S){var w={};for(var E in this.moduleInstances)E!==S&&(w[E]=this.moduleInstances[E]);return w}},{key:"configuration",set:function(S){var w,E;p.isObject(S)?this.config=Object.assign({},S):this.config={holder:S},p.deprecationAssert(!!this.config.holderId,"config.holderId","config.holder"),this.config.holderId&&!this.config.holder&&(this.config.holder=this.config.holderId,this.config.holderId=null),this.config.holder==null&&(this.config.holder="editorjs"),this.config.logLevel||(this.config.logLevel=p.LogLevels.VERBOSE),p.setLogLevel(this.config.logLevel),p.deprecationAssert(Boolean(this.config.initialBlock),"config.initialBlock","config.defaultBlock"),this.config.defaultBlock=this.config.defaultBlock||this.config.initialBlock||"paragraph",this.config.minHeight=this.config.minHeight!==void 0?this.config.minHeight:300;var L={type:this.config.defaultBlock,data:{}};this.config.placeholder=this.config.placeholder||!1,this.config.sanitizer=this.config.sanitizer||{p:!0,b:!0,a:!0},this.config.hideToolbar=!!this.config.hideToolbar&&this.config.hideToolbar,this.config.tools=this.config.tools||{},this.config.i18n=this.config.i18n||{},this.config.data=this.config.data||{blocks:[]},this.config.onReady=this.config.onReady||function(){},this.config.onChange=this.config.onChange||function(){},this.config.inlineToolbar=this.config.inlineToolbar===void 0||this.config.inlineToolbar,!p.isEmpty(this.config.data)&&this.config.data.blocks&&this.config.data.blocks.length!==0||(this.config.data={blocks:[L]}),this.config.readOnly=this.config.readOnly||!1,!((w=this.config.i18n)===null||w===void 0)&&w.messages&&g.default.setDictionary(this.config.i18n.messages),this.config.i18n.direction=((E=this.config.i18n)===null||E===void 0?void 0:E.direction)||"ltr"},get:function(){return this.config}}]),m}();a.default=_,_.displayName="Core",r.exports=t.default})=="function"?i.apply(t,n):i)===void 0||(r.exports=o)},function(r,t,e){var i=e(142);r.exports=function(n){if(Array.isArray(n))return i(n)}},function(r,t){r.exports=function(e){if(typeof Symbol!="undefined"&&Symbol.iterator in Object(e))return Array.from(e)}},function(r,t){r.exports=function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}},function(r,t){r.exports=function(e,i,n){return i in e?Object.defineProperty(e,i,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[i]=n,e}},function(r,t){r.exports=function(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},function(r,t){r.exports=function(e){return Function.toString.call(e).indexOf("[native code]")!==-1}},function(r,t,e){var i=e(107),n=e(371);function o(a,s,l){return n()?r.exports=o=Reflect.construct:r.exports=o=function(u,c,h){var p=[null];p.push.apply(p,c);var g=new(Function.bind.apply(u,p));return h&&i(g,h.prototype),g},o.apply(null,arguments)}r.exports=o},function(r,t){r.exports=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}},function(r,t,e){var i,n,o;n=[t,e(2),e(3)],(o=typeof(i=function(a,s,l){"use strict";var u=e(1);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,s=u(s),l=u(l);var c=function(){function h(){(0,s.default)(this,h),this.subscribers={}}return(0,l.default)(h,[{key:"on",value:function(p,g){p in this.subscribers||(this.subscribers[p]=[]),this.subscribers[p].push(g)}},{key:"once",value:function(p,g){var b=this;p in this.subscribers||(this.subscribers[p]=[]),this.subscribers[p].push(function v(k){var C=g(k),O=b.subscribers[p].indexOf(v);return O!==-1&&b.subscribers[p].splice(O,1),C})}},{key:"emit",value:function(p,g){this.subscribers[p]&&this.subscribers[p].reduce(function(b,v){return v(b)||b},g)}},{key:"off",value:function(p,g){for(var b=0;b<this.subscribers[p].length;b++)if(this.subscribers[p][b]===g){delete this.subscribers[p][b];break}}},{key:"destroy",value:function(){this.subscribers=null}}]),h}();a.default=c,c.displayName="EventsDispatcher",r.exports=t.default})=="function"?i.apply(t,n):i)===void 0||(r.exports=o)},function(r,t,e){var i={"./api":79,"./api/":79,"./api/blocks":147,"./api/blocks.ts":147,"./api/caret":149,"./api/caret.ts":149,"./api/events":150,"./api/events.ts":150,"./api/i18n":151,"./api/i18n.ts":151,"./api/index":79,"./api/index.ts":79,"./api/inlineToolbar":152,"./api/inlineToolbar.ts":152,"./api/listeners":153,"./api/listeners.ts":153,"./api/notifier":154,"./api/notifier.ts":154,"./api/readonly":155,"./api/readonly.ts":155,"./api/sanitizer":156,"./api/sanitizer.ts":156,"./api/saver":157,"./api/saver.ts":157,"./api/selection":158,"./api/selection.ts":158,"./api/styles":159,"./api/styles.ts":159,"./api/toolbar":160,"./api/toolbar.ts":160,"./api/tooltip":161,"./api/tooltip.ts":161,"./blockEvents":162,"./blockEvents.ts":162,"./blockManager":163,"./blockManager.ts":163,"./blockSelection":164,"./blockSelection.ts":164,"./caret":165,"./caret.ts":165,"./crossBlockSelection":166,"./crossBlockSelection.ts":166,"./dragNDrop":167,"./dragNDrop.ts":167,"./modificationsObserver":168,"./modificationsObserver.ts":168,"./notifier":169,"./notifier.ts":169,"./paste":170,"./paste.ts":170,"./readonly":171,"./readonly.ts":171,"./rectangleSelection":172,"./rectangleSelection.ts":172,"./renderer":173,"./renderer.ts":173,"./sanitizer":174,"./sanitizer.ts":174,"./saver":175,"./saver.ts":175,"./toolbar":80,"./toolbar/":80,"./toolbar/blockSettings":176,"./toolbar/blockSettings.ts":176,"./toolbar/conversion":177,"./toolbar/conversion.ts":177,"./toolbar/index":80,"./toolbar/index.ts":80,"./toolbar/inline":178,"./toolbar/inline.ts":178,"./toolbar/toolbox":179,"./toolbar/toolbox.ts":179,"./tools":180,"./tools.ts":180,"./tooltip":181,"./tooltip.ts":181,"./ui":182,"./ui.ts":182};function n(a){var s=o(a);return e(s)}function o(a){if(!e.o(i,a)){var s=new Error("Cannot find module '"+a+"'");throw s.code="MODULE_NOT_FOUND",s}return i[a]}n.keys=function(){return Object.keys(i)},n.resolve=o,r.exports=n,n.id=373},function(r,t,e){var i,n,o;n=[t,e(2),e(3),e(8)],(o=typeof(i=function(a,s,l,u){"use strict";var c=e(9),h=e(1);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,s=h(s),l=h(l),u=c(u);var p=function(){function g(){(0,s.default)(this,g),this.allListeners=[]}return(0,l.default)(g,[{key:"on",value:function(b,v,k){var C=arguments.length>3&&arguments[3]!==void 0&&arguments[3],O=u.generateId("l"),d={id:O,element:b,eventType:v,handler:k,options:C},_=this.findOne(b,v,k);if(!_)return this.allListeners.push(d),b.addEventListener(v,k,C),O}},{key:"off",value:function(b,v,k,C){var O=this,d=this.findAll(b,v,k);d.forEach(function(_,m){var y=O.allListeners.indexOf(d[m]);y>-1&&(O.allListeners.splice(y,1),_.element.removeEventListener(_.eventType,_.handler,_.options))})}},{key:"offById",value:function(b){var v=this.findById(b);v&&v.element.removeEventListener(v.eventType,v.handler,v.options)}},{key:"findOne",value:function(b,v,k){var C=this.findAll(b,v,k);return C.length>0?C[0]:null}},{key:"findAll",value:function(b,v,k){var C=b?this.findByEventTarget(b):[];return b&&v&&k?C.filter(function(O){return O.eventType===v&&O.handler===k}):b&&v?C.filter(function(O){return O.eventType===v}):C}},{key:"removeAll",value:function(){this.allListeners.map(function(b){b.element.removeEventListener(b.eventType,b.handler,b.options)}),this.allListeners=[]}},{key:"destroy",value:function(){this.removeAll()}},{key:"findByEventTarget",value:function(b){return this.allListeners.filter(function(v){if(v.element===b)return v})}},{key:"findByType",value:function(b){return this.allListeners.filter(function(v){if(v.eventType===b)return v})}},{key:"findByHandler",value:function(b){return this.allListeners.filter(function(v){if(v.handler===b)return v})}},{key:"findById",value:function(b){return this.allListeners.find(function(v){return v.id===b})}}]),g}();a.default=p,p.displayName="Listeners",r.exports=t.default})=="function"?i.apply(t,n):i)===void 0||(r.exports=o)},function(r,t,e){var i,n,o;n=[t,e(2),e(3),e(15),e(8),e(25)],(o=typeof(i=function(a,s,l,u,c,h){"use strict";var p=e(9),g=e(1);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,s=g(s),l=g(l),u=g(u),c=p(c),h=g(h);var b=function(){function v(k,C){(0,s.default)(this,v),this.cursor=-1,this.items=[],this.items=k||[],this.focusedCssClass=C}return(0,l.default)(v,[{key:"setItems",value:function(k){this.items=k}},{key:"next",value:function(){this.cursor=this.leafNodesAndReturnIndex(v.directions.RIGHT)}},{key:"previous",value:function(){this.cursor=this.leafNodesAndReturnIndex(v.directions.LEFT)}},{key:"dropCursor",value:function(){this.cursor!==-1&&(this.items[this.cursor].classList.remove(this.focusedCssClass),this.cursor=-1)}},{key:"leafNodesAndReturnIndex",value:function(k){var C=this;if(this.items.length===0)return this.cursor;var O=this.cursor;return O===-1?O=k===v.directions.RIGHT?-1:0:this.items[O].classList.remove(this.focusedCssClass),O=k===v.directions.RIGHT?(O+1)%this.items.length:(this.items.length+O-1)%this.items.length,u.default.canSetCaret(this.items[O])&&c.delay(function(){return h.default.setCursor(C.items[O])},50)(),this.items[O].classList.add(this.focusedCssClass),O}},{key:"currentItem",get:function(){return this.cursor===-1?null:this.items[this.cursor]}}]),v}();a.default=b,b.displayName="DomIterator",b.directions={RIGHT:"right",LEFT:"left"},r.exports=t.default})=="function"?i.apply(t,n):i)===void 0||(r.exports=o)},function(r,t,e){var i,n,o;n=[t,e(2),e(3),e(8),e(15),e(61)],(o=typeof(i=function(a,s,l,u,c,h){"use strict";var p=e(9),g=e(1);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,s=g(s),l=g(l),u=p(u),c=g(c);var b=function(){function v(k){(0,s.default)(this,v),this.blocks=[],this.workingArea=k}return(0,l.default)(v,[{key:"push",value:function(k){this.blocks.push(k),this.insertToDOM(k)}},{key:"swap",value:function(k,C){var O=this.blocks[C];c.default.swap(this.blocks[k].holder,O.holder),this.blocks[C]=this.blocks[k],this.blocks[k]=O}},{key:"move",value:function(k,C){var O=this.blocks.splice(C,1)[0],d=k-1,_=Math.max(0,d),m=this.blocks[_];k>0?this.insertToDOM(O,"afterend",m):this.insertToDOM(O,"beforebegin",m),this.blocks.splice(k,0,O);var y=this.composeBlockEvent("move",{fromIndex:C,toIndex:k});O.call(h.BlockToolAPI.MOVED,y)}},{key:"insert",value:function(k,C){var O=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(this.length){k>this.length&&(k=this.length),O&&(this.blocks[k].holder.remove(),this.blocks[k].call(h.BlockToolAPI.REMOVED));var d=O?1:0;if(this.blocks.splice(k,d,C),k>0){var _=this.blocks[k-1];this.insertToDOM(C,"afterend",_)}else{var m=this.blocks[k+1];m?this.insertToDOM(C,"beforebegin",m):this.insertToDOM(C)}}else this.push(C)}},{key:"remove",value:function(k){isNaN(k)&&(k=this.length-1),this.blocks[k].holder.remove(),this.blocks[k].call(h.BlockToolAPI.REMOVED),this.blocks.splice(k,1)}},{key:"removeAll",value:function(){this.workingArea.innerHTML="",this.blocks.forEach(function(k){return k.call(h.BlockToolAPI.REMOVED)}),this.blocks.length=0}},{key:"insertAfter",value:function(k,C){var O=this.blocks.indexOf(k);this.insert(O+1,C)}},{key:"get",value:function(k){return this.blocks[k]}},{key:"indexOf",value:function(k){return this.blocks.indexOf(k)}},{key:"insertToDOM",value:function(k,C,O){C?O.holder.insertAdjacentElement(C,k.holder):this.workingArea.appendChild(k.holder),k.call(h.BlockToolAPI.RENDERED)}},{key:"composeBlockEvent",value:function(k,C){return new CustomEvent(k,{detail:C})}},{key:"length",get:function(){return this.blocks.length}},{key:"array",get:function(){return this.blocks}},{key:"nodes",get:function(){return u.array(this.workingArea.children)}}],[{key:"set",value:function(k,C,O){return isNaN(Number(C))?(Reflect.set(k,C,O),!0):(k.insert(+C,O),!0)}},{key:"get",value:function(k,C){return isNaN(Number(C))?Reflect.get(k,C):k.get(+C)}}]),v}();a.default=b,b.displayName="Blocks",r.exports=t.default})=="function"?i.apply(t,n):i)===void 0||(r.exports=o)},function(r,t,e){r.exports=function(i){var n={};function o(a){if(n[a])return n[a].exports;var s=n[a]={i:a,l:!1,exports:{}};return i[a].call(s.exports,s,s.exports,o),s.l=!0,s.exports}return o.m=i,o.c=n,o.d=function(a,s,l){o.o(a,s)||Object.defineProperty(a,s,{enumerable:!0,get:l})},o.r=function(a){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},o.t=function(a,s){if(1&s&&(a=o(a)),8&s||4&s&&typeof a=="object"&&a&&a.__esModule)return a;var l=Object.create(null);if(o.r(l),Object.defineProperty(l,"default",{enumerable:!0,value:a}),2&s&&typeof a!="string")for(var u in a)o.d(l,u,function(c){return a[c]}.bind(null,u));return l},o.n=function(a){var s=a&&a.__esModule?function(){return a.default}:function(){return a};return o.d(s,"a",s),s},o.o=function(a,s){return Object.prototype.hasOwnProperty.call(a,s)},o.p="",o(o.s=0)}([function(i,n,o){"use strict";function a(u,c){for(var h=0;h<c.length;h++){var p=c[h];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(u,p.key,p)}}function s(u,c,h){return c&&a(u.prototype,c),h&&a(u,h),u}o.r(n);var l=function(){function u(c){var h=this;(function(p,g){if(!(p instanceof g))throw new TypeError("Cannot call a class as a function")})(this,u),this.commands={},this.keys={},this.name=c.name,this.parseShortcutName(c.name),this.element=c.on,this.callback=c.callback,this.executeShortcut=function(p){h.execute(p)},this.element.addEventListener("keydown",this.executeShortcut,!1)}return s(u,null,[{key:"supportedCommands",get:function(){return{SHIFT:["SHIFT"],CMD:["CMD","CONTROL","COMMAND","WINDOWS","CTRL"],ALT:["ALT","OPTION"]}}},{key:"keyCodes",get:function(){return{0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,BACKSPACE:8,ENTER:13,ESCAPE:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,INSERT:45,DELETE:46}}}]),s(u,[{key:"parseShortcutName",value:function(c){c=c.split("+");for(var h=0;h<c.length;h++){c[h]=c[h].toUpperCase();var p=!1;for(var g in u.supportedCommands)if(u.supportedCommands[g].includes(c[h])){p=this.commands[g]=!0;break}p||(this.keys[c[h]]=!0)}for(var b in u.supportedCommands)this.commands[b]||(this.commands[b]=!1)}},{key:"execute",value:function(c){var h,p={CMD:c.ctrlKey||c.metaKey,SHIFT:c.shiftKey,ALT:c.altKey},g=!0;for(h in this.commands)this.commands[h]!==p[h]&&(g=!1);var b,v=!0;for(b in this.keys)v=v&&c.keyCode===u.keyCodes[b];g&&v&&this.callback(c)}},{key:"remove",value:function(){this.element.removeEventListener("keydown",this.executeShortcut)}}]),u}();n.default=l}]).default},function(r,t,e){r.exports=function(i){var n={};function o(a){if(n[a])return n[a].exports;var s=n[a]={i:a,l:!1,exports:{}};return i[a].call(s.exports,s,s.exports,o),s.l=!0,s.exports}return o.m=i,o.c=n,o.d=function(a,s,l){o.o(a,s)||Object.defineProperty(a,s,{enumerable:!0,get:l})},o.r=function(a){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},o.t=function(a,s){if(1&s&&(a=o(a)),8&s||4&s&&typeof a=="object"&&a&&a.__esModule)return a;var l=Object.create(null);if(o.r(l),Object.defineProperty(l,"default",{enumerable:!0,value:a}),2&s&&typeof a!="string")for(var u in a)o.d(l,u,function(c){return a[c]}.bind(null,u));return l},o.n=function(a){var s=a&&a.__esModule?function(){return a.default}:function(){return a};return o.d(s,"a",s),s},o.o=function(a,s){return Object.prototype.hasOwnProperty.call(a,s)},o.p="/",o(o.s=0)}([function(i,n,o){"use strict";o(1),i.exports=function(){var a=o(6),s=null;return{show:function(l){if(l.message){(function(){if(s)return!0;s=a.getWrapper(),document.body.appendChild(s)})();var u=null,c=l.time||8e3;switch(l.type){case"confirm":u=a.confirm(l);break;case"prompt":u=a.prompt(l);break;default:u=a.alert(l),window.setTimeout(function(){u.remove()},c)}s.appendChild(u),u.classList.add("cdx-notify--bounce-in")}}}}()},function(i,n,o){var a=o(2);typeof a=="string"&&(a=[[i.i,a,""]]),o(4)(a,{hmr:!0,transform:void 0,insertInto:void 0}),a.locals&&(i.exports=a.locals)},function(i,n,o){(i.exports=o(3)(!1)).push([i.i,`.cdx-notify--error{background:#fffbfb!important}.cdx-notify--error::before{background:#fb5d5d!important}.cdx-notify__input{max-width:130px;padding:5px 10px;background:#f7f7f7;border:0;border-radius:3px;font-size:13px;color:#656b7c;outline:0}.cdx-notify__input:-ms-input-placeholder{color:#656b7c}.cdx-notify__input::placeholder{color:#656b7c}.cdx-notify__input:focus:-ms-input-placeholder{color:rgba(101,107,124,.3)}.cdx-notify__input:focus::placeholder{color:rgba(101,107,124,.3)}.cdx-notify__button{border:none;border-radius:3px;font-size:13px;padding:5px 10px;cursor:pointer}.cdx-notify__button:last-child{margin-left:10px}.cdx-notify__button--cancel{background:#f2f5f7;box-shadow:0 2px 1px 0 rgba(16,19,29,0);color:#656b7c}.cdx-notify__button--cancel:hover{background:#eee}.cdx-notify__button--confirm{background:#34c992;box-shadow:0 1px 1px 0 rgba(18,49,35,.05);color:#fff}.cdx-notify__button--confirm:hover{background:#33b082}.cdx-notify__btns-wrapper{display:-ms-flexbox;display:flex;-ms-flex-flow:row nowrap;flex-flow:row nowrap;margin-top:5px}.cdx-notify__cross{position:absolute;top:5px;right:5px;width:10px;height:10px;padding:5px;opacity:.54;cursor:pointer}.cdx-notify__cross::after,.cdx-notify__cross::before{content:'';position:absolute;left:9px;top:5px;height:12px;width:2px;background:#575d67}.cdx-notify__cross::before{transform:rotate(-45deg)}.cdx-notify__cross::after{transform:rotate(45deg)}.cdx-notify__cross:hover{opacity:1}.cdx-notifies{position:fixed;z-index:2;bottom:20px;left:20px;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",sans-serif}.cdx-notify{position:relative;width:220px;margin-top:15px;padding:13px 16px;background:#fff;box-shadow:0 11px 17px 0 rgba(23,32,61,.13);border-radius:5px;font-size:14px;line-height:1.4em;word-wrap:break-word}.cdx-notify::before{content:'';position:absolute;display:block;top:0;left:0;width:3px;height:calc(100% - 6px);margin:3px;border-radius:5px;background:0 0}@keyframes bounceIn{0%{opacity:0;transform:scale(.3)}50%{opacity:1;transform:scale(1.05)}70%{transform:scale(.9)}100%{transform:scale(1)}}.cdx-notify--bounce-in{animation-name:bounceIn;animation-duration:.6s;animation-iteration-count:1}.cdx-notify--success{background:#fafffe!important}.cdx-notify--success::before{background:#41ffb1!important}`,""])},function(i,n){i.exports=function(o){var a=[];return a.toString=function(){return this.map(function(s){var l=function(u,c){var h,p=u[1]||"",g=u[3];if(!g)return p;if(c&&typeof btoa=="function"){var b=(h=g,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(h))))+" */"),v=g.sources.map(function(k){return"/*# sourceURL="+g.sourceRoot+k+" */"});return[p].concat(v).concat([b]).join(`
`)}return[p].join(`
`)}(s,o);return s[2]?"@media "+s[2]+"{"+l+"}":l}).join("")},a.i=function(s,l){typeof s=="string"&&(s=[[null,s,""]]);for(var u={},c=0;c<this.length;c++){var h=this[c][0];typeof h=="number"&&(u[h]=!0)}for(c=0;c<s.length;c++){var p=s[c];typeof p[0]=="number"&&u[p[0]]||(l&&!p[2]?p[2]=l:l&&(p[2]="("+p[2]+") and ("+l+")"),a.push(p))}},a}},function(i,n,o){var a,s,l={},u=(a=function(){return window&&document&&document.all&&!window.atob},function(){return s===void 0&&(s=a.apply(this,arguments)),s}),c=function(w){var E={};return function(L){if(typeof L=="function")return L();if(E[L]===void 0){var I=function(A){return document.querySelector(A)}.call(this,L);if(window.HTMLIFrameElement&&I instanceof window.HTMLIFrameElement)try{I=I.contentDocument.head}catch(A){I=null}E[L]=I}return E[L]}}(),h=null,p=0,g=[],b=o(5);function v(w,E){for(var L=0;L<w.length;L++){var I=w[L],A=l[I.id];if(A){A.refs++;for(var B=0;B<A.parts.length;B++)A.parts[B](I.parts[B]);for(;B<I.parts.length;B++)A.parts.push(m(I.parts[B],E))}else{var T=[];for(B=0;B<I.parts.length;B++)T.push(m(I.parts[B],E));l[I.id]={id:I.id,refs:1,parts:T}}}}function k(w,E){for(var L=[],I={},A=0;A<w.length;A++){var B=w[A],T=E.base?B[0]+E.base:B[0],M={css:B[1],media:B[2],sourceMap:B[3]};I[T]?I[T].parts.push(M):L.push(I[T]={id:T,parts:[M]})}return L}function C(w,E){var L=c(w.insertInto);if(!L)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var I=g[g.length-1];if(w.insertAt==="top")I?I.nextSibling?L.insertBefore(E,I.nextSibling):L.appendChild(E):L.insertBefore(E,L.firstChild),g.push(E);else if(w.insertAt==="bottom")L.appendChild(E);else{if(typeof w.insertAt!="object"||!w.insertAt.before)throw new Error(`[Style Loader]

 Invalid value for parameter 'insertAt' ('options.insertAt') found.
 Must be 'top', 'bottom', or Object.
 (https://github.com/webpack-contrib/style-loader#insertat)
`);var A=c(w.insertInto+" "+w.insertAt.before);L.insertBefore(E,A)}}function O(w){if(w.parentNode===null)return!1;w.parentNode.removeChild(w);var E=g.indexOf(w);E>=0&&g.splice(E,1)}function d(w){var E=document.createElement("style");return w.attrs.type===void 0&&(w.attrs.type="text/css"),_(E,w.attrs),C(w,E),E}function _(w,E){Object.keys(E).forEach(function(L){w.setAttribute(L,E[L])})}function m(w,E){var L,I,A,B;if(E.transform&&w.css){if(!(B=E.transform(w.css)))return function(){};w.css=B}if(E.singleton){var T=p++;L=h||(h=d(E)),I=S.bind(null,L,T,!1),A=S.bind(null,L,T,!0)}else w.sourceMap&&typeof URL=="function"&&typeof URL.createObjectURL=="function"&&typeof URL.revokeObjectURL=="function"&&typeof Blob=="function"&&typeof btoa=="function"?(L=function(M){var j=document.createElement("link");return M.attrs.type===void 0&&(M.attrs.type="text/css"),M.attrs.rel="stylesheet",_(j,M.attrs),C(M,j),j}(E),I=function(M,j,J){var U=J.css,H=J.sourceMap,te=j.convertToAbsoluteUrls===void 0&&H;(j.convertToAbsoluteUrls||te)&&(U=b(U)),H&&(U+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(H))))+" */");var ae=new Blob([U],{type:"text/css"}),W=M.href;M.href=URL.createObjectURL(ae),W&&URL.revokeObjectURL(W)}.bind(null,L,E),A=function(){O(L),L.href&&URL.revokeObjectURL(L.href)}):(L=d(E),I=function(M,j){var J=j.css,U=j.media;if(U&&M.setAttribute("media",U),M.styleSheet)M.styleSheet.cssText=J;else{for(;M.firstChild;)M.removeChild(M.firstChild);M.appendChild(document.createTextNode(J))}}.bind(null,L),A=function(){O(L)});return I(w),function(M){if(M){if(M.css===w.css&&M.media===w.media&&M.sourceMap===w.sourceMap)return;I(w=M)}else A()}}i.exports=function(w,E){if(typeof DEBUG!="undefined"&&DEBUG&&typeof document!="object")throw new Error("The style-loader cannot be used in a non-browser environment");(E=E||{}).attrs=typeof E.attrs=="object"?E.attrs:{},E.singleton||typeof E.singleton=="boolean"||(E.singleton=u()),E.insertInto||(E.insertInto="head"),E.insertAt||(E.insertAt="bottom");var L=k(w,E);return v(L,E),function(I){for(var A=[],B=0;B<L.length;B++){var T=L[B];(M=l[T.id]).refs--,A.push(M)}for(I&&v(k(I,E),E),B=0;B<A.length;B++){var M;if((M=A[B]).refs===0){for(var j=0;j<M.parts.length;j++)M.parts[j]();delete l[M.id]}}}};var y,x=(y=[],function(w,E){return y[w]=E,y.filter(Boolean).join(`
`)});function S(w,E,L,I){var A=L?"":I.css;if(w.styleSheet)w.styleSheet.cssText=x(E,A);else{var B=document.createTextNode(A),T=w.childNodes;T[E]&&w.removeChild(T[E]),T.length?w.insertBefore(B,T[E]):w.appendChild(B)}}},function(i,n){i.exports=function(o){var a=typeof window!="undefined"&&window.location;if(!a)throw new Error("fixUrls requires window.location");if(!o||typeof o!="string")return o;var s=a.protocol+"//"+a.host,l=s+a.pathname.replace(/\/[^\/]*$/,"/");return o.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(u,c){var h,p=c.trim().replace(/^"(.*)"$/,function(g,b){return b}).replace(/^'(.*)'$/,function(g,b){return b});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(p)?u:(h=p.indexOf("//")===0?p:p.indexOf("/")===0?s+p:l+p.replace(/^\.\//,""),"url("+JSON.stringify(h)+")")})}},function(i,n,o){"use strict";var a,s,l,u,c,h;i.exports=(a="cdx-notify",s="cdx-notify__cross",l="cdx-notify__button--confirm",u="cdx-notify__button",c="cdx-notify__btns-wrapper",{alert:h=function(p){var g=document.createElement("DIV"),b=document.createElement("DIV"),v=p.message,k=p.style;return g.classList.add(a),k&&g.classList.add(a+"--"+k),g.innerHTML=v,b.classList.add(s),b.addEventListener("click",g.remove.bind(g)),g.appendChild(b),g},confirm:function(p){var g=h(p),b=document.createElement("div"),v=document.createElement("button"),k=document.createElement("button"),C=g.querySelector("."+s),O=p.cancelHandler,d=p.okHandler;return b.classList.add(c),v.innerHTML=p.okText||"Confirm",k.innerHTML=p.cancelText||"Cancel",v.classList.add(u),k.classList.add(u),v.classList.add(l),k.classList.add("cdx-notify__button--cancel"),O&&typeof O=="function"&&(k.addEventListener("click",O),C.addEventListener("click",O)),d&&typeof d=="function"&&v.addEventListener("click",d),v.addEventListener("click",g.remove.bind(g)),k.addEventListener("click",g.remove.bind(g)),b.appendChild(v),b.appendChild(k),g.appendChild(b),g},prompt:function(p){var g=h(p),b=document.createElement("div"),v=document.createElement("button"),k=document.createElement("input"),C=g.querySelector("."+s),O=p.cancelHandler,d=p.okHandler;return b.classList.add(c),v.innerHTML=p.okText||"Ok",v.classList.add(u),v.classList.add(l),k.classList.add("cdx-notify__input"),p.placeholder&&k.setAttribute("placeholder",p.placeholder),p.default&&(k.value=p.default),p.inputType&&(k.type=p.inputType),O&&typeof O=="function"&&C.addEventListener("click",O),d&&typeof d=="function"&&v.addEventListener("click",function(){d(k.value)}),v.addEventListener("click",g.remove.bind(g)),b.appendChild(k),b.appendChild(v),g.appendChild(b),g},getWrapper:function(){var p=document.createElement("DIV");return p.classList.add("cdx-notifies"),p}})}])},function(r,t,e){var i,n;(n=typeof(i=function(){function o(g){var b=g.tags;if(!Object.keys(b).map(function(v){return typeof b[v]}).every(function(v){return v==="object"||v==="boolean"||v==="function"}))throw new Error("The configuration was invalid");this.config=g}var a=["P","LI","TD","TH","DIV","H1","H2","H3","H4","H5","H6","PRE"];function s(g){return a.indexOf(g.nodeName)!==-1}var l=["A","B","STRONG","I","EM","SUB","SUP","U","STRIKE"];function u(g){return l.indexOf(g.nodeName)!==-1}function c(g,b,v){return typeof g.tags[b]=="function"?g.tags[b](v):g.tags[b]}function h(g,b){return b===void 0||typeof b=="boolean"&&!b}function p(g,b,v){var k=g.name.toLowerCase();return b!==!0&&(typeof b[k]=="function"?!b[k](g.value,v):b[k]===void 0||b[k]===!1||typeof b[k]=="string"&&b[k]!==g.value)}return o.prototype.clean=function(g){let b=document.implementation.createHTMLDocument(),v=b.createElement("div");return v.innerHTML=g,this._sanitize(b,v),v.innerHTML},o.prototype._sanitize=function(g,b){var v=function(w,E){return w.createTreeWalker(E,NodeFilter.SHOW_TEXT|NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_COMMENT,null,!1)}(g,b),k=v.firstChild();if(k)do if(k.nodeType!==Node.TEXT_NODE){if(k.nodeType===Node.COMMENT_NODE){b.removeChild(k),this._sanitize(g,b);break}var C,O=u(k);O&&(C=Array.prototype.some.call(k.childNodes,s));var d=!!b.parentNode,_=s(b)&&s(k)&&d,m=k.nodeName.toLowerCase(),y=c(this.config,m,k);if(O&&C||h(0,y)||!this.config.keepNestedBlockElements&&_){if(k.nodeName!=="SCRIPT"&&k.nodeName!=="STYLE")for(;k.childNodes.length>0;)b.insertBefore(k.childNodes[0],k);b.removeChild(k),this._sanitize(g,b);break}for(var x=0;x<k.attributes.length;x+=1){var S=k.attributes[x];p(S,y,k)&&(k.removeAttribute(S.name),x-=1)}this._sanitize(g,k)}else if(k.data.trim()===""&&(k.previousElementSibling&&s(k.previousElementSibling)||k.nextElementSibling&&s(k.nextElementSibling))){b.removeChild(k),this._sanitize(g,b);break}while(k=v.nextSibling())},o})=="function"?i.call(t,e,t,r):i)===void 0||(r.exports=n)},function(r,t,e){r.exports=function(i){var n={};function o(a){if(n[a])return n[a].exports;var s=n[a]={i:a,l:!1,exports:{}};return i[a].call(s.exports,s,s.exports,o),s.l=!0,s.exports}return o.m=i,o.c=n,o.d=function(a,s,l){o.o(a,s)||Object.defineProperty(a,s,{enumerable:!0,get:l})},o.r=function(a){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},o.t=function(a,s){if(1&s&&(a=o(a)),8&s||4&s&&typeof a=="object"&&a&&a.__esModule)return a;var l=Object.create(null);if(o.r(l),Object.defineProperty(l,"default",{enumerable:!0,value:a}),2&s&&typeof a!="string")for(var u in a)o.d(l,u,function(c){return a[c]}.bind(null,u));return l},o.n=function(a){var s=a&&a.__esModule?function(){return a.default}:function(){return a};return o.d(s,"a",s),s},o.o=function(a,s){return Object.prototype.hasOwnProperty.call(a,s)},o.p="/",o(o.s=0)}([function(i,n,o){function a(u,c){for(var h=0;h<c.length;h++){var p=c[h];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(u,p.key,p)}}function s(u,c,h){return c&&a(u.prototype,c),h&&a(u,h),u}o(1).toString();var l=function(){function u(c){var h=c.data,p=c.config,g=c.api,b=c.readOnly;(function(v,k){if(!(v instanceof k))throw new TypeError("Cannot call a class as a function")})(this,u),this.api=g,this.readOnly=b,this._CSS={block:this.api.styles.block,wrapper:"ce-paragraph"},this.readOnly||(this.onKeyUp=this.onKeyUp.bind(this)),this._placeholder=p.placeholder?p.placeholder:u.DEFAULT_PLACEHOLDER,this._data={},this._element=this.drawView(),this._preserveBlank=p.preserveBlank!==void 0&&p.preserveBlank,this.data=h}return s(u,null,[{key:"DEFAULT_PLACEHOLDER",get:function(){return""}}]),s(u,[{key:"onKeyUp",value:function(c){c.code!=="Backspace"&&c.code!=="Delete"||this._element.textContent===""&&(this._element.innerHTML="")}},{key:"drawView",value:function(){var c=document.createElement("DIV");return c.classList.add(this._CSS.wrapper,this._CSS.block),c.contentEditable=!1,c.dataset.placeholder=this.api.i18n.t(this._placeholder),this.readOnly||(c.contentEditable=!0,c.addEventListener("keyup",this.onKeyUp)),c}},{key:"render",value:function(){return this._element}},{key:"merge",value:function(c){var h={text:this.data.text+c.text};this.data=h}},{key:"validate",value:function(c){return!(c.text.trim()===""&&!this._preserveBlank)}},{key:"save",value:function(c){return{text:c.innerHTML}}},{key:"onPaste",value:function(c){var h={text:c.detail.data.innerHTML};this.data=h}},{key:"data",get:function(){var c=this._element.innerHTML;return this._data.text=c,this._data},set:function(c){this._data=c||{},this._element.innerHTML=this._data.text||""}}],[{key:"conversionConfig",get:function(){return{export:"text",import:"text"}}},{key:"sanitize",get:function(){return{text:{br:!0}}}},{key:"isReadOnlySupported",get:function(){return!0}},{key:"pasteConfig",get:function(){return{tags:["P"]}}},{key:"toolbox",get:function(){return{icon:o(5).default,title:"Text"}}}]),u}();i.exports=l},function(i,n,o){var a=o(2),s=o(3);typeof(s=s.__esModule?s.default:s)=="string"&&(s=[[i.i,s,""]]),a(s,{insert:"head",singleton:!1}),i.exports=s.locals||{}},function(i,n,o){"use strict";var a,s=function(){var d={};return function(_){if(d[_]===void 0){var m=document.querySelector(_);if(window.HTMLIFrameElement&&m instanceof window.HTMLIFrameElement)try{m=m.contentDocument.head}catch(y){m=null}d[_]=m}return d[_]}}(),l=[];function u(d){for(var _=-1,m=0;m<l.length;m++)if(l[m].identifier===d){_=m;break}return _}function c(d,_){for(var m={},y=[],x=0;x<d.length;x++){var S=d[x],w=_.base?S[0]+_.base:S[0],E=m[w]||0,L="".concat(w," ").concat(E);m[w]=E+1;var I=u(L),A={css:S[1],media:S[2],sourceMap:S[3]};I!==-1?(l[I].references++,l[I].updater(A)):l.push({identifier:L,updater:O(A,_),references:1}),y.push(L)}return y}function h(d){var _=document.createElement("style"),m=d.attributes||{};if(m.nonce===void 0){var y=o.nc;y&&(m.nonce=y)}if(Object.keys(m).forEach(function(S){_.setAttribute(S,m[S])}),typeof d.insert=="function")d.insert(_);else{var x=s(d.insert||"head");if(!x)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");x.appendChild(_)}return _}var p,g=(p=[],function(d,_){return p[d]=_,p.filter(Boolean).join(`
`)});function b(d,_,m,y){var x=m?"":y.media?"@media ".concat(y.media," {").concat(y.css,"}"):y.css;if(d.styleSheet)d.styleSheet.cssText=g(_,x);else{var S=document.createTextNode(x),w=d.childNodes;w[_]&&d.removeChild(w[_]),w.length?d.insertBefore(S,w[_]):d.appendChild(S)}}function v(d,_,m){var y=m.css,x=m.media,S=m.sourceMap;if(x?d.setAttribute("media",x):d.removeAttribute("media"),S&&btoa&&(y+=`
/*# sourceMappingURL=data:application/json;base64,`.concat(btoa(unescape(encodeURIComponent(JSON.stringify(S))))," */")),d.styleSheet)d.styleSheet.cssText=y;else{for(;d.firstChild;)d.removeChild(d.firstChild);d.appendChild(document.createTextNode(y))}}var k=null,C=0;function O(d,_){var m,y,x;if(_.singleton){var S=C++;m=k||(k=h(_)),y=b.bind(null,m,S,!1),x=b.bind(null,m,S,!0)}else m=h(_),y=v.bind(null,m,_),x=function(){(function(w){if(w.parentNode===null)return!1;w.parentNode.removeChild(w)})(m)};return y(d),function(w){if(w){if(w.css===d.css&&w.media===d.media&&w.sourceMap===d.sourceMap)return;y(d=w)}else x()}}i.exports=function(d,_){(_=_||{}).singleton||typeof _.singleton=="boolean"||(_.singleton=(a===void 0&&(a=Boolean(window&&document&&document.all&&!window.atob)),a));var m=c(d=d||[],_);return function(y){if(y=y||[],Object.prototype.toString.call(y)==="[object Array]"){for(var x=0;x<m.length;x++){var S=u(m[x]);l[S].references--}for(var w=c(y,_),E=0;E<m.length;E++){var L=u(m[E]);l[L].references===0&&(l[L].updater(),l.splice(L,1))}m=w}}}},function(i,n,o){(n=o(4)(!1)).push([i.i,`.ce-paragraph {
    line-height: 1.6em;
    outline: none;
}

.ce-paragraph[data-placeholder]:empty::before{
  content: attr(data-placeholder);
  color: #707684;
  font-weight: normal;
  opacity: 0;
}

/** Show placeholder at the first paragraph if Editor is empty */
.codex-editor--empty .ce-block:first-child .ce-paragraph[data-placeholder]:empty::before {
  opacity: 1;
}

.codex-editor--toolbox-opened .ce-block:first-child .ce-paragraph[data-placeholder]:empty::before,
.codex-editor--empty .ce-block:first-child .ce-paragraph[data-placeholder]:empty:focus::before {
  opacity: 0;
}

.ce-paragraph p:first-of-type{
    margin-top: 0;
}

.ce-paragraph p:last-of-type{
    margin-bottom: 0;
}
`,""]),i.exports=n},function(i,n,o){"use strict";i.exports=function(a){var s=[];return s.toString=function(){return this.map(function(l){var u=function(c,h){var p,g,b,v=c[1]||"",k=c[3];if(!k)return v;if(h&&typeof btoa=="function"){var C=(p=k,g=btoa(unescape(encodeURIComponent(JSON.stringify(p)))),b="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(g),"/*# ".concat(b," */")),O=k.sources.map(function(d){return"/*# sourceURL=".concat(k.sourceRoot||"").concat(d," */")});return[v].concat(O).concat([C]).join(`
`)}return[v].join(`
`)}(l,a);return l[2]?"@media ".concat(l[2]," {").concat(u,"}"):u}).join("")},s.i=function(l,u,c){typeof l=="string"&&(l=[[null,l,""]]);var h={};if(c)for(var p=0;p<this.length;p++){var g=this[p][0];g!=null&&(h[g]=!0)}for(var b=0;b<l.length;b++){var v=[].concat(l[b]);c&&h[v[0]]||(u&&(v[2]?v[2]="".concat(u," and ").concat(v[2]):v[2]=u),s.push(v))}},s}},function(i,n,o){"use strict";o.r(n),n.default=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0.2 -0.3 9 11.4" width="12" height="14">
  <path d="M0 2.77V.92A1 1 0 01.2.28C.35.1.56 0 .83 0h7.66c.28.01.48.1.63.28.14.17.21.38.21.64v1.85c0 .26-.08.48-.23.66-.15.17-.37.26-.66.26-.28 0-.5-.09-.64-.26a1 1 0 01-.21-.66V1.69H5.6v7.58h.5c.25 0 .45.08.6.23.17.16.25.35.25.6s-.08.45-.24.6a.87.87 0 01-.62.22H3.21a.87.87 0 01-.61-.22.78.78 0 01-.24-.6c0-.25.08-.44.24-.6a.85.85 0 01.61-.23h.5V1.7H1.73v1.08c0 .26-.08.48-.23.66-.15.17-.37.26-.66.26-.28 0-.5-.09-.64-.26A1 1 0 010 2.77z"/>
</svg>
`}])},function(r,t,e){var i,n,o;n=[t,e(2),e(3),e(15)],(o=typeof(i=function(a,s,l,u){"use strict";var c=e(1);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,s=c(s),l=c(l),u=c(u);var h=function(){function p(){(0,s.default)(this,p),this.commandName="bold",this.CSS={button:"ce-inline-tool",buttonActive:"ce-inline-tool--active",buttonModifier:"ce-inline-tool--bold"},this.nodes={button:void 0}}return(0,l.default)(p,[{key:"render",value:function(){return this.nodes.button=document.createElement("button"),this.nodes.button.type="button",this.nodes.button.classList.add(this.CSS.button,this.CSS.buttonModifier),this.nodes.button.appendChild(u.default.svg("bold",12,14)),this.nodes.button}},{key:"surround",value:function(g){document.execCommand(this.commandName)}},{key:"checkState",value:function(g){var b=document.queryCommandState(this.commandName);return this.nodes.button.classList.toggle(this.CSS.buttonActive,b),b}},{key:"shortcut",get:function(){return"CMD+B"}}],[{key:"sanitize",get:function(){return{b:{}}}}]),p}();a.default=h,h.displayName="BoldInlineTool",h.isInline=!0,h.title="Bold",r.exports=t.default})=="function"?i.apply(t,n):i)===void 0||(r.exports=o)},function(r,t,e){var i,n,o;n=[t,e(2),e(3),e(15)],(o=typeof(i=function(a,s,l,u){"use strict";var c=e(1);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,s=c(s),l=c(l),u=c(u);var h=function(){function p(){(0,s.default)(this,p),this.commandName="italic",this.CSS={button:"ce-inline-tool",buttonActive:"ce-inline-tool--active",buttonModifier:"ce-inline-tool--italic"},this.nodes={button:null}}return(0,l.default)(p,[{key:"render",value:function(){return this.nodes.button=document.createElement("button"),this.nodes.button.type="button",this.nodes.button.classList.add(this.CSS.button,this.CSS.buttonModifier),this.nodes.button.appendChild(u.default.svg("italic",4,11)),this.nodes.button}},{key:"surround",value:function(g){document.execCommand(this.commandName)}},{key:"checkState",value:function(g){var b=document.queryCommandState(this.commandName);return this.nodes.button.classList.toggle(this.CSS.buttonActive,b),b}},{key:"shortcut",get:function(){return"CMD+I"}}],[{key:"sanitize",get:function(){return{i:{}}}}]),p}();a.default=h,h.displayName="ItalicInlineTool",h.isInline=!0,h.title="Italic",r.exports=t.default})=="function"?i.apply(t,n):i)===void 0||(r.exports=o)},function(r,t,e){var i,n,o;n=[t,e(2),e(3),e(25),e(15),e(8)],(o=typeof(i=function(a,s,l,u,c,h){"use strict";var p=e(9),g=e(1);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,s=g(s),l=g(l),u=g(u),c=g(c),h=p(h);var b=function(){function v(k){var C=k.api;(0,s.default)(this,v),this.commandLink="createLink",this.commandUnlink="unlink",this.ENTER_KEY=13,this.CSS={button:"ce-inline-tool",buttonActive:"ce-inline-tool--active",buttonModifier:"ce-inline-tool--link",buttonUnlink:"ce-inline-tool--unlink",input:"ce-inline-tool-input",inputShowed:"ce-inline-tool-input--showed"},this.nodes={button:null,input:null},this.inputOpened=!1,this.toolbar=C.toolbar,this.inlineToolbar=C.inlineToolbar,this.notifier=C.notifier,this.i18n=C.i18n,this.selection=new u.default}return(0,l.default)(v,[{key:"render",value:function(){return this.nodes.button=document.createElement("button"),this.nodes.button.type="button",this.nodes.button.classList.add(this.CSS.button,this.CSS.buttonModifier),this.nodes.button.appendChild(c.default.svg("link",14,10)),this.nodes.button.appendChild(c.default.svg("unlink",15,11)),this.nodes.button}},{key:"renderActions",value:function(){var k=this;return this.nodes.input=document.createElement("input"),this.nodes.input.placeholder=this.i18n.t("Add a link"),this.nodes.input.classList.add(this.CSS.input),this.nodes.input.addEventListener("keydown",function(C){C.keyCode===k.ENTER_KEY&&k.enterPressed(C)}),this.nodes.input}},{key:"surround",value:function(k){if(k){this.inputOpened?(this.selection.restore(),this.selection.removeFakeBackground()):(this.selection.setFakeBackground(),this.selection.save());var C=this.selection.findParentTag("A");if(C)return this.selection.expandToTag(C),this.unlink(),this.closeActions(),this.checkState(),void this.toolbar.close()}this.toggleActions()}},{key:"checkState",value:function(k){var C=this.selection.findParentTag("A");if(C){this.nodes.button.classList.add(this.CSS.buttonUnlink),this.nodes.button.classList.add(this.CSS.buttonActive),this.openActions();var O=C.getAttribute("href");this.nodes.input.value=O!=="null"?O:"",this.selection.save()}else this.nodes.button.classList.remove(this.CSS.buttonUnlink),this.nodes.button.classList.remove(this.CSS.buttonActive);return!!C}},{key:"clear",value:function(){this.closeActions()}},{key:"toggleActions",value:function(){this.inputOpened?this.closeActions(!1):this.openActions(!0)}},{key:"openActions",value:function(){var k=arguments.length>0&&arguments[0]!==void 0&&arguments[0];this.nodes.input.classList.add(this.CSS.inputShowed),k&&this.nodes.input.focus(),this.inputOpened=!0}},{key:"closeActions",value:function(){var k=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];if(this.selection.isFakeBackgroundEnabled){var C=new u.default;C.save(),this.selection.restore(),this.selection.removeFakeBackground(),C.restore()}this.nodes.input.classList.remove(this.CSS.inputShowed),this.nodes.input.value="",k&&this.selection.clearSaved(),this.inputOpened=!1}},{key:"enterPressed",value:function(k){var C=this.nodes.input.value||"";return C.trim()?this.validateURL(C)?(C=this.prepareLink(C),this.selection.restore(),this.selection.removeFakeBackground(),this.insertLink(C),k.preventDefault(),k.stopPropagation(),k.stopImmediatePropagation(),this.selection.collapseToEnd(),void this.inlineToolbar.close()):(this.notifier.show({message:"Pasted link is not valid.",style:"error"}),void h.log("Incorrect Link pasted","warn",C)):(this.selection.restore(),this.unlink(),k.preventDefault(),void this.closeActions())}},{key:"validateURL",value:function(k){return!/\s/.test(k)}},{key:"prepareLink",value:function(k){return k=k.trim(),k=this.addProtocol(k)}},{key:"addProtocol",value:function(k){if(/^(\w+):(\/\/)?/.test(k))return k;var C=/^\/[^/\s]/.test(k),O=k.substring(0,1)==="#",d=/^\/\/[^/\s]/.test(k);return C||O||d||(k="http://"+k),k}},{key:"insertLink",value:function(k){var C=this.selection.findParentTag("A");C&&this.selection.expandToTag(C),document.execCommand(this.commandLink,!1,k)}},{key:"unlink",value:function(){document.execCommand(this.commandUnlink)}},{key:"shortcut",get:function(){return"CMD+K"}}],[{key:"sanitize",get:function(){return{a:{href:!0,target:"_blank",rel:"nofollow"}}}}]),v}();a.default=b,b.displayName="LinkInlineTool",b.isInline=!0,b.title="Link",r.exports=t.default})=="function"?i.apply(t,n):i)===void 0||(r.exports=o)},function(r,t,e){var i,n,o;n=[t,e(2),e(3),e(15)],(o=typeof(i=function(a,s,l,u){"use strict";var c=e(1);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,s=c(s),l=c(l),u=c(u);var h=function(){function p(g){var b=g.data,v=g.api;(0,s.default)(this,p),this.CSS={wrapper:"ce-stub",info:"ce-stub__info",title:"ce-stub__title",subtitle:"ce-stub__subtitle"},this.api=v,this.title=b.title||this.api.i18n.t("Error"),this.subtitle=this.api.i18n.t("The block can not be displayed correctly."),this.savedData=b.savedData,this.wrapper=this.make()}return(0,l.default)(p,[{key:"render",value:function(){return this.wrapper}},{key:"save",value:function(){return this.savedData}},{key:"make",value:function(){var g=u.default.make("div",this.CSS.wrapper),b=u.default.svg("sad-face",52,52),v=u.default.make("div",this.CSS.info),k=u.default.make("div",this.CSS.title,{textContent:this.title}),C=u.default.make("div",this.CSS.subtitle,{textContent:this.subtitle});return g.appendChild(b),v.appendChild(k),v.appendChild(C),g.appendChild(v),g}}]),p}();a.default=h,h.displayName="Stub",h.isReadOnlySupported=!0,r.exports=t.default})=="function"?i.apply(t,n):i)===void 0||(r.exports=o)},function(r,t,e){var i,n,o;n=[t,e(2),e(3),e(66),e(386),e(387),e(388)],(o=typeof(i=function(a,s,l,u,c,h,p){"use strict";var g=e(1);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,s=g(s),l=g(l),c=g(c),h=g(h),p=g(p);var b=function(k,C){var O={};for(var d in k)Object.prototype.hasOwnProperty.call(k,d)&&C.indexOf(d)<0&&(O[d]=k[d]);if(k!=null&&typeof Object.getOwnPropertySymbols=="function"){var _=0;for(d=Object.getOwnPropertySymbols(k);_<d.length;_++)C.indexOf(d[_])<0&&Object.prototype.propertyIsEnumerable.call(k,d[_])&&(O[d[_]]=k[d[_]])}return O},v=function(){function k(C,O,d){(0,s.default)(this,k),this.api=d,this.config=C,this.editorConfig=O}return(0,l.default)(k,[{key:"get",value:function(C){var O=this.config[C],d=O.class,_=O.isInternal,m=_!==void 0&&_,y=b(O,["class","isInternal"]);return new(this.getConstructor(d))({name:C,constructable:d,config:y,api:this.api,isDefault:C===this.editorConfig.defaultBlock,defaultPlaceholder:this.editorConfig.placeholder,isInternal:m})}},{key:"getConstructor",value:function(C){switch(!0){case C[u.InternalInlineToolSettings.IsInline]:return c.default;case C[u.InternalTuneSettings.IsTune]:return h.default;default:return p.default}}}]),k}();a.default=v,v.displayName="ToolsFactory",r.exports=t.default})=="function"?i.apply(t,n):i)===void 0||(r.exports=o)},function(r,t,e){var i,n,o;n=[t,e(2),e(3),e(5),e(6),e(4),e(66)],(o=typeof(i=function(a,s,l,u,c,h,p){"use strict";var g=e(9),b=e(1);function v(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(C){return!1}}Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,s=b(s),l=b(l),u=b(u),c=b(c),h=b(h);var k=function(C){(0,u.default)(_,C);var O,d=(O=_,function(){var m,y=(0,h.default)(O);if(v()){var x=(0,h.default)(this).constructor;m=Reflect.construct(y,arguments,x)}else m=y.apply(this,arguments);return(0,c.default)(this,m)});function _(){var m;return(0,s.default)(this,_),(m=d.apply(this,arguments)).type=p.ToolType.Inline,m}return(0,l.default)(_,[{key:"create",value:function(){return new this.constructable({api:this.api.getMethodsForTool(this),config:this.settings})}},{key:"title",get:function(){return this.constructable[p.InternalInlineToolSettings.Title]}}]),_}((p=g(p)).default);a.default=k,k.displayName="InlineTool",r.exports=t.default})=="function"?i.apply(t,n):i)===void 0||(r.exports=o)},function(r,t,e){var i,n,o;n=[t,e(2),e(3),e(5),e(6),e(4),e(66)],(o=typeof(i=function(a,s,l,u,c,h,p){"use strict";var g=e(9),b=e(1);function v(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(C){return!1}}Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,s=b(s),l=b(l),u=b(u),c=b(c),h=b(h);var k=function(C){(0,u.default)(_,C);var O,d=(O=_,function(){var m,y=(0,h.default)(O);if(v()){var x=(0,h.default)(this).constructor;m=Reflect.construct(y,arguments,x)}else m=y.apply(this,arguments);return(0,c.default)(this,m)});function _(){var m;return(0,s.default)(this,_),(m=d.apply(this,arguments)).type=p.ToolType.Tune,m}return(0,l.default)(_,[{key:"create",value:function(m,y){return new this.constructable({api:this.api.getMethodsForTool(this),settings:this.settings,block:y,data:m})}}]),_}((p=g(p)).default);a.default=k,k.displayName="BlockTune",r.exports=t.default})=="function"?i.apply(t,n):i)===void 0||(r.exports=o)},function(r,t,e){var i,n,o;n=[t,e(2),e(3),e(5),e(6),e(4),e(66),e(8)],(o=typeof(i=function(a,s,l,u,c,h,p,g){"use strict";var b=e(9),v=e(1);function k(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(O){return!1}}Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,s=v(s),l=v(l),u=v(u),c=v(c),h=v(h),p=b(p),g=b(g);var C=function(O){(0,u.default)(m,O);var d,_=(d=m,function(){var y,x=(0,h.default)(d);if(k()){var S=(0,h.default)(this).constructor;y=Reflect.construct(x,arguments,S)}else y=x.apply(this,arguments);return(0,c.default)(this,y)});function m(){var y;return(0,s.default)(this,m),(y=_.apply(this,arguments)).type=p.ToolType.Block,y}return(0,l.default)(m,[{key:"create",value:function(y,x,S){return new this.constructable({data:y,block:x,readOnly:S,api:this.api.getMethodsForTool(this),config:this.settings})}},{key:"isReadOnlySupported",get:function(){return this.constructable[p.InternalBlockToolSettings.IsReadOnlySupported]===!0}},{key:"isLineBreaksEnabled",get:function(){return this.constructable[p.InternalBlockToolSettings.IsEnabledLineBreaks]}},{key:"toolbox",get:function(){var y=this.constructable[p.InternalBlockToolSettings.Toolbox],x=this.config[p.UserSettings.Toolbox];if(!g.isEmpty(y)&&(x!=null?x:y)!==!1)return Object.assign({},y,x)}},{key:"conversionConfig",get:function(){return this.constructable[p.InternalBlockToolSettings.ConversionConfig]}},{key:"enabledInlineTools",get:function(){return this.config[p.UserSettings.EnabledInlineTools]}},{key:"enabledBlockTunes",get:function(){return this.config[p.UserSettings.EnabledBlockTunes]}},{key:"pasteConfig",get:function(){return this.constructable[p.InternalBlockToolSettings.PasteConfig]||{}}}]),m}(p.default);a.default=C,C.displayName="BlockTool",r.exports=t.default})=="function"?i.apply(t,n):i)===void 0||(r.exports=o)},function(r,t,e){var i,n,o;n=[t,e(2),e(3),e(15)],(o=typeof(i=function(a,s,l,u){"use strict";var c=e(1);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,s=c(s),l=c(l),u=c(u);var h=function(){function p(g){var b=g.api;(0,s.default)(this,p),this.CSS={button:"ce-settings__button",wrapper:"ce-tune-move-down",animation:"wobble"},this.api=b}return(0,l.default)(p,[{key:"render",value:function(){var g=this,b=u.default.make("div",[this.CSS.button,this.CSS.wrapper],{});return b.appendChild(u.default.svg("arrow-down",14,14)),this.api.listeners.on(b,"click",function(v){return g.handleClick(v,b)},!1),this.api.tooltip.onHover(b,this.api.i18n.t("Move down")),b}},{key:"handleClick",value:function(g,b){var v=this,k=this.api.blocks.getCurrentBlockIndex(),C=this.api.blocks.getBlockByIndex(k+1);if(!C)return b.classList.add(this.CSS.animation),void window.setTimeout(function(){b.classList.remove(v.CSS.animation)},500);var O=C.holder,d=O.getBoundingClientRect(),_=Math.abs(window.innerHeight-O.offsetHeight);d.top<window.innerHeight&&(_=window.scrollY+O.offsetHeight),window.scrollTo(0,_),this.api.blocks.move(k+1),this.api.tooltip.hide()}}]),p}();a.default=h,h.displayName="MoveDownTune",h.isTune=!0,r.exports=t.default})=="function"?i.apply(t,n):i)===void 0||(r.exports=o)},function(r,t,e){var i,n,o;n=[t,e(2),e(3),e(15)],(o=typeof(i=function(a,s,l,u){"use strict";var c=e(1);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,s=c(s),l=c(l),u=c(u);var h=function(){function p(g){var b=this,v=g.api;(0,s.default)(this,p),this.CSS={button:"ce-settings__button",buttonDelete:"ce-settings__button--delete",buttonConfirm:"ce-settings__button--confirm"},this.nodes={button:null},this.api=v,this.resetConfirmation=function(){b.setConfirmation(!1)}}return(0,l.default)(p,[{key:"render",value:function(){var g=this;return this.nodes.button=u.default.make("div",[this.CSS.button,this.CSS.buttonDelete],{}),this.nodes.button.appendChild(u.default.svg("cross",12,12)),this.api.listeners.on(this.nodes.button,"click",function(b){return g.handleClick(b)},!1),this.api.tooltip.onHover(this.nodes.button,this.api.i18n.t("Delete")),this.nodes.button}},{key:"handleClick",value:function(g){this.needConfirmation?(this.api.events.off("block-settings-closed",this.resetConfirmation),this.api.blocks.delete(),this.api.toolbar.close(),this.api.tooltip.hide(),g.stopPropagation()):(this.setConfirmation(!0),this.api.events.on("block-settings-closed",this.resetConfirmation))}},{key:"setConfirmation",value:function(g){this.needConfirmation=g,this.nodes.button.classList.add(this.CSS.buttonConfirm)}}]),p}();a.default=h,h.displayName="DeleteTune",h.isTune=!0,r.exports=t.default})=="function"?i.apply(t,n):i)===void 0||(r.exports=o)},function(r,t,e){var i,n,o;n=[t,e(2),e(3),e(15)],(o=typeof(i=function(a,s,l,u){"use strict";var c=e(1);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,s=c(s),l=c(l),u=c(u);var h=function(){function p(g){var b=g.api;(0,s.default)(this,p),this.CSS={button:"ce-settings__button",wrapper:"ce-tune-move-up",animation:"wobble"},this.api=b}return(0,l.default)(p,[{key:"render",value:function(){var g=this,b=u.default.make("div",[this.CSS.button,this.CSS.wrapper],{});return b.appendChild(u.default.svg("arrow-up",14,14)),this.api.listeners.on(b,"click",function(v){return g.handleClick(v,b)},!1),this.api.tooltip.onHover(b,this.api.i18n.t("Move up")),b}},{key:"handleClick",value:function(g,b){var v=this,k=this.api.blocks.getCurrentBlockIndex(),C=this.api.blocks.getBlockByIndex(k),O=this.api.blocks.getBlockByIndex(k-1);if(k===0||!C||!O)return b.classList.add(this.CSS.animation),void window.setTimeout(function(){b.classList.remove(v.CSS.animation)},500);var d,_=C.holder,m=O.holder,y=_.getBoundingClientRect(),x=m.getBoundingClientRect();d=x.top>0?Math.abs(y.top)-Math.abs(x.top):window.innerHeight-Math.abs(y.top)+Math.abs(x.top),window.scrollBy(0,-1*d),this.api.blocks.move(k-1),this.api.tooltip.hide()}}]),p}();a.default=h,h.displayName="MoveUpTune",h.isTune=!0,r.exports=t.default})=="function"?i.apply(t,n):i)===void 0||(r.exports=o)},function(r,t,e){var i,n,o;n=[t,e(29),e(2),e(3),e(5),e(6),e(4),e(146)],(o=typeof(i=function(a,s,l,u,c,h,p,g){"use strict";var b=e(1);function v(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(C){return!1}}Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,s=b(s),l=b(l),u=b(u),c=b(c),h=b(h),p=b(p);var k=function(C){(0,c.default)(_,C);var O,d=(O=_,function(){var m,y=(0,p.default)(O);if(v()){var x=(0,p.default)(this).constructor;m=Reflect.construct(y,arguments,x)}else m=y.apply(this,arguments);return(0,h.default)(this,m)});function _(){return(0,l.default)(this,_),d.apply(this,arguments)}return(0,u.default)(_,[{key:"blockTools",get:function(){return new _(Array.from(this.entries()).filter(function(m){return(0,s.default)(m,2)[1].isBlock()}))}},{key:"inlineTools",get:function(){return new _(Array.from(this.entries()).filter(function(m){return(0,s.default)(m,2)[1].isInline()}))}},{key:"blockTunes",get:function(){return new _(Array.from(this.entries()).filter(function(m){return(0,s.default)(m,2)[1].isTune()}))}},{key:"internalTools",get:function(){return new _(Array.from(this.entries()).filter(function(m){return(0,s.default)(m,2)[1].isInternal}))}},{key:"externalTools",get:function(){return new _(Array.from(this.entries()).filter(function(m){return!(0,s.default)(m,2)[1].isInternal}))}}]),_}((0,(g=b(g)).default)(Map));a.default=k,k.displayName="ToolsCollection",r.exports=t.default})=="function"?i.apply(t,n):i)===void 0||(r.exports=o)},function(r,t,e){r.exports=function(i){var n={};function o(a){if(n[a])return n[a].exports;var s=n[a]={i:a,l:!1,exports:{}};return i[a].call(s.exports,s,s.exports,o),s.l=!0,s.exports}return o.m=i,o.c=n,o.d=function(a,s,l){o.o(a,s)||Object.defineProperty(a,s,{enumerable:!0,get:l})},o.r=function(a){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},o.t=function(a,s){if(1&s&&(a=o(a)),8&s||4&s&&typeof a=="object"&&a&&a.__esModule)return a;var l=Object.create(null);if(o.r(l),Object.defineProperty(l,"default",{enumerable:!0,value:a}),2&s&&typeof a!="string")for(var u in a)o.d(l,u,function(c){return a[c]}.bind(null,u));return l},o.n=function(a){var s=a&&a.__esModule?function(){return a.default}:function(){return a};return o.d(s,"a",s),s},o.o=function(a,s){return Object.prototype.hasOwnProperty.call(a,s)},o.p="",o(o.s=0)}([function(i,n,o){i.exports=o(1)},function(i,n,o){"use strict";o.r(n),o.d(n,"default",function(){return a});class a{constructor(){this.nodes={wrapper:null,content:null},this.showed=!1,this.offsetTop=10,this.offsetLeft=10,this.offsetRight=10,this.hidingDelay=0,this.loadStyles(),this.prepare(),window.addEventListener("scroll",()=>{this.showed&&this.hide(!0)},{passive:!0})}get CSS(){return{tooltip:"ct",tooltipContent:"ct__content",tooltipShown:"ct--shown",placement:{left:"ct--left",bottom:"ct--bottom",right:"ct--right",top:"ct--top"}}}show(l,u,c){this.nodes.wrapper||this.prepare(),this.hidingTimeout&&clearTimeout(this.hidingTimeout);let h=Object.assign({placement:"bottom",marginTop:0,marginLeft:0,marginRight:0,marginBottom:0,delay:70,hidingDelay:0},c);if(h.hidingDelay&&(this.hidingDelay=h.hidingDelay),this.nodes.content.innerHTML="",typeof u=="string")this.nodes.content.appendChild(document.createTextNode(u));else{if(!(u instanceof Node))throw Error("[CodeX Tooltip] Wrong type of \xABcontent\xBB passed. It should be an instance of Node or String. But "+typeof u+" given.");this.nodes.content.appendChild(u)}switch(this.nodes.wrapper.classList.remove(...Object.values(this.CSS.placement)),h.placement){case"top":this.placeTop(l,h);break;case"left":this.placeLeft(l,h);break;case"right":this.placeRight(l,h);break;case"bottom":default:this.placeBottom(l,h)}h&&h.delay?this.showingTimeout=setTimeout(()=>{this.nodes.wrapper.classList.add(this.CSS.tooltipShown),this.showed=!0},h.delay):(this.nodes.wrapper.classList.add(this.CSS.tooltipShown),this.showed=!0)}hide(l=!1){if(this.hidingDelay&&!l)return this.hidingTimeout&&clearTimeout(this.hidingTimeout),void(this.hidingTimeout=setTimeout(()=>{this.hide(!0)},this.hidingDelay));this.nodes.wrapper.classList.remove(this.CSS.tooltipShown),this.showed=!1,this.showingTimeout&&clearTimeout(this.showingTimeout)}onHover(l,u,c){l.addEventListener("mouseenter",()=>{this.show(l,u,c)}),l.addEventListener("mouseleave",()=>{this.hide()})}prepare(){this.nodes.wrapper=this.make("div",this.CSS.tooltip),this.nodes.content=this.make("div",this.CSS.tooltipContent),this.append(this.nodes.wrapper,this.nodes.content),this.append(document.body,this.nodes.wrapper)}loadStyles(){let l="codex-tooltips-style";if(document.getElementById(l))return;let u=o(2),c=this.make("style",null,{textContent:u.toString(),id:l});this.prepend(document.head,c)}placeBottom(l,u){let c=l.getBoundingClientRect(),h=c.left+l.clientWidth/2-this.nodes.wrapper.offsetWidth/2,p=c.bottom+window.pageYOffset+this.offsetTop+u.marginTop;this.applyPlacement("bottom",h,p)}placeTop(l,u){let c=l.getBoundingClientRect(),h=c.left+l.clientWidth/2-this.nodes.wrapper.offsetWidth/2,p=c.top+window.pageYOffset-this.nodes.wrapper.clientHeight-this.offsetTop;this.applyPlacement("top",h,p)}placeLeft(l,u){let c=l.getBoundingClientRect(),h=c.left-this.nodes.wrapper.offsetWidth-this.offsetLeft-u.marginLeft,p=c.top+window.pageYOffset+l.clientHeight/2-this.nodes.wrapper.offsetHeight/2;this.applyPlacement("left",h,p)}placeRight(l,u){let c=l.getBoundingClientRect(),h=c.right+this.offsetRight+u.marginRight,p=c.top+window.pageYOffset+l.clientHeight/2-this.nodes.wrapper.offsetHeight/2;this.applyPlacement("right",h,p)}applyPlacement(l,u,c){this.nodes.wrapper.classList.add(this.CSS.placement[l]),this.nodes.wrapper.style.left=u+"px",this.nodes.wrapper.style.top=c+"px"}make(l,u=null,c={}){let h=document.createElement(l);Array.isArray(u)?h.classList.add(...u):u&&h.classList.add(u);for(let p in c)c.hasOwnProperty(p)&&(h[p]=c[p]);return h}append(l,u){Array.isArray(u)?u.forEach(c=>l.appendChild(c)):l.appendChild(u)}prepend(l,u){Array.isArray(u)?(u=u.reverse()).forEach(c=>l.prepend(c)):l.prepend(u)}}},function(i,n){i.exports=`.ct{z-index:999;opacity:0;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;pointer-events:none;-webkit-transition:opacity 50ms ease-in,-webkit-transform 70ms cubic-bezier(.215,.61,.355,1);transition:opacity 50ms ease-in,-webkit-transform 70ms cubic-bezier(.215,.61,.355,1);transition:opacity 50ms ease-in,transform 70ms cubic-bezier(.215,.61,.355,1);transition:opacity 50ms ease-in,transform 70ms cubic-bezier(.215,.61,.355,1),-webkit-transform 70ms cubic-bezier(.215,.61,.355,1);will-change:opacity,top,left;-webkit-box-shadow:0 8px 12px 0 rgba(29,32,43,.17),0 4px 5px -3px rgba(5,6,12,.49);box-shadow:0 8px 12px 0 rgba(29,32,43,.17),0 4px 5px -3px rgba(5,6,12,.49);border-radius:9px}.ct,.ct:before{position:absolute;top:0;left:0}.ct:before{content:"";bottom:0;right:0;background-color:#1d202b;z-index:-1;border-radius:4px}@supports(-webkit-mask-box-image:url("")){.ct:before{border-radius:0;-webkit-mask-box-image:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"><path d="M10.71 0h2.58c3.02 0 4.64.42 6.1 1.2a8.18 8.18 0 013.4 3.4C23.6 6.07 24 7.7 24 10.71v2.58c0 3.02-.42 4.64-1.2 6.1a8.18 8.18 0 01-3.4 3.4c-1.47.8-3.1 1.21-6.11 1.21H10.7c-3.02 0-4.64-.42-6.1-1.2a8.18 8.18 0 01-3.4-3.4C.4 17.93 0 16.3 0 13.29V10.7c0-3.02.42-4.64 1.2-6.1a8.18 8.18 0 013.4-3.4C6.07.4 7.7 0 10.71 0z"/></svg>') 48% 41% 37.9% 53.3%}}@media (--mobile){.ct{display:none}}.ct__content{padding:6px 10px;color:#cdd1e0;font-size:12px;text-align:center;letter-spacing:.02em;line-height:1em}.ct:after{content:"";width:8px;height:8px;position:absolute;background-color:#1d202b;z-index:-1}.ct--bottom{-webkit-transform:translateY(5px);transform:translateY(5px)}.ct--bottom:after{top:-3px;left:50%;-webkit-transform:translateX(-50%) rotate(-45deg);transform:translateX(-50%) rotate(-45deg)}.ct--top{-webkit-transform:translateY(-5px);transform:translateY(-5px)}.ct--top:after{top:auto;bottom:-3px;left:50%;-webkit-transform:translateX(-50%) rotate(-45deg);transform:translateX(-50%) rotate(-45deg)}.ct--left{-webkit-transform:translateX(-5px);transform:translateX(-5px)}.ct--left:after{top:50%;left:auto;right:0;-webkit-transform:translate(41.6%,-50%) rotate(-45deg);transform:translate(41.6%,-50%) rotate(-45deg)}.ct--right{-webkit-transform:translateX(5px);transform:translateX(5px)}.ct--right:after{top:50%;left:0;-webkit-transform:translate(-41.6%,-50%) rotate(-45deg);transform:translate(-41.6%,-50%) rotate(-45deg)}.ct--shown{opacity:1;-webkit-transform:none;transform:none}`}]).default},function(r,t,e){"use strict";e.r(t),t.default=`<?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg">
<symbol id="arrow-down" viewBox="0 0 14 14">
  <path transform="matrix(1 0 0 -1 0 14)" d="M8.024 4.1v8.6a1.125 1.125 0 0 1-2.25 0V4.1L2.18 7.695A1.125 1.125 0 1 1 .59 6.104L6.103.588c.44-.439 1.151-.439 1.59 0l5.516 5.516a1.125 1.125 0 0 1-1.59 1.59L8.023 4.1z"/>

</symbol>
<symbol id="arrow-up" viewBox="0 0 14 14">
    <path d="M8.024 4.1v8.6a1.125 1.125 0 0 1-2.25 0V4.1L2.18 7.695A1.125 1.125 0 1 1 .59 6.104L6.103.588c.44-.439 1.151-.439 1.59 0l5.516 5.516a1.125 1.125 0 0 1-1.59 1.59L8.023 4.1z"/>

</symbol>
<symbol id="bold" viewBox="0 0 12 14"><path d="M5.997 14H1.72c-.618 0-1.058-.138-1.323-.415C.132 13.308 0 12.867 0 12.262V1.738C0 1.121.135.676.406.406.676.136 1.114 0 1.719 0h4.536c.669 0 1.248.041 1.738.124.49.083.93.242 1.318.478a3.458 3.458 0 0 1 1.461 1.752c.134.366.2.753.2 1.16 0 1.401-.7 2.426-2.1 3.075 1.84.586 2.76 1.726 2.76 3.42 0 .782-.2 1.487-.602 2.114a3.61 3.61 0 0 1-1.623 1.39 5.772 5.772 0 0 1-1.471.377c-.554.073-1.2.11-1.939.11zm-.21-6.217h-2.95v4.087h3.046c1.916 0 2.874-.69 2.874-2.072 0-.707-.248-1.22-.745-1.537-.496-.319-1.238-.478-2.225-.478zM2.837 2.13v3.619h2.597c.707 0 1.252-.067 1.638-.2.385-.134.68-.389.883-.765.16-.267.239-.566.239-.897 0-.707-.252-1.176-.755-1.409-.503-.232-1.27-.348-2.301-.348H2.836z"/>
</symbol>
<symbol id="cross" viewBox="0 0 237 237">
  <path transform="rotate(45 280.675 51.325)" d="M191 191V73c0-5.523 4.477-10 10-10h25c5.523 0 10 4.477 10 10v118h118c5.523 0 10 4.477 10 10v25c0 5.523-4.477 10-10 10H236v118c0 5.523-4.477 10-10 10h-25c-5.523 0-10-4.477-10-10V236H73c-5.523 0-10-4.477-10-10v-25c0-5.523 4.477-10 10-10h118z"/>

</symbol>
<symbol id="dots" viewBox="0 0 8 8">
  <circle cx="6.5" cy="1.5" r="1.5"/>
  <circle cx="6.5" cy="6.5" r="1.5"/>
  <circle cx="1.5" cy="1.5" r="1.5"/>
  <circle cx="1.5" cy="6.5" r="1.5"/>

</symbol>
<symbol id="italic" viewBox="0 0 4 11">
    <path d="M3.289 4.17L2.164 9.713c-.078.384-.238.674-.48.87-.243.198-.52.296-.831.296-.312 0-.545-.1-.699-.302-.153-.202-.192-.49-.116-.864L1.15 4.225c.077-.38.232-.665.466-.857a1.25 1.25 0 01.818-.288c.312 0 .55.096.713.288.163.192.21.46.141.801zm-.667-2.09c-.295 0-.53-.09-.706-.273-.176-.181-.233-.439-.173-.77.055-.302.207-.55.457-.745C2.45.097 2.716 0 3 0c.273 0 .5.088.68.265.179.176.238.434.177.771-.06.327-.21.583-.45.767-.24.185-.502.277-.785.277z"/>

</symbol>
<symbol id="link" viewBox="0 0 14 10">
  <path d="M6 0v2H5a3 3 0 000 6h1v2H5A5 5 0 115 0h1zm2 0h1a5 5 0 110 10H8V8h1a3 3 0 000-6H8V0zM5 4h4a1 1 0 110 2H5a1 1 0 110-2z"/>

</symbol>
<symbol id="plus" viewBox="0 0 14 14">
    <path d="M8.05 5.8h4.625a1.125 1.125 0 0 1 0 2.25H8.05v4.625a1.125 1.125 0 0 1-2.25 0V8.05H1.125a1.125 1.125 0 0 1 0-2.25H5.8V1.125a1.125 1.125 0 0 1 2.25 0V5.8z"/>

</symbol>
<symbol id="sad-face" viewBox="0 0 52 52">
    <path fill="#D76B6B" fill-rule="nonzero" d="M26 52C11.64 52 0 40.36 0 26S11.64 0 26 0s26 11.64 26 26-11.64 26-26 26zm0-3.25c12.564 0 22.75-10.186 22.75-22.75S38.564 3.25 26 3.25 3.25 13.436 3.25 26 13.436 48.75 26 48.75zM15.708 33.042a2.167 2.167 0 1 1 0-4.334 2.167 2.167 0 0 1 0 4.334zm23.834 0a2.167 2.167 0 1 1 0-4.334 2.167 2.167 0 0 1 0 4.334zm-15.875 5.452a1.083 1.083 0 1 1-1.834-1.155c1.331-2.114 3.49-3.179 6.334-3.179 2.844 0 5.002 1.065 6.333 3.18a1.083 1.083 0 1 1-1.833 1.154c-.913-1.45-2.366-2.167-4.5-2.167s-3.587.717-4.5 2.167z"/>

</symbol>
<symbol id="toggler-down">
  <path d="M6.5 9.294a.792.792 0 01-.562-.232L2.233 5.356a.794.794 0 011.123-1.123L6.5 7.377l3.144-3.144a.794.794 0 011.123 1.123L7.062 9.062a.792.792 0 01-.562.232z"/>

</symbol>
<symbol id="unlink" viewBox="0 0 15 11">
  <path d="M13.073 2.099l-1.448 1.448A3 3 0 009 2H8V0h1c1.68 0 3.166.828 4.073 2.099zM6.929 4l-.879.879L7.172 6H5a1 1 0 110-2h1.929zM6 0v2H5a3 3 0 100 6h1v2H5A5 5 0 115 0h1zm6.414 7l2.122 2.121-1.415 1.415L11 8.414l-2.121 2.122L7.464 9.12 9.586 7 7.464 4.879 8.88 3.464 11 5.586l2.121-2.122 1.415 1.415L12.414 7z"/>

</symbol></svg>`},function(r,t){r.exports='.codex-editor{position:relative;-webkit-box-sizing:border-box;box-sizing:border-box;z-index:1}.codex-editor .hide,.codex-editor__redactor--hidden{display:none}.codex-editor__redactor [contenteditable]:empty:after{content:"\\feff "}@media (min-width:651px){.codex-editor--narrow .codex-editor__redactor{margin-right:50px}}@media (min-width:651px){.codex-editor--narrow.codex-editor--rtl .codex-editor__redactor{margin-left:50px;margin-right:0}}@media (min-width:651px){.codex-editor--narrow .ce-toolbar__actions{right:-5px}}.codex-editor__loader{position:relative;height:30vh}.codex-editor__loader:before{content:"";position:absolute;left:50%;top:50%;width:30px;height:30px;margin-top:-15px;margin-left:-15px;border-radius:50%;border:2px solid rgba(201,201,204,.48);border-top-color:transparent;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-animation:editor-loader-spin .8s linear infinite;animation:editor-loader-spin .8s linear infinite;will-change:transform}.codex-editor-copyable{position:absolute;height:1px;width:1px;top:-400%;opacity:.001}.codex-editor-overlay{position:fixed;top:0;left:0;right:0;bottom:0;z-index:999;pointer-events:none;overflow:hidden}.codex-editor-overlay__container{position:relative;pointer-events:auto;z-index:0}.codex-editor-overlay__rectangle{position:absolute;pointer-events:none;background-color:rgba(46,170,220,.2);border:1px solid transparent}.codex-editor svg{fill:currentColor;vertical-align:middle;max-height:100%}::-moz-selection{background-color:#d4ecff}::selection{background-color:#d4ecff}.codex-editor--toolbox-opened [contentEditable=true][data-placeholder]:focus:before{opacity:0!important}@-webkit-keyframes editor-loader-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes editor-loader-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}.ce-toolbar{position:absolute;left:0;right:0;top:0;-webkit-transition:opacity .1s ease;transition:opacity .1s ease;will-change:opacity,transform;display:none}@media (max-width:650px){.ce-toolbar{position:absolute;background-color:#fff;border:1px solid #eaeaea;-webkit-box-shadow:0 3px 15px -3px rgba(13,20,33,.13);box-shadow:0 3px 15px -3px rgba(13,20,33,.13);border-radius:4px;z-index:2}}@media (max-width:650px) and (max-width:650px){.ce-toolbar{-webkit-box-shadow:0 13px 7px -5px rgba(26,38,49,.09),6px 15px 34px -6px rgba(33,48,73,.29);box-shadow:0 13px 7px -5px rgba(26,38,49,.09),6px 15px 34px -6px rgba(33,48,73,.29);border-bottom-color:#d5d7db}}@media (max-width:650px){.ce-toolbar{padding:3px;margin-top:5px}.ce-toolbar--left-oriented:before{left:15px;margin-left:0}.ce-toolbar--right-oriented:before{left:auto;right:15px;margin-left:0}}.ce-toolbar--opened{display:block}@media (max-width:650px){.ce-toolbar--opened{display:-webkit-box;display:-ms-flexbox;display:flex}}.ce-toolbar__content{max-width:650px;margin:0 auto;position:relative}@media (max-width:650px){.ce-toolbar__content{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-line-pack:center;align-content:center;margin:0;max-width:calc(100% - 35px)}}.ce-toolbar__plus{color:#707684;cursor:pointer;width:34px;height:34px;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;position:absolute;left:-34px;-ms-flex-negative:0;flex-shrink:0}.ce-toolbar__plus--active,.ce-toolbar__plus:hover{color:#388ae5}.ce-toolbar__plus--active{-webkit-animation:bounceIn .75s 1;animation:bounceIn .75s 1;-webkit-animation-fill-mode:forwards;animation-fill-mode:forwards}.ce-toolbar__plus-shortcut{opacity:.6;word-spacing:-2px;margin-top:5px}.ce-toolbar__plus--hidden{display:none}@media (max-width:650px){.ce-toolbar__plus{display:-webkit-inline-box!important;display:-ms-inline-flexbox!important;display:inline-flex!important;position:static;-webkit-transform:none!important;transform:none!important}}.ce-toolbar .ce-toolbox,.ce-toolbar__plus{top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%)}.ce-toolbar__actions{position:absolute;right:-30px;top:5px;opacity:0}@media (max-width:650px){.ce-toolbar__actions{position:absolute;right:-28px;top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%);display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}}.ce-toolbar__actions--opened{opacity:1}.ce-toolbar__actions-buttons{text-align:right}.ce-toolbar__settings-btn{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;width:18px;height:18px;color:#707684;cursor:pointer;background:#eff2f5;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.ce-toolbar__settings-btn:hover{color:#1d202b}@media (max-width:650px){.ce-toolbar__settings-btn{background:transparent}}@media (min-width:651px){.codex-editor--narrow .ce-toolbar__plus{left:5px}}.ce-toolbox{position:absolute;visibility:hidden;-webkit-transition:opacity .1s ease;transition:opacity .1s ease;will-change:opacity;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row}@media (max-width:650px){.ce-toolbox{position:static;-webkit-transform:none!important;transform:none!important;-webkit-box-align:center;-ms-flex-align:center;align-items:center;overflow-x:auto}}.ce-toolbox--opened{opacity:1;visibility:visible}.ce-toolbox__button{color:#707684;cursor:pointer;width:34px;height:34px;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-ms-flex-negative:0;flex-shrink:0}.ce-toolbox__button--active,.ce-toolbox__button:hover{color:#388ae5}.ce-toolbox__button--active{-webkit-animation:bounceIn .75s 1;animation:bounceIn .75s 1;-webkit-animation-fill-mode:forwards;animation-fill-mode:forwards}.ce-toolbox-button-tooltip__shortcut{opacity:.6;word-spacing:-3px;margin-top:3px}@media (min-width:651px){.codex-editor--narrow .ce-toolbox{background:#fff;z-index:2}}.ce-inline-toolbar{position:absolute;background-color:#fff;border:1px solid #eaeaea;-webkit-box-shadow:0 3px 15px -3px rgba(13,20,33,.13);box-shadow:0 3px 15px -3px rgba(13,20,33,.13);border-radius:4px;z-index:2}@media (max-width:650px){.ce-inline-toolbar{-webkit-box-shadow:0 13px 7px -5px rgba(26,38,49,.09),6px 15px 34px -6px rgba(33,48,73,.29);box-shadow:0 13px 7px -5px rgba(26,38,49,.09),6px 15px 34px -6px rgba(33,48,73,.29);border-bottom-color:#d5d7db}}.ce-inline-toolbar{-webkit-transform:translateX(-50%) translateY(8px) scale(.9);transform:translateX(-50%) translateY(8px) scale(.9);opacity:0;visibility:hidden;-webkit-transition:opacity .25s ease,-webkit-transform .15s ease;transition:opacity .25s ease,-webkit-transform .15s ease;transition:transform .15s ease,opacity .25s ease;transition:transform .15s ease,opacity .25s ease,-webkit-transform .15s ease;will-change:transform,opacity;top:0;left:0}.ce-inline-toolbar--left-oriented:before{left:15px;margin-left:0}.ce-inline-toolbar--right-oriented:before{left:auto;right:15px;margin-left:0}.ce-inline-toolbar--showed{opacity:1;visibility:visible;-webkit-transform:translateX(-50%);transform:translateX(-50%)}.ce-inline-toolbar--left-oriented{-webkit-transform:translateX(-23px) translateY(8px) scale(.9);transform:translateX(-23px) translateY(8px) scale(.9)}.ce-inline-toolbar--left-oriented.ce-inline-toolbar--showed{-webkit-transform:translateX(-23px);transform:translateX(-23px)}.ce-inline-toolbar--right-oriented{-webkit-transform:translateX(-100%) translateY(8px) scale(.9);transform:translateX(-100%) translateY(8px) scale(.9);margin-left:23px}.ce-inline-toolbar--right-oriented.ce-inline-toolbar--showed{-webkit-transform:translateX(-100%);transform:translateX(-100%)}.ce-inline-toolbar [hidden]{display:none!important}.ce-inline-toolbar__toggler-and-button-wrapper{width:100%;padding:0 6px}.ce-inline-toolbar__buttons,.ce-inline-toolbar__toggler-and-button-wrapper{display:-webkit-box;display:-ms-flexbox;display:flex}.ce-inline-toolbar__dropdown{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;height:34px;padding:0 9px 0 10px;margin:0 6px 0 -6px;-webkit-box-align:center;-ms-flex-align:center;align-items:center;cursor:pointer;border-right:1px solid rgba(201,201,204,.48)}.ce-inline-toolbar__dropdown:hover{background:#eff2f5}.ce-inline-toolbar__dropdown--hidden{display:none}.ce-inline-toolbar__dropdown-content{display:-webkit-box;display:-ms-flexbox;display:flex;font-weight:500;font-size:14px}.ce-inline-toolbar__dropdown-content svg{height:12px}.ce-inline-toolbar__dropdown .icon--toggler-down{margin-left:4px}.ce-inline-toolbar__shortcut{opacity:.6;word-spacing:-3px;margin-top:3px}.ce-inline-tool{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;width:34px;height:34px;line-height:34px;padding:0!important;text-align:center;border-radius:3px;cursor:pointer;border:0;outline:none;background-color:transparent;vertical-align:bottom;color:#000;margin:0}.ce-inline-tool:hover{background-color:#eff2f5}.ce-inline-tool{border-radius:0;line-height:normal;width:auto;padding:0 5px!important;min-width:24px}.ce-inline-tool--active{color:#388ae5}.ce-inline-tool--focused{-webkit-box-shadow:inset 0 0 0 1px rgba(7,161,227,.08);box-shadow:inset 0 0 0 1px rgba(7,161,227,.08);background:rgba(34,186,255,.08)!important}.ce-inline-tool--focused-animated{-webkit-animation-name:buttonClicked;animation-name:buttonClicked;-webkit-animation-duration:.25s;animation-duration:.25s}.ce-inline-tool:not(:last-of-type){margin-right:2px}.ce-inline-tool .icon{height:12px}.ce-inline-tool--link .icon--unlink,.ce-inline-tool--unlink .icon--link{display:none}.ce-inline-tool--unlink .icon--unlink{display:inline-block;margin-bottom:-1px}.ce-inline-tool-input{outline:none;border:0;border-radius:0 0 4px 4px;margin:0;font-size:13px;padding:10px;width:100%;-webkit-box-sizing:border-box;box-sizing:border-box;display:none;font-weight:500;border-top:1px solid rgba(201,201,204,.48)}.ce-inline-tool-input::-webkit-input-placeholder{color:#707684}.ce-inline-tool-input::-moz-placeholder{color:#707684}.ce-inline-tool-input:-ms-input-placeholder{color:#707684}.ce-inline-tool-input::-ms-input-placeholder{color:#707684}.ce-inline-tool-input::placeholder{color:#707684}.ce-inline-tool-input--showed{display:block}.ce-conversion-toolbar{position:absolute;background-color:#fff;border:1px solid #eaeaea;-webkit-box-shadow:0 3px 15px -3px rgba(13,20,33,.13);box-shadow:0 3px 15px -3px rgba(13,20,33,.13);border-radius:4px;z-index:2}@media (max-width:650px){.ce-conversion-toolbar{-webkit-box-shadow:0 13px 7px -5px rgba(26,38,49,.09),6px 15px 34px -6px rgba(33,48,73,.29);box-shadow:0 13px 7px -5px rgba(26,38,49,.09),6px 15px 34px -6px rgba(33,48,73,.29);border-bottom-color:#d5d7db}}.ce-conversion-toolbar{opacity:0;visibility:hidden;will-change:transform,opacity;-webkit-transition:opacity .1s ease,-webkit-transform .1s ease;transition:opacity .1s ease,-webkit-transform .1s ease;transition:transform .1s ease,opacity .1s ease;transition:transform .1s ease,opacity .1s ease,-webkit-transform .1s ease;-webkit-transform:translateY(-8px);transform:translateY(-8px);left:-1px;width:150px;margin-top:5px;-webkit-box-sizing:content-box;box-sizing:content-box}.ce-conversion-toolbar--left-oriented:before{left:15px;margin-left:0}.ce-conversion-toolbar--right-oriented:before{left:auto;right:15px;margin-left:0}.ce-conversion-toolbar--showed{opacity:1;visibility:visible;-webkit-transform:none;transform:none}.ce-conversion-toolbar [hidden]{display:none!important}.ce-conversion-toolbar__buttons{display:-webkit-box;display:-ms-flexbox;display:flex}.ce-conversion-toolbar__label{color:#707684;font-size:11px;font-weight:500;letter-spacing:.33px;padding:10px 10px 5px;text-transform:uppercase}.ce-conversion-tool{display:-webkit-box;display:-ms-flexbox;display:flex;padding:5px 10px;font-size:14px;line-height:20px;font-weight:500;cursor:pointer;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.ce-conversion-tool--hidden{display:none}.ce-conversion-tool--focused{-webkit-box-shadow:inset 0 0 0 1px rgba(7,161,227,.08);box-shadow:inset 0 0 0 1px rgba(7,161,227,.08);background:rgba(34,186,255,.08)!important}.ce-conversion-tool--focused-animated{-webkit-animation-name:buttonClicked;animation-name:buttonClicked;-webkit-animation-duration:.25s;animation-duration:.25s}.ce-conversion-tool:hover{background:#eff2f5}.ce-conversion-tool__icon{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;width:20px;height:20px;border:1px solid rgba(201,201,204,.48);border-radius:3px;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;margin-right:10px;background:#fff}.ce-conversion-tool__icon svg{width:11px;height:11px}.ce-conversion-tool--last{margin-right:0!important}.ce-conversion-tool--active{color:#388ae5!important;-webkit-animation:bounceIn .75s 1;animation:bounceIn .75s 1;-webkit-animation-fill-mode:forwards;animation-fill-mode:forwards}.ce-settings{position:absolute;background-color:#fff;border:1px solid #eaeaea;-webkit-box-shadow:0 3px 15px -3px rgba(13,20,33,.13);box-shadow:0 3px 15px -3px rgba(13,20,33,.13);border-radius:4px;z-index:2}@media (max-width:650px){.ce-settings{-webkit-box-shadow:0 13px 7px -5px rgba(26,38,49,.09),6px 15px 34px -6px rgba(33,48,73,.29);box-shadow:0 13px 7px -5px rgba(26,38,49,.09),6px 15px 34px -6px rgba(33,48,73,.29);border-bottom-color:#d5d7db}}.ce-settings{right:-1px;top:30px;min-width:114px;-webkit-box-sizing:content-box;box-sizing:content-box}.ce-settings--left-oriented:before{left:15px;margin-left:0}.ce-settings--right-oriented:before{left:auto;right:15px;margin-left:0}@media (max-width:650px){.ce-settings{bottom:40px;right:-11px;top:auto}}.ce-settings:before{left:auto;right:12px}@media (max-width:650px){.ce-settings:before{bottom:-5px;top:auto}}.ce-settings{display:none}.ce-settings--opened{display:block;-webkit-animation-duration:.1s;animation-duration:.1s;-webkit-animation-name:panelShowing;animation-name:panelShowing}.ce-settings__plugin-zone:not(:empty){padding:3px 3px 0}.ce-settings__default-zone:not(:empty){padding:3px}.ce-settings__button{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;width:34px;height:34px;line-height:34px;padding:0!important;text-align:center;border-radius:3px;cursor:pointer;border:0;outline:none;background-color:transparent;vertical-align:bottom;color:#000;margin:0}.ce-settings__button:hover{background-color:#eff2f5}.ce-settings__button--active{color:#388ae5}.ce-settings__button--focused{-webkit-box-shadow:inset 0 0 0 1px rgba(7,161,227,.08);box-shadow:inset 0 0 0 1px rgba(7,161,227,.08);background:rgba(34,186,255,.08)!important}.ce-settings__button--focused-animated{-webkit-animation-name:buttonClicked;animation-name:buttonClicked;-webkit-animation-duration:.25s;animation-duration:.25s}.ce-settings__button:not(:nth-child(3n+3)){margin-right:3px}.ce-settings__button:nth-child(n+4){margin-top:3px}.ce-settings__button{line-height:32px}.ce-settings__button--disabled{cursor:not-allowed!important;opacity:.3}.ce-settings__button--selected{color:#388ae5}.ce-settings__button--delete{-webkit-transition:background-color .3s ease;transition:background-color .3s ease;will-change:background-color}.ce-settings__button--delete .icon{-webkit-transition:-webkit-transform .2s ease-out;transition:-webkit-transform .2s ease-out;transition:transform .2s ease-out;transition:transform .2s ease-out,-webkit-transform .2s ease-out;will-change:transform}.ce-settings__button--confirm{background-color:#e24a4a!important;color:#fff}.ce-settings__button--confirm:hover{background-color:#d54a4a!important}.ce-settings__button--confirm .icon{-webkit-transform:rotate(90deg);transform:rotate(90deg)}.ce-block:first-of-type{margin-top:0}.ce-block--selected .ce-block__content{background:#e1f2ff}.ce-block--selected .ce-block__content [contenteditable]{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.ce-block--selected .ce-block__content .ce-stub,.ce-block--selected .ce-block__content img{opacity:.55}.ce-block--stretched .ce-block__content{max-width:none}.ce-block__content{position:relative;max-width:650px;margin:0 auto;-webkit-transition:background-color .15s ease;transition:background-color .15s ease}.ce-block--drop-target .ce-block__content:before{content:"";position:absolute;top:100%;left:-20px;margin-top:-1px;height:8px;width:8px;border:solid #388ae5;border-width:1px 1px 0 0;-webkit-transform-origin:right;transform-origin:right;-webkit-transform:rotate(45deg);transform:rotate(45deg)}.ce-block--drop-target .ce-block__content:after{content:"";position:absolute;top:100%;height:1px;width:100%;color:#388ae5;background:repeating-linear-gradient(90deg,#388ae5,#388ae5 1px,#fff 0,#fff 6px)}.ce-block a{cursor:pointer;text-decoration:underline}.ce-block b{font-weight:700}.ce-block i{font-style:italic}@media (min-width:651px){.codex-editor--narrow .ce-block--focused{margin-right:-50px;padding-right:50px}}.wobble{-webkit-animation-name:wobble;animation-name:wobble;-webkit-animation-duration:.4s;animation-duration:.4s}@-webkit-keyframes wobble{0%{-webkit-transform:translateZ(0);transform:translateZ(0)}15%{-webkit-transform:translate3d(-5%,0,0) rotate(-5deg);transform:translate3d(-5%,0,0) rotate(-5deg)}30%{-webkit-transform:translate3d(2%,0,0) rotate(3deg);transform:translate3d(2%,0,0) rotate(3deg)}45%{-webkit-transform:translate3d(-3%,0,0) rotate(-3deg);transform:translate3d(-3%,0,0) rotate(-3deg)}60%{-webkit-transform:translate3d(2%,0,0) rotate(2deg);transform:translate3d(2%,0,0) rotate(2deg)}75%{-webkit-transform:translate3d(-1%,0,0) rotate(-1deg);transform:translate3d(-1%,0,0) rotate(-1deg)}to{-webkit-transform:translateZ(0);transform:translateZ(0)}}@keyframes wobble{0%{-webkit-transform:translateZ(0);transform:translateZ(0)}15%{-webkit-transform:translate3d(-5%,0,0) rotate(-5deg);transform:translate3d(-5%,0,0) rotate(-5deg)}30%{-webkit-transform:translate3d(2%,0,0) rotate(3deg);transform:translate3d(2%,0,0) rotate(3deg)}45%{-webkit-transform:translate3d(-3%,0,0) rotate(-3deg);transform:translate3d(-3%,0,0) rotate(-3deg)}60%{-webkit-transform:translate3d(2%,0,0) rotate(2deg);transform:translate3d(2%,0,0) rotate(2deg)}75%{-webkit-transform:translate3d(-1%,0,0) rotate(-1deg);transform:translate3d(-1%,0,0) rotate(-1deg)}to{-webkit-transform:translateZ(0);transform:translateZ(0)}}@-webkit-keyframes bounceIn{0%,20%,40%,60%,80%,to{-webkit-animation-timing-function:cubic-bezier(.215,.61,.355,1);animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{-webkit-transform:scale3d(.9,.9,.9);transform:scale3d(.9,.9,.9)}20%{-webkit-transform:scale3d(1.03,1.03,1.03);transform:scale3d(1.03,1.03,1.03)}60%{-webkit-transform:scaleX(1);transform:scaleX(1)}}@keyframes bounceIn{0%,20%,40%,60%,80%,to{-webkit-animation-timing-function:cubic-bezier(.215,.61,.355,1);animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{-webkit-transform:scale3d(.9,.9,.9);transform:scale3d(.9,.9,.9)}20%{-webkit-transform:scale3d(1.03,1.03,1.03);transform:scale3d(1.03,1.03,1.03)}60%{-webkit-transform:scaleX(1);transform:scaleX(1)}}@-webkit-keyframes selectionBounce{0%,20%,40%,60%,80%,to{-webkit-animation-timing-function:cubic-bezier(.215,.61,.355,1);animation-timing-function:cubic-bezier(.215,.61,.355,1)}50%{-webkit-transform:scale3d(1.01,1.01,1.01);transform:scale3d(1.01,1.01,1.01)}70%{-webkit-transform:scaleX(1);transform:scaleX(1)}}@keyframes selectionBounce{0%,20%,40%,60%,80%,to{-webkit-animation-timing-function:cubic-bezier(.215,.61,.355,1);animation-timing-function:cubic-bezier(.215,.61,.355,1)}50%{-webkit-transform:scale3d(1.01,1.01,1.01);transform:scale3d(1.01,1.01,1.01)}70%{-webkit-transform:scaleX(1);transform:scaleX(1)}}@-webkit-keyframes buttonClicked{0%,20%,40%,60%,80%,to{-webkit-animation-timing-function:cubic-bezier(.215,.61,.355,1);animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{-webkit-transform:scale3d(.95,.95,.95);transform:scale3d(.95,.95,.95)}60%{-webkit-transform:scale3d(1.02,1.02,1.02);transform:scale3d(1.02,1.02,1.02)}80%{-webkit-transform:scaleX(1);transform:scaleX(1)}}@keyframes buttonClicked{0%,20%,40%,60%,80%,to{-webkit-animation-timing-function:cubic-bezier(.215,.61,.355,1);animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{-webkit-transform:scale3d(.95,.95,.95);transform:scale3d(.95,.95,.95)}60%{-webkit-transform:scale3d(1.02,1.02,1.02);transform:scale3d(1.02,1.02,1.02)}80%{-webkit-transform:scaleX(1);transform:scaleX(1)}}@-webkit-keyframes panelShowing{0%{opacity:0;-webkit-transform:translateY(-8px) scale(.9);transform:translateY(-8px) scale(.9)}70%{opacity:1;-webkit-transform:translateY(2px);transform:translateY(2px)}to{-webkit-transform:translateY(0);transform:translateY(0)}}@keyframes panelShowing{0%{opacity:0;-webkit-transform:translateY(-8px) scale(.9);transform:translateY(-8px) scale(.9)}70%{opacity:1;-webkit-transform:translateY(2px);transform:translateY(2px)}to{-webkit-transform:translateY(0);transform:translateY(0)}}.cdx-block{padding:.4em 0}.cdx-input{border:1px solid rgba(201,201,204,.48);-webkit-box-shadow:inset 0 1px 2px 0 rgba(35,44,72,.06);box-shadow:inset 0 1px 2px 0 rgba(35,44,72,.06);border-radius:3px;padding:10px 12px;outline:none;width:100%;-webkit-box-sizing:border-box;box-sizing:border-box}.cdx-input[data-placeholder]:before{position:static!important;display:inline-block;width:0;white-space:nowrap;pointer-events:none}.cdx-settings-button{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;width:34px;height:34px;line-height:34px;padding:0!important;text-align:center;border-radius:3px;cursor:pointer;border:0;outline:none;background-color:transparent;vertical-align:bottom;color:#000;margin:0}.cdx-settings-button:hover{background-color:#eff2f5}.cdx-settings-button--focused{-webkit-box-shadow:inset 0 0 0 1px rgba(7,161,227,.08);box-shadow:inset 0 0 0 1px rgba(7,161,227,.08);background:rgba(34,186,255,.08)!important}.cdx-settings-button--focused-animated{-webkit-animation-name:buttonClicked;animation-name:buttonClicked;-webkit-animation-duration:.25s;animation-duration:.25s}.cdx-settings-button:not(:nth-child(3n+3)){margin-right:3px}.cdx-settings-button:nth-child(n+4){margin-top:3px}.cdx-settings-button--active{color:#388ae5}.cdx-loader{position:relative;border:1px solid rgba(201,201,204,.48)}.cdx-loader:before{content:"";position:absolute;left:50%;top:50%;width:18px;height:18px;margin:-11px 0 0 -11px;border:2px solid rgba(201,201,204,.48);border-left-color:#388ae5;border-radius:50%;-webkit-animation:cdxRotation 1.2s linear infinite;animation:cdxRotation 1.2s linear infinite}@-webkit-keyframes cdxRotation{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes cdxRotation{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}.cdx-button{padding:13px;border-radius:3px;border:1px solid rgba(201,201,204,.48);font-size:14.9px;background:#fff;-webkit-box-shadow:0 2px 2px 0 rgba(18,30,57,.04);box-shadow:0 2px 2px 0 rgba(18,30,57,.04);color:#707684;text-align:center;cursor:pointer}.cdx-button:hover{background:#fbfcfe;-webkit-box-shadow:0 1px 3px 0 rgba(18,30,57,.08);box-shadow:0 1px 3px 0 rgba(18,30,57,.08)}.cdx-button svg{height:20px;margin-right:.2em;margin-top:-2px}.ce-stub{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;width:100%;padding:3.5em 0;margin:17px 0;border-radius:3px;background:#fcf7f7;color:#b46262}.ce-stub__info{margin-left:20px}.ce-stub__title{margin-bottom:3px;font-weight:600;font-size:18px;text-transform:capitalize}.ce-stub__subtitle{font-size:16px}.codex-editor.codex-editor--rtl{direction:rtl}.codex-editor.codex-editor--rtl .cdx-list{padding-left:0;padding-right:40px}.codex-editor.codex-editor--rtl .ce-toolbar__plus{right:-34px;left:auto}.codex-editor.codex-editor--rtl .ce-toolbar__actions{right:auto;left:-34px}@media (max-width:650px){.codex-editor.codex-editor--rtl .ce-toolbar__actions{margin-left:0;margin-right:auto;padding-right:0;padding-left:10px}}.codex-editor.codex-editor--rtl .ce-settings{left:5px;right:auto}.codex-editor.codex-editor--rtl .ce-settings:before{right:auto;left:25px}.codex-editor.codex-editor--rtl .ce-settings__button:not(:nth-child(3n+3)){margin-left:3px;margin-right:0}.codex-editor.codex-editor--rtl .ce-conversion-tool__icon{margin-right:0;margin-left:10px}.codex-editor.codex-editor--rtl .ce-inline-toolbar__dropdown{border-right:0 solid transparent;border-left:1px solid rgba(201,201,204,.48);margin:0 -6px 0 6px}.codex-editor.codex-editor--rtl .ce-inline-toolbar__dropdown .icon--toggler-down{margin-left:0;margin-right:4px}@media (min-width:651px){.codex-editor--narrow.codex-editor--rtl .ce-toolbar__plus{left:0;right:5px}}@media (min-width:651px){.codex-editor--narrow.codex-editor--rtl .ce-toolbar__actions{left:-5px}}'}])})});var Ud=ye((pn,Vo)=>{(function(r,t){typeof pn=="object"&&typeof Vo=="object"?Vo.exports=t():typeof define=="function"&&define.amd?define([],t):typeof pn=="object"?pn.Undo=t():r.Undo=t()})(window,function(){return function(r){var t={};function e(i){if(t[i])return t[i].exports;var n=t[i]={i,l:!1,exports:{}};return r[i].call(n.exports,n,n.exports,e),n.l=!0,n.exports}return e.m=r,e.c=t,e.d=function(i,n,o){e.o(i,n)||Object.defineProperty(i,n,{enumerable:!0,get:o})},e.r=function(i){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i,"__esModule",{value:!0})},e.t=function(i,n){if(1&n&&(i=e(i)),8&n||4&n&&typeof i=="object"&&i&&i.__esModule)return i;var o=Object.create(null);if(e.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:i}),2&n&&typeof i!="string")for(var a in i)e.d(o,a,function(s){return i[s]}.bind(null,a));return o},e.n=function(i){var n=i&&i.__esModule?function(){return i.default}:function(){return i};return e.d(n,"a",n),n},e.o=function(i,n){return Object.prototype.hasOwnProperty.call(i,n)},e.p="/",e(e.s=0)}([function(r,t,e){"use strict";function i(s,l){for(var u=0;u<l.length;u++){var c=l[u];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(s,c.key,c)}}e.r(t),e.d(t,"default",function(){return a});var n=function(){function s(h,p){(function(g,b){if(!(g instanceof b))throw new TypeError("Cannot call a class as a function")})(this,s),this.holder=typeof p=="string"?document.getElementById(p):p,this.observer=null,this.debounceTimer=200,this.mutationDebouncer=this.debounce(function(){h()},this.debounceTimer)}var l,u,c;return l=s,(u=[{key:"setMutationObserver",value:function(){var h=this,p=this.holder;this.observer=new MutationObserver(function(g){h.mutationHandler(g)}),this.observer.observe(p,{childList:!0,attributes:!0,subtree:!0,characterData:!0,characterDataOldValue:!0})}},{key:"mutationHandler",value:function(h){var p=this,g=!1;h.forEach(function(b){switch(b.type){case"childList":b.target===p.holder?p.onDestroy():g=!0;break;case"characterData":g=!0;break;case"attributes":b.target.classList.contains("ce-block")||(g=!0)}}),g&&this.mutationDebouncer()}},{key:"debounce",value:function(h,p){var g,b=this;return function(){for(var v=arguments.length,k=new Array(v),C=0;C<v;C++)k[C]=arguments[C];var O=b;clearTimeout(g),g=setTimeout(function(){return h.apply(O,k)},p)}}},{key:"onDestroy",value:function(){var h=new CustomEvent("destroy");document.dispatchEvent(h),this.observer.disconnect()}}])&&i(l.prototype,u),c&&i(l,c),s}();function o(s,l){for(var u=0;u<l.length;u++){var c=l[u];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(s,c.key,c)}}var a=function(){function s(h){var p=this,g=h.editor,b=h.onUpdate,v=h.maxLength;(function(O,d){if(!(O instanceof d))throw new TypeError("Cannot call a class as a function")})(this,s);var k={maxLength:30,onUpdate:function(){}},C=g.configuration;this.editor=g,this.shouldSaveHistory=!0,this.readOnly=C.readOnly,this.maxLength=v||k.maxLength,this.onUpdate=b||k.onUpdate,new n(function(){return p.registerChange()},C.holder).setMutationObserver(),this.setEventListeners(),this.initialItem=null,this.clear()}var l,u,c;return l=s,c=[{key:"isReadOnlySupported",get:function(){return!0}}],(u=[{key:"truncate",value:function(h,p){for(;h.length>p;)h.shift()}},{key:"initialize",value:function(h){var p="blocks"in h?h.blocks:h,g={index:p.length-1,state:p};this.stack[0]=g,this.initialItem=g}},{key:"clear",value:function(){this.stack=this.initialItem?[this.initialItem]:[{index:0,state:[]}],this.position=0,this.onUpdate()}},{key:"registerChange",value:function(){var h=this;this.readOnly||(this.editor&&this.editor.save&&this.shouldSaveHistory&&this.editor.save().then(function(p){h.editorDidUpdate(p.blocks)&&h.save(p.blocks)}),this.shouldSaveHistory=!0)}},{key:"editorDidUpdate",value:function(h){var p=this.stack[this.position].state;return h.length!==p.length||JSON.stringify(p)!==JSON.stringify(h)}},{key:"save",value:function(h){this.position>=this.maxLength&&this.truncate(this.stack,this.maxLength),this.position=Math.min(this.position,this.stack.length-1),this.stack=this.stack.slice(0,this.position+1);var p=this.editor.blocks.getCurrentBlockIndex();this.stack.push({index:p,state:h}),this.position+=1,this.onUpdate()}},{key:"undo",value:function(){var h=this;if(this.canUndo()){this.shouldSaveHistory=!1;var p=this.stack[this.position-=1],g=p.index,b=p.state;this.onUpdate(),this.editor.blocks.render({blocks:b}).then(function(){return h.editor.caret.setToBlock(g,"end")})}}},{key:"redo",value:function(){var h=this;if(this.canRedo()){this.shouldSaveHistory=!1;var p=this.stack[this.position+=1],g=p.index,b=p.state;this.onUpdate(),this.editor.blocks.render({blocks:b}).then(function(){return h.editor.caret.setToBlock(g,"end")})}}},{key:"canUndo",value:function(){return!this.readOnly&&this.position>0}},{key:"canRedo",value:function(){return!this.readOnly&&this.position<this.count()}},{key:"count",value:function(){return this.stack.length-1}},{key:"setEventListeners",value:function(){var h=this,p=/(Mac)/i.test(navigator.platform)?"metaKey":"ctrlKey",g=function(v){v[p]&&v.key==="z"&&(v.preventDefault(),h.undo())},b=function(v){v[p]&&v.key==="y"&&(v.preventDefault(),h.redo())};document.addEventListener("keydown",g),document.addEventListener("keydown",b),document.addEventListener("destroy",function(){document.removeEventListener("keydown",g),document.removeEventListener("keydown",b)})}}])&&o(l.prototype,u),c&&o(l,c),s}()}]).default})});var tf=ye((exports,module)=>{frappe.dashboard_utils={render_chart_filters:function(r,t,e,i){r.forEach(n=>{let o="",a="";n.icon&&(o=frappe.utils.icon(n.icon)),n.class&&(a=n.class);let s=`<div class="${t} ${a} btn-group dropdown pull-right">
					<a data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
						<button class="btn btn-secondary btn-xs">
							${o}
							<span class="filter-label">${__(n.label)}</span>
							${frappe.utils.icon("select","xs")}
						</button>
				</a>`,l;n.fieldnames?l=n.options.map((h,p)=>`<li>
						<a class="dropdown-item" data-fieldname="${n.fieldnames[p]}" data-option="${encodeURIComponent(h)}">${__(h)}</a>
					</li>`).join(""):l=n.options.map(h=>`<li><a class="dropdown-item" data-option="${encodeURIComponent(h)}">${__(h)}</a></li>`).join("");let u=s+`<ul class="dropdown-menu">${l}</ul></div>`,c=$(u);i?c.prependTo(e):c.appendTo(e),c.find(".dropdown-menu").on("click","li a",h=>{let p=$(h.currentTarget),g;p.attr("data-fieldname")&&(g=p.attr("data-fieldname"));let b=decodeURIComponent(p.data("option"));p.parents(`.${t}`).find(".filter-label").html(__(b)),n.action(b,g)})})},get_filters_for_chart_type:function(r){if(r.chart_type==="Custom"&&r.source){let t="frappe.desk.doctype.dashboard_chart_source.dashboard_chart_source.get_config";return frappe.xcall(t,{name:r.source}).then(e=>(frappe.dom.eval(e),frappe.dashboards.chart_sources[r.source].filters))}else return r.chart_type==="Report"&&r.report_name?frappe.report_utils.get_report_filters(r.report_name).then(t=>t):Promise.resolve()},get_dashboard_settings(){return frappe.db.get_list("Dashboard Settings",{filters:{name:frappe.session.user},fields:["*"]}).then(r=>r.length?r[0]:this.create_dashboard_settings().then(t=>t))},create_dashboard_settings(){return frappe.xcall("frappe.desk.doctype.dashboard_settings.dashboard_settings.create_dashboard_settings",{user:frappe.session.user}).then(r=>r)},get_years_since_creation(r){let t=this.get_year(r),e=this.get_year(frappe.datetime.now_date()),i=[];for(var n=e;n>=t;n--)i.push(n);return i},get_year(r){return r.substring(0,r.indexOf("-"))},remove_common_static_filter_values(r,t){if(t)if($.isArray(r))r=r.filter(e=>{for(let i of t)if(e[0]==i[0]&&e[1]==i[1])return!1;return!0});else for(let e of Object.keys(t))delete r[e];return r},get_fields_for_dynamic_filter_dialog(r,t,e){let i=[{fieldtype:"HTML",fieldname:"description",options:`<div>
						<p>Set dynamic filter values in JavaScript for the required fields here.
						</p>
						<p>Ex:
							<code>frappe.defaults.get_user_default("Company")</code>
						</p>
					</div>`}];if(r)e&&(t=[...t,...e]),t.forEach(n=>{for(let o of i)if(o.fieldname==n[0]+":"+n[1])return;n[2]=="="&&i.push({label:`${n[1]} (${n[0]})`,fieldname:n[0]+":"+n[1],fieldtype:"Data"})});else{t=lt(lt({},e),t);for(let n of Object.keys(t))i.push({label:n,fieldname:n,fieldtype:"Data"})}return i},get_all_filters(doc){let filters=JSON.parse(doc.filters_json||"null"),dynamic_filters=JSON.parse(doc.dynamic_filters_json||"null");if(!dynamic_filters)return filters;if($.isArray(dynamic_filters))dynamic_filters.forEach(f=>{try{f[3]=eval(f[3])}catch(r){frappe.throw(__("Invalid expression set in filter {0} ({1})",[f[1],f[0]]))}}),filters=[...filters,...dynamic_filters];else{for(let key of Object.keys(dynamic_filters))try{let val=eval(dynamic_filters[key]);dynamic_filters[key]=val}catch(r){frappe.throw(__("Invalid expression set in filter {0}",[key]))}Object.assign(filters,dynamic_filters)}return filters},get_dashboard_link_field(){let r={label:__("Select Dashboard"),fieldtype:"Link",fieldname:"dashboard",options:"Dashboard"};return frappe.boot.developer_mode||(r.get_query=()=>({filters:{is_standard:0}})),r},get_add_to_dashboard_dialog(r,t,e){let i=this.get_dashboard_link_field(),n=new frappe.ui.Dialog({title:__("Add to Dashboard"),fields:[i],primary_action:o=>{o.name=r,o.set_standard=frappe.boot.developer_mode,frappe.xcall(e,{args:o}).then(()=>{let a=`<a href = "/app/dashboard/${o.dashboard}">${o.dashboard}</a>`,s=__("{0} {1} added to Dashboard {2}",[t,o.name,a]);frappe.msgprint(s)}),n.hide()}});return n}}});var Of=ye((x8,In)=>{(function(t){"use strict";typeof define=="function"&&define.amd?define(t):typeof In!="undefined"&&typeof In.exports!="undefined"?In.exports=t():window.Sortable=t()})(function(){"use strict";if(typeof window=="undefined"||!window.document)return function(){throw new Error("Sortable.js requires a window with a document")};var t,e,i,n,o,a,s,l,u,c,h,p,g,b,v=[],k=!1,C=!1,O=!1,d=[],_,m,y,x,S,w,E,L,I=!1,A=!1,B,T,M,j,J=/\s+/g,U="Sortable"+new Date().getTime(),H=window,te=H.document,ae=H.parseInt,W=H.setTimeout,Y=H.jQuery||H.Zepto,re=H.Polymer,ie={capture:!1,passive:!1},Q=!!navigator.userAgent.match(/(?:Trident.*rv[ :]?11\.|msie|iemobile)/i),ee=!!navigator.userAgent.match(/Edge/i),pe=ee||Q?"cssFloat":"float",be="draggable"in te.createElement("div"),we=function(){if(Q)return!1;var z=te.createElement("x");return z.style.cssText="pointer-events:auto",z.style.pointerEvents==="auto"}(),Le=!1,fe=!1,xe=Math.abs,Ne=Math.min,Be=[],Pe=function(z,G){var Z=qe(z),de=ae(Z.width),le=It(z,0,G),Ce=It(z,1,G),Se=le&&qe(le),Re=Ce&&qe(Ce),Ae=Se&&ae(Se.marginLeft)+ae(Se.marginRight)+Te(le).width,$e=Re&&ae(Re.marginLeft)+ae(Re.marginRight)+Te(Ce).width;if(Z.display==="flex")return Z.flexDirection==="column"||Z.flexDirection==="column-reverse"?"vertical":"horizontal";if(le&&Se.float!=="none"){var We=Se.float==="left"?"left":"right";return Ce&&(Re.clear==="both"||Re.clear===We)?"vertical":"horizontal"}return le&&(Se.display==="block"||Se.display==="flex"||Se.display==="table"||Se.display==="grid"||Ae>=de&&Z[pe]==="none"||Ce&&Z[pe]==="none"&&Ae+$e>de)?"vertical":"horizontal"},Ze=function(z,G){for(var Z=0;Z<d.length;Z++)if(!d[Z].children.length){var de=Te(d[Z]),le=d[Z][U].options.emptyInsertThreshold,Ce=z>=de.left-le&&z<=de.right+le,Se=G>=de.top-le&&G<=de.bottom+le;if(Ce&&Se)return d[Z]}},tt=function(z,G,Z,de,le){var Ce=Te(Z),Se=de==="vertical"?Ce.left:Ce.top,Re=de==="vertical"?Ce.right:Ce.bottom,Ae=de==="vertical"?z:G;return Se<Ae&&Ae<Re},Xe=function(z,G,Z){var de=z===t&&j||Te(z),le=G===t&&j||Te(G),Ce=Z==="vertical"?de.left:de.top,Se=Z==="vertical"?de.right:de.bottom,Re=Z==="vertical"?de.width:de.height,Ae=Z==="vertical"?le.left:le.top,$e=Z==="vertical"?le.right:le.bottom,We=Z==="vertical"?le.width:le.height;return Ce===Ae||Se===$e||Ce+Re/2===Ae+We/2},Ke=function(z,G){if(!z||!z.getBoundingClientRect)return H;var Z=z,de=!1;do if(Z.clientWidth<Z.scrollWidth||Z.clientHeight<Z.scrollHeight){var le=qe(Z);if(Z.clientWidth<Z.scrollWidth&&(le.overflowX=="auto"||le.overflowX=="scroll")||Z.clientHeight<Z.scrollHeight&&(le.overflowY=="auto"||le.overflowY=="scroll")){if(!Z||!Z.getBoundingClientRect||Z===te.body)return H;if(de||G)return Z;de=!0}}while(Z=Z.parentNode);return H},nt=hr(function(z,G,Z,de){if(G.scroll){var le=Z?Z[U]:window,Ce=G.scrollSensitivity,Se=G.scrollSpeed,Re=z.clientX,Ae=z.clientY,$e=window.innerWidth,We=window.innerHeight,Fe=!1;u!==Z&&(ot(),l=G.scroll,c=G.scrollFn,l===!0&&(l=Ke(Z,!0),u=l));var rt=0,mt=l;do{var Je=mt,Ue=Te(Je),At=Ue.top,$t=Ue.bottom,xt=Ue.left,St=Ue.right,F=Ue.width,ne=Ue.height,V,oe,D,R,P,N,X,q,K;if(Je!==H?(V=Je.scrollWidth,oe=Je.scrollHeight,D=qe(Je),N=F<V&&(D.overflowX==="auto"||D.overflowX==="scroll"),X=ne<oe&&(D.overflowY==="auto"||D.overflowY==="scroll"),q=Je.scrollLeft,K=Je.scrollTop):(V=te.documentElement.scrollWidth,oe=te.documentElement.scrollHeight,D=qe(te.documentElement),N=F<V&&(D.overflowX==="auto"||D.overflowX==="scroll"||D.overflowX==="visible"),X=ne<oe&&(D.overflowY==="auto"||D.overflowY==="scroll"||D.overflowY==="visible"),q=te.documentElement.scrollLeft,K=te.documentElement.scrollTop),R=N&&(xe(St-Re)<=Ce&&q+F<V)-(xe(xt-Re)<=Ce&&!!q),P=X&&(xe($t-Ae)<=Ce&&K+ne<oe)-(xe(At-Ae)<=Ce&&!!K),!v[rt])for(var se=0;se<=rt;se++)v[se]||(v[se]={});(v[rt].vx!=R||v[rt].vy!=P||v[rt].el!==Je)&&(v[rt].el=Je,v[rt].vx=R,v[rt].vy=P,clearInterval(v[rt].pid),Je&&(R!=0||P!=0)&&(Fe=!0,v[rt].pid=setInterval(function(){de&&this.layer===0&&Me.active._emulateDragOver(!0);var ge=v[this.layer].vy?v[this.layer].vy*Se:0,me=v[this.layer].vx?v[this.layer].vx*Se:0;typeof c=="function"&&c.call(le,me,ge,z,S,v[this.layer].el)!=="continue"||(v[this.layer].el===H?H.scrollTo(H.pageXOffset+me,H.pageYOffset+ge):(v[this.layer].el.scrollTop+=ge,v[this.layer].el.scrollLeft+=me))}.bind({layer:rt}),24))),rt++}while(G.bubbleScroll&&mt!==H&&(mt=Ke(mt,!1)));k=Fe}},30),ot=function(){v.forEach(function(z){clearInterval(z.pid)}),v=[]},ce=function(z){function G(le,Ce){return function(Se,Re,Ae,$e){var We=Se.options.group.name&&Re.options.group.name&&Se.options.group.name===Re.options.group.name;if(le==null&&(Ce||We))return!0;if(le==null||le===!1)return!1;if(Ce&&le==="clone")return le;if(typeof le=="function")return G(le(Se,Re,Ae,$e),Ce)(Se,Re,Ae,$e);var Fe=(Ce?Se:Re).options.group.name;return le===!0||typeof le=="string"&&le===Fe||le.join&&le.indexOf(Fe)>-1}}var Z={},de=z.group;(!de||typeof de!="object")&&(de={name:de}),Z.name=de.name,Z.checkPull=G(de.pull,!0),Z.checkPut=G(de.put),Z.revertClone=de.revertClone,z.group=Z},ve=function(z){!t||!t.parentNode||t.parentNode[U]&&t.parentNode[U]._computeIsAligned(z)},Ie=function(z,G){for(var Z=G;!Z[U];)Z=Z.parentNode;return z===Z},He=function(z,G,Z){for(var de=z.parentNode;de&&!de[U];)de=de.parentNode;de&&de[U][Z](nr(G,{artificialBubble:!0}))},at=function(){!we&&i&&qe(i,"display","none")},vt=function(){!we&&i&&qe(i,"display","")};te.addEventListener("click",function(z){if(O)return z.preventDefault(),z.stopPropagation&&z.stopPropagation(),z.stopImmediatePropagation&&z.stopImmediatePropagation(),O=!1,!1},!0);var bt=function(z){if(z=z.touches?z.touches[0]:z,t){var G=Ze(z.clientX,z.clientY);G&&G[U]._onDragOver({clientX:z.clientX,clientY:z.clientY,target:G,rootEl:G})}};Ye(te,"dragover",bt),Ye(te,"mousemove",bt),Ye(te,"touchmove",bt);function Me(z,G){if(!(z&&z.nodeType&&z.nodeType===1))throw"Sortable: `el` must be HTMLElement, not "+{}.toString.call(z);this.el=z,this.options=G=nr({},G),z[U]=this;var Z={group:null,sort:!0,disabled:!1,store:null,handle:null,scroll:!0,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0,draggable:/[uo]l/i.test(z.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Pe(z,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(Ce,Se){Ce.setData("Text",Se.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,touchStartThreshold:ae(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:Me.supportPointer!==!1&&("PointerEvent"in window||window.navigator&&"msPointerEnabled"in window.navigator),emptyInsertThreshold:5};for(var de in Z)!(de in G)&&(G[de]=Z[de]);ce(G);for(var le in this)le.charAt(0)==="_"&&typeof this[le]=="function"&&(this[le]=this[le].bind(this));this.nativeDraggable=G.forceFallback?!1:be,G.supportPointer?Ye(z,"pointerdown",this._onTapStart):(Ye(z,"mousedown",this._onTapStart),Ye(z,"touchstart",this._onTapStart)),this.nativeDraggable&&(Ye(z,"dragover",this),Ye(z,"dragenter",this)),d.push(this.el),G.store&&G.store.get&&this.sort(G.store.get(this)||[])}Me.prototype={constructor:Me,_computeIsAligned:function(z){var G;if(i&&!we?(at(),G=te.elementFromPoint(z.clientX,z.clientY),vt()):G=z.target,G=yt(G,this.options.draggable,this.el,!1),!fe&&!(!t||t.parentNode!==this.el)){for(var Z=this.el.children,de=0;de<Z.length;de++)yt(Z[de],this.options.draggable,this.el,!1)&&Z[de]!==G&&(Z[de].sortableMouseAligned=tt(z.clientX,z.clientY,Z[de],this._getDirection(z,null),this.options));yt(G,this.options.draggable,this.el,!0)||(E=null),fe=!0,W(function(){fe=!1},30)}},_getDirection:function(z,G){return typeof this.options.direction=="function"?this.options.direction.call(this,z,G,t):this.options.direction},_onTapStart:function(z){if(!!z.cancelable){var G=this,Z=this.el,de=this.options,le=de.preventOnFilter,Ce=z.type,Se=z.touches&&z.touches[0],Re=(Se||z).target,Ae=z.target.shadowRoot&&(z.path&&z.path[0]||z.composedPath&&z.composedPath()[0])||Re,$e=de.filter,We;if(Et(Z),!(Q&&!z.artificialBubble&&!Ie(Z,Re))&&!t&&!(/mousedown|pointerdown/.test(Ce)&&z.button!==0||de.disabled)&&!Ae.isContentEditable){if(Re=yt(Re,de.draggable,Z,!1),!Re){Q&&He(Z,z,"_onTapStart");return}if(s!==Re){if(We=Nt(Re,de.draggable),typeof $e=="function"){if($e.call(this,z,Re,this)){De(G,Ae,"filter",Re,Z,Z,We),le&&z.cancelable&&z.preventDefault();return}}else if($e&&($e=$e.split(",").some(function(Fe){if(Fe=yt(Ae,Fe.trim(),Z,!1),Fe)return De(G,Fe,"filter",Re,Z,Z,We),!0}),$e)){le&&z.cancelable&&z.preventDefault();return}de.handle&&!yt(Ae,de.handle,Z,!1)||this._prepareDragStart(z,Se,Re,We)}}}},_handleAutoScroll:function(z,G){if(!(!t||!this.options.scroll)){var Z=z.clientX,de=z.clientY,le=te.elementFromPoint(Z,de),Ce=this;if(G||ee||Q){nt(z,Ce.options,le,G);var Se=Ke(le,!0);k&&(!_||Z!==m||de!==y)&&(_&&clearInterval(_),_=setInterval(function(){if(!!t){var Re=Ke(te.elementFromPoint(Z,de),!0);Re!==Se&&(Se=Re,ot(),nt(z,Ce.options,Se,G))}},10),m=Z,y=de)}else{if(!Ce.options.bubbleScroll||Ke(le,!0)===window){ot();return}nt(z,Ce.options,Ke(le,!1),!1)}}},_prepareDragStart:function(z,G,Z,de){var le=this,Ce=le.el,Se=le.options,Re=Ce.ownerDocument,Ae;Z&&!t&&Z.parentNode===Ce&&(o=Ce,t=Z,e=t.parentNode,a=t.nextSibling,s=Z,g=Se.group,h=de,x={target:t,clientX:(G||z).clientX,clientY:(G||z).clientY},this._lastX=(G||z).clientX,this._lastY=(G||z).clientY,t.style["will-change"]="all",t.style.transition="",t.style.transform="",Ae=function(){le._disableDelayedDrag(),t.draggable=le.nativeDraggable,le._triggerDragStart(z,G),De(le,o,"choose",t,o,o,h),Qe(t,Se.chosenClass,!0)},Se.ignore.split(",").forEach(function($e){dt(t,$e.trim(),et)}),Se.supportPointer?Ye(Re,"pointerup",le._onDrop):(Ye(Re,"mouseup",le._onDrop),Ye(Re,"touchend",le._onDrop),Ye(Re,"touchcancel",le._onDrop)),Se.delay?(Ye(Re,"mouseup",le._disableDelayedDrag),Ye(Re,"touchend",le._disableDelayedDrag),Ye(Re,"touchcancel",le._disableDelayedDrag),Ye(Re,"mousemove",le._delayedDragTouchMoveHandler),Ye(Re,"touchmove",le._delayedDragTouchMoveHandler),Se.supportPointer&&Ye(Re,"pointermove",le._delayedDragTouchMoveHandler),le._dragStartTimer=W(Ae,Se.delay)):Ae())},_delayedDragTouchMoveHandler:function(z){var G=z.touches?z.touches[0]:z;Ne(xe(G.clientX-this._lastX),xe(G.clientY-this._lastY))>=this.options.touchStartThreshold&&this._disableDelayedDrag()},_disableDelayedDrag:function(){var z=this.el.ownerDocument;clearTimeout(this._dragStartTimer),Ge(z,"mouseup",this._disableDelayedDrag),Ge(z,"touchend",this._disableDelayedDrag),Ge(z,"touchcancel",this._disableDelayedDrag),Ge(z,"mousemove",this._delayedDragTouchMoveHandler),Ge(z,"touchmove",this._delayedDragTouchMoveHandler),Ge(z,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(z,G){G=G||(z.pointerType=="touch"?z:null),!this.nativeDraggable||G?this.options.supportPointer?Ye(te,"pointermove",this._onTouchMove):G?Ye(te,"touchmove",this._onTouchMove):Ye(te,"mousemove",this._onTouchMove):(Ye(t,"dragend",this),Ye(o,"dragstart",this._onDragStart));try{te.selection?wt(function(){te.selection.empty()}):window.getSelection().removeAllRanges()}catch(Z){}},_dragStarted:function(z){if(C=!1,o&&t){this.nativeDraggable&&(Ye(te,"dragover",this._handleAutoScroll),Ye(te,"dragover",ve));var G=this.options;!z&&Qe(t,G.dragClass,!1),Qe(t,G.ghostClass,!0),qe(t,"transform",""),Me.active=this,z&&this._appendGhost(),De(this,o,"start",t,o,o,h)}else this._nulling()},_emulateDragOver:function(z){if(S){if(this._lastX===S.clientX&&this._lastY===S.clientY&&!z)return;this._lastX=S.clientX,this._lastY=S.clientY,at();for(var G=te.elementFromPoint(S.clientX,S.clientY),Z=G;G&&G.shadowRoot;)G=G.shadowRoot.elementFromPoint(S.clientX,S.clientY),Z=G;if(Z)do{if(Z[U]){var de;if(de=Z[U]._onDragOver({clientX:S.clientX,clientY:S.clientY,target:G,rootEl:Z}),de&&!this.options.dragoverBubble)break}G=Z}while(Z=Z.parentNode);t.parentNode[U]._computeIsAligned(S),vt()}},_onTouchMove:function(z){if(x){var G=this.options,Z=G.fallbackTolerance,de=G.fallbackOffset,le=z.touches?z.touches[0]:z,Ce=i&&er(i),Se=i&&Ce&&Ce.a,Re=i&&Ce&&Ce.d,Ae=(le.clientX-x.clientX+de.x)/(Se||1),$e=(le.clientY-x.clientY+de.y)/(Re||1),We=z.touches?"translate3d("+Ae+"px,"+$e+"px,0)":"translate("+Ae+"px,"+$e+"px)";if(!Me.active&&!C){if(Z&&Ne(xe(le.clientX-this._lastX),xe(le.clientY-this._lastY))<Z)return;this._onDragStart(z,!0)}this._handleAutoScroll(le,!0),w=!0,S=le,qe(i,"webkitTransform",We),qe(i,"mozTransform",We),qe(i,"msTransform",We),qe(i,"transform",We),z.cancelable&&z.preventDefault()}},_appendGhost:function(){if(!i){var z=Te(t,this.options.fallbackOnBody?te.body:o,!0),G=qe(t),Z=this.options;i=t.cloneNode(!0),Qe(i,Z.ghostClass,!1),Qe(i,Z.fallbackClass,!0),Qe(i,Z.dragClass,!0),qe(i,"box-sizing","border-box"),qe(i,"margin",0),qe(i,"top",z.top),qe(i,"left",z.left),qe(i,"width",z.width),qe(i,"height",z.height),qe(i,"opacity","0.8"),qe(i,"position","fixed"),qe(i,"zIndex","100000"),qe(i,"pointerEvents","none"),Z.fallbackOnBody&&te.body.appendChild(i)||o.appendChild(i)}},_onDragStart:function(z,G){var Z=this,de=z.dataTransfer,le=Z.options;n=Tt(t),n.draggable=!1,n.style["will-change"]="",this._hideClone(),Qe(n,Z.options.chosenClass,!1),Z._cloneId=wt(function(){Z.options.removeCloneOnHide||o.insertBefore(n,t),De(Z,o,"clone",t)}),!G&&Qe(t,le.dragClass,!0),G?(O=!0,Z._loopId=setInterval(Z._emulateDragOver,50)):(Ge(te,"mouseup",Z._onDrop),Ge(te,"touchend",Z._onDrop),Ge(te,"touchcancel",Z._onDrop),de&&(de.effectAllowed="move",le.setData&&le.setData.call(Z,de,t)),Ye(te,"drop",Z),qe(t,"transform","translateZ(0)")),C=!0,Z._dragStartId=wt(Z._dragStarted.bind(Z,G)),Ye(te,"selectstart",Z)},_onDragOver:function(z){var G=this.el,Z=z.target,de,le,Ce,Se=this.options,Re=Se.group,Ae=Me.active,$e=g===Re,We=Se.sort,Fe=this;if(Le||Q&&!z.rootEl&&!z.artificialBubble&&!Ie(G,Z))return;function rt(){return Ae&&(Qe(t,b?b.options.ghostClass:Ae.options.ghostClass,!1),Qe(t,Se.ghostClass,!0)),b!==Fe&&Fe!==Me.active?b=Fe:Fe===Me.active&&(b=null),(Z===t&&!t.animated||Z===G&&!Z.animated)&&(E=null),!Se.dragoverBubble&&!z.rootEl&&Z!==te&&(Fe._handleAutoScroll(z),t.parentNode[U]._computeIsAligned(z)),!Se.dragoverBubble&&z.stopPropagation&&z.stopPropagation(),!0}function mt(){De(Fe,o,"change",Z,G,o,h,Nt(t,Se.draggable),z)}if(z.preventDefault!==void 0&&z.cancelable&&z.preventDefault(),w=!0,Z=yt(Z,Se.draggable,G,!0),!!yt(z.target,null,t,!0)||Z.animated)return rt();if(Z!==t&&(O=!1),Ae&&!Se.disabled&&($e?We||(Ce=!o.contains(t)):b===this||(this.lastPutMode=g.checkPull(this,Ae,t,z))&&Re.checkPut(this,Ae,t,z))){var Je=this._getDirection(z,Z);if(de=Te(t),Ce)return this._hideClone(),e=o,a?o.insertBefore(t,a):o.appendChild(t),rt();if(G.children.length===0||G.children[0]===i||pt(z,Je,G)&&!t.animated){if(G.children.length!==0&&G.children[0]!==i&&G===z.target&&(Z=dr(G)),Z&&(le=Te(Z)),$e?Ae._hideClone():Ae._showClone(this),tr(o,G,t,de,Z,le,z,!!Z)!==!1)return G.appendChild(t),e=G,j=null,mt(),this._animate(de,t),Z&&this._animate(le,Z),rt()}else if(Z&&Z!==t&&Z.parentNode===G){var Ue=0,At,$t=Z.sortableMouseAligned,xt=t.parentNode!==G,St=ze(Z,Je==="vertical"?"top":"left");if(E!==Z&&(B=null,At=Te(Z)[Je==="vertical"?"top":"left"],I=!1),Xe(t,Z,Je)&&$t||xt||St||Se.invertSwap||B==="insert"||B==="swap"?(B!=="swap"&&(A=Se.invertSwap||xt||k||St),Ue=Lt(z,Z,Je,Se.swapThreshold,Se.invertedSwapThreshold==null?Se.swapThreshold:Se.invertedSwapThreshold,A,E===Z),B="swap"):(Ue=Xt(Z,Se),B="insert"),Ue===0)return rt();j=null,E=Z,L=Ue,le=Te(Z);var F=Z.nextElementSibling,ne=!1;ne=Ue===1;var V=tr(o,G,t,de,Z,le,z,ne);if(V!==!1)return(V===1||V===-1)&&(ne=V===1),Le=!0,W(rr,30),$e?Ae._hideClone():Ae._showClone(this),ne&&!F?G.appendChild(t):Z.parentNode.insertBefore(t,ne?F:Z),e=t.parentNode,At!==void 0&&!A&&(T=xe(At-Te(Z)[Je==="vertical"?"top":"left"])),mt(),!xt&&this._animate(le,Z),this._animate(de,t),rt()}if(G.contains(t))return rt()}return Q&&!z.rootEl&&He(G,z,"_onDragOver"),!1},_animate:function(z,G){var Z=this.options.animation;if(Z){var de=Te(G);if(G===t&&(j=de),z.nodeType===1&&(z=Te(z)),z.left+z.width/2!==de.left+de.width/2||z.top+z.height/2!==de.top+de.height/2){var le=er(this.el),Ce=le&&le.a,Se=le&&le.d;qe(G,"transition","none"),qe(G,"transform","translate3d("+(z.left-de.left)/(Ce||1)+"px,"+(z.top-de.top)/(Se||1)+"px,0)"),M=G.offsetWidth,qe(G,"transition","transform "+Z+"ms"+(this.options.easing?" "+this.options.easing:"")),qe(G,"transform","translate3d(0,0,0)")}typeof G.animated=="number"&&clearTimeout(G.animated),G.animated=W(function(){qe(G,"transition",""),qe(G,"transform",""),G.animated=!1},Z)}},_offUpEvents:function(){var z=this.el.ownerDocument;Ge(te,"touchmove",this._onTouchMove),Ge(te,"pointermove",this._onTouchMove),Ge(z,"mouseup",this._onDrop),Ge(z,"touchend",this._onDrop),Ge(z,"pointerup",this._onDrop),Ge(z,"touchcancel",this._onDrop),Ge(te,"selectstart",this)},_onDrop:function(z){var G=this.el,Z=this.options;C=!1,k=!1,A=!1,I=!1,clearInterval(this._loopId),clearInterval(_),ot(),Kt(),clearTimeout(this._dragStartTimer),Ee(this._cloneId),Ee(this._dragStartId),Ge(te,"mousemove",this._onTouchMove),this.nativeDraggable&&(Ge(te,"drop",this),Ge(G,"dragstart",this._onDragStart),Ge(te,"dragover",this._handleAutoScroll),Ge(te,"dragover",ve)),this._offUpEvents(),z&&(w&&(z.cancelable&&z.preventDefault(),!Z.dropBubble&&z.stopPropagation()),i&&i.parentNode&&i.parentNode.removeChild(i),(o===e||b&&b.lastPutMode!=="clone")&&n&&n.parentNode&&n.parentNode.removeChild(n),t&&(this.nativeDraggable&&Ge(t,"dragend",this),et(t),t.style["will-change"]="",Qe(t,b?b.options.ghostClass:this.options.ghostClass,!1),Qe(t,this.options.chosenClass,!1),De(this,o,"unchoose",t,e,o,h,null,z),o!==e?(p=Nt(t,Z.draggable),p>=0&&(De(null,e,"add",t,e,o,h,p,z),De(this,o,"remove",t,e,o,h,p,z),De(null,e,"sort",t,e,o,h,p,z),De(this,o,"sort",t,e,o,h,p,z)),b&&b.save()):t.nextSibling!==a&&(p=Nt(t,Z.draggable),p>=0&&(De(this,o,"update",t,e,o,h,p,z),De(this,o,"sort",t,e,o,h,p,z))),Me.active&&((p==null||p===-1)&&(p=h),De(this,o,"end",t,e,o,h,p,z),this.save()))),this._nulling()},_nulling:function(){o=t=e=i=a=n=s=l=u=v.length=_=m=y=x=S=w=p=h=E=L=M=j=b=g=Me.active=null,Be.forEach(function(z){z.checked=!0}),Be.length=0},handleEvent:function(z){switch(z.type){case"drop":case"dragend":this._onDrop(z);break;case"dragenter":case"dragover":t&&(this._onDragOver(z),Ft(z));break;case"selectstart":z.preventDefault();break}},toArray:function(){for(var z=[],G,Z=this.el.children,de=0,le=Z.length,Ce=this.options;de<le;de++)G=Z[de],yt(G,Ce.draggable,this.el,!1)&&z.push(G.getAttribute(Ce.dataIdAttr)||xr(G));return z},sort:function(z){var G={},Z=this.el;this.toArray().forEach(function(de,le){var Ce=Z.children[le];yt(Ce,this.options.draggable,Z,!1)&&(G[de]=Ce)},this),z.forEach(function(de){G[de]&&(Z.removeChild(G[de]),Z.appendChild(G[de]))})},save:function(){var z=this.options.store;z&&z.set&&z.set(this)},closest:function(z,G){return yt(z,G||this.options.draggable,this.el,!1)},option:function(z,G){var Z=this.options;if(G===void 0)return Z[z];Z[z]=G,z==="group"&&ce(Z)},destroy:function(){var z=this.el;z[U]=null,Ge(z,"mousedown",this._onTapStart),Ge(z,"touchstart",this._onTapStart),Ge(z,"pointerdown",this._onTapStart),this.nativeDraggable&&(Ge(z,"dragover",this),Ge(z,"dragenter",this)),Array.prototype.forEach.call(z.querySelectorAll("[draggable]"),function(G){G.removeAttribute("draggable")}),this._onDrop(),d.splice(d.indexOf(this.el),1),this.el=z=null},_hideClone:function(){n.cloneHidden||(qe(n,"display","none"),n.cloneHidden=!0,n.parentNode&&this.options.removeCloneOnHide&&n.parentNode.removeChild(n))},_showClone:function(z){if(z.lastPutMode!=="clone"){this._hideClone();return}n.cloneHidden&&(o.contains(t)&&!this.options.group.revertClone?o.insertBefore(n,t):a?o.insertBefore(n,a):o.appendChild(n),this.options.group.revertClone&&this._animate(t,n),qe(n,"display",""),n.cloneHidden=!1)}};function yt(z,G,Z,de){if(z){Z=Z||te;do{if(G!=null&&(G[0]===">"&&z.parentNode===Z&&ir(z,G.substring(1))||ir(z,G))||de&&z===Z)return z;if(z===Z)break}while(z=Wt(z))}return null}function Wt(z){return z.host&&z!==te&&z.host.nodeType?z.host:z.parentNode}function Ft(z){z.dataTransfer&&(z.dataTransfer.dropEffect="move"),z.cancelable&&z.preventDefault()}function Ye(z,G,Z){z.addEventListener(G,Z,ie)}function Ge(z,G,Z){z.removeEventListener(G,Z,ie)}function Qe(z,G,Z){if(z&&G)if(z.classList)z.classList[Z?"add":"remove"](G);else{var de=(" "+z.className+" ").replace(J," ").replace(" "+G+" "," ");z.className=(de+(Z?" "+G:"")).replace(J," ")}}function qe(z,G,Z){var de=z&&z.style;if(de){if(Z===void 0)return te.defaultView&&te.defaultView.getComputedStyle?Z=te.defaultView.getComputedStyle(z,""):z.currentStyle&&(Z=z.currentStyle),G===void 0?Z:Z[G];!(G in de)&&G.indexOf("webkit")===-1&&(G="-webkit-"+G),de[G]=Z+(typeof Z=="string"?"":"px")}}function er(z){var G="";do{var Z=qe(z,"transform");Z&&Z!=="none"&&(G=Z+" "+G)}while(z=z.parentNode);if(window.DOMMatrix)return new DOMMatrix(G);if(window.WebKitCSSMatrix)return new WebKitCSSMatrix(G);if(window.CSSMatrix)return new CSSMatrix(G)}function dt(z,G,Z){if(z){var de=z.getElementsByTagName(G),le=0,Ce=de.length;if(Z)for(;le<Ce;le++)Z(de[le],le);return de}return[]}function De(z,G,Z,de,le,Ce,Se,Re,Ae){z=z||G[U];var $e,We=z.options,Fe="on"+Z.charAt(0).toUpperCase()+Z.substr(1);window.CustomEvent&&!Q&&!ee?$e=new CustomEvent(Z,{bubbles:!0,cancelable:!0}):($e=te.createEvent("Event"),$e.initEvent(Z,!0,!0)),$e.to=le||G,$e.from=Ce||G,$e.item=de||G,$e.clone=n,$e.oldIndex=Se,$e.newIndex=Re,$e.originalEvent=Ae,G&&G.dispatchEvent($e),We[Fe]&&We[Fe].call(z,$e)}function tr(z,G,Z,de,le,Ce,Se,Re){var Ae,$e=z[U],We=$e.options.onMove,Fe;return window.CustomEvent&&!Q&&!ee?Ae=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(Ae=te.createEvent("Event"),Ae.initEvent("move",!0,!0)),Ae.to=G,Ae.from=z,Ae.dragged=Z,Ae.draggedRect=de,Ae.related=le||G,Ae.relatedRect=Ce||Te(G),Ae.willInsertAfter=Re,Ae.originalEvent=Se,z.dispatchEvent(Ae),We&&(Fe=We.call($e,Ae,Se)),Fe}function et(z){z.draggable=!1}function rr(){Le=!1}function It(z,G,Z){for(var de=0,le=0,Ce=z.children;le<Ce.length;){if(Ce[le].style.display!=="none"&&Ce[le]!==i&&Ce[le]!==t&&yt(Ce[le],Z.draggable,z,!1)){if(de===G)return Ce[le];de++}le++}return null}function dr(z){for(var G=z.lastElementChild;(G===i||G.style.display==="none")&&(G=G.previousElementSibling,!!G););return G||null}function pt(z,G,Z){var de=Te(dr(Z)),le=G==="vertical"?z.clientY:z.clientX,Ce=G==="vertical"?z.clientX:z.clientY,Se=G==="vertical"?de.bottom:de.right,Re=G==="vertical"?de.left:de.top,Ae=G==="vertical"?de.right:de.bottom,$e=10;return G==="vertical"?Ce>Ae+$e||Ce<=Ae&&le>Se&&Ce>=Re:le>Se&&Ce>Re||le<=Se&&Ce>Ae+$e}function Lt(z,G,Z,de,le,Ce,Se){var Re=Te(G),Ae=Z==="vertical"?z.clientY:z.clientX,$e=Z==="vertical"?Re.height:Re.width,We=Z==="vertical"?Re.top:Re.left,Fe=Z==="vertical"?Re.bottom:Re.right,rt=Te(t),mt=!1;if(!Ce){if(Se&&T<$e*de)if(!I&&(L===1?Ae>We+$e*le/2:Ae<Fe-$e*le/2)&&(I=!0),I)mt=!0;else{var Je=Z==="vertical"?rt.top:rt.left,Ue=Z==="vertical"?rt.bottom:rt.right;if(L===1?Ae<We+T:Ae>Fe-T)return L*-1}else if(Ae>We+$e*(1-de)/2&&Ae<Fe-$e*(1-de)/2)return Ae>We+$e/2?-1:1}return mt=mt||Ce,mt&&(Ae<We+$e*le/2||Ae>Fe-$e*le/2)?Ae>We+$e/2?1:-1:0}function Xt(z,G){var Z=Nt(t,G.draggable),de=Nt(z,G.draggable);return Z<de?1:-1}function xr(z){for(var G=z.tagName+z.className+z.src+z.href+z.textContent,Z=G.length,de=0;Z--;)de+=G.charCodeAt(Z);return de.toString(36)}function Nt(z,G){var Z=0;if(!z||!z.parentNode)return-1;for(;z&&(z=z.previousElementSibling);)z.nodeName.toUpperCase()!=="TEMPLATE"&&z!==n&&Z++;return Z}function ir(z,G){if(z)try{if(z.matches)return z.matches(G);if(z.msMatchesSelector)return z.msMatchesSelector(G);if(z.webkitMatchesSelector)return z.webkitMatchesSelector(G)}catch(Z){return!1}return!1}var Pt;function hr(z,G){return function(){if(!Pt){var Z=arguments,de=this;Pt=W(function(){Z.length===1?z.call(de,Z[0]):z.apply(de,Z),Pt=void 0},G)}}}function Kt(){clearTimeout(Pt),Pt=void 0}function nr(z,G){if(z&&G)for(var Z in G)G.hasOwnProperty(Z)&&(z[Z]=G[Z]);return z}function Tt(z){return re&&re.dom?re.dom(z).cloneNode(!0):Y?Y(z).clone(!0)[0]:z.cloneNode(!0)}function Et(z){Be.length=0;for(var G=z.getElementsByTagName("input"),Z=G.length;Z--;){var de=G[Z];de.checked&&Be.push(de)}}function wt(z){return W(z,0)}function Ee(z){return clearTimeout(z)}function Te(z,G,Z){if(!(!z.getBoundingClientRect&&z!==H)){var de,le,Ce,Se,Re,Ae,$e;if(z!==H?(de=z.getBoundingClientRect(),le=de.top,Ce=de.left,Se=de.bottom,Re=de.right,Ae=de.height,$e=de.width):(le=0,Ce=0,Se=window.innerHeight,Re=window.innerWidth,Ae=window.innerHeight,$e=window.innerWidth),Z&&z!==H){if(G=G||z.parentNode,!Q)do if(G&&G.getBoundingClientRect&&qe(G,"transform")!=="none"){var We=G.getBoundingClientRect();le-=We.top+ae(qe(G,"border-top-width")),Ce-=We.left+ae(qe(G,"border-left-width")),Se=le+de.height,Re=Ce+de.width;break}while(G=G.parentNode);var Fe=er(z),rt=Fe&&Fe.a,mt=Fe&&Fe.d;Fe&&(le/=mt,Ce/=rt,$e/=rt,Ae/=mt,Se=le+Ae,Re=Ce+$e)}return{top:le,left:Ce,bottom:Se,right:Re,width:$e,height:Ae}}}function ze(z,G){for(var Z=Ke(Z,!0),de=Te(z)[G];Z;){var le=Te(Z)[G],Ce;if(G==="top"||G==="left"?Ce=de>=le:Ce=de<=le,!Ce)return!0;if(Z===H)break;Z=Ke(Z,!1)}return!1}return Ye(te,"touchmove",function(z){(Me.active||C)&&z.cancelable&&z.preventDefault()}),Me.utils={on:Ye,off:Ge,css:qe,find:dt,is:function(z,G){return!!yt(z,G,z,!1)},extend:nr,throttle:hr,closest:yt,toggleClass:Qe,clone:Tt,index:Nt,nextTick:wt,cancelNextTick:Ee,detectDirection:Pe,getChild:It},Me.create=function(z,G){return new Me(z,G)},Me.version="1.8.3",Me})});var Qf=ye((C8,Zf)=>{"use strict";function dk(r){return r&&typeof r=="object"&&"default"in r?r.default:r}var fk=dk(Of());function ue(r,t){return typeof r=="string"?(t||document).querySelector(r):r||null}ue.each=(r,t)=>typeof r=="string"?Array.from((t||document).querySelectorAll(r)):r||null;ue.create=(r,t)=>{let e=document.createElement(r);for(let i in t){let n=t[i];if(i==="inside")ue(n).appendChild(e);else if(i==="around"){let o=ue(n);o.parentNode.insertBefore(e,o),e.appendChild(o)}else i==="styles"?typeof n=="object"&&Object.keys(n).map(o=>{e.style[o]=n[o]}):i in e?e[i]=n:e.setAttribute(i,n)}return e};ue.on=(r,t,e,i)=>{i?ue.delegate(r,t,e,i):(i=e,ue.bind(r,t,i))};ue.off=(r,t,e)=>{r.removeEventListener(t,e)};ue.bind=(r,t,e)=>{t.split(/\s+/).forEach(function(i){r.addEventListener(i,e)})};ue.delegate=(r,t,e,i)=>{r.addEventListener(t,function(n){let o=n.target.closest(e);o&&(n.delegatedTarget=o,i.call(this,n,o))})};ue.unbind=(r,t)=>{if(r)for(let e in t){let i=t[e];e.split(/\s+/).forEach(function(n){r.removeEventListener(n,i)})}};ue.fire=(r,t,e)=>{let i=document.createEvent("HTMLEvents");i.initEvent(t,!0,!0);for(let n in e)i[n]=e[n];return r.dispatchEvent(i)};ue.data=(r,t)=>{if(!t)return r.dataset;for(let e in t)r.dataset[e]=t[e]};ue.style=(r,t)=>{if(typeof t=="string")return ue.getStyle(r,t);Array.isArray(r)||(r=[r]),r.map(e=>{for(let i in t)e.style[i]=t[i]})};ue.removeStyle=(r,t)=>{Array.isArray(r)||(r=[r]),Array.isArray(t)||(t=[t]),r.map(e=>{for(let i of t)e.style[i]=""})};ue.getStyle=(r,t)=>{if(!t)return getComputedStyle(r);let e=getComputedStyle(r)[t];return["width","height"].includes(t)&&(e=parseFloat(e)),e};ue.closest=(r,t)=>t?t.matches(r)?t:ue.closest(r,t.parentNode):null;ue.inViewport=(r,t)=>{let{top:e,left:i,bottom:n,right:o}=r.getBoundingClientRect(),{top:a,left:s,bottom:l,right:u}=t.getBoundingClientRect();return e>=a&&i>=s&&n<=l&&o<=u};ue.scrollTop=function(t,e){requestAnimationFrame(()=>{t.scrollTop=e})};ue.scrollbarSize=function(){return ue.scrollBarSizeValue||(ue.scrollBarSizeValue=pk()),ue.scrollBarSizeValue};function pk(){let r=document.createElement("div");ue.style(r,{width:"100px",height:"100px",overflow:"scroll",position:"absolute",top:"-9999px"}),document.body.appendChild(r);let t=r.offsetWidth-r.clientWidth;return document.body.removeChild(r),t}ue.hasVerticalOverflow=function(r){return r.scrollHeight>r.offsetHeight+10};ue.hasHorizontalOverflow=function(r){return r.scrollWidth>r.offsetWidth+10};ue.measureTextWidth=function(r){let t=document.createElement("div");return t.style.position="absolute",t.style.visibility="hidden",t.style.height="auto",t.style.width="auto",t.style.whiteSpace="nowrap",t.innerText=r,document.body.appendChild(t),t.clientWidth+1};function hk(r){var t=typeof r;return r!=null&&(t=="object"||t=="function")}var Kr=hk,Mn=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function Nn(){throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}function _k(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function mk(r,t){return t={exports:{}},r(t,t.exports),t.exports}var gk=typeof Mn=="object"&&Mn&&Mn.Object===Object&&Mn,vk=gk,bk=typeof self=="object"&&self&&self.Object===Object&&self,yk=vk||bk||Function("return this")(),Ri=yk,wk=function(){return Ri.Date.now()},sa=wk,kk=Ri.Symbol,jn=kk,Df=Object.prototype,xk=Df.hasOwnProperty,Ck=Df.toString,Ei=jn?jn.toStringTag:void 0;function Sk(r){var t=xk.call(r,Ei),e=r[Ei];try{r[Ei]=void 0}catch(n){}var i=Ck.call(r);return t?r[Ei]=e:delete r[Ei],i}var Tk=Sk,Ek=Object.prototype,Ak=Ek.toString;function $k(r){return Ak.call(r)}var Ok=$k,Rk="[object Null]",Lk="[object Undefined]",Rf=jn?jn.toStringTag:void 0;function Bk(r){return r==null?r===void 0?Lk:Rk:Rf&&Rf in Object(r)?Tk(r):Ok(r)}var jf=Bk;function Ik(r){return r!=null&&typeof r=="object"}var Mk=Ik,Nk="[object Symbol]";function Pk(r){return typeof r=="symbol"||Mk(r)&&jf(r)==Nk}var Dk=Pk,Lf=0/0,jk=/^\s+|\s+$/g,zk=/^[-+]0x[0-9a-f]+$/i,Fk=/^0b[01]+$/i,Hk=/^0o[0-7]+$/i,qk=parseInt;function Uk(r){if(typeof r=="number")return r;if(Dk(r))return Lf;if(Kr(r)){var t=typeof r.valueOf=="function"?r.valueOf():r;r=Kr(t)?t+"":t}if(typeof r!="string")return r===0?r:+r;r=r.replace(jk,"");var e=Fk.test(r);return e||Hk.test(r)?qk(r.slice(2),e?2:8):zk.test(r)?Lf:+r}var Bf=Uk,Wk="Expected a function",Vk=Math.max,Yk=Math.min;function Gk(r,t,e){var i,n,o,a,s,l,u=0,c=!1,h=!1,p=!0;if(typeof r!="function")throw new TypeError(Wk);t=Bf(t)||0,Kr(e)&&(c=!!e.leading,h="maxWait"in e,o=h?Vk(Bf(e.maxWait)||0,t):o,p="trailing"in e?!!e.trailing:p);function g(y){var x=i,S=n;return i=n=void 0,u=y,a=r.apply(S,x),a}function b(y){return u=y,s=setTimeout(C,t),c?g(y):a}function v(y){var x=y-l,S=y-u,w=t-x;return h?Yk(w,o-S):w}function k(y){var x=y-l,S=y-u;return l===void 0||x>=t||x<0||h&&S>=o}function C(){var y=sa();if(k(y))return O(y);s=setTimeout(C,v(y))}function O(y){return s=void 0,p&&i?g(y):(i=n=void 0,a)}function d(){s!==void 0&&clearTimeout(s),u=0,i=l=n=s=void 0}function _(){return s===void 0?a:O(sa())}function m(){var y=sa(),x=k(y);if(i=arguments,n=this,l=y,x){if(s===void 0)return b(l);if(h)return s=setTimeout(C,t),g(l)}return s===void 0&&(s=setTimeout(C,t)),a}return m.cancel=d,m.flush=_,m}var zf=Gk,Xk="Expected a function";function Kk(r,t,e){var i=!0,n=!0;if(typeof r!="function")throw new TypeError(Xk);return Kr(e)&&(i="leading"in e?!!e.leading:i,n="trailing"in e?!!e.trailing:n),zf(r,t,{leading:i,maxWait:t,trailing:n})}var Jk=Kk,Zk="[object AsyncFunction]",Qk="[object Function]",e1="[object GeneratorFunction]",t1="[object Proxy]";function r1(r){if(!Kr(r))return!1;var t=jf(r);return t==Qk||t==e1||t==Zk||t==t1}var i1=r1,n1=Ri["__core-js_shared__"],la=n1,If=function(){var r=/[^.]+$/.exec(la&&la.keys&&la.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}();function o1(r){return!!If&&If in r}var a1=o1,s1=Function.prototype,l1=s1.toString;function c1(r){if(r!=null){try{return l1.call(r)}catch(t){}try{return r+""}catch(t){}}return""}var u1=c1,d1=/[\\^$.*+?()[\]{}|]/g,f1=/^\[object .+?Constructor\]$/,p1=Function.prototype,h1=Object.prototype,_1=p1.toString,m1=h1.hasOwnProperty,g1=RegExp("^"+_1.call(m1).replace(d1,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function v1(r){if(!Kr(r)||a1(r))return!1;var t=i1(r)?g1:f1;return t.test(u1(r))}var b1=v1;function y1(r,t){return r==null?void 0:r[t]}var w1=y1;function k1(r,t){var e=w1(r,t);return b1(e)?e:void 0}var fa=k1,x1=fa(Object,"create"),Oi=x1;function C1(){this.__data__=Oi?Oi(null):{},this.size=0}var S1=C1;function T1(r){var t=this.has(r)&&delete this.__data__[r];return this.size-=t?1:0,t}var E1=T1,A1="__lodash_hash_undefined__",$1=Object.prototype,O1=$1.hasOwnProperty;function R1(r){var t=this.__data__;if(Oi){var e=t[r];return e===A1?void 0:e}return O1.call(t,r)?t[r]:void 0}var L1=R1,B1=Object.prototype,I1=B1.hasOwnProperty;function M1(r){var t=this.__data__;return Oi?t[r]!==void 0:I1.call(t,r)}var N1=M1,P1="__lodash_hash_undefined__";function D1(r,t){var e=this.__data__;return this.size+=this.has(r)?0:1,e[r]=Oi&&t===void 0?P1:t,this}var j1=D1;function Jr(r){var t=-1,e=r==null?0:r.length;for(this.clear();++t<e;){var i=r[t];this.set(i[0],i[1])}}Jr.prototype.clear=S1;Jr.prototype.delete=E1;Jr.prototype.get=L1;Jr.prototype.has=N1;Jr.prototype.set=j1;var Mf=Jr;function z1(){this.__data__=[],this.size=0}var F1=z1;function H1(r,t){return r===t||r!==r&&t!==t}var q1=H1;function U1(r,t){for(var e=r.length;e--;)if(q1(r[e][0],t))return e;return-1}var Fn=U1,W1=Array.prototype,V1=W1.splice;function Y1(r){var t=this.__data__,e=Fn(t,r);if(e<0)return!1;var i=t.length-1;return e==i?t.pop():V1.call(t,e,1),--this.size,!0}var G1=Y1;function X1(r){var t=this.__data__,e=Fn(t,r);return e<0?void 0:t[e][1]}var K1=X1;function J1(r){return Fn(this.__data__,r)>-1}var Z1=J1;function Q1(r,t){var e=this.__data__,i=Fn(e,r);return i<0?(++this.size,e.push([r,t])):e[i][1]=t,this}var ex=Q1;function Zr(r){var t=-1,e=r==null?0:r.length;for(this.clear();++t<e;){var i=r[t];this.set(i[0],i[1])}}Zr.prototype.clear=F1;Zr.prototype.delete=G1;Zr.prototype.get=K1;Zr.prototype.has=Z1;Zr.prototype.set=ex;var tx=Zr,rx=fa(Ri,"Map"),ix=rx;function nx(){this.size=0,this.__data__={hash:new Mf,map:new(ix||tx),string:new Mf}}var ox=nx;function ax(r){var t=typeof r;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?r!=="__proto__":r===null}var sx=ax;function lx(r,t){var e=r.__data__;return sx(t)?e[typeof t=="string"?"string":"hash"]:e.map}var Hn=lx;function cx(r){var t=Hn(this,r).delete(r);return this.size-=t?1:0,t}var ux=cx;function dx(r){return Hn(this,r).get(r)}var fx=dx;function px(r){return Hn(this,r).has(r)}var hx=px;function _x(r,t){var e=Hn(this,r),i=e.size;return e.set(r,t),this.size+=e.size==i?0:1,this}var mx=_x;function Qr(r){var t=-1,e=r==null?0:r.length;for(this.clear();++t<e;){var i=r[t];this.set(i[0],i[1])}}Qr.prototype.clear=ox;Qr.prototype.delete=ux;Qr.prototype.get=fx;Qr.prototype.has=hx;Qr.prototype.set=mx;var gx=Qr,vx="__lodash_hash_undefined__";function bx(r){return this.__data__.set(r,vx),this}var yx=bx;function wx(r){return this.__data__.has(r)}var kx=wx;function zn(r){var t=-1,e=r==null?0:r.length;for(this.__data__=new gx;++t<e;)this.add(r[t])}zn.prototype.add=zn.prototype.push=yx;zn.prototype.has=kx;var xx=zn;function Cx(r,t,e,i){for(var n=r.length,o=e+(i?1:-1);i?o--:++o<n;)if(t(r[o],o,r))return o;return-1}var Sx=Cx;function Tx(r){return r!==r}var Ex=Tx;function Ax(r,t,e){for(var i=e-1,n=r.length;++i<n;)if(r[i]===t)return i;return-1}var $x=Ax;function Ox(r,t,e){return t===t?$x(r,t,e):Sx(r,Ex,e)}var Rx=Ox;function Lx(r,t){var e=r==null?0:r.length;return!!e&&Rx(r,t,0)>-1}var Bx=Lx;function Ix(r,t,e){for(var i=-1,n=r==null?0:r.length;++i<n;)if(e(t,r[i]))return!0;return!1}var Mx=Ix;function Nx(r,t){return r.has(t)}var Px=Nx,Dx=fa(Ri,"Set"),ca=Dx;function jx(){}var zx=jx;function Fx(r){var t=-1,e=Array(r.size);return r.forEach(function(i){e[++t]=i}),e}var Ff=Fx,Hx=1/0,qx=ca&&1/Ff(new ca([,-0]))[1]==Hx?function(r){return new ca(r)}:zx,Ux=qx,Wx=200;function Vx(r,t,e){var i=-1,n=Bx,o=r.length,a=!0,s=[],l=s;if(e)a=!1,n=Mx;else if(o>=Wx){var u=t?null:Ux(r);if(u)return Ff(u);a=!1,n=Px,l=new xx}else l=t?[]:s;e:for(;++i<o;){var c=r[i],h=t?t(c):c;if(c=e||c!==0?c:0,a&&h===h){for(var p=l.length;p--;)if(l[p]===h)continue e;t&&l.push(h),s.push(c)}else n(l,h,e)||(l!==s&&l.push(h),s.push(c))}return s}var Yx=Vx;function Gx(r){return r&&r.length?Yx(r):[]}var Xx=Gx;function Hf(r){return r.replace(/([A-Z])/g,t=>`-${t[0].toLowerCase()}`)}function ua(r){return Object.keys(r).map(e=>{let i=Hf(e),n=r[e];return n===void 0?"":`data-${i}="${n}" `}).join("").trim()}function Nf(r){var t=document.createElement("textarea");t.style.position="fixed",t.style.top=0,t.style.left=0,t.style.width="2em",t.style.height="2em",t.style.padding=0,t.style.border="none",t.style.outline="none",t.style.boxShadow="none",t.style.background="transparent",t.value=r,document.body.appendChild(t),t.select();try{document.execCommand("copy")}catch(e){console.log("Oops, unable to copy")}document.body.removeChild(t)}function Kx(r){return!isNaN(r)}var qf=Jk,Jx=zf;function $i(r,t=null){return(...e)=>new Promise(i=>{setTimeout(()=>{let o=r.apply(t,e);i(o)})})}function qn(r,t,e){let i=e.reduce((n,o)=>(n[o]={get(){return t[o]}},n),{});Object.defineProperties(r,i)}function Zx(r){return r!==void 0||r!==null}function Qx(r){return!Zx(r)}function Pn(r){return!isNaN(r)}function eC(r){return Array.isArray(r)?r:[r]}function Pf(r){return Xx(r)}function Ai(r,t){return r-t}function tC(r){return r.replace(/<[^>]*>/g,"")}function rC(r,t){return r&&(Object.keys(t).forEach(e=>{let i=new RegExp(`{(${e})}`,"g");r=r.replace(i,t[e])}),r)}var Uf=class{constructor(t){this.options=t,this.sortRows=$i(this.sortRows,this),this.switchColumn=$i(this.switchColumn,this),this.removeColumn=$i(this.removeColumn,this),this.options.filterRows=$i(this.options.filterRows,this)}init(t,e){t||(t=this.options.data),e&&(this.options.columns=e),this.data=t,this.rowCount=0,this.columns=[],this.rows=[],this.prepareColumns(),this.prepareRows(),this.prepareTreeRows(),this.prepareRowView(),this.prepareNumericColumns()}get currentSort(){return this.columns.find(e=>e.sortOrder!=="none")||{colIndex:-1,sortOrder:"none"}}prepareColumns(){this.columns=[],this.validateColumns(),this.prepareDefaultColumns(),this.prepareHeader()}prepareDefaultColumns(){if(this.options.checkboxColumn&&!this.hasColumnById("_checkbox")){let t={id:"_checkbox",content:this.getCheckboxHTML(),editable:!1,resizable:!1,sortable:!1,focusable:!1,dropdown:!1,width:32};this.columns.push(t)}if(this.options.serialNoColumn&&!this.hasColumnById("_rowIndex")){let t={id:"_rowIndex",content:"",align:"center",editable:!1,resizable:!1,focusable:!1,dropdown:!1};this.columns.push(t)}}prepareHeader(){let t=this.columns.concat(this.options.columns),e={isHeader:1,editable:!0,sortable:!0,resizable:!0,focusable:!0,dropdown:!0,width:null,format:i=>i==null?"":i+""};this.columns=t.map((i,n)=>this.prepareCell(i,n)).map(i=>Object.assign({},e,i)).map(i=>(i.content=i.content||i.name||"",i.id=i.id||i.content,i))}prepareCell(t,e){let i={content:"",sortOrder:"none",colIndex:e,column:this.columns[e]};return t!==null&&typeof t=="object"?Object.assign(i,t):i.content=t,i}prepareNumericColumns(){let t=this.getRow(0);!t||(this.columns=this.columns.map((e,i)=>{let n=t[i].content;return!e.align&&Kx(n)&&(e.align="right"),e}))}prepareRows(){this.validateData(this.data),this.rows=this.data.map((t,e)=>{let i=this._getNextRowCount(),n=[],o={rowIndex:i};if(Array.isArray(t))for(this.options.checkboxColumn&&n.push(this.getCheckboxHTML()),this.options.serialNoColumn&&n.push(i+1+""),n=n.concat(t);n.length<this.columns.length;)n.push("");else{for(let a of this.columns)a.id==="_checkbox"?n.push(this.getCheckboxHTML()):a.id==="_rowIndex"?n.push(i+1+""):n.push(t[a.id]);o.indent=t.indent||0}return this.prepareRow(n,o)})}prepareTreeRows(){this.rows.forEach((t,e)=>{if(Pn(t.meta.indent)){let i=this.getRow(e+1);t.meta.isLeaf=!i||Qx(i.meta.indent)||i.meta.indent<=t.meta.indent,t.meta.isTreeNodeClose=!1}})}prepareRowView(){this.rowViewOrder=this.rows.map(t=>t.meta.rowIndex)}prepareRow(t,e){let i={rowIndex:e.rowIndex,indent:e.indent};return t=t.map((n,o)=>this.prepareCell(n,o)).map(n=>Object.assign({},i,n)),t.meta=e,t}validateColumns(){let t=this.options.columns;if(!Array.isArray(t))throw new Dn("`columns` must be an array");t.forEach((e,i)=>{if(typeof e!="string"&&typeof e!="object")throw new Dn(`column "${i}" must be a string or an object`)})}validateData(t){if(Array.isArray(t)&&(t.length===0||Array.isArray(t[0])||typeof t[0]=="object"))return!0;throw new Dn("`data` must be an array of arrays or objects")}appendRows(t){this.validateData(t),this.rows.push(...this.prepareRows(t))}sortRows(t,e="none"){t=+t,this.getColumns().map(i=>{i.colIndex===t?i.sortOrder=e:i.sortOrder="none"}),this._sortRows(t,e)}_sortRows(t,e){if(this.currentSort.colIndex===t&&(this.currentSort.sortOrder==="asc"&&e==="desc"||this.currentSort.sortOrder==="desc"&&e==="asc")){this.reverseArray(this.rowViewOrder),this.currentSort.sortOrder=e;return}if(this.rowViewOrder.sort((i,n)=>{let o=i,a=n,s=this.getCell(t,i).content,l=this.getCell(t,n).content;if(s=s==null?"":s,l=l==null?"":l,e==="none")return o-a;if(e==="asc"){if(s<l)return-1;if(s>l)return 1;if(s===l)return 0}else if(e==="desc"){if(s<l)return 1;if(s>l)return-1;if(s===l)return 0}return 0}),this.hasColumnById("_rowIndex")){let i=this.getColumnIndexById("_rowIndex");this.rows.forEach((n,o)=>{let a=this.rowViewOrder.indexOf(o),s=n[i];s.content=a+1+""})}}reverseArray(t){let e=null,i=null,n=t.length;for(e=0,i=n-1;e<i;e+=1,i-=1){let o=t[e];t[e]=t[i],t[i]=o}}switchColumn(t,e){let i=this.columns[t];this.columns[t]=this.columns[e],this.columns[e]=i,this.columns[t].colIndex=t,this.columns[e].colIndex=e,this.rows.forEach(n=>{let o=Object.assign({},n[t],{colIndex:e}),a=Object.assign({},n[e],{colIndex:t});n[e]=o,n[t]=a})}removeColumn(t){t=+t;let e=n=>n.colIndex!==t,i=(n,o)=>Object.assign({},n,{colIndex:o});this.columns=this.columns.filter(e).map(i),this.rows.forEach(n=>{n.splice(t,1),n.forEach((o,a)=>{o.colIndex=a})})}updateRow(t,e){t.length<this.columns.length&&(this.hasColumnById("_rowIndex")&&(t=[e+1+""].concat(t)),this.hasColumnById("_checkbox")&&(t=['<input type="checkbox" />'].concat(t)));let i=this.prepareRow(t,{rowIndex:e}),n=this.rows.findIndex(o=>o[0].rowIndex===e);return this.rows[n]=i,i}updateCell(t,e,i){let n;typeof t=="object"&&(n=t,t=n.colIndex,e=n.rowIndex,i=n),n=this.getCell(t,e);for(let o in i){let a=i[o];a!==void 0&&(n[o]=a)}return n}updateColumn(t,e){let i=this.getColumn(t);for(let n in e){let o=e[n];o!==void 0&&(i[n]=o)}return i}filterRows(t){return this.options.filterRows(this.rows,t).then(e=>(e||(e=this.getAllRowIndices()),e.then||(e=Promise.resolve(e)),e.then(i=>(this._filteredRows=i,{rowsToHide:this.getAllRowIndices().filter(o=>!i.includes(o)),rowsToShow:i}))))}getFilteredRowIndices(){return this._filteredRows||this.getAllRowIndices()}getAllRowIndices(){return this.rows.map(t=>t.meta.rowIndex)}getRowCount(){return this.rowCount}_getNextRowCount(){let t=this.rowCount;return this.rowCount++,t}getRows(t,e){return this.rows.slice(t,e)}getRowsForView(t,e){return this.rowViewOrder.map(n=>this.rows[n]).slice(t,e)}getColumns(t){let e=this.columns;return t&&(e=e.slice(this.getStandardColumnCount())),e}getStandardColumnCount(){return this.options.checkboxColumn&&this.options.serialNoColumn?2:this.options.checkboxColumn||this.options.serialNoColumn?1:0}getColumnCount(t){let e=this.columns.length;return t&&(e=e-this.getStandardColumnCount()),e}getColumn(t){return t=+t,t<0&&(t=this.columns.length+t),this.columns.find(e=>e.colIndex===t)}getColumnById(t){return this.columns.find(e=>e.id===t)}getRow(t){return t=+t,this.rows[t]}getCell(t,e){return e=+e,t=+t,this.getRow(e)[t]}getChildren(t){t=+t;let e=this.getRow(t).meta.indent,i=[];for(let n=t+1;n<this.rowCount;n++){let o=this.getRow(n);if(!isNaN(o.meta.indent)&&(o.meta.indent>e&&i.push(n),o.meta.indent===e))break}return i}getImmediateChildren(t){t=+t;let e=this.getRow(t).meta.indent,i=[],n=e+1;for(let o=t+1;o<this.rowCount;o++){let a=this.getRow(o);if(!(isNaN(a.meta.indent)||a.meta.indent>n)&&(a.meta.indent===n&&i.push(o),a.meta.indent===e))break}return i}get(){return{columns:this.columns,rows:this.rows}}getData(t){return this.data[t]}hasColumn(t){return Boolean(this.columns.find(e=>e.content===t))}hasColumnById(t){return Boolean(this.columns.find(e=>e.id===t))}getColumnIndex(t){return this.columns.findIndex(e=>e.content===t)}getColumnIndexById(t){return this.columns.findIndex(e=>e.id===t)}getCheckboxHTML(){return'<input type="checkbox" />'}},Dn=class extends TypeError{},da={chevronDown:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"></polyline></svg>',chevronRight:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"><polyline points="9 18 15 12 9 6"></polyline></svg>'},Wf=class{constructor(t){this.instance=t,qn(this,this.instance,["wrapper","options","style","header","bodyScrollable","columnmanager","rowmanager","datamanager","keyboard"]),this.bindEvents()}bindEvents(){this.bindFocusCell(),this.bindEditCell(),this.bindKeyboardSelection(),this.bindCopyCellContents(),this.bindMouseEvents(),this.bindTreeEvents()}bindFocusCell(){this.bindKeyboardNav()}bindEditCell(){this.$editingCell=null,ue.on(this.bodyScrollable,"dblclick",".dt-cell",(t,e)=>{this.activateEditing(e)}),this.keyboard.on("enter",()=>{this.$focusedCell&&!this.$editingCell?this.activateEditing(this.$focusedCell):this.$editingCell&&this.deactivateEditing()})}bindKeyboardNav(){let t=e=>{if(!this.$focusedCell||this.$editingCell)return!1;let i=this.$focusedCell,{rowIndex:n,colIndex:o}=ue.data(i);return e==="left"?i=this.getLeftMostCell$(n):e==="right"?i=this.getRightMostCell$(n):e==="up"?i=this.getTopMostCell$(o):e==="down"&&(i=this.getBottomMostCell$(o)),this.focusCell(i),!0};["left","right","up","down","tab","shift+tab"].map(e=>this.keyboard.on(e,()=>this.focusCellInDirection(e))),["left","right","up","down"].map(e=>this.keyboard.on(`ctrl+${e}`,()=>t(e))),this.keyboard.on("esc",()=>{this.deactivateEditing(!1),this.columnmanager.toggleFilter(!1)}),this.options.inlineFilters&&(this.keyboard.on("ctrl+f",e=>{let i=ue.closest(".dt-cell",e.target),{colIndex:n}=ue.data(i);return this.activateFilter(n),!0}),ue.on(this.header,"focusin",".dt-filter",()=>{this.unfocusCell(this.$focusedCell)}))}bindKeyboardSelection(){let t=e=>{let i=this.getSelectionCursor();return e==="left"?i=this.getLeftCell$(i):e==="right"?i=this.getRightCell$(i):e==="up"?i=this.getAboveCell$(i):e==="down"&&(i=this.getBelowCell$(i)),i};["left","right","up","down"].map(e=>this.keyboard.on(`shift+${e}`,()=>this.selectArea(t(e))))}bindCopyCellContents(){this.keyboard.on("ctrl+c",()=>{let t=this.copyCellContents(this.$focusedCell,this.$selectionCursor),e=this.instance.translate("{count} cells copied",{count:t});t&&this.instance.showToastMessage(e,2)}),this.options.pasteFromClipboard&&this.keyboard.on("ctrl+v",t=>(this.instance.pasteTarget.focus(),setTimeout(()=>{let e=this.instance.pasteTarget.value;this.instance.pasteTarget.value="",this.pasteContentInCell(e)},10),!1))}bindMouseEvents(){let t=null;ue.on(this.bodyScrollable,"mousedown",".dt-cell",i=>{t=!0,this.focusCell(ue(i.delegatedTarget))}),ue.on(this.bodyScrollable,"mouseup",()=>{t=!1});let e=i=>{!t||this.selectArea(ue(i.delegatedTarget))};ue.on(this.bodyScrollable,"mousemove",".dt-cell",qf(e,50))}bindTreeEvents(){ue.on(this.bodyScrollable,"click",".dt-tree-node__toggle",(t,e)=>{let i=ue.closest(".dt-cell",e),{rowIndex:n}=ue.data(i);i.classList.contains("dt-cell--tree-close")?this.rowmanager.openSingleNode(n):this.rowmanager.closeSingleNode(n)})}focusCell(t,{skipClearSelection:e=0,skipDOMFocus:i=0,skipScrollToCell:n=0}={}){if(!t||t===this.$editingCell)return;let{colIndex:o,isHeader:a}=ue.data(t);a||this.columnmanager.getColumn(o).focusable===!1||(n||this.scrollToCell(t),this.deactivateEditing(),e||this.clearSelection(),this.$focusedCell&&this.$focusedCell.classList.remove("dt-cell--focus"),this.$focusedCell=t,t.classList.add("dt-cell--focus"),i||t.focus(),this.highlightRowColumnHeader(t))}unfocusCell(t){!t||(t.classList.remove("dt-cell--focus"),this.$focusedCell=null,this.lastHeaders&&this.lastHeaders.forEach(e=>e&&e.classList.remove("dt-cell--highlight")))}highlightRowColumnHeader(t){let{colIndex:e,rowIndex:i}=ue.data(t),n=this.datamanager.getColumnIndexById("_rowIndex"),o=`.dt-cell--header-${e}`,a=`.dt-cell--${n}-${i}`;this.lastHeaders&&this.lastHeaders.forEach(u=>u&&u.classList.remove("dt-cell--highlight"));let s=ue(o,this.wrapper),l=ue(a,this.wrapper);this.lastHeaders=[s,l],this.lastHeaders.forEach(u=>u&&u.classList.add("dt-cell--highlight"))}selectAreaOnClusterChanged(){if(!(this.$focusedCell&&this.$selectionCursor))return;let{colIndex:t,rowIndex:e}=ue.data(this.$selectionCursor),i=this.getCell$(t,e);if(!i||i===this.$selectionCursor)return;let n=ue.data(this.$focusedCell);this.$focusedCell=this.getCell$(n.colIndex,n.rowIndex),this.selectArea(i)}focusCellOnClusterChanged(){if(!this.$focusedCell)return;let{colIndex:t,rowIndex:e}=ue.data(this.$focusedCell),i=this.getCell$(t,e);!i||this.focusCell(i,{skipClearSelection:1,skipDOMFocus:1,skipScrollToCell:1})}selectArea(t){!this.$focusedCell||this._selectArea(this.$focusedCell,t)&&(this.$selectionCursor=t)}_selectArea(t,e){if(t===e)return!1;let i=this.getCellsInRange(t,e);return i?(this.clearSelection(),this._selectedCells=i.map(n=>this.getCell$(...n)),requestAnimationFrame(()=>{this._selectedCells.map(n=>n.classList.add("dt-cell--highlight"))}),!0):!1}getCellsInRange(t,e){let i,n,o,a;if(typeof t=="number")[i,n,o,a]=arguments;else if(typeof t=="object"){if(!(t&&e))return!1;let h=ue.data(t),p=ue.data(e);i=+h.colIndex,n=+h.rowIndex,o=+p.colIndex,a=+p.rowIndex}if(n>a&&([n,a]=[a,n]),i>o&&([i,o]=[o,i]),this.isStandardCell(i)||this.isStandardCell(o))return!1;let s=[],l=i,u=n,c=[];for(;u<=a;)c.push(u),u+=1;return c.map(h=>{for(;l<=o;)s.push([l,h]),l++;l=i}),s}clearSelection(){(this._selectedCells||[]).forEach(t=>t.classList.remove("dt-cell--highlight")),this._selectedCells=[],this.$selectionCursor=null}getSelectionCursor(){return this.$selectionCursor||this.$focusedCell}activateEditing(t){this.focusCell(t);let{rowIndex:e,colIndex:i}=ue.data(t),n=this.columnmanager.getColumn(i);if(n&&(n.editable===!1||n.focusable===!1))return;let o=this.getCell(i,e);if(o&&o.editable===!1)return;if(this.$editingCell){let{_rowIndex:l,_colIndex:u}=ue.data(this.$editingCell);if(e===l&&i===u)return}this.$editingCell=t,t.classList.add("dt-cell--editing");let a=ue(".dt-cell__edit",t);a.innerHTML="";let s=this.getEditor(i,e,o.content,a);s&&(this.currentCellEditor=s,s.initValue(o.content,e,n))}deactivateEditing(t=!0){t&&this.submitEditing(),this.$focusedCell&&this.$focusedCell.focus(),this.$editingCell&&(this.$editingCell.classList.remove("dt-cell--editing"),this.$editingCell=null)}getEditor(t,e,i,n){let o=this.datamanager.getColumn(t),a=this.datamanager.getRow(e),s=this.datamanager.getData(e),l=this.options.getEditor?this.options.getEditor(t,e,i,n,o,a,s):this.getDefaultEditor(n);return l===!1?!1:(l===void 0&&(l=this.getDefaultEditor(n)),l)}getDefaultEditor(t){let e=ue.create("input",{class:"dt-input",type:"text",inside:t});return{initValue(i){e.focus(),e.value=i},getValue(){return e.value},setValue(i){e.value=i}}}submitEditing(){let t=Promise.resolve();if(!this.$editingCell)return t;let e=this.$editingCell,{rowIndex:i,colIndex:n}=ue.data(e),o=this.datamanager.getColumn(n);if(e){let a=this.currentCellEditor;if(a){let s=a.getValue();s.then||(s=Promise.resolve(s)),t=s.then(l=>{let u=this.getCell(n,i).content;if(u===l)return!1;let c=a.setValue(l,i,o);return this.updateCell(n,i,l),e.focus(),c&&c.then&&c.catch(h=>{console.log(h),this.updateCell(n,i,u)}),c})}}return this.currentCellEditor=null,t}copyCellContents(t,e){if(!e&&t){let{colIndex:a,rowIndex:s}=ue.data(t),l=this.getCell(a,s);return Nf(l.content),1}let i=this.getCellsInRange(t,e);if(!i)return 0;let n=i.map(a=>this.getCell(...a)).reduce((a,s)=>{let l=s.rowIndex;return a[l]=a[l]||[],a[l].push(s.content),a},[]),o=n.map(a=>a.join("	")).join(`
`);return Nf(o),n.reduce((a,s)=>a+s.length,0)}pasteContentInCell(t){if(!this.$focusedCell)return;let e=t.split(`
`).map(a=>a.split("	")).filter(a=>a.length&&a.every(s=>s)),{colIndex:i,rowIndex:n}=ue.data(this.$focusedCell),o={colIndex:+i,rowIndex:+n};e.forEach((a,s)=>{let l=s+o.rowIndex;a.forEach((u,c)=>{let h=c+o.colIndex;this.updateCell(h,l,u)})})}activateFilter(t){this.columnmanager.toggleFilter(),this.columnmanager.focusFilter(t),this.columnmanager.isFilterShown||this.$focusedCell&&this.$focusedCell.focus()}updateCell(t,e,i){let n=this.datamanager.updateCell(t,e,{content:i});this.refreshCell(n)}refreshCell(t){let e=ue(this.selector(t.colIndex,t.rowIndex),this.bodyScrollable);e.innerHTML=this.getCellContent(t)}toggleTreeButton(t,e){let i=this.columnmanager.getFirstColumnIndex(),n=this.getCell$(i,t);n&&n.classList[e?"remove":"add"]("dt-cell--tree-close")}isStandardCell(t){return t<this.columnmanager.getFirstColumnIndex()}focusCellInDirection(t){if(!this.$focusedCell||this.$editingCell&&["left","right","up","down"].includes(t))return!1;this.$editingCell&&["tab","shift+tab"].includes(t)&&this.deactivateEditing();let e=this.$focusedCell;if(t==="left"||t==="shift+tab"?e=this.getLeftCell$(e):t==="right"||t==="tab"?e=this.getRightCell$(e):t==="up"?e=this.getAboveCell$(e):t==="down"&&(e=this.getBelowCell$(e)),!e)return!1;let{colIndex:i}=ue.data(e);if(!this.columnmanager.getColumn(i).focusable){let o=this.$focusedCell;this.unfocusCell(o),this.$focusedCell=e;let a=this.focusCellInDirection(t);return a||this.focusCell(o),a}return this.focusCell(e),!0}getCell$(t,e){return ue(this.selector(t,e),this.bodyScrollable)}getAboveCell$(t){let{colIndex:e}=ue.data(t),i=t.parentElement.previousElementSibling;for(;i&&i.classList.contains("dt-row--hide");)i=i.previousElementSibling;return i?ue(`.dt-cell--col-${e}`,i):t}getBelowCell$(t){let{colIndex:e}=ue.data(t),i=t.parentElement.nextElementSibling;for(;i&&i.classList.contains("dt-row--hide");)i=i.nextElementSibling;return i?ue(`.dt-cell--col-${e}`,i):t}getLeftCell$(t){return t.previousElementSibling}getRightCell$(t){return t.nextElementSibling}getLeftMostCell$(t){return this.getCell$(this.columnmanager.getFirstColumnIndex(),t)}getRightMostCell$(t){return this.getCell$(this.columnmanager.getLastColumnIndex(),t)}getTopMostCell$(t){return this.getCell$(t,this.rowmanager.getFirstRowIndex())}getBottomMostCell$(t){return this.getCell$(t,this.rowmanager.getLastRowIndex())}getCell(t,e){return this.instance.datamanager.getCell(t,e)}getRowHeight(){return ue.style(ue(".dt-row",this.bodyScrollable),"height")}scrollToCell(t){if(ue.inViewport(t,this.bodyScrollable))return!1;let{rowIndex:e}=ue.data(t);return this.rowmanager.scrollToRow(e),!1}getRowCountPerPage(){return Math.ceil(this.instance.getViewportHeight()/this.getRowHeight())}getCellHTML(t){let{rowIndex:e,colIndex:i,isHeader:n,isFilter:o,isTotalRow:a}=t,s=ua({rowIndex:e,colIndex:i,isHeader:n,isFilter:o,isTotalRow:a}),l=this.datamanager.getRow(e),u=!(n||o||a);return`
            <div class="${["dt-cell","dt-cell--col-"+i,u?`dt-cell--${i}-${e}`:"",u?"dt-cell--row-"+e:"",n?"dt-cell--header":"",n?`dt-cell--header-${i}`:"",o?"dt-cell--filter":"",u&&l&&l.meta.isTreeNodeClose?"dt-cell--tree-close":""].join(" ")}" ${s} tabindex="0">
                ${this.getCellContent(t)}
            </div>
        `}getCellContent(t){let{isHeader:e,isFilter:i,colIndex:n}=t,a=!e&&t.editable!==!1?this.getEditCellHTML(n):"",l=e&&t.sortable!==!1?`<span class="sort-indicator">
                ${this.options.sortIndicator[t.sortOrder]}
            </span>`:"",c=e&&t.resizable!==!1?'<span class="dt-cell__resize-handle"></span>':"",p=e&&t.dropdown!==!1?this.columnmanager.getDropdownHTML():"",g=t.format||t.column&&t.column.format||null,b;if(e||i||!g)b=t.content;else{let k=this.datamanager.getRow(t.rowIndex),C=this.datamanager.getData(t.rowIndex);b=g(t.content,k,t.column,C)}if(t.html=b,this.options.treeView&&!(e||i)&&t.indent!==void 0){let k=this.datamanager.getRow(t.rowIndex+1),C=k&&k.meta.indent>t.indent,O=20,d="px";if(this.datamanager.getColumnIndexById("_rowIndex")+1===t.colIndex){let m=(t.indent||0)*O,y=C?`<span class="dt-tree-node__toggle" style="left: ${m-O}${d}">
                        <span class="icon-open">${da.chevronDown}</span>
                        <span class="icon-close">${da.chevronRight}</span>
                    </span>`:"";b=`<span class="dt-tree-node" style="padding-left: ${m}${d}">
                    ${y}
                    <span>${b}</span>
                </span>`}}return`
            <div class="${["dt-cell__content",e?`dt-cell__content--header-${n}`:`dt-cell__content--col-${n}`].join(" ")}">
                ${b}
                ${l}
                ${c}
                ${p}
            </div>
            ${a}
        `}getEditCellHTML(t){return`<div class="dt-cell__edit dt-cell__edit--col-${t}"></div>`}selector(t,e){return`.dt-cell--${t}-${e}`}},Vf=class{constructor(t){this.instance=t,qn(this,this.instance,["options","fireEvent","header","datamanager","cellmanager","style","wrapper","rowmanager","bodyScrollable","bodyRenderer"]),this.bindEvents()}renderHeader(){this.header.innerHTML="<div></div>",this.refreshHeader()}refreshHeader(){let t=this.datamanager.getColumns();ue("div",this.header).innerHTML=this.getHeaderHTML(t),this.$filterRow=ue(".dt-row-filter",this.header),this.$filterRow&&ue.style(this.$filterRow,{display:"none"}),this.$columnMap=[],this.bindMoveColumn()}getHeaderHTML(t){let e=this.rowmanager.getRowHTML(t,{isHeader:1});return this.options.inlineFilters&&(e+=this.rowmanager.getRowHTML(t,{isFilter:1})),e}bindEvents(){this.bindDropdown(),this.bindResizeColumn(),this.bindPerfectColumnWidth(),this.bindFilter()}bindDropdown(){let t=".dt-dropdown__toggle",e=".dt-dropdown__list";this.instance.dropdownContainer.innerHTML=this.getDropdownListHTML(),this.$dropdownList=this.instance.dropdownContainer.firstElementChild,ue.on(this.header,"click",t,a=>{this.openDropdown(a)});let i=a=>{let s=[t,t+" *",e,e+" *"].join(",");a.target.matches(s)||o()};ue.on(document.body,"click",i),document.addEventListener("scroll",o,!0),this.instance.on("onDestroy",()=>{ue.off(document.body,"click",i),ue.off(document,"scroll",o)}),ue.on(this.$dropdownList,"click",".dt-dropdown__list-item",(a,s)=>{if(!this._dropdownActiveColIndex)return;let l=this.options.headerDropdown,{index:u}=ue.data(s),c=this._dropdownActiveColIndex,h=l[u].action;h&&h.call(this.instance,this.getColumn(c)),this.hideDropdown()});let n=this;function o(a){n.hideDropdown()}this.hideDropdown()}openDropdown(t){this._dropdownWidth||(ue.style(this.$dropdownList,{display:""}),this._dropdownWidth=ue.style(this.$dropdownList,"width")),ue.style(this.$dropdownList,{display:"",left:t.clientX-this._dropdownWidth+4+"px",top:t.clientY+4+"px"});let e=ue.closest(".dt-cell",t.target),{colIndex:i}=ue.data(e);this._dropdownActiveColIndex=i}hideDropdown(){ue.style(this.$dropdownList,{display:"none"}),this._dropdownActiveColIndex=null}bindResizeColumn(){let t=!1,e,i,n;ue.on(this.header,"mousedown",".dt-cell .dt-cell__resize-handle",(s,l)=>{document.body.classList.add("dt-resize"),e=l.parentNode.parentNode;let{colIndex:c}=ue.data(e),h=this.getColumn(c);h&&h.resizable===!1||(t=!0,i=ue.style(ue(".dt-cell__content",e),"width"),n=s.pageX)});let o=s=>{if(document.body.classList.remove("dt-resize"),!e)return;t=!1;let{colIndex:l}=ue.data(e);this.setColumnWidth(l),this.style.setBodyStyle(),e=null};ue.on(document.body,"mouseup",o),this.instance.on("onDestroy",()=>{ue.off(document.body,"mouseup",o)});let a=s=>{if(!t)return;let l=s.pageX-n;this.options.direction==="rtl"&&(l=-1*l);let u=i+l,{colIndex:c}=ue.data(e);this.options.minimumColumnWidth>u||(this.datamanager.updateColumn(c,{width:u}),this.setColumnHeaderWidth(c))};ue.on(document.body,"mousemove",a),this.instance.on("onDestroy",()=>{ue.off(document.body,"mousemove",a)})}bindPerfectColumnWidth(){ue.on(this.header,"dblclick",".dt-cell .dt-cell__resize-handle",(t,e)=>{let i=e.parentNode.parentNode,{colIndex:n}=ue.data(i),o=this.bodyRenderer.visibleRows.map(v=>v[n]).reduce((v,k)=>v.content.length>k.content.length?v:k),a=this.cellmanager.getCellHTML(o),s=document.createElement("div");s.innerHTML=a;let l=s.querySelector(".dt-cell__content").textContent,{borderLeftWidth:u,borderRightWidth:c,paddingLeft:h,paddingRight:p}=ue.getStyle(this.bodyScrollable.querySelector(".dt-cell__content")),g=[u,c,h,p].map(parseFloat).reduce((v,k)=>v+k),b=ue.measureTextWidth(l)+g;this.datamanager.updateColumn(n,{width:b}),this.setColumnHeaderWidth(n),this.setColumnWidth(n)})}bindMoveColumn(){if(this.options.disableReorderColumn)return;let t=ue(".dt-row",this.header);this.sortable=fk.create(t,{onEnd:e=>{let{oldIndex:i,newIndex:n}=e,o=e.item,{colIndex:a}=ue.data(o);+a!==n&&this.switchColumn(i,n)},preventOnFilter:!1,filter:".dt-cell__resize-handle, .dt-dropdown",chosenClass:"dt-cell--dragging",animation:150})}sortColumn(t,e){this.instance.freeze(),this.sortRows(t,e).then(()=>(this.refreshHeader(),this.rowmanager.refreshRows())).then(()=>this.instance.unfreeze()).then(()=>{this.fireEvent("onSortColumn",this.getColumn(t))})}removeColumn(t){let e=this.getColumn(t);this.instance.freeze(),this.datamanager.removeColumn(t).then(()=>(this.refreshHeader(),this.rowmanager.refreshRows())).then(()=>this.instance.unfreeze()).then(()=>{this.fireEvent("onRemoveColumn",e)})}switchColumn(t,e){this.instance.freeze(),this.datamanager.switchColumn(t,e).then(()=>(this.refreshHeader(),this.rowmanager.refreshRows())).then(()=>{this.setColumnWidth(t),this.setColumnWidth(e),this.instance.unfreeze()}).then(()=>{this.fireEvent("onSwitchColumn",this.getColumn(t),this.getColumn(e))})}toggleFilter(t){if(!this.options.inlineFilters)return;let e;t===void 0?e=!this.isFilterShown:e=t,e?ue.style(this.$filterRow,{display:""}):ue.style(this.$filterRow,{display:"none"}),this.isFilterShown=e,this.style.setBodyStyle()}focusFilter(t){if(!this.isFilterShown)return;ue(`.dt-cell--col-${t} .dt-filter`,this.$filterRow).focus()}bindFilter(){if(!this.options.inlineFilters)return;let t=e=>{this.applyFilter(this.getAppliedFilters())};ue.on(this.header,"keydown",".dt-filter",Jx(t,300))}applyFilter(t){this.datamanager.filterRows(t).then(({rowsToShow:e})=>{this.rowmanager.showRows(e)})}getAppliedFilters(){let t={};return ue.each(".dt-filter",this.header).map(e=>{let i=e.value;i&&(t[e.dataset.colIndex]=i)}),t}applyDefaultSortOrder(){let t=this.getColumns().filter(e=>e.sortOrder!=="none");if(t.length===1){let e=t[0];this.sortColumn(e.colIndex,e.sortOrder)}}sortRows(t,e){return this.datamanager.sortRows(t,e)}getColumn(t){return this.datamanager.getColumn(t)}getColumns(){return this.datamanager.getColumns()}setColumnWidth(t,e){t=+t;let i=e||this.getColumn(t).width,n=[`.dt-cell__content--col-${t}`,`.dt-cell__edit--col-${t}`].join(", "),o={width:i+"px"};this.style.setStyle(n,o)}setColumnHeaderWidth(t){t=+t,this.$columnMap=this.$columnMap||[];let e=`.dt-cell__content--header-${t}`,{width:i}=this.getColumn(t),n=this.$columnMap[t];n||(n=this.header.querySelector(e),this.$columnMap[t]=n),n.style.width=i+"px"}getColumnMinWidth(t){return t=+t,this.getColumn(t).minWidth||24}getFirstColumnIndex(){return this.datamanager.getColumnIndexById("_rowIndex")+1}getHeaderCell$(t){return ue(`.dt-cell--header-${t}`,this.header)}getLastColumnIndex(){return this.datamanager.getColumnCount()-1}getDropdownHTML(){let{dropdownButton:t}=this.options;return`
            <div class="dt-dropdown">
                <div class="dt-dropdown__toggle">${t}</div>
            </div>
      `}getDropdownListHTML(){let{headerDropdown:t}=this.options;return`
            <div class="dt-dropdown__list">
            ${t.map((e,i)=>`
                <div class="dt-dropdown__list-item" data-index="${i}">${e.label}</div>
            `).join("")}
            </div>
        `}},Yf=class{constructor(t){this.instance=t,qn(this,this.instance,["options","fireEvent","wrapper","bodyScrollable","bodyRenderer","style"]),this.bindEvents(),this.refreshRows=$i(this.refreshRows,this)}get datamanager(){return this.instance.datamanager}get cellmanager(){return this.instance.cellmanager}bindEvents(){this.bindCheckbox()}bindCheckbox(){!this.options.checkboxColumn||(this.checkMap=[],ue.on(this.wrapper,"click",'.dt-cell--col-0 [type="checkbox"]',(t,e)=>{let i=e.closest(".dt-cell"),{rowIndex:n,isHeader:o}=ue.data(i),a=e.checked;o?this.checkAll(a):this.checkRow(n,a)}))}refreshRows(){this.instance.renderBody(),this.instance.setDimensions()}refreshRow(t,e){this.datamanager.updateRow(t,e).forEach(n=>{this.cellmanager.refreshCell(n)})}getCheckedRows(){if(!this.checkMap)return[];let t=[];for(let e in this.checkMap)this.checkMap[e]===1&&t.push(e);return t}highlightCheckedRows(){this.getCheckedRows().map(t=>this.checkRow(t,!0))}checkRow(t,e){let i=e?1:0,n=o=>`.dt-cell--0-${o} [type="checkbox"]`;this.checkMap[t]=i,ue.each(n(t),this.bodyScrollable).map(o=>{o.checked=e}),this.highlightRow(t,e),this.showCheckStatus(),this.fireEvent("onCheckRow",this.datamanager.getRow(t))}checkAll(t){let e=t?1:0;t?this.checkMap=Array.from(Array(this.getTotalRows())).map(i=>e):this.checkMap=[],ue.each('.dt-cell--col-0 [type="checkbox"]',this.bodyScrollable).map(i=>{i.checked=t}),this.highlightAll(t),this.showCheckStatus(),this.fireEvent("onCheckRow")}showCheckStatus(){if(!this.options.checkedRowStatus)return;let e=this.getCheckedRows().length;if(e>0){let i=this.instance.translate("{count} rows selected",{count:e});this.bodyRenderer.showToastMessage(i)}else this.bodyRenderer.clearToastMessage()}highlightRow(t,e=!0){let i=this.getRow$(t);if(!!i){if(!e&&this.bodyScrollable.classList.contains("dt-scrollable--highlight-all")){i.classList.add("dt-row--unhighlight");return}e&&i.classList.contains("dt-row--unhighlight")&&i.classList.remove("dt-row--unhighlight"),this._highlightedRows=this._highlightedRows||{},e?(i.classList.add("dt-row--highlight"),this._highlightedRows[t]=i):(i.classList.remove("dt-row--highlight"),delete this._highlightedRows[t])}}highlightAll(t=!0){if(t)this.bodyScrollable.classList.add("dt-scrollable--highlight-all");else{this.bodyScrollable.classList.remove("dt-scrollable--highlight-all");for(let e in this._highlightedRows)this._highlightedRows[e].classList.remove("dt-row--highlight");this._highlightedRows={}}}showRows(t){t=eC(t);let e=t.map(i=>this.datamanager.getRow(i));this.bodyRenderer.renderRows(e)}showAllRows(){let t=this.datamanager.getAllRowIndices();this.showRows(t)}getChildrenToShowForNode(t){let e=this.datamanager.getRow(t);return e.meta.isTreeNodeClose=!1,this.datamanager.getImmediateChildren(t)}openSingleNode(t){let e=this.getChildrenToShowForNode(t),i=this.bodyRenderer.visibleRowIndices,n=Pf([...e,...i]).sort(Ai);this.showRows(n)}getChildrenToHideForNode(t){let e=this.datamanager.getRow(t);e.meta.isTreeNodeClose=!0;let i=this.datamanager.getChildren(t);return i.forEach(n=>{let o=this.datamanager.getRow(n);o.meta.isLeaf||(o.meta.isTreeNodeClose=!0)}),i}closeSingleNode(t){let e=this.getChildrenToHideForNode(t),n=this.bodyRenderer.visibleRowIndices.filter(o=>!e.includes(o)).sort(Ai);this.showRows(n)}expandAllNodes(){let i=this.datamanager.getRows().filter(a=>!a.meta.isLeaf).map(a=>this.getChildrenToShowForNode(a.meta.rowIndex)).flat(),n=this.bodyRenderer.visibleRowIndices,o=Pf([...i,...n]).sort(Ai);this.showRows(o)}collapseAllNodes(){let i=this.datamanager.getRows().filter(a=>a.meta.indent===0).map(a=>this.getChildrenToHideForNode(a.meta.rowIndex)).flat(),o=this.bodyRenderer.visibleRowIndices.filter(a=>!i.includes(a)).sort(Ai);this.showRows(o)}setTreeDepth(t){let e=this.datamanager.getRows(),i=e.filter(s=>s.meta.indent<t),n=e.filter(s=>s.meta.indent>=t),o=n.filter(s=>s.meta.indent>t);n.forEach(s=>{s.meta.isLeaf||(s.meta.isTreeNodeClose=!0)}),i.forEach(s=>{s.meta.isLeaf||(s.meta.isTreeNodeClose=!1)});let a=e.filter(s=>!o.includes(s)).map(s=>s.meta.rowIndex).sort(Ai);this.showRows(a)}getRow$(t){return ue(this.selector(t),this.bodyScrollable)}getTotalRows(){return this.datamanager.getRowCount()}getFirstRowIndex(){return 0}getLastRowIndex(){return this.datamanager.getRowCount()-1}scrollToRow(t){t=+t,this._lastScrollTo=this._lastScrollTo||0;let e=this.getRow$(t);if(ue.inViewport(e,this.bodyScrollable))return;let{height:i}=e.getBoundingClientRect(),{top:n,bottom:o}=this.bodyScrollable.getBoundingClientRect(),a=Math.floor((o-n)/i),s=0;t>this._lastScrollTo?s=i*(t+1-a):s=i*(t+1-1),this._lastScrollTo=t,ue.scrollTop(this.bodyScrollable,s)}getRowHTML(t,e){let i=ua(e),n=e.rowIndex;return e.isFilter&&(t=t.map(o=>Object.assign({},o,{content:this.getFilterInput({colIndex:o.colIndex,name:o.name}),isFilter:1,isHeader:void 0,editable:!1})),n="filter"),e.isHeader&&(n="header"),`
            <div class="dt-row dt-row-${n}" ${i}>
                ${t.map(o=>this.cellmanager.getCellHTML(o)).join("")}
            </div>
        `}getFilterInput(t){let e=`title="Filter based on ${t.name||"Index"}"`;return`<input class="dt-filter dt-input" type="text" ${ua(t)} tabindex="1" 
            ${t.colIndex===0?"disabled":e} />`}selector(t){return`.dt-row-${t}`}},iC=mk(function(r,t){(function(e){r.exports=e()})(function(){return function e(i,n,o){function a(u,c){if(!n[u]){if(!i[u]){var h=typeof Nn=="function"&&Nn;if(!c&&h)return h(u,!0);if(s)return s(u,!0);var p=new Error("Cannot find module '"+u+"'");throw p.code="MODULE_NOT_FOUND",p}var g=n[u]={exports:{}};i[u][0].call(g.exports,function(b){var v=i[u][1][b];return a(v||b)},g,g.exports,e,i,n,o)}return n[u].exports}for(var s=typeof Nn=="function"&&Nn,l=0;l<o.length;l++)a(o[l]);return a}({1:[function(e,i,n){Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function c(h,p){for(var g=0;g<p.length;g++){var b=p[g];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(h,b.key,b)}}return function(h,p,g){return p&&c(h.prototype,p),g&&c(h,g),h}}();function a(c,h){if(!(c instanceof h))throw new TypeError("Cannot call a class as a function")}var s={width:"100%",height:"100%"},l=function(h){return Number(h)===Number(h)},u=function(){o(c,null,[{key:"create",value:function(p,g){return new c(p,g)}},{key:"mergeStyle",value:function(p,g){for(var b in g)p.style[b]!==g[b]&&(p.style[b]=g[b])}},{key:"getMaxBrowserHeight",value:function(){var p=document.createElement("div"),g=document.createElement("div");c.mergeStyle(p,{position:"absolute",height:"1px",opacity:0}),c.mergeStyle(g,{height:"1e7px"}),p.appendChild(g),document.body.appendChild(p);var b=g.offsetHeight;return document.body.removeChild(p),b}}]);function c(h,p){var g=this;a(this,c),this._config={},this._lastRepaint=null,this._maxElementHeight=c.getMaxBrowserHeight(),this.refresh(h,p);var b=this._config,v=function k(){var C=g._getScrollPosition(),O=g._lastRepaint;if(g._renderAnimationFrame=window.requestAnimationFrame(k),C!==O&&(!O||Math.abs(C-O)>g._averageHeight)){var d=g._renderChunk();g._lastRepaint=C,d!==!1&&typeof b.afterRender=="function"&&b.afterRender()}};v()}return o(c,[{key:"destroy",value:function(){window.cancelAnimationFrame(this._renderAnimationFrame)}},{key:"refresh",value:function(p,g){var b=this;if(Object.assign(this._config,s,g),!p||p.nodeType!==1)throw new Error("HyperList requires a valid DOM Node container");this._element=p;var v=this._config,k=this._scroller||v.scroller||document.createElement(v.scrollerTagName||"tr");if(typeof v.useFragment!="boolean"&&(this._config.useFragment=!0),!v.generate)throw new Error("Missing required `generate` function");if(!l(v.total))throw new Error("Invalid required `total` value, expected number");if(!Array.isArray(v.itemHeight)&&!l(v.itemHeight))throw new Error("\n        Invalid required `itemHeight` value, expected number or array\n      ".trim());l(v.itemHeight)?this._itemHeights=Array(v.total).fill(v.itemHeight):this._itemHeights=v.itemHeight,Object.keys(s).filter(function(m){return m in v}).forEach(function(m){var y=v[m],x=l(y),S=x?!1:y.slice(-1)==="%";if(y&&typeof y!="string"&&typeof y!="number"){var w="Invalid optional `"+m+"`, expected string or number";throw new Error(w)}else x&&(v[m]=y+"px");if(m==="height"){var E=x?y:parseInt(y.replace(/px|%/,""),10);S?b._containerHeight=window.innerHeight*E/100:b._containerHeight=l(y)?y:E}});var C={width:""+v.width,height:""+v.height,overflow:"auto",position:"relative"};c.mergeStyle(p,C);var O=v.itemHeight*v.total,d=this._maxElementHeight;O>d&&console.warn(["HyperList: The maximum element height",d+"px has","been exceeded; please reduce your item height."].join(" "));var _={opacity:"0",position:"absolute",width:"1px",height:O+"px"};c.mergeStyle(k,_),this._scroller||p.appendChild(k),this._scroller=k,this._scrollHeight=this._computeScrollHeight(),this._itemPositions=this._itemPositions||Array(v.total).fill(0),this._computePositions(0),this._renderChunk(this._lastRepaint!==null),typeof v.afterRender=="function"&&v.afterRender()}},{key:"_getRow",value:function(p){var g=this._config,b=g.generate(p),v=b.height;if(v!==void 0&&l(v)?(b=b.element,v!==this._itemHeights&&(this._itemHeights[p]=v,this._computePositions(p),this._scrollHeight=this._computeScrollHeight(p))):v=this._itemHeights[p],!b||b.nodeType!==1)throw new Error("Generator did not return a DOM Node for index: "+p);var k=b.getAttribute("class")||"";b.setAttribute("class",k+" "+(g.rowClassName||"vrow"));var C=this._itemPositions[p];return c.mergeStyle(b,{position:"absolute",top:C+"px"}),b}},{key:"_getScrollPosition",value:function(){var p=this._config;return typeof p.overrideScrollPosition=="function"?p.overrideScrollPosition():this._element.scrollTop}},{key:"_renderChunk",value:function(p){var g=this._config,b=this._element,v=this._getScrollPosition(),k=g.total,C=g.reverse?this._getReverseFrom(v):this._getFrom(v)-1;if((C<0||C-this._screenItemsLen<0)&&(C=0),!p&&this._lastFrom===C)return!1;this._lastFrom=C;var O=C+this._cachedItemsLen;(O>k||O+this._cachedItemsLen>k)&&(O=k);var d=g.useFragment?document.createDocumentFragment():[],_=this._scroller;d[g.useFragment?"appendChild":"push"](_);for(var m=C;m<O;m++){var y=this._getRow(m);d[g.useFragment?"appendChild":"push"](y)}if(g.applyPatch)return g.applyPatch(b,d);b.innerHTML="",b.appendChild(d)}},{key:"_computePositions",value:function(){var p=arguments.length<=0||arguments[0]===void 0?1:arguments[0],g=this._config,b=g.total,v=g.reverse;p<1&&!v&&(p=1);for(var k=p;k<b;k++)v?k===0?this._itemPositions[0]=this._scrollHeight-this._itemHeights[0]:this._itemPositions[k]=this._itemPositions[k-1]-this._itemHeights[k]:this._itemPositions[k]=this._itemHeights[k-1]+this._itemPositions[k-1]}},{key:"_computeScrollHeight",value:function(){var p=this,g=this._config,b=g.total,v=this._itemHeights.reduce(function(_,m){return _+m},0);c.mergeStyle(this._scroller,{opacity:0,position:"absolute",width:"1px",height:v+"px"});var k=this._itemHeights.slice(0).sort(function(_,m){return _-m}),C=Math.floor(b/2),O=b%2===0?(k[C]+k[C-1])/2:k[C],d=this._element.clientHeight?this._element.clientHeight:this._containerHeight;return this._screenItemsLen=Math.ceil(d/O),this._containerHeight=d,this._cachedItemsLen=Math.max(this._cachedItemsLen||0,this._screenItemsLen*3),this._averageHeight=O,g.reverse&&window.requestAnimationFrame(function(){p._element.scrollTop=v}),v}},{key:"_getFrom",value:function(p){for(var g=0;this._itemPositions[g]<p;)g++;return g}},{key:"_getReverseFrom",value:function(p){for(var g=this._config.total-1;g>0&&this._itemPositions[g]<p+this._containerHeight;)g--;return g}}]),c}();n.default=u,i.exports=n.default},{}]},{},[1])(1)})}),nC=_k(iC),Gf=class{constructor(t){this.instance=t,this.options=t.options,this.datamanager=t.datamanager,this.rowmanager=t.rowmanager,this.cellmanager=t.cellmanager,this.bodyScrollable=t.bodyScrollable,this.footer=this.instance.footer,this.log=t.log}renderRows(t){if(this.visibleRows=t,this.visibleRowIndices=t.map(o=>o.meta.rowIndex),t.length===0){this.bodyScrollable.innerHTML=this.getNoDataHTML();return}let e=this.datamanager.rowViewOrder.map(o=>this.visibleRowIndices.includes(o)?o:null).filter(o=>o!==null),i=getComputedStyle(this.bodyScrollable),n={width:i.width,height:i.height,itemHeight:this.options.cellHeight,total:t.length,generate:o=>{let a=document.createElement("div"),s=e[o],l=this.datamanager.getRow(s),u=this.rowmanager.getRowHTML(l,l.meta);return a.innerHTML=u,a.children[0]},afterRender:()=>{this.restoreState()}};this.hyperlist?this.hyperlist.refresh(this.bodyScrollable,n):this.hyperlist=new nC(this.bodyScrollable,n),this.renderFooter()}render(){let t=this.datamanager.getRowsForView();this.renderRows(t),this.instance.setDimensions()}renderFooter(){if(!this.options.showTotalRow)return;let t=this.getTotalRow(),e=this.rowmanager.getRowHTML(t,{isTotalRow:1,rowIndex:"totalRow"});this.footer.innerHTML=e}getTotalRow(){return this.datamanager.getColumns().map(n=>{let o=null;return["_rowIndex","_checkbox"].includes(n.id)&&(o=""),{content:o,isTotalRow:1,colIndex:n.colIndex,column:n}}).map((n,o)=>{if(n.content==="")return n;if(this.options.hooks.columnTotal){let a=this.visibleRows.map(l=>l[o].content),s=this.options.hooks.columnTotal.call(this.instance,a,n);if(s!=null)return n.content=s,n}return n.content=this.visibleRows.reduce((a,s)=>{let l=s[o];return typeof l.content=="number"?(a==null&&(a=0),a+l.content):a},n.content),n})}restoreState(){this.rowmanager.highlightCheckedRows(),this.cellmanager.selectAreaOnClusterChanged(),this.cellmanager.focusCellOnClusterChanged()}showToastMessage(t,e){this.instance.toastMessage.innerHTML=this.getToastMessageHTML(t),e&&setTimeout(()=>{this.clearToastMessage()},e*1e3)}clearToastMessage(){this.instance.toastMessage.innerHTML=""}getNoDataHTML(){return`<div class="dt-scrollable__no-data">${this.options.noDataMessage}</div>`}getToastMessageHTML(t){return`<span class="dt-toast__message">${t}</span>`}},Xf=class{constructor(t){this.instance=t,qn(this,this.instance,["options","datamanager","columnmanager","header","footer","bodyScrollable","datatableWrapper","getColumn","bodyRenderer"]),this.scopeClass="dt-instance-"+t.constructor.instances,t.datatableWrapper.classList.add(this.scopeClass);let e=document.createElement("style");t.wrapper.insertBefore(e,t.datatableWrapper),this.styleEl=e,this.bindResizeWindow(),this.bindScrollHeader()}get stylesheet(){return this.styleEl.sheet}bindResizeWindow(){this.onWindowResize=this.onWindowResize.bind(this),this.onWindowResize=qf(this.onWindowResize,300),this.options.layout==="fluid"&&ue.on(window,"resize",this.onWindowResize)}bindScrollHeader(){this._settingHeaderPosition=!1,ue.on(this.bodyScrollable,"scroll",t=>{this._settingHeaderPosition||(this._settingHeaderPosition=!0,requestAnimationFrame(()=>{let e=-t.target.scrollLeft;ue.style(this.header,{transform:`translateX(${e}px)`}),ue.style(this.footer,{transform:`translateX(${e}px)`}),this._settingHeaderPosition=!1}))})}onWindowResize(){this.distributeRemainingWidth(),this.refreshColumnWidth(),this.setBodyStyle()}destroy(){this.styleEl.remove(),ue.off(window,"resize",this.onWindowResize)}setStyle(t,e){if(t.includes(",")){t.split(",").map(a=>a.trim()).forEach(a=>{this.setStyle(a,e)});return}if(t=t.trim(),!t)return;this._styleRulesMap=this._styleRulesMap||{};let i=this._getPrefixedSelector(t);this._styleRulesMap[i]&&(this.removeStyle(t),e=Object.assign({},this._styleRulesMap[i],e));let n=this._getRuleString(e),o=`${i} { ${n} }`;this._styleRulesMap[i]=e,this.stylesheet.insertRule(o)}removeStyle(t){if(t.includes(",")){t.split(",").map(n=>n.trim()).forEach(n=>{this.removeStyle(n)});return}if(t=t.trim(),!t)return;let e=this._getPrefixedSelector(t),i=Array.from(this.stylesheet.cssRules).findIndex(n=>n.selectorText===e);i!==-1&&this.stylesheet.deleteRule(i)}_getPrefixedSelector(t){return`.${this.scopeClass} ${t}`}_getRuleString(t){return Object.keys(t).map(e=>{let i=e;return e.includes("-")||(i=Hf(e)),`${i}:${t[e]};`}).join("")}setDimensions(){this.setCellHeight(),this.setupMinWidth(),this.setupNaturalColumnWidth(),this.setupColumnWidth(),this.distributeRemainingWidth(),this.setColumnStyle(),this.setBodyStyle()}setCellHeight(){this.setStyle(".dt-cell",{height:this.options.cellHeight+"px"})}setupMinWidth(){ue.each(".dt-cell--header",this.header).map(t=>{let{colIndex:e}=ue.data(t),i=this.getColumn(e);if(!i.minWidth){let n=ue.style(ue(".dt-cell__content",t),"width");i.minWidth=n}})}setupNaturalColumnWidth(){!ue(".dt-row")||(ue.each(".dt-row-header .dt-cell",this.header).map(t=>{let{colIndex:e}=ue.data(t),i=this.datamanager.getColumn(e),n=ue.style(ue(".dt-cell__content",t),"width");typeof n=="number"&&n>=this.options.minimumColumnWidth?i.naturalWidth=n:i.naturalWidth=this.options.minimumColumnWidth}),ue.each(".dt-row-0 .dt-cell",this.bodyScrollable).map(t=>{let{colIndex:e}=ue.data(t),i=this.datamanager.getColumn(e),n=ue.style(ue(".dt-cell__content",t),"width");typeof n=="number"&&n>=i.naturalWidth?i.naturalWidth=n:i.naturalWidth=i.naturalWidth}))}setupColumnWidth(){if(this.options.layout==="ratio"){let t=ue.style(this.datatableWrapper,"width");if(this.options.serialNoColumn){let n=this.datamanager.getColumnById("_rowIndex");t=t-n.width-1}if(this.options.checkboxColumn){let n=this.datamanager.getColumnById("_checkbox");t=t-n.width-1}let e=this.datamanager.getColumns().map(n=>n.id==="_rowIndex"||n.id==="_checkbox"?0:(n.width||(n.width=1),n.ratioWidth=parseInt(n.width,10),n.ratioWidth)).reduce((n,o)=>n+o),i=t/e;this.datamanager.getColumns().map(n=>{n.id==="_rowIndex"||n.id==="_checkbox"||(n.width=Math.floor(i*n.ratioWidth)-1)})}else this.datamanager.getColumns().map(t=>{t.width||(t.width=t.naturalWidth),t.id==="_rowIndex"&&(t.width=this.getRowIndexColumnWidth()),t.width<this.options.minimumColumnWidth&&(t.width=this.options.minimumColumnWidth)})}distributeRemainingWidth(){if(this.options.layout!=="fluid")return;let t=ue.style(this.instance.datatableWrapper,"width"),e=ue(".dt-row",this.bodyScrollable),i=t;if(e)i=ue.style(e,"width");else{let a=ue(".dt-row",this.instance.header);i=Array.from(a.children).map(l=>l.offsetWidth).reduce((l,u)=>l+u,0)}let n=this.datamanager.getColumns().filter(a=>a.resizable),o=(t-i)/n.length;n.map(a=>{let s=ue.style(this.getColumnHeaderElement(a.colIndex),"width"),l=Math.floor(s+o)-2;this.datamanager.updateColumn(a.colIndex,{width:l})})}setColumnStyle(){this.datamanager.getColumns().map(t=>{t.align||(t.align="left"),["left","center","right"].includes(t.align)||(t.align="left"),this.setStyle(`.dt-cell--col-${t.colIndex}`,{"text-align":t.align}),this.columnmanager.setColumnHeaderWidth(t.colIndex),this.columnmanager.setColumnWidth(t.colIndex)})}refreshColumnWidth(){this.datamanager.getColumns().map(t=>{this.columnmanager.setColumnHeaderWidth(t.colIndex),this.columnmanager.setColumnWidth(t.colIndex)})}setBodyStyle(){let t=ue.style(this.datatableWrapper,"width"),e=ue(".dt-row",this.bodyScrollable);if(!e)return;let i=ue.style(e,"width"),n=t>i?i:t;ue.style(this.bodyScrollable,{width:n+"px"}),ue.removeStyle(this.bodyScrollable,"height");let o=ue.getStyle(this.bodyScrollable,"height"),a=(this.bodyRenderer.hyperlist||{})._scrollHeight||1/0,s=ue.hasHorizontalOverflow(this.bodyScrollable),l;a<o&&(l=a,s&&(l+=ue.scrollbarSize()),ue.style(this.bodyScrollable,{height:l+"px"})),this.bodyScrollable.scrollHeight-this.bodyScrollable.offsetHeight<ue.scrollbarSize()&&ue.style(this.bodyScrollable,{overflowY:"hidden"}),this.options.layout==="fluid"&&ue.style(this.bodyScrollable,{overflowX:"hidden"})}getColumnHeaderElement(t){return t=+t,t<0?null:ue(`.dt-cell--col-${t}`,this.header)}getRowIndexColumnWidth(){let t=this.datamanager.getRowCount(),e=22;return ue.measureTextWidth(t+"")+e}},oC={13:"enter",91:"meta",16:"shift",17:"ctrl",18:"alt",37:"left",38:"up",39:"right",40:"down",9:"tab",27:"esc",67:"c",70:"f",86:"v"},Kf=class{constructor(t){this.listeners={},ue.on(t,"keydown",this.handler.bind(this))}handler(t){let e=oC[t.keyCode];t.shiftKey&&e!=="shift"&&(e="shift+"+e),(t.ctrlKey&&e!=="ctrl"||t.metaKey&&e!=="meta")&&(e="ctrl+"+e);let i=this.listeners[e];if(i&&i.length>0)for(let n of i){let o=n(t);(o===void 0||o===!0)&&t.preventDefault()}}on(t,e){t.split(",").map(n=>n.trim()).map(n=>{this.listeners[n]=this.listeners[n]||[],this.listeners[n].push(e)})}},aC={"Sort Ascending":"Sort Ascending","Sort Descending":"Sort Descending","Reset sorting":"Reset sorting","Remove column":"Remove column","No Data":"No Data","{count} cells copied":{"1":"{count} cell copied",default:"{count} cells copied"},"{count} rows selected":{"1":"{count} row selected",default:"{count} rows selected"}},sC={"Sort Ascending":"Aufsteigend sortieren","Sort Descending":"Absteigend sortieren","Reset sorting":"Sortierung zur\xFCcksetzen","Remove column":"Spalte entfernen","No Data":"Keine Daten","{count} cells copied":{"1":"{count} Zelle kopiert",default:"{count} Zellen kopiert"},"{count} rows selected":{"1":"{count} Zeile ausgew\xE4hlt",default:"{count} Zeilen ausgew\xE4hlt"}},lC={"Sort Ascending":"Trier par ordre croissant","Sort Descending":"Trier par ordre d\xE9croissant","Reset sorting":"R\xE9initialiser le tri","Remove column":"Supprimer colonne","No Data":"Pas de donn\xE9es","{count} cells copied":{"1":"{count} cellule copi\xE9e",default:"{count} cellules copi\xE9es"},"{count} rows selected":{"1":"{count} ligne s\xE9lectionn\xE9e",default:"{count} lignes s\xE9lectionn\xE9es"}},cC={"Sort Ascending":"Ordinamento ascendente","Sort Descending":"Ordinamento decrescente","Reset sorting":"Azzeramento ordinamento","Remove column":"Rimuovi colonna","No Data":"Nessun dato","{count} cells copied":{"1":"Copiato {count} cella",default:"{count} celle copiate"},"{count} rows selected":{"1":"{count} linea selezionata",default:"{count} linee selezionate"}};function uC(){return{en:aC,de:sC,fr:lC,it:cC}}var Jf=class{constructor(t){this.language=t,this.translations=uC()}addTranslations(t){this.translations=Object.assign(this.translations,t)}translate(t,e){let i=this.translations[this.language]&&this.translations[this.language][t]||t;return typeof i=="object"&&(i=e&&e.count?this.getPluralizedTranslation(i,e.count):t),rC(i,e||{})}getPluralizedTranslation(t,e){return t[e]||t.default}};function dC(r,t){let e=[];if(Object.keys(t).length===0)return r.map(i=>i.meta.rowIndex);for(let i in t){let n=t[i],a=(e.length?e.map(u=>r[u]):r).map(u=>u[i]),s=pC(n),l=fC(s);l?e=l(s.text,a):e=a.map(u=>u.rowIndex)}return e}function fC(r){let t=o=>String(tC(o.html||"")||o.content||"").toLowerCase(),e=o=>parseFloat(o.content),i=(o,a)=>{if(o.column.compareValue){let l=o.column.compareValue(o,a);if(l&&Array.isArray(l))return l}let s=e(o);return isNaN(s)?[t(o),a]:[s,a]};return{contains(o,a){return a.filter(s=>{let l=t(s),u=(o||"").toLowerCase();return!u||l.includes(u)}).map(s=>s.rowIndex)},greaterThan(o,a){return a.filter(s=>{let[l,u]=i(s,o);return l>u}).map(s=>s.rowIndex)},lessThan(o,a){return a.filter(s=>{let[l,u]=i(s,o);return l<u}).map(s=>s.rowIndex)},equals(o,a){return a.filter(s=>parseFloat(s.content)===o).map(s=>s.rowIndex)},notEquals(o,a){return a.filter(s=>parseFloat(s.content)!==o).map(s=>s.rowIndex)},range(o,a){return a.filter(s=>{let l=i(s,o[0]),u=i(s,o[1]),c=l[0];return c>=l[1]&&c<=u[1]}).map(s=>s.rowIndex)},containsNumber(o,a){return a.filter(s=>{let l=parseFloat(o,10),u=o,c=e(s),h=t(s);return l===c||h.includes(u)}).map(s=>s.rowIndex)}}[r.type]}function pC(r=""){if(r.length===0)return{};let t=r;return[">","<","="].includes(t[0])?t=r.slice(1):t.startsWith("!=")&&(t=r.slice(2)),r.startsWith(">")&&t?{type:"greaterThan",text:t.trim()}:r.startsWith("<")&&t?{type:"lessThan",text:t.trim()}:r.startsWith("=")&&Pn(t)?{type:"equals",text:Number(r.slice(1).trim())}:Pn(t)?{type:"containsNumber",text:t}:r.startsWith("!=")&&Pn(t)?{type:"notEquals",text:Number(r.slice(2).trim())}:r.split(":").length===2?(t=r.split(":"),{type:"range",text:t.map(e=>e.trim())}):{type:"contains",text:t.toLowerCase()}}function hC(r){return{columns:[],data:[],dropdownButton:da.chevronDown,headerDropdown:[{label:r.translate("Sort Ascending"),action:function(t){this.sortColumn(t.colIndex,"asc")}},{label:r.translate("Sort Descending"),action:function(t){this.sortColumn(t.colIndex,"desc")}},{label:r.translate("Reset sorting"),action:function(t){this.sortColumn(t.colIndex,"none")}},{label:r.translate("Remove column"),action:function(t){this.removeColumn(t.colIndex)}}],events:{onRemoveColumn(t){},onSwitchColumn(t,e){},onSortColumn(t){},onCheckRow(t){},onDestroy(){}},hooks:{columnTotal:null},sortIndicator:{asc:"\u2191",desc:"\u2193",none:""},overrideComponents:{},filterRows:dC,freezeMessage:"",getEditor:null,serialNoColumn:!0,checkboxColumn:!1,clusterize:!0,logs:!1,layout:"fixed",noDataMessage:r.translate("No Data"),cellHeight:40,minimumColumnWidth:30,inlineFilters:!1,treeView:!1,checkedRowStatus:!0,dynamicRowHeight:!1,pasteFromClipboard:!1,showTotalRow:!1,direction:"ltr",disableReorderColumn:!1}}var _C={DataManager:Uf,CellManager:Wf,ColumnManager:Vf,RowManager:Yf,BodyRenderer:Gf,Style:Xf,Keyboard:Kf},ei=class{constructor(t,e){if(ei.instances++,typeof t=="string"&&(t=document.querySelector(t)),this.wrapper=t,!(this.wrapper instanceof HTMLElement))throw new Error("Invalid argument given for `wrapper`");this.initializeTranslations(e),this.setDefaultOptions(),this.buildOptions(e),this.prepare(),this.initializeComponents(),this.options.data&&(this.refresh(),this.columnmanager.applyDefaultSortOrder())}initializeTranslations(t){this.language=t.language||"en",this.translationManager=new Jf(this.language),t.translations&&this.translationManager.addTranslations(t.translations)}setDefaultOptions(){this.DEFAULT_OPTIONS=hC(this)}buildOptions(t){this.options=this.options||{},this.options=Object.assign({},this.DEFAULT_OPTIONS,this.options||{},t),t.headerDropdown=t.headerDropdown||[],this.options.headerDropdown=[...this.DEFAULT_OPTIONS.headerDropdown,...t.headerDropdown],this.events=Object.assign({},this.DEFAULT_OPTIONS.events,this.options.events||{},t.events||{}),this.fireEvent=this.fireEvent.bind(this)}prepare(){this.prepareDom(),this.unfreeze()}initializeComponents(){let t=Object.assign({},_C,this.options.overrideComponents),{Style:e,Keyboard:i,DataManager:n,RowManager:o,ColumnManager:a,CellManager:s,BodyRenderer:l}=t;this.style=new e(this),this.keyboard=new i(this.wrapper),this.datamanager=new n(this.options),this.rowmanager=new o(this),this.columnmanager=new a(this),this.cellmanager=new s(this),this.bodyRenderer=new l(this)}prepareDom(){this.wrapper.innerHTML=`
            <div class="datatable" dir="${this.options.direction}">
                <div class="dt-header"></div>
                <div class="dt-scrollable"></div>
                <div class="dt-footer"></div>
                <div class="dt-freeze">
                    <span class="dt-freeze__message">
                        ${this.options.freezeMessage}
                    </span>
                </div>
                <div class="dt-toast"></div>
                <div class="dt-dropdown-container"></div>
                <textarea class="dt-paste-target"></textarea>
            </div>
        `,this.datatableWrapper=ue(".datatable",this.wrapper),this.header=ue(".dt-header",this.wrapper),this.footer=ue(".dt-footer",this.wrapper),this.bodyScrollable=ue(".dt-scrollable",this.wrapper),this.freezeContainer=ue(".dt-freeze",this.wrapper),this.toastMessage=ue(".dt-toast",this.wrapper),this.pasteTarget=ue(".dt-paste-target",this.wrapper),this.dropdownContainer=ue(".dt-dropdown-container",this.wrapper)}refresh(t,e){this.datamanager.init(t,e),this.render(),this.setDimensions()}destroy(){this.wrapper.innerHTML="",this.style.destroy(),this.fireEvent("onDestroy")}appendRows(t){this.datamanager.appendRows(t),this.rowmanager.refreshRows()}refreshRow(t,e){this.rowmanager.refreshRow(t,e)}render(){this.renderHeader(),this.renderBody()}renderHeader(){this.columnmanager.renderHeader()}renderBody(){this.bodyRenderer.render()}setDimensions(){this.style.setDimensions()}showToastMessage(t,e){this.bodyRenderer.showToastMessage(t,e)}clearToastMessage(){this.bodyRenderer.clearToastMessage()}getColumn(t){return this.datamanager.getColumn(t)}getColumns(){return this.datamanager.getColumns()}getRows(){return this.datamanager.getRows()}getCell(t,e){return this.datamanager.getCell(t,e)}getColumnHeaderElement(t){return this.columnmanager.getColumnHeaderElement(t)}getViewportHeight(){return this.viewportHeight||(this.viewportHeight=ue.style(this.bodyScrollable,"height")),this.viewportHeight}sortColumn(t,e){this.columnmanager.sortColumn(t,e)}removeColumn(t){this.columnmanager.removeColumn(t)}scrollToLastColumn(){this.datatableWrapper.scrollLeft=9999}freeze(){ue.style(this.freezeContainer,{display:""})}unfreeze(){ue.style(this.freezeContainer,{display:"none"})}updateOptions(t){this.buildOptions(t)}fireEvent(t,...e){let i=[...this._internalEventHandlers[t]||[],this.events[t]].filter(Boolean);for(let n of i)n.apply(this,e)}on(t,e){this._internalEventHandlers=this._internalEventHandlers||{},this._internalEventHandlers[t]=this._internalEventHandlers[t]||[],this._internalEventHandlers[t].push(e)}log(){this.options.logs&&console.log.apply(console,arguments)}translate(t,e){return this.translationManager.translate(t,e)}};ei.instances=0;var mC="frappe-datatable",gC="0.0.0-development",vC="A modern datatable library for the web",bC="dist/frappe-datatable.cjs.js",yC="dist/frappe-datatable.min.js",wC="dist/frappe-datatable.min.js",kC={start:"yarn run dev",build:"rollup -c && NODE_ENV=production rollup -c",dev:"rollup -c -w","cy:server":"http-server -p 8989","cy:open":"cypress open","cy:run":"cypress run",test:"start-server-and-test cy:server http://localhost:8989 cy:run","test-local":"start-server-and-test cy:server http://localhost:8989 cy:open","travis-deploy-once":"travis-deploy-once","semantic-release":"semantic-release",lint:"eslint src","lint-and-build":"yarn lint && yarn build",commit:"npx git-cz"},xC=["dist","src"],CC={autoprefixer:"^9.0.0",chai:"3.5.0",cypress:"^9.2.0","cz-conventional-changelog":"^2.1.0",deepmerge:"^2.0.1",eslint:"^5.0.1","eslint-config-airbnb":"^16.1.0","eslint-config-airbnb-base":"^12.1.0","eslint-plugin-import":"^2.11.0","http-server":"^0.11.1",mocha:"3.3.0","postcss-custom-properties":"^7.0.0","postcss-nested":"^3.0.0",rollup:"^0.59.4","rollup-plugin-commonjs":"^8.3.0","rollup-plugin-eslint":"^4.0.0","rollup-plugin-json":"^2.3.0","rollup-plugin-node-resolve":"^3.0.3","rollup-plugin-postcss":"^1.2.8","rollup-plugin-uglify-es":"^0.0.1","semantic-release":"^17.1.1","start-server-and-test":"^1.4.1","travis-deploy-once":"^5.0.1"},SC={type:"git",url:"https://github.com/frappe/datatable.git"},TC=["datatable","data","grid","table"],EC="Faris Ansari",AC="MIT",$C={url:"https://github.com/frappe/datatable/issues"},OC="https://frappe.io/datatable",RC={hyperlist:"^1.0.0-beta",lodash:"^4.17.5",sortablejs:"^1.7.0"},LC={commitizen:{path:"cz-conventional-changelog"}},BC={name:mC,version:gC,description:vC,main:bC,unpkg:yC,jsdelivr:wC,scripts:kC,files:xC,devDependencies:CC,repository:SC,keywords:TC,author:EC,license:AC,bugs:$C,homepage:OC,dependencies:RC,config:LC};ei.__version__=BC.version;Zf.exports=ei});var tp=ye((Un,pa)=>{(function(r,t){typeof Un=="object"&&typeof pa=="object"?pa.exports=t():typeof define=="function"&&define.amd?define([],t):typeof Un=="object"?Un.Driver=t():r.Driver=t()})(window,function(){return function(r){var t={};function e(i){if(t[i])return t[i].exports;var n=t[i]={i,l:!1,exports:{}};return r[i].call(n.exports,n,n.exports,e),n.l=!0,n.exports}return e.m=r,e.c=t,e.d=function(i,n,o){e.o(i,n)||Object.defineProperty(i,n,{enumerable:!0,get:o})},e.r=function(i){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i,"__esModule",{value:!0})},e.t=function(i,n){if(1&n&&(i=e(i)),8&n||4&n&&typeof i=="object"&&i&&i.__esModule)return i;var o=Object.create(null);if(e.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:i}),2&n&&typeof i!="string")for(var a in i)e.d(o,a,function(s){return i[s]}.bind(null,a));return o},e.n=function(i){var n=i&&i.__esModule?function(){return i.default}:function(){return i};return e.d(n,"a",n),n},e.o=function(i,n){return Object.prototype.hasOwnProperty.call(i,n)},e.p="/dist/",e(e.s=57)}([function(r,t,e){var i=e(2),n=e(11),o=e(4),a=e(13),s=e(22),l=function(u,c,h){var p,g,b,v,k=u&l.F,C=u&l.G,O=u&l.S,d=u&l.P,_=u&l.B,m=C?i:O?i[c]||(i[c]={}):(i[c]||{}).prototype,y=C?n:n[c]||(n[c]={}),x=y.prototype||(y.prototype={});for(p in C&&(h=c),h)b=((g=!k&&m&&m[p]!==void 0)?m:h)[p],v=_&&g?s(b,i):d&&typeof b=="function"?s(Function.call,b):b,m&&a(m,p,b,u&l.U),y[p]!=b&&o(y,p,v),d&&x[p]!=b&&(x[p]=b)};i.core=n,l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,r.exports=l},function(r,t,e){var i=e(17)("wks"),n=e(14),o=e(2).Symbol,a=typeof o=="function";(r.exports=function(s){return i[s]||(i[s]=a&&o[s]||(a?o:n)("Symbol."+s))}).store=i},function(r,t){var e=r.exports=typeof window!="undefined"&&window.Math==Math?window:typeof self!="undefined"&&self.Math==Math?self:Function("return this")();typeof __g=="number"&&(__g=e)},function(r,t){r.exports=function(e){return typeof e=="object"?e!==null:typeof e=="function"}},function(r,t,e){var i=e(5),n=e(16);r.exports=e(6)?function(o,a,s){return i.f(o,a,n(1,s))}:function(o,a,s){return o[a]=s,o}},function(r,t,e){var i=e(12),n=e(35),o=e(21),a=Object.defineProperty;t.f=e(6)?Object.defineProperty:function(s,l,u){if(i(s),l=o(l,!0),i(u),n)try{return a(s,l,u)}catch(c){}if("get"in u||"set"in u)throw TypeError("Accessors not supported!");return"value"in u&&(s[l]=u.value),s}},function(r,t,e){r.exports=!e(7)(function(){return Object.defineProperty({},"a",{get:function(){return 7}}).a!=7})},function(r,t){r.exports=function(e){try{return!!e()}catch(i){return!0}}},function(r,t){var e={}.hasOwnProperty;r.exports=function(i,n){return e.call(i,n)}},function(r,t,e){var i=e(39),n=e(24);r.exports=function(o){return i(n(o))}},function(r,t,e){var i=e(0);i(i.S+i.F*!e(6),"Object",{defineProperty:e(5).f})},function(r,t){var e=r.exports={version:"2.6.9"};typeof __e=="number"&&(__e=e)},function(r,t,e){var i=e(3);r.exports=function(n){if(!i(n))throw TypeError(n+" is not an object!");return n}},function(r,t,e){var i=e(2),n=e(4),o=e(8),a=e(14)("src"),s=e(59),l=(""+s).split("toString");e(11).inspectSource=function(u){return s.call(u)},(r.exports=function(u,c,h,p){var g=typeof h=="function";g&&(o(h,"name")||n(h,"name",c)),u[c]!==h&&(g&&(o(h,a)||n(h,a,u[c]?""+u[c]:l.join(String(c)))),u===i?u[c]=h:p?u[c]?u[c]=h:n(u,c,h):(delete u[c],n(u,c,h)))})(Function.prototype,"toString",function(){return typeof this=="function"&&this[a]||s.call(this)})},function(r,t){var e=0,i=Math.random();r.exports=function(n){return"Symbol(".concat(n===void 0?"":n,")_",(++e+i).toString(36))}},function(r,t,e){var i=e(45),n=e(28);r.exports=Object.keys||function(o){return i(o,n)}},function(r,t){r.exports=function(e,i){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:i}}},function(r,t,e){var i=e(11),n=e(2),o=n["__core-js_shared__"]||(n["__core-js_shared__"]={});(r.exports=function(a,s){return o[a]||(o[a]=s!==void 0?s:{})})("versions",[]).push({version:i.version,mode:e(18)?"pure":"global",copyright:"\xA9 2019 Denis Pushkarev (zloirock.ru)"})},function(r,t){r.exports=!1},function(r,t,e){var i=e(24);r.exports=function(n){return Object(i(n))}},function(r,t,e){"use strict";var i=e(2),n=e(8),o=e(6),a=e(0),s=e(13),l=e(62).KEY,u=e(7),c=e(17),h=e(26),p=e(14),g=e(1),b=e(43),v=e(44),k=e(63),C=e(42),O=e(12),d=e(3),_=e(19),m=e(9),y=e(21),x=e(16),S=e(30),w=e(67),E=e(49),L=e(47),I=e(5),A=e(15),B=E.f,T=I.f,M=w.f,j=i.Symbol,J=i.JSON,U=J&&J.stringify,H=g("_hidden"),te=g("toPrimitive"),ae={}.propertyIsEnumerable,W=c("symbol-registry"),Y=c("symbols"),re=c("op-symbols"),ie=Object.prototype,Q=typeof j=="function"&&!!L.f,ee=i.QObject,pe=!ee||!ee.prototype||!ee.prototype.findChild,be=o&&u(function(){return S(T({},"a",{get:function(){return T(this,"a",{value:7}).a}})).a!=7})?function(ce,ve,Ie){var He=B(ie,ve);He&&delete ie[ve],T(ce,ve,Ie),He&&ce!==ie&&T(ie,ve,He)}:T,we=function(ce){var ve=Y[ce]=S(j.prototype);return ve._k=ce,ve},Le=Q&&typeof j.iterator=="symbol"?function(ce){return typeof ce=="symbol"}:function(ce){return ce instanceof j},fe=function(ce,ve,Ie){return ce===ie&&fe(re,ve,Ie),O(ce),ve=y(ve,!0),O(Ie),n(Y,ve)?(Ie.enumerable?(n(ce,H)&&ce[H][ve]&&(ce[H][ve]=!1),Ie=S(Ie,{enumerable:x(0,!1)})):(n(ce,H)||T(ce,H,x(1,{})),ce[H][ve]=!0),be(ce,ve,Ie)):T(ce,ve,Ie)},xe=function(ce,ve){O(ce);for(var Ie,He=k(ve=m(ve)),at=0,vt=He.length;vt>at;)fe(ce,Ie=He[at++],ve[Ie]);return ce},Ne=function(ce){var ve=ae.call(this,ce=y(ce,!0));return!(this===ie&&n(Y,ce)&&!n(re,ce))&&(!(ve||!n(this,ce)||!n(Y,ce)||n(this,H)&&this[H][ce])||ve)},Be=function(ce,ve){if(ce=m(ce),ve=y(ve,!0),ce!==ie||!n(Y,ve)||n(re,ve)){var Ie=B(ce,ve);return!Ie||!n(Y,ve)||n(ce,H)&&ce[H][ve]||(Ie.enumerable=!0),Ie}},Pe=function(ce){for(var ve,Ie=M(m(ce)),He=[],at=0;Ie.length>at;)n(Y,ve=Ie[at++])||ve==H||ve==l||He.push(ve);return He},Ze=function(ce){for(var ve,Ie=ce===ie,He=M(Ie?re:m(ce)),at=[],vt=0;He.length>vt;)!n(Y,ve=He[vt++])||Ie&&!n(ie,ve)||at.push(Y[ve]);return at};Q||(s((j=function(){if(this instanceof j)throw TypeError("Symbol is not a constructor!");var ce=p(arguments.length>0?arguments[0]:void 0),ve=function(Ie){this===ie&&ve.call(re,Ie),n(this,H)&&n(this[H],ce)&&(this[H][ce]=!1),be(this,ce,x(1,Ie))};return o&&pe&&be(ie,ce,{configurable:!0,set:ve}),we(ce)}).prototype,"toString",function(){return this._k}),E.f=Be,I.f=fe,e(48).f=w.f=Pe,e(29).f=Ne,L.f=Ze,o&&!e(18)&&s(ie,"propertyIsEnumerable",Ne,!0),b.f=function(ce){return we(g(ce))}),a(a.G+a.W+a.F*!Q,{Symbol:j});for(var tt="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),Xe=0;tt.length>Xe;)g(tt[Xe++]);for(var Ke=A(g.store),nt=0;Ke.length>nt;)v(Ke[nt++]);a(a.S+a.F*!Q,"Symbol",{for:function(ce){return n(W,ce+="")?W[ce]:W[ce]=j(ce)},keyFor:function(ce){if(!Le(ce))throw TypeError(ce+" is not a symbol!");for(var ve in W)if(W[ve]===ce)return ve},useSetter:function(){pe=!0},useSimple:function(){pe=!1}}),a(a.S+a.F*!Q,"Object",{create:function(ce,ve){return ve===void 0?S(ce):xe(S(ce),ve)},defineProperty:fe,defineProperties:xe,getOwnPropertyDescriptor:Be,getOwnPropertyNames:Pe,getOwnPropertySymbols:Ze});var ot=u(function(){L.f(1)});a(a.S+a.F*ot,"Object",{getOwnPropertySymbols:function(ce){return L.f(_(ce))}}),J&&a(a.S+a.F*(!Q||u(function(){var ce=j();return U([ce])!="[null]"||U({a:ce})!="{}"||U(Object(ce))!="{}"})),"JSON",{stringify:function(ce){for(var ve,Ie,He=[ce],at=1;arguments.length>at;)He.push(arguments[at++]);if(Ie=ve=He[1],(d(ve)||ce!==void 0)&&!Le(ce))return C(ve)||(ve=function(vt,bt){if(typeof Ie=="function"&&(bt=Ie.call(this,vt,bt)),!Le(bt))return bt}),He[1]=ve,U.apply(J,He)}}),j.prototype[te]||e(4)(j.prototype,te,j.prototype.valueOf),h(j,"Symbol"),h(Math,"Math",!0),h(i.JSON,"JSON",!0)},function(r,t,e){var i=e(3);r.exports=function(n,o){if(!i(n))return n;var a,s;if(o&&typeof(a=n.toString)=="function"&&!i(s=a.call(n))||typeof(a=n.valueOf)=="function"&&!i(s=a.call(n))||!o&&typeof(a=n.toString)=="function"&&!i(s=a.call(n)))return s;throw TypeError("Can't convert object to primitive value")}},function(r,t,e){var i=e(37);r.exports=function(n,o,a){if(i(n),o===void 0)return n;switch(a){case 1:return function(s){return n.call(o,s)};case 2:return function(s,l){return n.call(o,s,l)};case 3:return function(s,l,u){return n.call(o,s,l,u)}}return function(){return n.apply(o,arguments)}}},function(r,t){var e={}.toString;r.exports=function(i){return e.call(i).slice(8,-1)}},function(r,t){r.exports=function(e){if(e==null)throw TypeError("Can't call method on  "+e);return e}},function(r,t,e){"use strict";var i=e(7);r.exports=function(n,o){return!!n&&i(function(){o?n.call(null,function(){},1):n.call(null)})}},function(r,t,e){var i=e(5).f,n=e(8),o=e(1)("toStringTag");r.exports=function(a,s,l){a&&!n(a=l?a:a.prototype,o)&&i(a,o,{configurable:!0,value:s})}},function(r,t,e){var i=e(17)("keys"),n=e(14);r.exports=function(o){return i[o]||(i[o]=n(o))}},function(r,t){r.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(r,t){t.f={}.propertyIsEnumerable},function(r,t,e){var i=e(12),n=e(65),o=e(28),a=e(27)("IE_PROTO"),s=function(){},l=function(){var u,c=e(36)("iframe"),h=o.length;for(c.style.display="none",e(66).appendChild(c),c.src="javascript:",(u=c.contentWindow.document).open(),u.write("<script>document.F=Object<\/script>"),u.close(),l=u.F;h--;)delete l.prototype[o[h]];return l()};r.exports=Object.create||function(u,c){var h;return u!==null?(s.prototype=i(u),h=new s,s.prototype=null,h[a]=u):h=l(),c===void 0?h:n(h,c)}},function(r,t,e){"use strict";var i=e(68),n=e(69),o=e(32),a=e(9);r.exports=e(70)(Array,"Array",function(s,l){this._t=a(s),this._i=0,this._k=l},function(){var s=this._t,l=this._k,u=this._i++;return!s||u>=s.length?(this._t=void 0,n(1)):n(0,l=="keys"?u:l=="values"?s[u]:[u,s[u]])},"values"),o.Arguments=o.Array,i("keys"),i("values"),i("entries")},function(r,t){r.exports={}},function(r,t,e){e(44)("asyncIterator")},function(r,t,e){"use strict";var i=e(0),n=e(38)(0),o=e(25)([].forEach,!0);i(i.P+i.F*!o,"Array",{forEach:function(a){return n(this,a,arguments[1])}})},function(r,t,e){r.exports=!e(6)&&!e(7)(function(){return Object.defineProperty(e(36)("div"),"a",{get:function(){return 7}}).a!=7})},function(r,t,e){var i=e(3),n=e(2).document,o=i(n)&&i(n.createElement);r.exports=function(a){return o?n.createElement(a):{}}},function(r,t){r.exports=function(e){if(typeof e!="function")throw TypeError(e+" is not a function!");return e}},function(r,t,e){var i=e(22),n=e(39),o=e(19),a=e(40),s=e(60);r.exports=function(l,u){var c=l==1,h=l==2,p=l==3,g=l==4,b=l==6,v=l==5||b,k=u||s;return function(C,O,d){for(var _,m,y=o(C),x=n(y),S=i(O,d,3),w=a(x.length),E=0,L=c?k(C,w):h?k(C,0):void 0;w>E;E++)if((v||E in x)&&(m=S(_=x[E],E,y),l)){if(c)L[E]=m;else if(m)switch(l){case 3:return!0;case 5:return _;case 6:return E;case 2:L.push(_)}else if(g)return!1}return b?-1:p||g?g:L}}},function(r,t,e){var i=e(23);r.exports=Object("z").propertyIsEnumerable(0)?Object:function(n){return i(n)=="String"?n.split(""):Object(n)}},function(r,t,e){var i=e(41),n=Math.min;r.exports=function(o){return o>0?n(i(o),9007199254740991):0}},function(r,t){var e=Math.ceil,i=Math.floor;r.exports=function(n){return isNaN(n=+n)?0:(n>0?i:e)(n)}},function(r,t,e){var i=e(23);r.exports=Array.isArray||function(n){return i(n)=="Array"}},function(r,t,e){t.f=e(1)},function(r,t,e){var i=e(2),n=e(11),o=e(18),a=e(43),s=e(5).f;r.exports=function(l){var u=n.Symbol||(n.Symbol=o?{}:i.Symbol||{});l.charAt(0)=="_"||l in u||s(u,l,{value:a.f(l)})}},function(r,t,e){var i=e(8),n=e(9),o=e(46)(!1),a=e(27)("IE_PROTO");r.exports=function(s,l){var u,c=n(s),h=0,p=[];for(u in c)u!=a&&i(c,u)&&p.push(u);for(;l.length>h;)i(c,u=l[h++])&&(~o(p,u)||p.push(u));return p}},function(r,t,e){var i=e(9),n=e(40),o=e(64);r.exports=function(a){return function(s,l,u){var c,h=i(s),p=n(h.length),g=o(u,p);if(a&&l!=l){for(;p>g;)if((c=h[g++])!=c)return!0}else for(;p>g;g++)if((a||g in h)&&h[g]===l)return a||g||0;return!a&&-1}}},function(r,t){t.f=Object.getOwnPropertySymbols},function(r,t,e){var i=e(45),n=e(28).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(o){return i(o,n)}},function(r,t,e){var i=e(29),n=e(16),o=e(9),a=e(21),s=e(8),l=e(35),u=Object.getOwnPropertyDescriptor;t.f=e(6)?u:function(c,h){if(c=o(c),h=a(h,!0),l)try{return u(c,h)}catch(p){}if(s(c,h))return n(!i.f.call(c,h),c[h])}},function(r,t,e){for(var i=e(31),n=e(15),o=e(13),a=e(2),s=e(4),l=e(32),u=e(1),c=u("iterator"),h=u("toStringTag"),p=l.Array,g={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},b=n(g),v=0;v<b.length;v++){var k,C=b[v],O=g[C],d=a[C],_=d&&d.prototype;if(_&&(_[c]||s(_,c,p),_[h]||s(_,h,C),l[C]=p,O))for(k in i)_[k]||o(_,k,i[k],!0)}},function(r,t,e){"use strict";var i=e(73),n={};n[e(1)("toStringTag")]="z",n+""!="[object z]"&&e(13)(Object.prototype,"toString",function(){return"[object "+i(this)+"]"},!0)},function(r,t,e){var i=e(19),n=e(15);e(74)("keys",function(){return function(o){return n(i(o))}})},function(r,t,e){"use strict";var i=e(0),n=e(38)(2);i(i.P+i.F*!e(25)([].filter,!0),"Array",{filter:function(o){return n(this,o,arguments[1])}})},function(r,t,e){var i=e(0);i(i.P,"Function",{bind:e(75)})},function(r,t,e){var i=e(0);i(i.S,"Object",{create:e(30)})},function(r,t,e){var i=e(0);i(i.S,"Object",{setPrototypeOf:e(81).set})},function(r,t,e){e(58),r.exports=e(82)},function(r,t){},function(r,t,e){r.exports=e(17)("native-function-to-string",Function.toString)},function(r,t,e){var i=e(61);r.exports=function(n,o){return new(i(n))(o)}},function(r,t,e){var i=e(3),n=e(42),o=e(1)("species");r.exports=function(a){var s;return n(a)&&(typeof(s=a.constructor)!="function"||s!==Array&&!n(s.prototype)||(s=void 0),i(s)&&(s=s[o])===null&&(s=void 0)),s===void 0?Array:s}},function(r,t,e){var i=e(14)("meta"),n=e(3),o=e(8),a=e(5).f,s=0,l=Object.isExtensible||function(){return!0},u=!e(7)(function(){return l(Object.preventExtensions({}))}),c=function(p){a(p,i,{value:{i:"O"+ ++s,w:{}}})},h=r.exports={KEY:i,NEED:!1,fastKey:function(p,g){if(!n(p))return typeof p=="symbol"?p:(typeof p=="string"?"S":"P")+p;if(!o(p,i)){if(!l(p))return"F";if(!g)return"E";c(p)}return p[i].i},getWeak:function(p,g){if(!o(p,i)){if(!l(p))return!0;if(!g)return!1;c(p)}return p[i].w},onFreeze:function(p){return u&&h.NEED&&l(p)&&!o(p,i)&&c(p),p}}},function(r,t,e){var i=e(15),n=e(47),o=e(29);r.exports=function(a){var s=i(a),l=n.f;if(l)for(var u,c=l(a),h=o.f,p=0;c.length>p;)h.call(a,u=c[p++])&&s.push(u);return s}},function(r,t,e){var i=e(41),n=Math.max,o=Math.min;r.exports=function(a,s){return(a=i(a))<0?n(a+s,0):o(a,s)}},function(r,t,e){var i=e(5),n=e(12),o=e(15);r.exports=e(6)?Object.defineProperties:function(a,s){n(a);for(var l,u=o(s),c=u.length,h=0;c>h;)i.f(a,l=u[h++],s[l]);return a}},function(r,t,e){var i=e(2).document;r.exports=i&&i.documentElement},function(r,t,e){var i=e(9),n=e(48).f,o={}.toString,a=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];r.exports.f=function(s){return a&&o.call(s)=="[object Window]"?function(l){try{return n(l)}catch(u){return a.slice()}}(s):n(i(s))}},function(r,t,e){var i=e(1)("unscopables"),n=Array.prototype;n[i]==null&&e(4)(n,i,{}),r.exports=function(o){n[i][o]=!0}},function(r,t){r.exports=function(e,i){return{value:i,done:!!e}}},function(r,t,e){"use strict";var i=e(18),n=e(0),o=e(13),a=e(4),s=e(32),l=e(71),u=e(26),c=e(72),h=e(1)("iterator"),p=!([].keys&&"next"in[].keys()),g=function(){return this};r.exports=function(b,v,k,C,O,d,_){l(k,v,C);var m,y,x,S=function(j){if(!p&&j in I)return I[j];switch(j){case"keys":case"values":return function(){return new k(this,j)}}return function(){return new k(this,j)}},w=v+" Iterator",E=O=="values",L=!1,I=b.prototype,A=I[h]||I["@@iterator"]||O&&I[O],B=A||S(O),T=O?E?S("entries"):B:void 0,M=v=="Array"&&I.entries||A;if(M&&(x=c(M.call(new b)))!==Object.prototype&&x.next&&(u(x,w,!0),i||typeof x[h]=="function"||a(x,h,g)),E&&A&&A.name!=="values"&&(L=!0,B=function(){return A.call(this)}),i&&!_||!p&&!L&&I[h]||a(I,h,B),s[v]=B,s[w]=g,O)if(m={values:E?B:S("values"),keys:d?B:S("keys"),entries:T},_)for(y in m)y in I||o(I,y,m[y]);else n(n.P+n.F*(p||L),v,m);return m}},function(r,t,e){"use strict";var i=e(30),n=e(16),o=e(26),a={};e(4)(a,e(1)("iterator"),function(){return this}),r.exports=function(s,l,u){s.prototype=i(a,{next:n(1,u)}),o(s,l+" Iterator")}},function(r,t,e){var i=e(8),n=e(19),o=e(27)("IE_PROTO"),a=Object.prototype;r.exports=Object.getPrototypeOf||function(s){return s=n(s),i(s,o)?s[o]:typeof s.constructor=="function"&&s instanceof s.constructor?s.constructor.prototype:s instanceof Object?a:null}},function(r,t,e){var i=e(23),n=e(1)("toStringTag"),o=i(function(){return arguments}())=="Arguments";r.exports=function(a){var s,l,u;return a===void 0?"Undefined":a===null?"Null":typeof(l=function(c,h){try{return c[h]}catch(p){}}(s=Object(a),n))=="string"?l:o?i(s):(u=i(s))=="Object"&&typeof s.callee=="function"?"Arguments":u}},function(r,t,e){var i=e(0),n=e(11),o=e(7);r.exports=function(a,s){var l=(n.Object||{})[a]||Object[a],u={};u[a]=s(l),i(i.S+i.F*o(function(){l(1)}),"Object",u)}},function(r,t,e){"use strict";var i=e(37),n=e(3),o=e(76),a=[].slice,s={};r.exports=Function.bind||function(l){var u=i(this),c=a.call(arguments,1),h=function(){var p=c.concat(a.call(arguments));return this instanceof h?function(g,b,v){if(!(b in s)){for(var k=[],C=0;C<b;C++)k[C]="a["+C+"]";s[b]=Function("F,a","return new F("+k.join(",")+")")}return s[b](g,v)}(u,p.length,p):o(u,p,l)};return n(u.prototype)&&(h.prototype=u.prototype),h}},function(r,t){r.exports=function(e,i,n){var o=n===void 0;switch(i.length){case 0:return o?e():e.call(n);case 1:return o?e(i[0]):e.call(n,i[0]);case 2:return o?e(i[0],i[1]):e.call(n,i[0],i[1]);case 3:return o?e(i[0],i[1],i[2]):e.call(n,i[0],i[1],i[2]);case 4:return o?e(i[0],i[1],i[2],i[3]):e.call(n,i[0],i[1],i[2],i[3])}return e.apply(n,i)}},function(r,t,e){"use strict";e(78)("trim",function(i){return function(){return i(this,3)}})},function(r,t,e){var i=e(0),n=e(24),o=e(7),a=e(79),s="["+a+"]",l=RegExp("^"+s+s+"*"),u=RegExp(s+s+"*$"),c=function(p,g,b){var v={},k=o(function(){return!!a[p]()||"\u200B\x85"[p]()!="\u200B\x85"}),C=v[p]=k?g(h):a[p];b&&(v[b]=C),i(i.P+i.F*k,"String",v)},h=c.trim=function(p,g){return p=String(n(p)),1&g&&(p=p.replace(l,"")),2&g&&(p=p.replace(u,"")),p};r.exports=c},function(r,t){r.exports=`	
\v\f\r \xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF`},function(r,t,e){"use strict";var i=e(0),n=e(46)(!1),o=[].indexOf,a=!!o&&1/[1].indexOf(1,-0)<0;i(i.P+i.F*(a||!e(25)(o)),"Array",{indexOf:function(s){return a?o.apply(this,arguments)||0:n(this,s,arguments[1])}})},function(r,t,e){var i=e(3),n=e(12),o=function(a,s){if(n(a),!i(s)&&s!==null)throw TypeError(s+": can't set as prototype!")};r.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(a,s,l){try{(l=e(22)(Function.call,e(49).f(Object.prototype,"__proto__").set,2))(a,[]),s=!(a instanceof Array)}catch(u){s=!0}return function(u,c){return o(u,c),s?u.__proto__=c:l(u,c),u}}({},!1):void 0),check:o}},function(r,t,e){"use strict";e.r(t),e(34),e(20),e(50),e(31),e(51),e(52),e(10),e(53),e(54);var i=.75,n=10,o=!0,a=!0,s=!0,l=!1,u="driver-highlighted-element-stage",c='<div id="'.concat("driver-page-overlay",'"></div>'),h='<div id="'.concat(u,'"></div>');e(33),e(77);function p(W){return(p=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Y){return typeof Y}:function(Y){return Y&&typeof Symbol=="function"&&Y.constructor===Symbol&&Y!==Symbol.prototype?"symbol":typeof Y})(W)}var g=function(W){var Y=document.createElement("div");return Y.innerHTML=W.trim(),Y.firstChild},b=function W(Y,re){if(arguments.length>2&&arguments[2]!==void 0&&arguments[2]){for(var ie=["","-webkit-","-ms-","moz-","-o-"],Q=0;Q<ie.length;Q++){var ee=W(Y,ie[Q]+re);if(ee)return ee}return""}var pe="";return Y.currentStyle?pe=Y.currentStyle[re]:document.defaultView&&document.defaultView.getComputedStyle&&(pe=document.defaultView.getComputedStyle(Y,null).getPropertyValue(re)),pe&&pe.toLowerCase?pe.toLowerCase():pe},v=function(W){return W&&p(W)==="object"&&"nodeType"in W};function k(W,Y){for(var re=0;re<Y.length;re++){var ie=Y[re];ie.enumerable=ie.enumerable||!1,ie.configurable=!0,"value"in ie&&(ie.writable=!0),Object.defineProperty(W,ie.key,ie)}}var C=function(){function W(Q,ee,pe){(function(be,we){if(!(be instanceof we))throw new TypeError("Cannot call a class as a function")})(this,W),this.options=Q,this.highlightedElement=null,this.lastHighlightedElement=null,this.hideTimer=null,this.window=ee,this.document=pe,this.removeNode=this.removeNode.bind(this)}var Y,re,ie;return Y=W,(re=[{key:"attachNode",value:function(){var Q=this.document.getElementById("driver-page-overlay");Q||(Q=g(c),document.body.appendChild(Q)),this.node=Q,this.node.style.opacity="0",this.options.animate||this.node.parentElement&&this.node.parentElement.removeChild(this.node)}},{key:"highlight",value:function(Q){Q&&Q.node?Q.isSame(this.highlightedElement)||(this.window.clearTimeout(this.hideTimer),Q.onHighlightStarted(),this.highlightedElement&&!this.highlightedElement.isSame(this.lastHighlightedElement)&&this.highlightedElement.onDeselected(),Q.getCalculatedPosition().canHighlight()&&(this.lastHighlightedElement=this.highlightedElement,this.highlightedElement=Q,this.show(),this.highlightedElement.onHighlighted())):console.warn("Invalid element to highlight. Must be an instance of `Element`")}},{key:"show",value:function(){var Q=this;this.node&&this.node.parentElement||(this.attachNode(),window.setTimeout(function(){Q.node.style.opacity="".concat(Q.options.opacity),Q.node.style.position="fixed",Q.node.style.left="0",Q.node.style.top="0",Q.node.style.bottom="0",Q.node.style.right="0"}))}},{key:"getHighlightedElement",value:function(){return this.highlightedElement}},{key:"getLastHighlightedElement",value:function(){return this.lastHighlightedElement}},{key:"clear",value:function(){var Q=arguments.length>0&&arguments[0]!==void 0&&arguments[0];this.options.onReset&&this.options.onReset(this.highlightedElement),this.highlightedElement&&this.highlightedElement.onDeselected(!0),this.highlightedElement=null,this.lastHighlightedElement=null,this.node&&(this.window.clearTimeout(this.hideTimer),this.options.animate&&!Q?(this.node.style.opacity="0",this.hideTimer=this.window.setTimeout(this.removeNode,300)):this.removeNode())}},{key:"removeNode",value:function(){this.node&&this.node.parentElement&&this.node.parentElement.removeChild(this.node)}},{key:"refresh",value:function(){this.highlightedElement&&(this.highlightedElement.showPopover(),this.highlightedElement.showStage())}}])&&k(Y.prototype,re),ie&&k(Y,ie),W}();e(80);function O(W,Y){for(var re=0;re<Y.length;re++){var ie=Y[re];ie.enumerable=ie.enumerable||!1,ie.configurable=!0,"value"in ie&&(ie.writable=!0),Object.defineProperty(W,ie.key,ie)}}var d=function(){function W(){var Q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},ee=Q.left,pe=ee===void 0?0:ee,be=Q.top,we=be===void 0?0:be,Le=Q.right,fe=Le===void 0?0:Le,xe=Q.bottom,Ne=xe===void 0?0:xe;(function(Be,Pe){if(!(Be instanceof Pe))throw new TypeError("Cannot call a class as a function")})(this,W),this.left=pe,this.right=fe,this.top=we,this.bottom=Ne}var Y,re,ie;return Y=W,(re=[{key:"canHighlight",value:function(){return this.left<this.right&&this.top<this.bottom}}])&&O(Y.prototype,re),ie&&O(Y,ie),W}();function _(W,Y){for(var re=0;re<Y.length;re++){var ie=Y[re];ie.enumerable=ie.enumerable||!1,ie.configurable=!0,"value"in ie&&(ie.writable=!0),Object.defineProperty(W,ie.key,ie)}}var m=function(){function W(){var Q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},ee=Q.node,pe=Q.options,be=Q.popover,we=Q.stage,Le=Q.overlay,fe=Q.window,xe=Q.document;(function(Ne,Be){if(!(Ne instanceof Be))throw new TypeError("Cannot call a class as a function")})(this,W),this.node=ee,this.document=xe,this.window=fe,this.options=pe,this.overlay=Le,this.popover=be,this.stage=we,this.animationTimeout=null}var Y,re,ie;return Y=W,(re=[{key:"isInView",value:function(){for(var Q=this.node.offsetTop,ee=this.node.offsetLeft,pe=this.node.offsetWidth,be=this.node.offsetHeight,we=this.node;we.offsetParent;)Q+=(we=we.offsetParent).offsetTop,ee+=we.offsetLeft;return Q>=this.window.pageYOffset&&ee>=this.window.pageXOffset&&Q+be<=this.window.pageYOffset+this.window.innerHeight&&ee+pe<=this.window.pageXOffset+this.window.innerWidth}},{key:"scrollManually",value:function(){var Q=this.node.getBoundingClientRect().top+this.window.pageYOffset-this.window.innerHeight/2;this.window.scrollTo(0,Q)}},{key:"bringInView",value:function(){if(this.node&&!this.isInView())if(this.node.scrollIntoView)try{this.node.scrollIntoView(this.options.scrollIntoViewOptions||{behavior:"instant",block:"center"})}catch(Q){this.scrollManually()}else this.scrollManually()}},{key:"getCalculatedPosition",value:function(){var Q=this.document.body,ee=this.document.documentElement,pe=this.window,be=this.window.pageYOffset||ee.scrollTop||Q.scrollTop,we=pe.pageXOffset||ee.scrollLeft||Q.scrollLeft,Le=this.node.getBoundingClientRect();return new d({top:Le.top+be,left:Le.left+we,right:Le.left+we+Le.width,bottom:Le.top+be+Le.height})}},{key:"getPopover",value:function(){return this.popover}},{key:"onDeselected",value:function(){var Q=arguments.length>0&&arguments[0]!==void 0&&arguments[0];this.hidePopover(),Q&&this.hideStage(),this.removeHighlightClasses(),this.window.clearTimeout(this.animationTimeout),this.options.onDeselected&&this.options.onDeselected(this)}},{key:"isSame",value:function(Q){return!(!Q||!Q.node)&&Q.node===this.node}},{key:"onHighlightStarted",value:function(){this.options.onHighlightStarted&&this.options.onHighlightStarted(this)}},{key:"onHighlighted",value:function(){this.isInView()||this.bringInView(),this.showPopover(),this.showStage(),this.addHighlightClasses(),this.options.onHighlighted&&this.options.onHighlighted(this)}},{key:"removeHighlightClasses",value:function(){this.node.classList.remove("driver-highlighted-element"),this.node.classList.remove("driver-position-relative");for(var Q=this.document.querySelectorAll(".".concat("driver-fix-stacking")),ee=0;ee<Q.length;ee++)Q[ee].classList.remove("driver-fix-stacking")}},{key:"addHighlightClasses",value:function(){this.node.classList.add("driver-highlighted-element"),this.canMakeRelative()&&this.node.classList.add("driver-position-relative"),this.fixStackingContext()}},{key:"fixStackingContext",value:function(){for(var Q=this.node.parentNode;Q&&Q.tagName&&Q.tagName.toLowerCase()!=="body";){var ee=b(Q,"z-index"),pe=parseFloat(b(Q,"opacity")),be=b(Q,"transform",!0),we=b(Q,"transform-style",!0),Le=b(Q,"transform-box",!0),fe=b(Q,"filter",!0),xe=b(Q,"perspective",!0);(/[0-9]+/.test(ee)||pe<1||be&&be!=="none"||we&&we!=="flat"||Le&&Le!=="border-box"||fe&&fe!=="none"||xe&&xe!=="none")&&Q.classList.add("driver-fix-stacking"),Q=Q.parentNode}}},{key:"canMakeRelative",value:function(){var Q=this.getStyleProperty("position");return["absolute","fixed","relative"].indexOf(Q)===-1}},{key:"getStyleProperty",value:function(Q){return b(this.node,Q)}},{key:"showStage",value:function(){this.stage.show(this.getCalculatedPosition())}},{key:"getNode",value:function(){return this.node}},{key:"hideStage",value:function(){this.stage.hide()}},{key:"hidePopover",value:function(){this.popover&&this.popover.hide()}},{key:"showPopover",value:function(){var Q=this;if(this.popover){var ee=this.getCalculatedPosition(),pe=300;this.options.animate&&this.overlay.lastHighlightedElement||(pe=0),this.animationTimeout=this.window.setTimeout(function(){Q.popover.show(ee)},pe)}}},{key:"getFullPageSize",value:function(){var Q=this.document.body,ee=this.document.documentElement;return{height:Math.max(Q.scrollHeight,Q.offsetHeight,ee.scrollHeight,ee.offsetHeight),width:Math.max(Q.scrollWidth,Q.offsetWidth,ee.scrollWidth,ee.offsetWidth)}}},{key:"getSize",value:function(){return{height:Math.max(this.node.scrollHeight,this.node.offsetHeight),width:Math.max(this.node.scrollWidth,this.node.offsetWidth)}}}])&&_(Y.prototype,re),ie&&_(Y,ie),W}();e(55),e(56);function y(W){return(y=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Y){return typeof Y}:function(Y){return Y&&typeof Symbol=="function"&&Y.constructor===Symbol&&Y!==Symbol.prototype?"symbol":typeof Y})(W)}function x(W,Y,re){return Y in W?Object.defineProperty(W,Y,{value:re,enumerable:!0,configurable:!0,writable:!0}):W[Y]=re,W}function S(W,Y){for(var re=0;re<Y.length;re++){var ie=Y[re];ie.enumerable=ie.enumerable||!1,ie.configurable=!0,"value"in ie&&(ie.writable=!0),Object.defineProperty(W,ie.key,ie)}}function w(W,Y){return!Y||y(Y)!=="object"&&typeof Y!="function"?function(re){if(re===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return re}(W):Y}function E(W){return(E=Object.setPrototypeOf?Object.getPrototypeOf:function(Y){return Y.__proto__||Object.getPrototypeOf(Y)})(W)}function L(W,Y){return(L=Object.setPrototypeOf||function(re,ie){return re.__proto__=ie,re})(W,Y)}var I=function(W){function Y(ee,pe,be){var we;return function(Le,fe){if(!(Le instanceof fe))throw new TypeError("Cannot call a class as a function")}(this,Y),(we=w(this,E(Y).call(this))).options=function(Le){for(var fe=1;fe<arguments.length;fe++){var xe=arguments[fe]!=null?arguments[fe]:{},Ne=Object.keys(xe);typeof Object.getOwnPropertySymbols=="function"&&(Ne=Ne.concat(Object.getOwnPropertySymbols(xe).filter(function(Be){return Object.getOwnPropertyDescriptor(xe,Be).enumerable}))),Ne.forEach(function(Be){x(Le,Be,xe[Be])})}return Le}({isFirst:!0,isLast:!0,totalCount:1,currentIndex:0,offset:0,showButtons:!0,closeBtnText:"Close",doneBtnText:"Done",startBtnText:"Next &rarr;",nextBtnText:"Next &rarr;",prevBtnText:"&larr; Previous"},ee),we.window=pe,we.document=be,we}var re,ie,Q;return function(ee,pe){if(typeof pe!="function"&&pe!==null)throw new TypeError("Super expression must either be null or a function");ee.prototype=Object.create(pe&&pe.prototype,{constructor:{value:ee,writable:!0,configurable:!0}}),pe&&L(ee,pe)}(Y,m),re=Y,(ie=[{key:"attachNode",value:function(){var ee=this.document.getElementById("driver-popover-item");ee&&ee.parentElement.removeChild(ee),ee=g(function(){var pe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return`
  <div id="`.concat("driver-popover-item",'" class="').concat(pe,`">
    <div class="`).concat("driver-popover-tip",`"></div>
    <div class="`).concat("driver-popover-title",`">Popover Title</div>
    <div class="`).concat("driver-popover-description",`">Popover Description</div>
    <div class="driver-clearfix `).concat("driver-popover-footer",`">
      <button class="`).concat("driver-close-btn",`">Close</button>
      <span class="driver-btn-group `).concat("driver-navigation-btns",`">
        <button class="`).concat("driver-prev-btn",`">&larr; Previous</button>
        <button class="`).concat("driver-next-btn",`">Next &rarr;</button>
      </span>
    </div>
  </div>`)}(this.options.className)),document.body.appendChild(ee),this.node=ee,this.tipNode=ee.querySelector(".".concat("driver-popover-tip")),this.titleNode=ee.querySelector(".".concat("driver-popover-title")),this.descriptionNode=ee.querySelector(".".concat("driver-popover-description")),this.footerNode=ee.querySelector(".".concat("driver-popover-footer")),this.nextBtnNode=ee.querySelector(".".concat("driver-next-btn")),this.prevBtnNode=ee.querySelector(".".concat("driver-prev-btn")),this.closeBtnNode=ee.querySelector(".".concat("driver-close-btn"))}},{key:"getTitleNode",value:function(){return this.titleNode}},{key:"getDescriptionNode",value:function(){return this.descriptionNode}},{key:"hide",value:function(){this.node&&(this.node.style.display="none")}},{key:"setInitialState",value:function(){this.node.style.display="block",this.node.style.left="0",this.node.style.top="0",this.node.style.bottom="",this.node.style.right="",this.node.querySelector(".".concat("driver-popover-tip")).className="driver-popover-tip"}},{key:"show",value:function(ee){switch(this.attachNode(),this.setInitialState(),this.titleNode.innerHTML=this.options.title,this.descriptionNode.innerHTML=this.options.description||"",this.renderFooter(),this.options.position){case"left":case"left-top":this.positionOnLeft(ee);break;case"left-center":this.positionOnLeftCenter(ee);break;case"left-bottom":this.positionOnLeftBottom(ee);break;case"right":case"right-top":this.positionOnRight(ee);break;case"right-center":this.positionOnRightCenter(ee);break;case"right-bottom":this.positionOnRightBottom(ee);break;case"top":case"top-left":this.positionOnTop(ee);break;case"top-center":this.positionOnTopCenter(ee);break;case"top-right":this.positionOnTopRight(ee);break;case"bottom":case"bottom-left":this.positionOnBottom(ee);break;case"bottom-center":this.positionOnBottomCenter(ee);break;case"bottom-right":this.positionOnBottomRight(ee);break;case"mid-center":this.positionOnMidCenter(ee);break;case"auto":default:this.autoPosition(ee)}this.bringInView()}},{key:"renderFooter",value:function(){this.nextBtnNode.innerHTML=this.options.nextBtnText,this.prevBtnNode.innerHTML=this.options.prevBtnText,this.closeBtnNode.innerHTML=this.options.closeBtnText;var ee=this.options.totalCount&&this.options.totalCount!==1;this.options.showButtons?(ee?(this.nextBtnNode.style.display="inline-block",this.prevBtnNode.style.display="inline-block",this.closeBtnNode.classList.remove("driver-close-only-btn")):(this.nextBtnNode.style.display="none",this.prevBtnNode.style.display="none",this.closeBtnNode.classList.add("driver-close-only-btn")),this.footerNode.style.display="block",this.options.isFirst?(this.prevBtnNode.classList.add("driver-disabled"),this.nextBtnNode.innerHTML=this.options.startBtnText):this.prevBtnNode.classList.remove("driver-disabled"),this.options.isLast?this.nextBtnNode.innerHTML=this.options.doneBtnText:this.nextBtnNode.innerHTML=this.options.nextBtnText):this.footerNode.style.display="none"}},{key:"positionOnLeft",value:function(ee){var pe=this.getSize().width,be=this.options.padding+10;this.node.style.left="".concat(ee.left-pe-be,"px"),this.node.style.top="".concat(ee.top+this.options.offset-this.options.padding,"px"),this.node.style.right="",this.node.style.bottom="",this.tipNode.classList.add("right")}},{key:"positionOnLeftBottom",value:function(ee){var pe=this.getSize(),be=pe.width,we=this.options.padding+10;this.node.style.left="".concat(ee.left-be-we,"px"),this.node.style.top="".concat(ee.bottom+this.options.padding+this.options.offset-pe.height,"px"),this.node.style.bottom="",this.node.style.right="",this.tipNode.classList.add("right","position-bottom")}},{key:"positionOnLeftCenter",value:function(ee){var pe=this.getSize(),be=pe.width,we=pe.height/2,Le=this.options.padding+10,fe=(ee.bottom-ee.top)/2,xe=ee.top-we+fe+this.options.offset;this.node.style.left="".concat(ee.left-be-Le,"px"),this.node.style.top="".concat(xe,"px"),this.node.style.right="",this.node.style.bottom="",this.tipNode.classList.add("right","position-center")}},{key:"positionOnRight",value:function(ee){var pe=this.options.padding+10;this.node.style.left="".concat(ee.right+pe,"px"),this.node.style.top="".concat(ee.top+this.options.offset-this.options.padding,"px"),this.node.style.right="",this.node.style.bottom="",this.tipNode.classList.add("left")}},{key:"positionOnRightCenter",value:function(ee){var pe=this.getSize(),be=this.options.padding+10,we=pe.height/2,Le=(ee.bottom-ee.top)/2,fe=ee.top-we+Le+this.options.offset;this.node.style.left="".concat(ee.right+be,"px"),this.node.style.top="".concat(fe,"px"),this.node.style.right="",this.node.style.bottom="",this.tipNode.classList.add("left","position-center")}},{key:"positionOnRightBottom",value:function(ee){var pe=this.options.padding+10,be=this.getSize();this.node.style.left="".concat(ee.right+pe,"px"),this.node.style.top="".concat(ee.bottom+this.options.padding+this.options.offset-be.height,"px"),this.node.style.bottom="",this.node.style.right="",this.tipNode.classList.add("left","position-bottom")}},{key:"positionOnTop",value:function(ee){var pe=this.getSize().height,be=this.options.padding+10;this.node.style.top="".concat(ee.top-pe-be,"px"),this.node.style.left="".concat(ee.left-this.options.padding+this.options.offset,"px"),this.node.style.right="",this.node.style.bottom="",this.tipNode.classList.add("bottom")}},{key:"positionOnTopCenter",value:function(ee){var pe=this.getSize(),be=pe.height,we=pe.width/2,Le=this.options.padding+10,fe=this.options.offset+ee.left+(ee.right-ee.left)/2;this.node.style.top="".concat(ee.top-be-Le,"px"),this.node.style.left="".concat(fe-we-this.options.padding,"px"),this.node.style.right="",this.node.style.bottom="",this.tipNode.classList.add("bottom","position-center")}},{key:"positionOnTopRight",value:function(ee){var pe=this.getSize(),be=pe.height,we=this.options.padding+10;this.node.style.top="".concat(ee.top-be-we,"px"),this.node.style.left="".concat(ee.right+this.options.padding+this.options.offset-pe.width,"px"),this.node.style.right="",this.node.style.bottom="",this.tipNode.classList.add("bottom","position-right")}},{key:"positionOnBottom",value:function(ee){var pe=this.options.padding+10;this.node.style.top="".concat(ee.bottom+pe,"px"),this.node.style.left="".concat(ee.left-this.options.padding+this.options.offset,"px"),this.node.style.right="",this.node.style.bottom="",this.tipNode.classList.add("top")}},{key:"positionOnBottomCenter",value:function(ee){var pe=this.getSize().width/2,be=this.options.padding+10,we=this.options.offset+ee.left+(ee.right-ee.left)/2;this.node.style.top="".concat(ee.bottom+be,"px"),this.node.style.left="".concat(we-pe-this.options.padding,"px"),this.node.style.right="",this.node.style.bottom="",this.tipNode.classList.add("top","position-center")}},{key:"positionOnBottomRight",value:function(ee){var pe=this.getSize(),be=this.options.padding+10;this.node.style.top="".concat(ee.bottom+be,"px"),this.node.style.left="".concat(ee.right+this.options.padding+this.options.offset-pe.width,"px"),this.node.style.right="",this.node.style.bottom="",this.tipNode.classList.add("top","position-right")}},{key:"positionOnMidCenter",value:function(ee){var pe=this.getSize(),be=pe.height,we=pe.width/2,Le=be/2,fe=(ee.bottom-ee.top)/2,xe=ee.top-Le+fe+this.options.offset,Ne=this.options.offset+ee.left+(ee.right-ee.left)/2;this.node.style.top="".concat(xe,"px"),this.node.style.left="".concat(Ne-we-this.options.padding,"px"),this.node.style.right="",this.node.style.bottom="",this.tipNode.classList.add("mid-center")}},{key:"autoPosition",value:function(ee){var pe=this.getFullPageSize(),be=this.getSize(),we=pe.height,Le=be.height,fe=this.options.padding+10;ee.bottom+Le+fe>=we?this.positionOnTop(ee):this.positionOnBottom(ee)}}])&&S(re.prototype,ie),Q&&S(re,Q),Y}();function A(W){return(A=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Y){return typeof Y}:function(Y){return Y&&typeof Symbol=="function"&&Y.constructor===Symbol&&Y!==Symbol.prototype?"symbol":typeof Y})(W)}function B(W,Y){for(var re=0;re<Y.length;re++){var ie=Y[re];ie.enumerable=ie.enumerable||!1,ie.configurable=!0,"value"in ie&&(ie.writable=!0),Object.defineProperty(W,ie.key,ie)}}function T(W,Y){return!Y||A(Y)!=="object"&&typeof Y!="function"?function(re){if(re===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return re}(W):Y}function M(W){return(M=Object.setPrototypeOf?Object.getPrototypeOf:function(Y){return Y.__proto__||Object.getPrototypeOf(Y)})(W)}function j(W,Y){return(j=Object.setPrototypeOf||function(re,ie){return re.__proto__=ie,re})(W,Y)}var J=function(W){function Y(ee,pe,be){var we;return function(Le,fe){if(!(Le instanceof fe))throw new TypeError("Cannot call a class as a function")}(this,Y),(we=T(this,M(Y).call(this))).options=ee,we.window=pe,we.document=be,we}var re,ie,Q;return function(ee,pe){if(typeof pe!="function"&&pe!==null)throw new TypeError("Super expression must either be null or a function");ee.prototype=Object.create(pe&&pe.prototype,{constructor:{value:ee,writable:!0,configurable:!0}}),pe&&j(ee,pe)}(Y,m),re=Y,(ie=[{key:"attachNode",value:function(){var ee=this.document.getElementById(u);ee||(ee=g(h),document.body.appendChild(ee)),this.node=ee,this.options.animate?this.node.classList.remove("driver-stage-no-animation"):this.node.classList.add("driver-stage-no-animation")}},{key:"hide",value:function(){this.node&&this.node.parentElement&&this.node.parentElement.removeChild(this.node)}},{key:"setInitialStyle",value:function(){this.node.style.display="block",this.node.style.left="0",this.node.style.top="0",this.node.style.bottom="",this.node.style.right=""}},{key:"show",value:function(ee){this.attachNode(),this.setInitialStyle();var pe=2*this.options.padding,be=ee.right-ee.left+pe,we=ee.bottom-ee.top+pe;this.node.style.display="block",this.node.style.position="absolute",this.node.style.width="".concat(be,"px"),this.node.style.height="".concat(we,"px"),this.node.style.top="".concat(ee.top-pe/2,"px"),this.node.style.left="".concat(ee.left-pe/2,"px"),this.node.style.backgroundColor=this.options.stageBackground}}])&&B(re.prototype,ie),Q&&B(re,Q),Y}();function U(W){for(var Y=1;Y<arguments.length;Y++){var re=arguments[Y]!=null?arguments[Y]:{},ie=Object.keys(re);typeof Object.getOwnPropertySymbols=="function"&&(ie=ie.concat(Object.getOwnPropertySymbols(re).filter(function(Q){return Object.getOwnPropertyDescriptor(re,Q).enumerable}))),ie.forEach(function(Q){H(W,Q,re[Q])})}return W}function H(W,Y,re){return Y in W?Object.defineProperty(W,Y,{value:re,enumerable:!0,configurable:!0,writable:!0}):W[Y]=re,W}function te(W,Y){for(var re=0;re<Y.length;re++){var ie=Y[re];ie.enumerable=ie.enumerable||!1,ie.configurable=!0,"value"in ie&&(ie.writable=!0),Object.defineProperty(W,ie.key,ie)}}e.d(t,"default",function(){return ae});var ae=function(){function W(){var Q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};(function(ee,pe){if(!(ee instanceof pe))throw new TypeError("Cannot call a class as a function")})(this,W),this.options=U({animate:o,opacity:i,padding:n,scrollIntoViewOptions:null,allowClose:a,keyboardControl:s,overlayClickNext:l,stageBackground:"#ffffff",onHighlightStarted:function(){return null},onHighlighted:function(){return null},onDeselected:function(){return null},onReset:function(){return null},onNext:function(){return null},onPrevious:function(){return null}},Q),this.document=document,this.window=window,this.isActivated=!1,this.steps=[],this.currentStep=0,this.currentMovePrevented=!1,this.overlay=new C(this.options,window,document),this.onResize=this.onResize.bind(this),this.onKeyUp=this.onKeyUp.bind(this),this.onClick=this.onClick.bind(this),this.moveNext=this.moveNext.bind(this),this.movePrevious=this.movePrevious.bind(this),this.preventMove=this.preventMove.bind(this),this.bind()}var Y,re,ie;return Y=W,(re=[{key:"getSteps",value:function(){return this.steps}},{key:"setSteps",value:function(Q){this.steps=Q}},{key:"bind",value:function(){this.window.addEventListener("resize",this.onResize,!1),this.window.addEventListener("keyup",this.onKeyUp,!1),"ontouchstart"in document.documentElement?this.window.addEventListener("touchstart",this.onClick,!1):this.window.addEventListener("click",this.onClick,!1)}},{key:"onClick",value:function(Q){if(this.isActivated&&this.hasHighlightedElement()){Q.stopPropagation();var ee=this.overlay.getHighlightedElement(),pe=this.document.getElementById("driver-popover-item"),be=ee.node.contains(Q.target),we=pe&&pe.contains(Q.target);if(be||we||!this.options.overlayClickNext)if(be||we||!this.options.allowClose){var Le=Q.target.classList.contains("driver-next-btn"),fe=Q.target.classList.contains("driver-prev-btn");Q.target.classList.contains("driver-close-btn")?this.reset():Le?this.handleNext():fe&&this.handlePrevious()}else this.reset();else this.handleNext()}}},{key:"onResize",value:function(){this.isActivated&&this.refresh()}},{key:"refresh",value:function(){this.overlay.refresh()}},{key:"onKeyUp",value:function(Q){if(this.isActivated&&this.options.keyboardControl)if(Q.keyCode!==27){var ee=this.getHighlightedElement();ee&&ee.popover&&(Q.keyCode===39?this.handleNext():Q.keyCode===37&&this.handlePrevious())}else this.reset()}},{key:"movePrevious",value:function(){var Q=this.steps[this.currentStep-1];Q?(this.overlay.highlight(Q),this.currentStep-=1):this.reset()}},{key:"preventMove",value:function(){this.currentMovePrevented=!0}},{key:"handleNext",value:function(){this.currentMovePrevented=!1;var Q=this.steps[this.currentStep];Q&&Q.options&&Q.options.onNext&&Q.options.onNext(this.overlay.highlightedElement),this.currentMovePrevented||this.moveNext()}},{key:"handlePrevious",value:function(){this.currentMovePrevented=!1;var Q=this.steps[this.currentStep];Q&&Q.options&&Q.options.onPrevious&&Q.options.onPrevious(this.overlay.highlightedElement),this.currentMovePrevented||this.movePrevious()}},{key:"moveNext",value:function(){var Q=this.steps[this.currentStep+1];Q?(this.overlay.highlight(Q),this.currentStep+=1):this.reset()}},{key:"hasNextStep",value:function(){return!!this.steps[this.currentStep+1]}},{key:"hasPreviousStep",value:function(){return!!this.steps[this.currentStep-1]}},{key:"reset",value:function(){var Q=arguments.length>0&&arguments[0]!==void 0&&arguments[0];this.currentStep=0,this.isActivated=!1,this.overlay.clear(Q)}},{key:"hasHighlightedElement",value:function(){var Q=this.overlay.getHighlightedElement();return Q&&Q.node}},{key:"getHighlightedElement",value:function(){return this.overlay.getHighlightedElement()}},{key:"getLastHighlightedElement",value:function(){return this.overlay.getLastHighlightedElement()}},{key:"defineSteps",value:function(Q){this.steps=[];for(var ee=0;ee<Q.length;ee++){var pe=this.prepareElementFromStep(Q[ee],Q,ee);pe&&this.steps.push(pe)}}},{key:"prepareElementFromStep",value:function(Q){var ee=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],pe=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,be=U({},this.options),we=Q,Le=typeof Q!="string"&&!v(Q);if(!Q||Le&&!Q.element)throw new Error("Element is required in step ".concat(pe));Le&&(we=Q.element,be=U({},this.options,Q));var fe=v(we)?we:this.document.querySelector(we);if(!fe)return console.warn("Element to highlight ".concat(we," not found")),null;var xe=null;if(be.popover&&be.popover.title){var Ne=[this.options.className,be.popover.className].filter(function(tt){return tt}).join(" "),Be=U({},be,be.popover,{className:Ne,totalCount:ee.length,currentIndex:pe,isFirst:pe===0,isLast:ee.length===0||pe===ee.length-1});xe=new I(Be,this.window,this.document)}var Pe=U({},be),Ze=new J(Pe,this.window,this.document);return new m({node:fe,options:be,popover:xe,stage:Ze,overlay:this.overlay,window:this.window,document:this.document})}},{key:"start",value:function(){var Q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;if(!this.steps||this.steps.length===0)throw new Error("There are no steps defined to iterate");this.isActivated=!0,this.currentStep=Q,this.overlay.highlight(this.steps[Q])}},{key:"highlight",value:function(Q){this.isActivated=!0;var ee=this.prepareElementFromStep(Q);ee&&this.overlay.highlight(ee)}}])&&te(Y.prototype,re),ie&&te(Y,ie),W}()}]).default})});window.frappe||(window.frappe={});frappe.provide=function(r){for(var t=r.split("."),e=window,i=0;i<t.length;i++){var n=t[i];e[n]||(e[n]={}),e=e[n]}return e};frappe.provide("locals");frappe.provide("frappe.flags");frappe.provide("frappe.settings");frappe.provide("frappe.utils");frappe.provide("frappe.ui.form");frappe.provide("frappe.modules");frappe.provide("frappe.templates");frappe.provide("frappe.test_data");frappe.provide("frappe.utils");frappe.provide("frappe.model");frappe.provide("frappe.user");frappe.provide("frappe.session");frappe.provide("frappe._messages");frappe.provide("locals.DocType");frappe.provide("frappe.listview_settings");frappe.provide("frappe.tour");frappe.provide("frappe.listview_parent_route");window.NEWLINE=`
`;window.TAB=9;window.UP_ARROW=38;window.DOWN_ARROW=40;window.cur_frm=null;frappe._=function(r,t,e=null){if(!r||typeof r!="string")return r;let i="",n=r;return e&&(i=frappe._messages[`${n}:${e}`]),i||(i=frappe._messages[n]||r),t&&typeof t=="object"&&(i=$.format(i,t)),i};window.__=frappe._;frappe.get_languages=function(){return frappe.languages||(frappe.languages=[],$.each(frappe.boot.lang_dict,function(r,t){frappe.languages.push({label:r,value:t})}),frappe.languages=frappe.languages.sort(function(r,t){return r.value<t.value?-1:1})),frappe.languages};(function(r){"use strict";var t=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;function e(){}e.extend=function(i){var n=this.prototype,o=Object.create(n);for(var a in i)o[a]=typeof i[a]=="function"&&typeof n[a]=="function"&&t.test(i[a])?function(l,u){return function(){var c=this._super;this._super=n[l];var h=u.apply(this,arguments);return this._super=c,h}}(a,i[a]):i[a];var s=typeof o.init=="function"?o.hasOwnProperty("init")?o.init:function(){n.init.apply(this,arguments)}:function(){};return s.prototype=o,o.constructor=s,s.extend=e.extend,s},r.Class=e})(window);String.prototype.includes||(String.prototype.includes=function(r,t){"use strict";return typeof t!="number"&&(t=0),t+r.length>this.length?!1:this.indexOf(r,t)!==-1});Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(r,t){if(this==null)throw new TypeError('"this" is null or not defined');var e=Object(this),i=e.length>>>0;if(i===0)return!1;for(var n=t|0,o=Math.max(n>=0?n:i-Math.abs(n),0);o<i;){if(e[o]===r)return!0;o++}return!1}});typeof String.prototype.trimLeft!="function"&&(String.prototype.trimLeft=function(){return this.replace(/^\s+/,"")});typeof String.prototype.trimRight!="function"&&(String.prototype.trimRight=function(){return this.replace(/\s+$/,"")});typeof Object.assign!="function"&&Object.defineProperty(Object,"assign",{value:function(t){"use strict";if(t==null)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),i=1;i<arguments.length;i++){var n=arguments[i];if(n!=null)for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},writable:!0,configurable:!0});frappe.require=function(r,t){return typeof r=="string"&&(r=[r]),r=r.map(e=>frappe.assets.bundled_asset(e)),new Promise(e=>{frappe.assets.execute(r,()=>{e(),t&&t()})})};frappe.assets={check:function(){if(window._version_number!=localStorage.getItem("_version_number")&&(frappe.assets.clear_local_storage(),console.log("Cleared App Cache.")),localStorage._last_load){var r=new Date-new Date(localStorage._last_load);(r<1e4||r>864e5)&&frappe.assets.clear_local_storage()}else frappe.assets.clear_local_storage();frappe.assets.init_local_storage()},init_local_storage:function(){localStorage._last_load=new Date,localStorage._version_number=window._version_number,frappe.boot&&(localStorage.metadata_version=frappe.boot.metadata_version)},clear_local_storage:function(){$.each(["_last_load","_version_number","metadata_version","page_info","last_visited"],function(t,e){localStorage.removeItem(e)});for(var r in localStorage)(r.indexOf("desk_assets:")===0||r.indexOf("_page:")===0||r.indexOf("_doctype:")===0||r.indexOf("preferred_breadcrumbs:")===0)&&localStorage.removeItem(r);console.log("localStorage cleared")},executed_:[],execute:function(r,t){for(var e=[],i=0,n=r.length;i<n;i++)frappe.assets.exists(r[i])||e.push(r[i]);e.length?frappe.assets.fetch(e,function(){frappe.assets.eval_assets(r,t)}):frappe.assets.eval_assets(r,t)},eval_assets:function(r,t){for(var e=0,i=r.length;e<i;e++){var n=r[e];frappe.assets.executed_.indexOf(n)===-1&&(frappe.assets.handler[frappe.assets.extn(n)](frappe.assets.get(n),n),frappe.assets.executed_.push(n))}t&&t()},exists:function(r){return frappe.assets.executed_.indexOf(r)!==-1?!0:frappe.boot.developer_mode?!1:!!frappe.assets.get(r)},fetch:function(r,t){frappe.call({type:"GET",method:"frappe.client.get_js",args:{items:r},callback:function(e){$.each(r,function(i,n){frappe.assets.add(n,e.message[i])}),t()},freeze:!0})},add:function(r,t){if("localStorage"in window)try{frappe.assets.set(r,t)}catch(e){frappe.assets.clear_local_storage(),frappe.assets.set(r,t)}},get:function(r){return localStorage.getItem("desk_assets:"+r)},set:function(r,t){localStorage.setItem("desk_assets:"+r,t)},extn:function(r){return r.indexOf("?")!=-1&&(r=r.split("?").slice(-1)[0]),r.split(".").slice(-1)[0]},handler:{js:function(r,t){frappe.dom.eval(r)},css:function(r,t){frappe.dom.set_style(r)}},bundled_asset(r,t=null){return!r.startsWith("/assets")&&r.includes(".bundle.")&&(r.endsWith(".css")&&t&&(r=`rtl_${r}`),r=frappe.boot.assets_json[r]||r),r}};function hp(r,t){return r==null?r:(this.unkeyed_index=0,r.replace(/\{(\w*)\}/g,function(e,i){if(i===""&&(i=this.unkeyed_index,this.unkeyed_index++),i==+i)return t[i]!==void 0?t[i]:e}.bind(this)))}jQuery&&(jQuery.format=hp);frappe.provide("frappe.form.formatters");frappe.form.link_formatters={};frappe.form.formatters={_right:function(r,t){return t&&(t.inline||t.only_value)?r:"<div style='text-align: right'>"+r+"</div>"},_apply_custom_formatter:function(r,t){if(t){let e=frappe.meta.docfield_map[t.parent]&&frappe.meta.docfield_map[t.parent][t.fieldname];e&&e.formatter&&typeof e.formatter=="function"&&(r=e.formatter(r,t))}return r},Data:function(r,t){return t&&t.options=="URL"?`<a href="${r}" title="Open Link" target="_blank">${r}</a>`:(r=r==null?"":r,frappe.form.formatters._apply_custom_formatter(r,t))},Autocomplete:function(r,t){return __(frappe.form.formatters.Data(r,t))},Select:function(r,t){return __(frappe.form.formatters.Data(r,t))},Float:function(r,t,e,i){var n=t.precision||cint(frappe.boot.sysdefaults&&frappe.boot.sysdefaults.float_precision)||null;if(t.options&&t.options.trim())return t.precision=n,frappe.form.formatters.Currency(r,t,e,i);if(!(e||{}).always_show_decimals&&!is_null(r)){var o=cstr(r).split(".");(o[1]==null||cint(o[1])===0)&&(n=0)}return frappe.form.formatters._right(r==null||r===""?"":format_number(r,null,n),e)},Int:function(r,t,e){return frappe.form.formatters._right(r==null?"":cint(r),e)},Percent:function(r,t,e){let i=t.precision||cint(frappe.boot.sysdefaults&&frappe.boot.sysdefaults.float_precision)||2;return frappe.form.formatters._right(flt(r,i)+"%",e)},Rating:function(r,t){let e="",i=t.options||5;return r=r*i,r=Math.round(r*2)/2,Array.from({length:cint(i)},(n,o)=>o+1).forEach(n=>{e+=`<svg class="icon icon-md" data-rating=${n} viewBox="0 0 24 24" fill="none">
				<path class="right-half ${n<=(r||0)?"star-click":""}" d="M11.9987 3.00011C12.177 3.00011 12.3554 3.09303 12.4471 3.27888L14.8213 8.09112C14.8941 8.23872 15.0349 8.34102 15.1978 8.3647L20.5069 9.13641C20.917 9.19602 21.0807 9.69992 20.7841 9.9892L16.9421 13.7354C16.8243 13.8503 16.7706 14.0157 16.7984 14.1779L17.7053 19.4674C17.7753 19.8759 17.3466 20.1874 16.9798 19.9945L12.2314 17.4973C12.1586 17.459 12.0786 17.4398 11.9987 17.4398V3.00011Z" fill="var(--star-fill)" stroke="var(--star-fill)"/>
				<path class="left-half ${n<=(r||0)||n-.5==r?"star-click":""}" d="M11.9987 3.00011C11.8207 3.00011 11.6428 3.09261 11.5509 3.27762L9.15562 8.09836C9.08253 8.24546 8.94185 8.34728 8.77927 8.37075L3.42887 9.14298C3.01771 9.20233 2.85405 9.70811 3.1525 9.99707L7.01978 13.7414C7.13858 13.8564 7.19283 14.0228 7.16469 14.1857L6.25116 19.4762C6.18071 19.8842 6.6083 20.1961 6.97531 20.0045L11.7672 17.5022C11.8397 17.4643 11.9192 17.4454 11.9987 17.4454V3.00011Z" fill="var(--star-fill)" stroke="var(--star-fill)"/>
			</svg>`}),`<div class="rating">
			${e}
		</div>`},Currency:function(r,t,e,i){var n=frappe.meta.get_field_currency(t,i),o=t.precision||cint(frappe.boot.sysdefaults.currency_precision)||2;if(o>2){var a=cstr(r).split("."),s=a.length>1?a[1]:"";if(s.length<3||s.length<o){let l=frappe.model.get_value(":Currency",n,"fraction_units")||100;s.length<cstr(l).length&&(o=cstr(l).length-1)}}return r=r==null||r===""?"":format_currency(r,n,o),e&&e.only_value?r:frappe.form.formatters._right(r,e)},Check:function(r){return`<input type="checkbox" disabled
			class="disabled-${r?"selected":"deselected"}">`},Link:function(r,t,e,i){var n=t._options||t.options,o=r;let a=frappe.utils.get_link_title(n,r);return r&&r.match&&r.match(/^['"].*['"]$/)&&r.replace(/^.(.*).$/,"$1"),e&&(e.for_print||e.only_value)?a||r:(frappe.form.link_formatters[n]&&i&&n!==i.doctype&&(r=frappe.form.link_formatters[n](r,i,t)),r?r[0]=="'"&&r[r.length-1]=="'"?r.substring(1,r.length-1):t&&t.link_onclick?repl('<a onclick="%(onclick)s">%(value)s</a>',{onclick:t.link_onclick.replace(/"/g,"&quot;"),value:r}):t&&n&&frappe.model.can_read(n)?`<a
					href="/app/${encodeURIComponent(frappe.router.slug(n))}/${encodeURIComponent(o)}"
					data-doctype="${n}"
					data-name="${o}"
					data-value="${o}">
					${__(e&&e.label||a||r)}</a>`:a||r:"")},Date:function(r){return frappe.datetime.str_to_user?(r&&(r=frappe.datetime.str_to_user(r),r==="Invalid date"&&(r=null)),r||""):r},DateRange:function(r){return Array.isArray(r)?__("{0} to {1}",[frappe.datetime.str_to_user(r[0]),frappe.datetime.str_to_user(r[1])]):r||""},Datetime:function(r){return r?moment(frappe.datetime.convert_to_user_tz(r)).format(frappe.boot.sysdefaults.date_format.toUpperCase()+" "+(frappe.boot.sysdefaults.time_format||"HH:mm:ss")):""},Text:function(r,t){if(r){for(var e=["<p","<div","<br","<table"],i=!1,n=0;n<e.length;n++)if(r.match(e[n])){i=!0;break}i||(r=frappe.utils.replace_newlines(r))}return frappe.form.formatters.Data(r,t)},Time:function(r){return r&&(r=frappe.datetime.str_to_user(r,!0)),r||""},Duration:function(r,t){if(r){let e=frappe.utils.get_duration_options(t);r=frappe.utils.get_formatted_duration(r,e)}return r||""},LikedBy:function(r){var t="";return $.each(JSON.parse(r||"[]"),function(e,i){i&&(t+=frappe.avatar(i))}),t},Tag:function(r){var t="";return $.each((r||"").split(","),function(e,i){i&&(t+=`
				<span
					class="data-pill btn-xs align-center ellipsis"
					style="background-color: var(--control-bg); box-shadow: none; margin-right: 4px;"
					data-field="_user_tags" data-label="${i}'">
					${i}
				</span>`)}),t},Comment:function(r){return r},Assign:function(r){var t="";return $.each(JSON.parse(r||"[]"),function(e,i){i&&(t+='<span class="label label-warning" 				style="margin-right: 7px;"				data-field="_assign">'+i+"</span>")}),t},SmallText:function(r){return frappe.form.formatters.Text(r)},TextEditor:function(r){let t=frappe.form.formatters.Text(r);try{!$(t).find(".ql-editor").length&&!$(t).hasClass("ql-editor")&&(t=`<div class="ql-editor read-mode">${t}</div>`)}catch(e){t=`<div class="ql-editor read-mode">${t}</div>`}return t},Code:function(r){return"<pre>"+(r==null?"":$("<div>").text(r).html())+"</pre>"},WorkflowState:function(r){var t=frappe.get_doc("Workflow State",r);return t?repl("<span class='label label-%(style)s' 				data-workflow-state='%(value)s'				style='padding-bottom: 4px; cursor: pointer;'>				<i class='fa fa-small fa-white fa-%(icon)s'></i> %(value)s</span>",{value:r,style:t.style.toLowerCase(),icon:t.icon}):"<span class='label'>"+r+"</span>"},Email:function(r){return $("<div></div>").text(r).html()},FileSize:function(r){return r>1048576?r=flt(flt(r)/1048576,1)+"M":r>1024&&(r=flt(flt(r)/1024,1)+"K"),r},TableMultiSelect:function(r,t,e){r=r||[];let n=frappe.get_meta(t.options).fields.find(a=>a.fieldtype==="Link");return r.map(a=>{let s=a[n.fieldname];return frappe.format(s,n,e,a)}).join(", ")},Color:r=>r?`<div>
			<div class="selected-color" style="background-color: ${r}"></div>
			<span class="color-value">${r}</span>
		</div>`:"",Icon:r=>r?`<div>
			<div class="selected-icon">${frappe.utils.icon(r,"md")}</div>
			<span class="icon-value">${r}</span>
		</div>`:""};frappe.form.get_formatter=function(r){return r||(r="Data"),frappe.form.formatters[r.replace(/ /g,"")]||frappe.form.formatters.Data};frappe.format=function(r,t,e,i){t||(t={fieldtype:"Data"}),t.fieldname=="_user_tags"&&(t.fieldtype="Tag");var n=t.fieldtype||"Data";n==="Dynamic Link"&&(n="Link",t._options=i?i[t.options]:null);var o=t.formatter||frappe.form.get_formatter(n),a=o(r,t,e,i);return typeof a=="string"&&(a=frappe.dom.remove_script_and_style(a)),a};frappe.get_format_helper=function(r){var t={get_formatted:function(e){var i=frappe.meta.get_docfield(r.doctype,e);return i||console.log("fieldname not found: "+e),frappe.format(r[e],i,{inline:1},r)}};return $.extend(t,r),t};frappe.form.link_formatters.User=function(r,t,e){return t&&(t.full_name||e&&t[`${e.fieldname}_full_name`])||r};frappe.provide("frappe.dom");frappe.dom={id_count:0,freeze_count:0,by_id:function(r){return document.getElementById(r)},get_unique_id:function(){let r="unique-"+frappe.dom.id_count;return frappe.dom.id_count++,r},set_unique_id:function(r){var t=$(r);if(t.attr("id"))return t.attr("id");var e="unique-"+frappe.dom.id_count;return t.attr("id",e),frappe.dom.id_count++,e},eval:function(r){if(!!r){var t=document.createElement("script");t.appendChild(document.createTextNode(r)),document.getElementsByTagName("head")[0].appendChild(t)}},remove_script_and_style:function(r){let t=["script","style","noscript","title","meta","base","head"];if(!new RegExp(t.map(s=>`<${s}>.*<\\/${s}>`).join("|"),"s").test(r))return r;var i=document.createElement("div");i.innerHTML=r;var n=!1;t.forEach(function(s){var l=i.getElementsByTagName(s);for(a=l.length;a--;)n=!0,l[a].parentNode.removeChild(l[a])});for(var o=i.getElementsByTagName("link"),a=o.length;a--;)o[a].getAttribute("rel")=="stylesheet"&&(n=!0,o[a].parentNode.removeChild(o[a]));return n?i.innerHTML:r},is_element_in_viewport:function(r,t=0){typeof jQuery=="function"&&r instanceof jQuery&&(r=r[0]);var e=r.getBoundingClientRect();return e.top+t>=0&&e.left+t>=0&&e.bottom-t<=$(window).height()&&e.right-t<=$(window).width()},is_element_in_modal(r){return Boolean($(r).parents(".modal").length)},set_style:function(r,t){if(!!r){var e=document.createElement("style");if(e.type="text/css",t){var i=document.getElementById(t);i&&i.parentNode.removeChild(i),e.id=t}return e.styleSheet?e.styleSheet.cssText=r:e.appendChild(document.createTextNode(r)),document.getElementsByTagName("head")[0].appendChild(e),e}},add:function(r,t,e,i,n,o){r&&r.substr&&(r=frappe.dom.by_id(r));var a=document.createElement(t);return r&&r.appendChild(a),e&&(t.toLowerCase()=="img"?a.src=e:a.className=e),i&&frappe.dom.css(a,i),n&&(a.innerHTML=n),o&&(a.onclick=o),a},css:function(r,t){return r&&t&&$.extend(r.style,t),r},activate:function(r,t,e,i="active"){r.find(`.${e}.${i}`).removeClass(i),t.addClass(i)},freeze:function(r,t){if($("#freeze").length)$("#freeze").addClass("in");else{var e=$('<div id="freeze" class="modal-backdrop fade"></div>').on("click",function(){if(cur_frm&&cur_frm.cur_grid)return cur_frm.cur_grid.toggle_view(),!1}).appendTo("#body");e.html(repl('<div class="freeze-message-container"><div class="freeze-message"><p class="lead">%(msg)s</p></div></div>',{msg:r||""})),setTimeout(function(){e.addClass("in")},1)}t&&$("#freeze").addClass(t),frappe.dom.freeze_count++},unfreeze:function(){if(!!frappe.dom.freeze_count&&(frappe.dom.freeze_count--,!frappe.dom.freeze_count))var r=$("#freeze").removeClass("in").remove()},save_selection:function(){if(window.getSelection){var r=window.getSelection();if(r.getRangeAt&&r.rangeCount){for(var t=[],e=0,i=r.rangeCount;e<i;++e)t.push(r.getRangeAt(e));return t}}else if(document.selection&&document.selection.createRange)return document.selection.createRange();return null},restore_selection:function(r){if(r)if(window.getSelection){var t=window.getSelection();t.removeAllRanges();for(var e=0,i=r.length;e<i;++e)t.addRange(r[e])}else document.selection&&r.select&&r.select()},is_touchscreen:function(){return"ontouchstart"in window},handle_broken_images(r){$(r).find("img").on("error",t=>{$(t.currentTarget).addClass("no-image")})},scroll_to_bottom(r){let t=$(r);t.scrollTop(t[0].scrollHeight)},file_to_base64(r){return new Promise(t=>{let e=new FileReader;e.onload=function(){t(e.result)},e.readAsDataURL(r)})},scroll_to_section(r){setTimeout(()=>{let t=$(`a:contains("${r}")`);t.length&&(t.parent().hasClass("collapsed")&&t.click(),frappe.ui.scroll(t.parent().parent()))},200)},pixel_to_inches(r){let t=$('<div id="dpi" style="height: 1in; width: 1in; left: 100%; position: fixed; top: 100%;"></div>');t.appendTo(document.body);let e=document.getElementById("dpi").offsetWidth,i=r/e;return t.remove(),i}};frappe.ellipsis=function(r,t){return t||(t=20),r=cstr(r),r.length>t&&(r=r.substr(0,t)+"..."),r};frappe.run_serially=function(r){var t=Promise.resolve();return r.forEach(e=>{e&&(t=t.then?t.then(e):Promise.resolve())}),t};frappe.load_image=(r,t,e,i=()=>{})=>{var n=new Image;n.onload=function(){t(this)},n.onerror=e,i(n),n.src=r};frappe.timeout=r=>new Promise(t=>{setTimeout(()=>t(),r*1e3)});frappe.scrub=function(r,t="_"){return r.replace(/ /g,t).toLowerCase()};frappe.unscrub=function(r){return frappe.model.unscrub(r)};frappe.get_data_pill=(r,t=null,e=null,i=null)=>{let n=$(`
		<button class="data-pill btn">
			<div class="flex align-center ellipsis">
				${i||""}
				<span class="pill-label ${i?"ml-2":""}">${r}</span>
			</div>
		</button>
	`);if(e){let o=$(`
			<span class="remove-btn cursor-pointer">
				${frappe.utils.icon("close","sm")}
			</span>
		`).click(()=>{e(t||r,n)});n.append(o)}return n};frappe.get_modal=function(r,t){return $(`<div class="modal fade" style="overflow: auto;" tabindex="-1">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<div class="fill-width flex title-section">
						<span class="indicator hidden"></span>
						<h4 class="modal-title">${r}</h4>
					</div>
					<div class="modal-actions">
						<button class="btn btn-modal-minimize btn-link hide">
							${frappe.utils.icon("collapse")}
						</button>
						<button class="btn btn-modal-close btn-link" data-dismiss="modal">
							${frappe.utils.icon("close-alt","sm","close-alt")}
						</button>
					</div>
				</div>
				<div class="modal-body ui-front">${t}</div>
				<div class="modal-footer hide">
					<div class="custom-actions"></div>
					<div class="standard-actions">
						<button type="button" class="btn btn-secondary btn-sm hide btn-modal-secondary">
						</button>
						<button type="button" class="btn btn-primary btn-sm hide btn-modal-primary">
							${__("Confirm")}
						</button>
					</div>
				</div>
			</div>
		</div>
	</div>`)};frappe.is_online=function(){return frappe.boot.developer_mode==1?!0:"onLine"in navigator?navigator.onLine:!0};$(window).on("online",function(){frappe.show_alert({indicator:"green",message:__("You are connected to internet.")})});$(window).on("offline",function(){frappe.show_alert({indicator:"orange",message:__("Connection lost. Some features might not work.")})});var Ii=class{constructor(t,e,i,n){this.layout=n,this.card_layout=i,this.parent=t,this.df=e||{},this.fields_list=[],this.fields_dict={},this.make(),this.df.label&&this.df.collapsible&&localStorage.getItem(e.css_class+"-closed")&&this.collapse(),this.row={wrapper:this.wrapper},this.refresh()}make(){let t=this.card_layout;this.wrapper=$(`<div class="row
				${this.df.is_dashboard_section?"form-dashboard-section":"form-section"}
				${t?"card-section":""}">
			`).appendTo(this.parent),this.layout&&this.layout.sections.push(this),this.df&&(this.df.label&&this.make_head(),this.df.description&&(this.description_wrapper=$(`<div class="col-sm-12 form-section-description">
						${__(this.df.description)}
					</div>`),this.wrapper.append(this.description_wrapper)),this.df.css_class&&this.wrapper.addClass(this.df.css_class),this.df.hide_border&&this.wrapper.toggleClass("hide-border",!0)),this.body=$('<div class="section-body">').appendTo(this.wrapper),this.df.body_html&&this.body.append(this.df.body_html)}make_head(){this.head=$(`
			<div class="section-head">
				${__(this.df.label)}
				<span class="ml-2 collapse-indicator mb-1"></span>
			</div>
		`),this.head.appendTo(this.wrapper),this.indicator=this.head.find(".collapse-indicator"),this.indicator.hide(),this.df.collapsible&&(this.collapse_link=this.head.on("click",()=>{this.collapse()}),this.set_icon(),this.indicator.show())}refresh(t){!this.df||(t=t||this.df.hidden||this.df.hidden_due_to_dependency,this.wrapper.toggleClass("hide-control",!!t))}collapse(t){!(this.head&&this.body)||(t===void 0&&(t=!this.body.hasClass("hide")),this.body.toggleClass("hide",t),this.head&&this.head.toggleClass("collapsed",t),this.set_icon(t),this.fields_list.forEach(e=>{e.df.fieldtype=="Signature"&&e.refresh()}),this.df.css_class&&localStorage.setItem(this.df.css_class+"-closed",t?"1":""))}set_icon(t){let e=t?"down":"up-line";this.indicator&&this.indicator.html(frappe.utils.icon(e,"sm","mb-1"))}is_collapsed(){return this.body.hasClass("hide")}has_missing_mandatory(){let t=!1;for(let e=0,i=this.fields_list.length;e<i;e++){let n=this.fields_list[e].df;if(n.reqd&&this.layout.doc[n.fieldname]==null){t=!0;break}}return t}hide(){this.on_section_toggle(!1)}show(){this.on_section_toggle(!0)}on_section_toggle(t){this.wrapper.toggleClass("hide-control",!t)}};var Mi=class{constructor(t,e,i,n,o){this.parent=t,this.df=e||{},this.frm=i,this.doctype=this.frm.doctype,this.label=this.df&&this.df.label,this.tabs_list=n,this.tabs_content=o,this.fields_list=[],this.fields_dict={},this.make(),this.setup_listeners(),this.refresh()}make(){let t=`${frappe.scrub(this.doctype,"-")}-${this.df.fieldname}`;this.parent=$(`
			<li class="nav-item">
				<a class="nav-link ${this.df.active?"active":""}" id="${t}-tab"
					data-toggle="tab"
					href="#${t}"
					role="tab"
					aria-controls="${this.label}">
						${__(this.label)}
				</a>
			</li>
		`).appendTo(this.tabs_list),this.wrapper=$(`<div class="tab-pane fade show ${this.df.active?"active":""}"
			id="${t}" role="tabpanel" aria-labelledby="${t}-tab">`).appendTo(this.tabs_content)}refresh(){if(!this.df)return;let t=this.df.hidden||this.df.hidden_due_to_dependency;!t&&this.df.show_dashboard&&this.frm.is_new()&&!this.fields_list.length&&(t=!0),!t&&this.frm&&!this.frm.get_perm(this.df.permlevel||0,"read")&&(t=!0),!t&&!this.df.show_dashboard&&(t=!0,this.wrapper.find(".form-section:not(.hide-control, .empty-section), .form-dashboard-section:not(.hide-control, .empty-section)").length&&(t=!1)),this.toggle(!t)}toggle(t){this.parent.toggleClass("hide",!t),this.wrapper.toggleClass("hide",!t),this.parent.toggleClass("show",t),this.wrapper.toggleClass("show",t),this.hidden=!t}show(){this.parent.show()}hide(){this.parent.hide()}set_active(){var t,e;this.parent.find(".nav-link").tab("show"),this.wrapper.addClass("active"),(e=(t=this.frm)==null?void 0:t.set_active_tab)==null||e.call(t,this)}is_active(){return this.wrapper.hasClass("active")}is_hidden(){return this.wrapper.hasClass("hide")}setup_listeners(){this.parent.find(".nav-link").on("shown.bs.tab",()=>{var t,e;(e=this==null?void 0:(t=this.frm).set_active_tab)==null||e.call(t,this)})}};var Ni=class{constructor(t,e){e||(e={}),this.df=e,this.section=t,this.make(),this.resize_all_columns()}make(){this.wrapper=$(`
			<div class="form-column">
				<form>
				</form>
			</div>
		`).appendTo(this.section.body).find("form").on("submit",function(){return!1}),this.df.label&&$(`
				<label class="control-label">
					${__(this.df.label)}
				</label>
			`).appendTo(this.wrapper)}resize_all_columns(){let t=cint(12/this.section.wrapper.find(".form-column").length);this.section.wrapper.find(".form-column").removeClass().addClass("form-column").addClass("col-sm-"+t)}refresh(){this.section.refresh()}};frappe.ui.form.Layout=class{constructor(t){this.views={},this.pages=[],this.tabs=[],this.sections=[],this.page_breaks=[],this.fields_list=[],this.fields_dict={},$.extend(this,t)}make(){!this.parent&&this.body&&(this.parent=this.body),this.wrapper=$('<div class="form-layout">').appendTo(this.parent),this.message=$('<div class="form-message hidden"></div>').appendTo(this.wrapper),this.page=$('<div class="form-page"></div>').appendTo(this.wrapper),this.fields||(this.fields=this.get_doctype_fields()),this.is_tabbed_layout()&&this.setup_tabbed_layout(),this.setup_tab_events(),this.render()}setup_tabbed_layout(){$(`
			<div class="form-tabs-list">
				<ul class="nav form-tabs" id="form-tabs" role="tablist"></ul>
			</div>
		`).appendTo(this.page),this.tabs_list=this.page.find(".form-tabs"),this.tabs_content=$('<div class="form-tab-content tab-content"></div>').appendTo(this.page),this.setup_events()}show_empty_form_message(){this.wrapper.find(".frappe-control:visible").length||this.wrapper.find(".section-head.collapsed").length||this.show_message(__("This form does not have any input"))}get_doctype_fields(){let t=[this.get_new_name_field()];return this.doctype_layout?t=t.concat(this.get_fields_from_layout()):t=t.concat(frappe.meta.sort_docfields(frappe.meta.docfield_map[this.doctype])),t}get_new_name_field(){return{parent:this.frm.doctype,fieldtype:"Data",fieldname:"__newname",reqd:1,hidden:1,label:__("Name"),get_status:function(t){return t.frm&&t.frm.is_new()&&t.frm.meta.autoname&&["prompt","name"].includes(t.frm.meta.autoname.toLowerCase())?"Write":"None"}}}get_fields_from_layout(){let t=[];for(let e of this.doctype_layout.fields){let i=copy_dict(frappe.meta.docfield_map[this.doctype][e.fieldname]);i.label=e.label,t.push(i)}return t}show_message(t,e){this.message_color&&this.message.removeClass(this.message_color),this.message_color=e&&["yellow","blue","red","green","orange"].includes(e)?e:"blue",t?(t.substr(0,1)!=="<"&&(t="<div>"+t+"</div>"),this.message.removeClass("hidden").addClass(this.message_color),$(t).appendTo(this.message)):this.message.empty().addClass("hidden")}render(t){let e=t||this.fields;if(this.section=null,this.column=null,this.no_opening_section()&&!this.is_tabbed_layout()&&this.fields.unshift({fieldtype:"Section Break"}),this.is_tabbed_layout()){let i={label:__("Details"),fieldtype:"Tab Break",fieldname:"__details"};(this.fields[1].fieldtype==="Tab Break"?this.fields[1]:null)||this.fields.splice(1,0,i)}e.forEach(i=>{switch(i.fieldtype){case"Fold":this.make_page(i);break;case"Page Break":this.make_page_break(),this.make_section(i);break;case"Section Break":this.make_section(i);break;case"Column Break":this.make_column(i);break;case"Tab Break":this.make_tab(i);break;default:this.make_field(i)}})}no_opening_section(){return this.fields[0]&&this.fields[0].fieldtype!="Section Break"||!this.fields.length}no_opening_tab(){return this.fields[1]&&this.fields[1].fieldtype!="Tab Break"||!this.fields.length}is_tabbed_layout(){return this.fields.find(t=>t.fieldtype==="Tab Break")}replace_field(t,e,i){if(e.fieldname=t,this.fields_dict[t]&&this.fields_dict[t].df){let n=this.init_field(e,i);this.fields_dict[t].$wrapper.remove(),this.fields_list.splice(this.fields_dict[t],1,n),this.fields_dict[t]=n,this.section.fields_list.splice(this.section.fields_dict[t],1,n),this.section.fields_dict[t]=n,this.refresh_fields([e])}}make_field(t,e,i){!this.section&&this.make_section(),!this.column&&this.make_column();let n=this.init_field(t,i);this.fields_list.push(n),this.fields_dict[t.fieldname]=n,this.section.fields_list.push(n),this.section.fields_dict[t.fieldname]=n,n.section=this.section,this.current_tab&&(n.tab=this.current_tab,this.current_tab.fields_list.push(n),this.current_tab.fields_dict[t.fieldname]=n)}init_field(t,e=!1){let i=frappe.ui.form.make_control({df:t,doctype:this.doctype,parent:this.column.wrapper.get(0),frm:this.frm,render_input:e,doc:this.doc,layout:this});return i.layout=this,i}make_page_break(){this.page=$('<div class="form-page page-break"></div>').appendTo(this.wrapper)}make_page(t){let e=this,i=$('<div class="form-clickable-section text-center">				<a class="btn-fold h6 text-muted">'+__("Show more details")+"</a>			</div>").appendTo(this.wrapper);this.page=$('<div class="form-page second-page hide"></div>').appendTo(this.wrapper),this.fold_btn=i.find(".btn-fold").on("click",function(){let n=$(this).parent().next();n.hasClass("hide")?($(this).removeClass("btn-fold").html(__("Hide details")),n.removeClass("hide"),frappe.utils.scroll_to($(this),!0,30),e.folded=!1):($(this).addClass("btn-fold").html(__("Show more details")),n.addClass("hide"),e.folded=!0)}),this.section=null,this.folded=!0}unfold(){this.fold_btn.trigger("click")}make_section(t){this.section=new Ii(this.current_tab?this.current_tab.wrapper:this.page,t,this.card_layout,this),t&&(this.fields_dict[t.fieldname]=this.section,this.fields_list.push(this.section)),this.column=null}make_column(t){this.column=new Ni(this.section,t),t&&t.fieldname&&this.fields_list.push(this.column)}make_tab(t){this.section=null;let e=new Mi(this,t,this.frm,this.tabs_list,this.tabs_content);return this.current_tab=e,this.make_section({fieldtype:"Section Break"}),this.tabs.push(e),e}refresh(t){t&&(this.doc=t),this.frm&&this.wrapper.find(".empty-form-alert").remove(),this.attach_doc_and_docfields(!0),this.frm&&this.frm.wrapper&&$(this.frm.wrapper).trigger("refresh-fields"),this.refresh_dependency(),this.refresh_sections(),this.frm&&this.refresh_section_collapse(),document.activeElement&&document.activeElement.tagName=="INPUT"&&this.is_numeric_field_active()&&document.activeElement.select()}is_numeric_field_active(){let e=($(document.activeElement).closest(".frappe-control").data()||{}).fieldtype;return frappe.model.numeric_fieldtypes.includes(e)}refresh_sections(){this.wrapper.find(".form-section:not(.hide-control)").each(function(){let t=$(this).removeClass("empty-section visible-section");t.find(".frappe-control:not(.hide-control)").length?t.addClass("visible-section"):t.addClass("empty-section")}),this.is_tabbed_layout()&&this.refresh_tabs()}refresh_tabs(){for(let e of this.tabs)e.refresh();let t=this.tabs.filter(e=>!e.hidden);t&&t.length==1&&t[0].parent.toggleClass("hide show"),this.set_tab_as_active()}set_tab_as_active(){var e,i;let t=(i=this==null?void 0:(e=this.frm).get_active_tab)==null?void 0:i.call(e);if(t)t.set_active();else if(this.tabs.length){let n=this.tabs.find(o=>!o.is_hidden());n&&n.set_active()}}refresh_fields(t){let e=t.map(i=>{if(i.fieldname)return i.fieldname});this.fields_list.map(i=>{e.includes(i.df.fieldname)&&(i.refresh(),i.df.default&&i.set_input(i.df.default))})}add_fields(t){this.render(t),this.refresh_fields(t)}refresh_section_collapse(){if(!!(this.sections&&this.sections.length))for(let t=0;t<this.sections.length;t++){let e=this.sections[t],i=e.df;if(i&&i.collapsible){let n=!0;i.collapsible_depends_on&&(n=!this.evaluate_depends_on_value(i.collapsible_depends_on)),n&&e.has_missing_mandatory()&&(n=!1),e.collapse(n)}}}attach_doc_and_docfields(t){let e=this;for(let i=0,n=this.fields_list.length;i<n;i++){let o=this.fields_list[i];e.doc&&(o.doc=e.doc,o.doctype=e.doc.doctype,o.docname=e.doc.name,o.df=frappe.meta.get_docfield(e.doc.doctype,o.df.fieldname,e.doc.name)||o.df),t&&o.df&&o.refresh&&o.refresh()}}refresh_section_count(){this.wrapper.find(".section-count-label:visible").each(function(t){$(this).html(t+1)})}setup_events(){this.tabs_list.off("click").on("click",".nav-link",t=>{t.preventDefault(),t.stopImmediatePropagation(),$(t.currentTarget).tab("show")})}setup_tab_events(){this.wrapper.on("keydown",t=>{if(t.which==9){let e=$(t.target),i=e.attr("data-doctype"),n=e.attr("data-fieldname");if(i)return this.handle_tab(i,n,t.shiftKey)}})}handle_tab(t,e,i){let n=null,o=null,a=this.fields_list,s=!1;if(t!=this.doctype){if(n=this.get_open_grid_row(),!n||!n.layout)return;a=n.layout.fields_list}for(let l=0,u=a.length;l<u;l++){if(a[l].df.fieldname==e){if(i){o?this.set_focus(o):$(this.primary_button).focus();break}if(l<u-1&&(s=this.focus_on_next_field(l,a)),s)break}this.is_visible(a[l])&&(o=a[l])}return s||(n?n.doc.idx==n.grid.grid_rows.length?n.toggle_view(!1,function(){n.grid.frm.layout.handle_tab(n.grid.df.parent,n.grid.df.fieldname)}):n.grid.grid_rows[n.doc.idx].toggle_view(!0):i||$(this.primary_button).focus()),!1}focus_on_next_field(t,e){for(let i=t+1,n=e.length;i<n;i++){let o=e[i];if(this.is_visible(o)){if(o.df.fieldtype==="Table")return o.grid.grid_rows&&o.grid.grid_rows.length||o.grid.add_new_row(),o.grid.grid_rows[0].show_form(),!0;if(!in_list(frappe.model.no_value_type,o.df.fieldtype))return this.set_focus(o),!0}}}is_visible(t){return t.disp_status==="Write"&&t.df&&"hidden"in t.df&&!t.df.hidden}set_focus(t){t.tab&&t.tab.set_active(),t.df.fieldtype=="Table"?t.grid.grid_rows.length?t.grid.grid_rows[0].toggle_view(!0):t.grid.add_new_row(1):t.editor?t.editor.set_focus():t.$input&&t.$input.focus()}get_open_grid_row(){return $(".grid-row-open").data("grid_row")}refresh_dependency(){let t=!1,e=this.fields_list.concat(this.tabs);for(let i in e){let n=e[i];if(n.df.depends_on||n.df.mandatory_depends_on||n.df.read_only_depends_on){t=!0;break}}if(!!t){for(let i=e.length-1;i>=0;i--){let n=e[i];n.guardian_has_value=!0,n.df.depends_on&&(n.guardian_has_value=this.evaluate_depends_on_value(n.df.depends_on),n.guardian_has_value?n.df.hidden_due_to_dependency&&(n.df.hidden_due_to_dependency=!1,n.refresh()):n.df.hidden_due_to_dependency||(n.df.hidden_due_to_dependency=!0,n.refresh())),n.df.mandatory_depends_on&&this.set_dependant_property(n.df.mandatory_depends_on,n.df.fieldname,"reqd"),n.df.read_only_depends_on&&this.set_dependant_property(n.df.read_only_depends_on,n.df.fieldname,"read_only")}this.refresh_section_count()}}set_dependant_property(t,e,i){let o=this.evaluate_depends_on_value(t)?1:0,a;this.frm?a=this.frm:(this.is_dialog||this.doctype==="Web Form")&&(a=this),a&&(this.doc&&this.doc.parent&&this.doc.parentfield?(a.setting_dependency=!0,a.set_df_property(this.doc.parentfield,i,o,this.doc.parent,e,this.doc.name),a.setting_dependency=!1,this.fields_dict[e]&&this.fields_dict[e].refresh()):a.set_df_property(e,i,o))}evaluate_depends_on_value(t){let e=null,i=this.doc;if(!i&&this.get_values&&(i=this.get_values(!0)),!i)return;let n=this.frm?this.frm.doc:this.doc||null;if(typeof t=="boolean")e=t;else if(typeof t=="function")e=t(i);else if(t.substr(0,5)=="eval:")try{e=frappe.utils.eval(t.substr(5),{doc:i,parent:n}),n&&n.istable&&t.includes("is_submittable")&&(e=!0)}catch(a){frappe.throw(__('Invalid "depends_on" expression'))}else if(t.substr(0,3)=="fn:"&&this.frm)e=this.frm.script_manager.trigger(t.substr(3),this.doctype,this.docname);else{var o=i[t];$.isArray(o)?e=!!o.length:e=!!o}return e}};frappe.provide("frappe.ui");frappe.ui.FieldGroup=class extends frappe.ui.form.Layout{constructor(t){super(t);this.dirty=!1,$.each(this.fields||[],function(e,i){!i.fieldname&&i.label&&(i.fieldname=i.label.replace(/ /g,"_").toLowerCase())}),this.values&&this.set_values(this.values)}make(){var t=this;this.fields&&(super.make(),this.refresh(),$.each(this.fields_list,function(e,i){if(i.df.default){let n=i.df.default;n=="Today"&&i.df.fieldtype=="Date"&&(n=frappe.datetime.get_today()),i.set_input(n),t.refresh_dependency()}}),this.no_submit_on_enter||this.catch_enter_as_submit(),$(this.wrapper).find("input, select").on("change awesomplete-selectcomplete",()=>{this.dirty=!0,frappe.run_serially([()=>frappe.timeout(.1),()=>t.refresh_dependency()])}))}focus_on_first_input(){this.no_focus||$.each(this.fields_list,function(t,e){if(!in_list(["Date","Datetime","Time","Check"],e.df.fieldtype)&&e.set_focus)return e.set_focus(),!1})}catch_enter_as_submit(){var t=this;$(this.body).find('input[type="text"], input[type="password"], select').keypress(function(e){e.which==13&&t.has_primary_action&&(e.preventDefault(),t.get_primary_btn().trigger("click"))})}get_input(t){var e=this.fields_dict[t];return $(e.txt?e.txt:e.input)}get_field(t){return this.fields_dict[t]}get_values(t){var e={},i=[];for(var n in this.fields_dict){var o=this.fields_dict[n];if(o.get_value){var a=o.get_value();o.df.reqd&&is_null(typeof a=="string"?strip_html(a):a)&&i.push(__(o.df.label)),o.df.reqd&&o.df.fieldtype==="Text Editor"&&is_null(strip_html(cstr(a)))&&i.push(__(o.df.label)),is_null(a)||(e[o.df.fieldname]=a)}this.is_dialog&&o.df.reqd&&!o.value&&o.refresh_input()}return i.length&&!t?(frappe.msgprint({title:__("Missing Values Required"),message:__("Following fields have missing values:")+"<br><br><ul><li>"+i.join("<li>")+"</ul>",indicator:"orange"}),null):e}get_value(t){var e=this.fields_dict[t];return e&&(e.get_value?e.get_value():null)}set_value(t,e){return new Promise(i=>{var n=this.fields_dict[t];n?n.set_value(e).then(()=>{var o;(o=n.set_input)==null||o.call(n,e),this.refresh_dependency(),i()}):i()})}has_field(t){return!!this.fields_dict[t]}set_input(t,e){return this.set_value(t,e)}set_values(t){let e=[];for(var i in t)this.fields_dict[i]&&e.push(this.set_value(i,t[i]));return Promise.all(e)}clear(){for(var t in this.fields_dict){var e=this.fields_dict[t];e&&e.set_input&&e.set_input(e.df.default||"")}}set_df_property(t,e,i){if(!t)return;let n=this.get_field(t);n.df[e]=i,n.refresh()}};frappe.provide("frappe.ui");window.cur_dialog=null;frappe.ui.open_dialogs=[];frappe.ui.Dialog=class extends frappe.ui.FieldGroup{constructor(t){super();this.display=!1,this.is_dialog=!0,$.extend(this,{animate:!0,size:null},t),this.make()}make(){this.$wrapper=frappe.get_modal("",""),this.static&&(this.$wrapper.modal({backdrop:"static",keyboard:!1}),this.get_close_btn().hide()),this.wrapper=this.$wrapper.find(".modal-dialog").get(0),this.size=="small"?$(this.wrapper).addClass("modal-sm"):this.size=="large"?$(this.wrapper).addClass("modal-lg"):this.size=="extra-large"&&$(this.wrapper).addClass("modal-xl"),this.make_head(),this.modal_body=this.$wrapper.find(".modal-body"),this.$body=$("<div></div>").appendTo(this.modal_body),this.body=this.$body.get(0),this.$message=$('<div class="hide modal-message"></div>').appendTo(this.modal_body),this.header=this.$wrapper.find(".modal-header"),this.footer=this.$wrapper.find(".modal-footer"),this.standard_actions=this.footer.find(".standard-actions"),this.custom_actions=this.footer.find(".custom-actions"),this.set_indicator(),super.make(),this.refresh_section_collapse(),this.action=this.action||{primary:{},secondary:{}},(this.primary_action||this.action.primary&&this.action.primary.onsubmit)&&this.set_primary_action(this.primary_action_label||this.action.primary.label||__("Submit",null,"Primary action in dialog"),this.primary_action||this.action.primary.onsubmit),this.secondary_action&&this.set_secondary_action(this.secondary_action),(this.secondary_action_label||this.action.secondary&&this.action.secondary.label)&&this.set_secondary_action_label(this.secondary_action_label||this.action.secondary.label),this.minimizable&&(this.header.find(".title-section").click(()=>this.is_minimized&&this.toggle_minimize()),this.get_minimize_btn().removeClass("hide").on("click",()=>this.toggle_minimize()));var t=this;this.$wrapper.on("hide.bs.modal",function(){t.display=!1,t.is_minimized=!1,t.hide_scrollbar(!1),frappe.ui.open_dialogs[frappe.ui.open_dialogs.length-1]===t&&(frappe.ui.open_dialogs.pop(),frappe.ui.open_dialogs.length?window.cur_dialog=frappe.ui.open_dialogs[frappe.ui.open_dialogs.length-1]:window.cur_dialog=null),t.onhide&&t.onhide(),t.on_hide&&t.on_hide()}).on("shown.bs.modal",function(){t.display=!0,window.cur_dialog=t,frappe.ui.open_dialogs.push(t),t.focus_on_first_input(),t.hide_scrollbar(!0),t.on_page_show&&t.on_page_show(),$(document).trigger("frappe.ui.Dialog:shown"),$(document).off("focusin.modal")}).on("scroll",function(){var e=$("input:focus");e.length&&["Date","Datetime","Time"].includes(e.attr("data-fieldtype"))&&e.blur()})}get_primary_btn(){return this.standard_actions.find(".btn-primary")}get_minimize_btn(){return this.$wrapper.find(".modal-header .btn-modal-minimize")}set_message(t){this.$message.removeClass("hide"),this.$body.addClass("hide"),this.$message.text(t)}clear_message(){this.$message.addClass("hide"),this.$body.removeClass("hide")}clear(){super.clear(),this.clear_message()}set_primary_action(t,e){this.footer.removeClass("hide"),this.has_primary_action=!0;var i=this;return this.get_primary_btn().removeClass("hide").html(t).off("click").on("click",function(){i.primary_action_fulfilled=!0;var n=i.get_values();!n||e&&e.apply(i,[n])})}set_secondary_action(t){return this.footer.removeClass("hide"),this.get_secondary_btn().removeClass("hide").off("click").on("click",t)}set_secondary_action_label(t){this.get_secondary_btn().removeClass("hide").html(t)}disable_primary_action(){this.get_primary_btn().addClass("disabled")}enable_primary_action(){this.get_primary_btn().removeClass("disabled")}make_head(){this.set_title(this.title)}set_title(t){this.$wrapper.find(".modal-title").html(t)}set_indicator(){this.indicator&&this.header.find(".indicator").removeClass().addClass("indicator "+this.indicator)}show(){return this.animate?this.$wrapper.addClass("fade"):this.$wrapper.removeClass("fade"),this.$wrapper.modal("show"),this.$wrapper.removeClass("modal-minimize"),this.minimizable&&this.is_minimized&&($(".modal-backdrop").toggle(),this.is_minimized=!1),this.clear_message(),this.primary_action_fulfilled=!1,this.is_visible=!0,this}hide(){this.$wrapper.modal("hide"),this.is_visible=!1}get_close_btn(){return this.$wrapper.find(".btn-modal-close")}get_secondary_btn(){return this.standard_actions.find(".btn-modal-secondary")}no_cancel(){this.get_close_btn().toggle(!1)}cancel(){this.get_close_btn().trigger("click")}toggle_minimize(){$(".modal-backdrop").toggle();let t=this.$wrapper.closest(".modal").toggleClass("modal-minimize");t.attr("tabindex")?t.removeAttr("tabindex"):t.attr("tabindex",-1),this.is_minimized=!this.is_minimized;let e=this.is_minimized?"expand":"collapse";this.get_minimize_btn().html(frappe.utils.icon(e)),this.on_minimize_toggle&&this.on_minimize_toggle(this.is_minimized),this.header.find(".modal-title").toggleClass("cursor-pointer"),this.hide_scrollbar(!this.is_minimized)}hide_scrollbar(t){$("body").css("overflow",t?"hidden":"auto")}add_custom_action(t,e,i=null){this.footer.removeClass("hide");let n=$(`
			<button class="btn btn-secondary btn-sm ${i||""}">
				${t}
			</button>
		`);this.custom_actions.append(n),e&&n.click(e)}};frappe.ui.hide_open_dialog=()=>{window.cur_dialog&&(cur_dialog.minimizable?cur_dialog.is_minimized||cur_dialog.toggle_minimize():cur_dialog.hide())};frappe.provide("frappe.messages");frappe.messages.waiting=function(r,t){return $(frappe.messages.get_waiting_message(t)).appendTo(r)};frappe.messages.get_waiting_message=function(r){return repl('<div class="msg-box" style="width: 63%; margin: 30px auto;">		<p class="text-center">%(msg)s</p></div>',{msg:r})};frappe.throw=function(r){throw typeof r=="string"&&(r={message:r,title:__("Error")}),r.indicator||(r.indicator="red"),frappe.msgprint(r),new Error(r.message)};frappe.confirm=function(r,t,e){var i=new frappe.ui.Dialog({title:__("Confirm",null,"Title of confirmation dialog"),primary_action_label:__("Yes",null,"Approve confirmation dialog"),primary_action:()=>{t&&t(),i.hide()},secondary_action_label:__("No",null,"Dismiss confirmation dialog"),secondary_action:()=>i.hide()});return i.$body.append(`<p class="frappe-confirm-message">${r}</p>`),i.show(),i.confirm_dialog=!0,e&&(i.onhide=()=>{i.primary_action_fulfilled||e()}),i};frappe.warn=function(r,t,e,i,n){let o=new frappe.ui.Dialog({title:r,indicator:"red",primary_action_label:i,primary_action:()=>{e&&e(),o.hide()},secondary_action_label:__("Cancel",null,"Secondary button in warning dialog"),secondary_action:()=>o.hide(),minimizable:n});return o.$body.append(`<div class="frappe-confirm-message">${t}</div>`),o.standard_actions.find(".btn-primary").removeClass("btn-primary").addClass("btn-danger"),o.show(),o};frappe.prompt=function(r,t,e,i){typeof r=="string"&&(r=[{label:r,fieldname:"value",fieldtype:"Data",reqd:1}]),$.isArray(r)||(r=[r]);var n=new frappe.ui.Dialog({fields:r,title:e||__("Enter Value",null,"Title of prompt dialog")});return n.set_primary_action(i||__("Submit",null,"Primary action of prompt dialog"),function(){var o=n.get_values();!o||(n.hide(),t(o))}),n.show(),n};frappe.msgprint=function(r,t,e){if(!!r){if($.isPlainObject(r))var i=r;else if(typeof r=="string"&&r.substr(0,1)==="{")var i=JSON.parse(r);else var i={message:r,title:t};if(i.indicator||(i.indicator="blue"),i.as_list){let o=i.message.map(a=>`<li>${a}</li>`).join("");i.message=`<ul style="padding-left: 20px">${o}</ul>`}if(i.as_table){let o=i.message.map(a=>`<tr>${a.map(l=>`<td>${l}</td>`).join("")}</tr>`).join("");i.message=`<table class="table table-bordered" style="margin: 0;">${o}</table>`}if(i.message instanceof Array){let o=i.message,a=o.map(s=>JSON.parse(s)).filter(s=>s.raise_exception);a.length&&(o=a),o.forEach(function(s){frappe.msgprint(s)});return}if(i.alert||i.toast){frappe.show_alert(i);return}if(frappe.msg_dialog||(frappe.msg_dialog=new frappe.ui.Dialog({title:__("Message"),onhide:function(){frappe.msg_dialog.custom_onhide&&frappe.msg_dialog.custom_onhide(),frappe.msg_dialog.msg_area.empty()},minimizable:i.is_minimizable||e}),frappe.msg_dialog.msg_area=$('<div class="msgprint">').appendTo(frappe.msg_dialog.body),frappe.msg_dialog.clear=function(){frappe.msg_dialog.msg_area.empty()},frappe.msg_dialog.indicator=frappe.msg_dialog.header.find(".indicator")),i.primary_action){if(i.primary_action.server_action&&typeof i.primary_action.server_action=="string"&&(i.primary_action.action=()=>{frappe.call({method:i.primary_action.server_action,args:{args:i.primary_action.args},callback(){i.primary_action.hide_on_success&&frappe.hide_msgprint()}})}),i.primary_action.client_action&&typeof i.primary_action.client_action=="string"){let o=i.primary_action.client_action.split("."),a=window;for(let s of o)a=a[s];i.primary_action.action=()=>{typeof a=="function"&&a(i.primary_action.args)}}frappe.msg_dialog.set_primary_action(__(i.primary_action.label||i.primary_action_label||"Done"),i.primary_action.action)}else frappe.msg_dialog.has_primary_action&&(frappe.msg_dialog.get_primary_btn().addClass("hide"),frappe.msg_dialog.has_primary_action=!1);i.secondary_action&&(frappe.msg_dialog.set_secondary_action(i.secondary_action.action),frappe.msg_dialog.set_secondary_action_label(__(i.secondary_action.label||"Close"))),i.message==null&&(i.message=""),i.message.search(/<br>|<p>|<li>/)==-1&&(r=frappe.utils.replace_newlines(i.message));var n=!1;return i.clear?frappe.msg_dialog.msg_area.empty():n=frappe.msg_dialog.msg_area.html(),(i.title||!n)&&frappe.msg_dialog.set_title(i.title||__("Message",null,"Default title of the message dialog")),i.indicator?frappe.msg_dialog.indicator.removeClass().addClass("indicator "+i.indicator):frappe.msg_dialog.indicator.removeClass().addClass("hidden"),i.wide?frappe.msg_dialog.wrapper.classList.contains("msgprint-dialog")&&frappe.msg_dialog.wrapper.classList.remove("msgprint-dialog"):frappe.msg_dialog.wrapper.classList.add("msgprint-dialog"),n&&frappe.msg_dialog.msg_area.append("<hr>"),frappe.msg_dialog.msg_area.append(i.message),frappe.msg_dialog.$wrapper.css("z-index",2e3),frappe.msg_dialog.show(),frappe.msg_dialog}};window.msgprint=frappe.msgprint;frappe.hide_msgprint=function(r){frappe.msg_dialog&&frappe.msg_dialog.msg_area&&frappe.msg_dialog.msg_area.empty(),frappe.msg_dialog&&frappe.msg_dialog.$wrapper.is(":visible")&&(r&&frappe.msg_dialog.$wrapper.removeClass("fade"),frappe.msg_dialog.hide(),r&&frappe.msg_dialog.$wrapper.addClass("fade"))};frappe.update_msgprint=function(r){!frappe.msg_dialog||frappe.msg_dialog&&!frappe.msg_dialog.$wrapper.is(":visible")?frappe.msgprint(r):frappe.msg_dialog.msg_area.html(r)};frappe.verify_password=function(r){frappe.prompt({fieldname:"password",label:__("Enter your password"),fieldtype:"Password",reqd:1},function(t){frappe.call({method:"frappe.core.doctype.user.user.verify_password",args:{password:t.password},callback:function(e){e.exc||r()}})},__("Verify Password"),__("Verify"))};frappe.show_progress=(r,t,e=100,i,n=!1)=>{let o;return frappe.cur_progress&&frappe.cur_progress.title===r&&frappe.cur_progress.is_visible?o=frappe.cur_progress:(o=new frappe.ui.Dialog({title:r}),o.progress=$(`<div>
			<div class="progress">
				<div class="progress-bar"></div>
			</div>
			<p class="description text-muted small"></p>
		</div`).appendTo(o.body),o.progress_bar=o.progress.css({"margin-top":"10px"}).find(".progress-bar"),o.$wrapper.removeClass("fade"),o.show(),frappe.cur_progress=o),i&&o.progress.find(".description").text(i),o.percent=cint(flt(t)*100/e),o.progress_bar.css({width:o.percent+"%"}),n&&o.percent===100&&setTimeout(frappe.hide_progress,500),o};frappe.hide_progress=function(){frappe.cur_progress&&(frappe.cur_progress.hide(),frappe.cur_progress=null)};frappe.show_alert=frappe.toast=function(r,t=7,e={}){let i={orange:"solid-warning",yellow:"solid-warning",blue:"solid-info",green:"solid-success",red:"solid-error"};typeof r=="string"&&(r={message:r}),$("#dialog-container").length||$('<div id="dialog-container"><div id="alert-container"></div></div>').appendTo("body");let n;r.indicator?n=i[r.indicator.toLowerCase()]||"solid-"+r.indicator:n="solid-info";let o=r.indicator||"blue",a=$(`
		<div class="alert desk-alert ${o}" role="alert">
			<div class="alert-message-container">
				<div class="alert-title-container">
					<div>${frappe.utils.icon(n,"lg")}</div>
					<div class="alert-message">${r.message}</div>
				</div>
				<div class="alert-subtitle">${r.subtitle||""}</div>
			</div>
			<div class="alert-body" style="display: none"></div>
			<a class="close">${frappe.utils.icon("close-alt")}</a>
		</div>
	`);return a.hide().appendTo("#alert-container").show(),r.body&&a.find(".alert-body").show().html(r.body),a.find(".close, button").click(function(){return a.addClass("out"),setTimeout(()=>a.remove(),800),!1}),Object.keys(e).map(s=>{a.find(`[data-action=${s}]`).on("click",e[s])}),t>2&&(t=t-.8),setTimeout(()=>(a.addClass("out"),setTimeout(()=>a.remove(),800),!1),t*1e3),a};Object.defineProperty(window,"show_alert",{get:function(){return console.warn("Please use `frappe.show_alert` instead of `show_alert`. It will be deprecated soon."),frappe.show_alert}});frappe.provide("frappe.ui.keys");var Pi=new WeakMap,ka=[];frappe.ui.keys.shortcut_groups=Pi;frappe.ui.keys.get_shortcut_group=r=>(Pi.has(r)||Pi.set(r,new frappe.ui.keys.AltShortcutGroup),Pi.get(r));var wa=!1,jt=null,Yn=$(document.body);frappe.ui.keys.bind_shortcut_group_event=()=>{if(wa)return;wa=!0;function r(){jt?(jt.addClass("alt-pressed"),Yn.removeClass("alt-pressed")):(Yn.addClass("alt-pressed"),jt&&jt.removeClass("alt-pressed"))}function t(){jt&&jt.removeClass("alt-pressed"),Yn.removeClass("alt-pressed")}$(document).on("keydown",e=>{let i=(frappe.ui.keys.key_map[e.which]||"").toLowerCase();if(i==="alt"&&r(),!(e.shiftKey||e.ctrlKey||e.metaKey)&&i&&e.altKey){let n=_p(i);n&&(e.preventDefault(),n.$target[0].click()),r()}}),$(document).on("keyup",e=>{e.key==="Alt"&&t()}),$(document).on("mousemove",()=>{t()})};function _p(r){let t=ka.filter(i=>r in i.shortcuts_dict).map(i=>i.shortcuts_dict[r]).filter(i=>i.$target.is(":visible")),e=null;return jt&&jt.is(".open")&&(e=t.find(i=>$.contains(jt[0],i.$target[0]))),e||(e=t.find(i=>$.contains(window.cur_page.page.page.wrapper[0],i.$target[0])),e)}frappe.ui.keys.AltShortcutGroup=class{constructor(){this.shortcuts_dict={},jt=null,this.bind_events(),frappe.ui.keys.bind_shortcut_group_event(),ka.push(this)}bind_events(){$(document).on("show.bs.dropdown",t=>{jt&&jt.removeClass("alt-pressed");let e=$(t.target);e.is(".dropdown, .btn-group")&&(jt=e)}),$(document).on("hide.bs.dropdown",()=>{jt&&jt.removeClass("alt-pressed"),jt=null})}add(t,e){e||(e=t);let i=e.text().trim(),o=i.split("").find(s=>{s=s.toLowerCase();let l=s>="a"&&s<="z";return!this.is_taken(s)&&l});if(!o){e.attr("data-label",encodeURIComponent(i));return}for(let s in this.shortcuts_dict){let l=this.shortcuts_dict[s];if(l.text===i){l.$target=t,l.$text_el=e,this.underline_text(l);return}}let a={$target:t,$text_el:e,letter:o,text:i};this.shortcuts_dict[o.toLowerCase()]=a,this.underline_text(a)}underline_text(t){t.$text_el.attr("data-label",encodeURIComponent(t.text));let e=!1,i=t.text.split("").map(o=>(o===t.letter&&!e&&(o=`<span class="alt-underline">${o}</span>`,e=!0),o)).join("");i=t.$text_el.html().replace(t.text.trim(),i.trim()),t.$text_el.html(i)}is_taken(t){let e=frappe.ui.keys.standard_shortcuts.filter(i=>!i.page).some(i=>i.shortcut===`alt+${t}`);return t in this.shortcuts_dict||e}};frappe.provide("frappe.ui.keys.handlers");frappe.ui.keys.setup=function(){$(window).on("keydown",function(r){var t=frappe.ui.keys.get_key(r);if(frappe.ui.keys.handlers[t]){for(var e=null,i=0,n=frappe.ui.keys.handlers[t].length;i<n;i++){var o=frappe.ui.keys.handlers[t][i],a=o.apply(this,[r]);a===!1&&(e=a)}return e}})};var Er=[];frappe.ui.keys.standard_shortcuts=Er;frappe.ui.keys.add_shortcut=({shortcut:r,action:t,description:e,page:i,target:n,condition:o,ignore_inputs:a=!1}={})=>{if(n instanceof jQuery){let c=n;t=()=>{c[0].click()}}o||(o=()=>!0);let s=c=>{if(!($(document.activeElement).is("input, select, textarea, [contenteditable=true]")&&!a)&&!!o()&&t&&(!i||i.wrapper.is(":visible"))){let g=t(c);(g||g===void 0)&&c.preventDefault()}};s.page=i,frappe.ui.keys.off(r,i),frappe.ui.keys.on(r,s);let l=Er.findIndex(c=>c.shortcut===r),u={shortcut:r,action:t,description:e,page:i,condition:o};l===-1?Er.push(u):Er[l]=u};frappe.ui.keys.show_keyboard_shortcut_dialog=()=>{if(frappe.ui.keys.is_dialog_shown)return;let r=Er.filter(l=>!l.page),t=Er.filter(l=>l.page&&l.page===window.cur_page.page.page),e=Er.filter(l=>l.page&&l.page===window.cur_page.page.frm);function i(l,u){if(!l.length)return"";let c=l.filter(h=>h.condition?h.condition():!0).filter(h=>!!h.description).map(h=>{let p=h.shortcut.split("+").map(frappe.utils.to_title_case).join("+");return frappe.utils.is_mac()&&(p=p.replace("Ctrl","\u2318")),`<tr>
					<td width="40%"><kbd>${p}</kbd></td>
					<td width="60%">${h.description||""}</td>
				</tr>`}).join("");return c?(c=`<h5 style="margin: 0;">${u}</h5>
			<table style="margin-top: 10px;" class="table table-bordered">
				${c}
			</table>`,c):""}let n=i(r,__("Global Shortcuts")),o=i(t,__("Page Shortcuts")),a=i(e,__("Grid Shortcuts")),s=new frappe.ui.Dialog({title:__("Keyboard Shortcuts"),on_hide(){frappe.ui.keys.is_dialog_shown=!1}});s.$body.append(n),s.$body.append(o),s.$body.append(a),s.$body.append(`
		<div class="text-muted">
			${__("Press Alt Key to trigger additional shortcuts in Menu and Sidebar")}
		</div>
	`),s.show(),frappe.ui.keys.is_dialog_shown=!0};frappe.ui.keys.get_key=function(r){var t=r.keyCode||r.which,e=frappe.ui.keys.key_map[t]||String.fromCharCode(t);return(r.ctrlKey||r.metaKey)&&(e="ctrl+"+e),r.shiftKey&&(e="shift+"+e),r.altKey&&(e="alt+"+e),r.altKey&&r.ctrlKey,e.toLowerCase()};frappe.ui.keys.on=function(r,t){frappe.ui.keys.handlers[r]||(frappe.ui.keys.handlers[r]=[]),frappe.ui.keys.handlers[r].push(t)};frappe.ui.keys.off=function(r,t){let e=frappe.ui.keys.handlers[r];!e||e.length===0||(frappe.ui.keys.handlers[r]=e.filter(i=>t?i.page!==t:!1))};frappe.ui.keys.add_shortcut({shortcut:"ctrl+s",action:function(r){return frappe.app.trigger_primary_action(),r.preventDefault(),!1},description:__("Trigger Primary Action"),ignore_inputs:!0});frappe.ui.keys.add_shortcut({shortcut:"ctrl+g",action:function(r){return $("#navbar-search").focus(),r.preventDefault(),!1},description:__("Open Awesomebar")});frappe.ui.keys.add_shortcut({shortcut:"ctrl+h",action:function(r){r.preventDefault(),$(".navbar-home img").click()},description:__("Navigate Home")});frappe.ui.keys.add_shortcut({shortcut:"alt+s",action:function(r){r.preventDefault(),$(".dropdown-navbar-user a").eq(0).click()},description:__("Open Settings")});frappe.ui.keys.add_shortcut({shortcut:"shift+/",action:function(){frappe.ui.keys.show_keyboard_shortcut_dialog()},description:__("Show Keyboard Shortcuts")});frappe.ui.keys.add_shortcut({shortcut:"alt+h",action:function(r){r.preventDefault(),$(".dropdown-help a").eq(0).click()},description:__("Open Help")});frappe.ui.keys.on("escape",function(r){xa()});frappe.ui.keys.on("esc",function(r){xa()});frappe.ui.keys.on("enter",function(r){window.cur_dialog&&cur_dialog.confirm_dialog&&cur_dialog.get_primary_btn().trigger("click")});frappe.ui.keys.on("ctrl+down",function(r){var t=frappe.ui.form.get_open_grid_form();t&&t.toggle_view(!1,function(){t.open_next()})});frappe.ui.keys.on("ctrl+up",function(r){var t=frappe.ui.form.get_open_grid_form();t&&t.toggle_view(!1,function(){t.open_prev()})});frappe.ui.keys.add_shortcut({shortcut:"shift+ctrl+r",action:function(){frappe.ui.toolbar.clear_cache()},description:__("Clear Cache and Reload")});frappe.ui.keys.key_map={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",91:"meta",18:"alt",27:"escape",37:"left",39:"right",38:"up",40:"down",32:"space",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",191:"/",188:"<",190:">"};"abcdefghijklmnopqrstuvwxyz".split("").forEach((r,t)=>{frappe.ui.keys.key_map[65+t]=r});frappe.ui.keyCode={ESCAPE:27,LEFT:37,RIGHT:39,UP:38,DOWN:40,ENTER:13,TAB:9,SPACE:32,BACKSPACE:8};function xa(){var r;mp(),(r=document.activeElement)==null||r.blur()}function mp(){var r=$(".grid-row-open");if(r.length){var t=r.data("grid_row");return t.toggle_view(!1),!1}if(cur_dialog&&!cur_dialog.no_cancel_flag)return cur_dialog.cancel(),!1}frappe.provide("frappe.ui");frappe.ui.color={get:function(r,t){return r&&t?this.get_color_shade(r,t):r?this.get_color_shade(r,"default"):frappe.ui.color_map},get_color:function(r){let t=Object.keys(frappe.ui.color_map);if(t.includes(r))return frappe.ui.color_map[r];console.warn(`'color_name' can be one of ${t} and not ${r}`)},get_color_map(){let r=["red","green","blue","dark-green","yellow","gray","purple","pink","orange"],t=["100","300","500","700"],e=getComputedStyle(document.body),i={};return r.forEach(n=>{i[n]=t.map(o=>e.getPropertyValue(`--${n}-${o}`).trim())}),i},get_color_shade:function(r,t){let e={default:2,light:1,"extra-light":0,dark:3};if(Object.keys(e).includes(t)){let i=this.get_color(r);return i?i[e[t]]:r}else console.warn(`'shade' can be one of ${Object.keys(e)} and not ${t}`)},all:function(){return Object.values(frappe.ui.color_map).reduce((r,t)=>r.concat(t),[])},names:function(){return Object.keys(frappe.ui.color_map)},is_standard:function(r){return r?r.startsWith("#")?this.all().includes(r):this.names().includes(r):!1},get_color_name:function(r){for(let t in frappe.ui.color_map)if(frappe.ui.color_map[t].includes(r))return t},get_contrast_color:function(r){if(!this.validate_hex(r))return;if(!this.is_standard(r))return this.brightness(r)<128?this.lighten(r,.5):this.lighten(r,-.5);let t=this.get_color_name(r);return this.get_color(t).indexOf(r)<=1?this.get(t,"dark"):this.get(t,"extra-light")},validate_hex:function(r){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(r)},lighten(r,t){var e=parseInt(r.slice(1),16),i=t<0?0:255,n=t<0?t*-1:t,o=e>>16,a=e>>8&255,s=e&255;return"#"+(16777216+(Math.round((i-o)*n)+o)*65536+(Math.round((i-a)*n)+a)*256+(Math.round((i-s)*n)+s)).toString(16).slice(1)},hex_to_rgb(r){r.startsWith("#")&&(r=r.substring(1));let t=parseInt(r.substring(0,2),16),e=parseInt(r.substring(2,4),16),i=parseInt(r.substring(4,6),16);return{r:t,g:e,b:i}},brightness(r){let t=this.hex_to_rgb(r);return(t.r*299+t.g*587+t.b*114)/1e3}};frappe.ui.color_map=frappe.ui.color.get_color_map();frappe.provide("frappe.ui");frappe.ui.Sidebar=class{constructor({wrapper:t,css_class:e}){this.wrapper=t,this.css_class=e,this.items={},this.make_dom()}make_dom(){this.wrapper.html(`
			<div class="${this.css_class} overlay-sidebar hidden-xs hidden-sm">
			</div>
		`),this.$sidebar=this.wrapper.find("."+this.css_class)}add_item(t,e,i=!1){let n,o;if(!e&&this.wrapper.find(".sidebar-menu").length===0?n=this.get_section():n=this.get_section(e),t instanceof jQuery)o=$("<li>"),t.appendTo(o);else{let s=`<li class=${i?"h6":""}>
				<a ${t.href?`href="${t.href}"`:""}>${t.label}</a>
			</li>`;o=$(s).click(()=>t.on_click&&t.on_click())}n.append(o),t.name&&(this.items[t.name]=o)}remove_item(t){this.items[t]&&this.items[t].remove()}get_section(t=""){let e=$(this.wrapper.find(`[data-section-heading="${t}"]`));if(e.length)return e;let i=t?`<li class="h6">${t}</li>`:"";return e=$(`
			<ul class="list-unstyled sidebar-menu" data-section-heading="${t||"default"}">
				${i}
			</ul>
		`),this.$sidebar.append(e),e}};frappe.ui.LinkPreview=class{constructor(){this.popovers_list=[],this.LINK_CLASSES='a[data-doctype], input[data-fieldtype="Link"], .popover',this.popover_timeout=null,this.setup_events()}setup_events(){$(document.body).on("mouseover",this.LINK_CLASSES,r=>{this.link_hovered=!0,this.element=$(r.currentTarget),this.is_link=this.element.get(0).tagName.toLowerCase()==="a",this.element.parents().find(".popover").length||(this.identify_doc(),this.popover=this.element.data("bs.popover"),this.name&&this.doctype&&this.setup_popover_control(r))}),this.handle_popover_hide()}identify_doc(){this.is_link?(this.doctype=this.element.attr("data-doctype"),this.name=this.element.attr("data-name"),this.href=this.element.attr("href")):(this.href=this.element.parents(".control-input-wrapper").find(".control-value a").attr("href"),this.doctype=this.element.attr("data-target"),this.name=this.element.val())}setup_popover_control(r){!(frappe.boot.link_preview_doctypes||[]).includes(this.doctype)||(this.element.on("change",()=>{this.new_popover=!0}),!this.popover||this.new_popover?this.data_timeout=setTimeout(()=>{this.create_popover(r)},100):this.popover_timeout=setTimeout(()=>{this.element.is(":focus")||this.show_popover(r)},1e3))}create_popover(r){this.new_popover=!1,!this.element.is(":focus")&&this.get_preview_data().then(t=>{t&&(this.popover_timeout&&clearTimeout(this.popover_timeout),this.popover_timeout=setTimeout(()=>{if(this.popover&&this.popover.options){let e=this.get_popover_html(t);this.popover.options.content=e}else this.init_preview_popover(t);this.show_popover(r)},1e3))})}show_popover(r){if(this.default_timeout=setTimeout(()=>{this.clear_all_popovers()},1e4),this.is_link)this.element.popover("show");else{var t=r.pageX;this.element.popover("show");var e=$(".popover").width();$(".control-field-popover").css("left",t-e/2+"px")}}handle_popover_hide(){$(document).on("mouseout",this.LINK_CLASSES,()=>{$(".popover:hover").length||(this.link_hovered=!1),this.link_hovered||(this.data_timeout&&clearTimeout(this.data_timeout),this.popover_timeout&&clearTimeout(this.popover_timeout),this.default_timeout&&clearTimeout(this.default_timeout),this.clear_all_popovers())}),frappe.router.on("change",()=>{this.clear_all_popovers()})}clear_all_popovers(){this.popovers_list.forEach(r=>r.hide())}get_preview_data(){return frappe.xcall("frappe.desk.link_preview.get_preview_data",{doctype:this.doctype,docname:this.name})}init_preview_popover(r){let t=this.get_popover_html(r);this.element.popover({container:"body",template:`
				<div class="link-preview-popover popover">
					<div class="arrow"></div>
					<div class="popover-body popover-content">
					</div>
				</div>
			`,html:!0,sanitizeFn:i=>i,content:t,trigger:"manual",placement:"top"}),$(this.element.data("bs.popover").tip).toggleClass("control-field-popover",this.is_link),this.popovers_list.push(this.element.data("bs.popover"))}get_popover_html(r){return this.href||(this.href=window.location.href),this.href&&this.href.includes(" ")&&(this.href=this.href.replace(new RegExp(" ","g"),"%20")),`
			<div class="preview-popover-header">
				<div class="preview-header">
					${this.get_image_html(r)}
					<div class="preview-name">
						<a href=${this.href}>${__(r.preview_title)}</a>
					</div>
					<div class="text-muted preview-title">${this.get_id_html(r)}</div>
				</div>
			</div>
			<hr>
			<div class="popover-body">
				${this.get_content_html(r)}
			</div>
		`}get_id_html(r){let t="";return r.preview_title!==r.name&&(t=`<a class="text-muted" href=${this.href}>${r.name}</a>`),t}get_image_html(r){return`<div class="preview-image">
			${frappe.get_avatar("avatar-medium",r.preview_title,r.preview_image)}
		</div>`}get_content_html(r){let t="";return Object.keys(r).forEach(e=>{if(!["preview_image","preview_title","name"].includes(e)){let i=frappe.ellipsis(r[e],280),n=e;t+=`
					<div class="preview-field">
						<div class="preview-label text-muted">${__(n)}</div>
						<div class="preview-value">${i}</div>
					</div>
				`}}),`<div class="preview-table">${t}</div>`}};frappe.provide("frappe.request");frappe.provide("frappe.request.error_handlers");frappe.request.url="/";frappe.request.ajax_count=0;frappe.request.waiting_for_ajax=[];frappe.request.logs={};frappe.xcall=function(r,t){return new Promise((e,i)=>{frappe.call({method:r,args:t,callback:n=>{e(n.message)},error:n=>{i(n.message)}})})};frappe.call=function(r){if(!frappe.is_online())return frappe.show_alert({indicator:"orange",message:__("Connection Lost"),subtitle:__("You are not connected to Internet. Retry after sometime.")},3),r.always&&r.always(),$.ajax();typeof arguments[0]=="string"&&(r={method:arguments[0],args:arguments[1],callback:arguments[2],headers:arguments[3]}),r.quiet&&(r.no_spinner=!0);var t=$.extend({},r.args);t.freeze&&(r.freeze=r.freeze||t.freeze,r.freeze_message=r.freeze_message||t.freeze_message),r.module&&r.page?t.cmd=r.module+".page."+r.page+"."+r.page+"."+r.method:r.doc?$.extend(t,{cmd:"run_doc_method",docs:frappe.get_doc(r.doc.doctype,r.doc.name),method:r.method,args:r.args}):r.method&&(t.cmd=r.method);var e=function(n,o){if(n.task_id)frappe.socketio.subscribe(n.task_id,r),r.queued&&r.queued(n);else if(r.callback)return r.callback(n,o)};let i=r.url;if(!i){if(i="/api/method/"+t.cmd,window.cordova){let n=frappe.request.url;n=n.slice(0,n.length-1),i=n+i}delete t.cmd}return r.debounce&&frappe.request.is_fresh(t,r.debounce)?Promise.resolve():frappe.request.call({type:r.type||"POST",args:t,success:e,error:r.error,always:r.always,btn:r.btn,freeze:r.freeze,freeze_message:r.freeze_message,headers:r.headers||{},error_handlers:r.error_handlers||{},async:r.async,silent:r.silent,url:i})};frappe.request.call=function(r){frappe.request.prepare(r);var t={200:function(n,o){r.success_callback&&r.success_callback(n,o.responseText)},401:function(n){frappe.app.session_expired_dialog&&frappe.app.session_expired_dialog.display?frappe.app.redirect_to_login():frappe.app.handle_session_expired()},404:function(n){frappe.flags.setting_original_route?frappe.app.redirect_to_login():frappe.msgprint({title:__("Not found"),indicator:"red",message:__("The resource you are looking for is not available")})},403:function(n){if(frappe.session.user==="Guest"&&frappe.session.logged_in_user!=="Guest")frappe.app.handle_session_expired();else if(n.responseJSON&&n.responseJSON._error_message)frappe.msgprint({title:__("Not permitted"),indicator:"red",message:n.responseJSON._error_message}),n.responseJSON._server_messages=null;else if(n.responseJSON&&n.responseJSON._server_messages){var o=JSON.parse(n.responseJSON._server_messages);if(o.indexOf(__("Not permitted"))!==-1)return}else frappe.msgprint({title:__("Not permitted"),indicator:"red",message:__("You do not have enough permissions to access this resource. Please contact your manager to get access.")})},508:function(n){frappe.utils.play_sound("error"),frappe.msgprint({title:__("Please try again"),indicator:"red",message:__("Another transaction is blocking this one. Please try again in a few seconds.")})},413:function(n,o){frappe.msgprint({indicator:"red",title:__("File too big"),message:__("File size exceeded the maximum allowed size of {0} MB",[(frappe.boot.max_file_size||5242880)/1048576])})},417:function(n){var o=n.responseJSON;if(!o)try{o=JSON.parse(n.responseText)}catch(a){o=n.responseText}r.error_callback&&r.error_callback(o)},501:function(n,o){typeof n=="string"&&(n=JSON.parse(n)),r.error_callback&&r.error_callback(n,o.responseText)},500:function(n){frappe.utils.play_sound("error");try{r.error_callback&&r.error_callback(),frappe.request.report_error(n,r)}catch(o){frappe.request.report_error(n,r)}},504:function(n){frappe.msgprint(__("Request Timed Out")),r.error_callback&&r.error_callback()},502:function(n){frappe.msgprint(__("Internal Server Error"))}},e={QueryTimeoutError:function(){frappe.utils.play_sound("error"),frappe.msgprint({title:__("Request Timeout"),indicator:"red",message:__("Server was too busy to process this request. Please try again.")})},QueryDeadlockError:function(){frappe.utils.play_sound("error"),frappe.msgprint({title:__("Deadlock Occurred"),indicator:"red",message:__("Server was too busy to process this request. Please try again.")})}},i={url:r.url||frappe.request.url,data:r.args,type:r.type,dataType:r.dataType||"json",async:r.async,headers:Object.assign({"X-Frappe-CSRF-Token":frappe.csrf_token,Accept:"application/json","X-Frappe-CMD":r.args&&r.args.cmd||""||""},r.headers),cache:!1};return r.args&&r.args.doctype&&(i.headers["X-Frappe-Doctype"]=encodeURIComponent(r.args.doctype)),frappe.last_request=i.data,$.ajax(i).done(function(n,o,a){try{typeof n=="string"&&(n=JSON.parse(n)),(n.docs||n.docinfo)&&frappe.model.sync(n),n.__messages&&$.extend(frappe._messages,n.__messages),n._link_titles&&(frappe._link_titles||(frappe._link_titles={}),$.extend(frappe._link_titles,n._link_titles));var s=t[a.statusCode().status];s&&s(n,a)}catch(l){console.log("Unable to handle success response",n),console.error(l)}}).always(function(n,o,a){try{if(typeof n=="string"&&(n=JSON.parse(n)),n.responseText){var a=n;n=JSON.parse(n.responseText)}}catch(s){n=null}frappe.request.cleanup(r,n),r.always&&r.always(n)}).fail(function(n,o){try{if(n.getResponseHeader("content-type")=="application/json"&&n.responseText){var a;try{a=JSON.parse(n.responseText)}catch(c){console.log("Unable to parse reponse text"),console.log(n.responseText),console.log(c)}if(a&&a.exception){var s=a.exception.split(".").at(-1).split(":").at(0),l=e[s];if(l){l(a);return}}}var u=t[n.statusCode().status];if(u){u(n);return}r.error_callback&&r.error_callback(n)}catch(c){console.log("Unable to handle failed response"),console.error(c)}})};frappe.request.is_fresh=function(r,t){frappe.request.logs[r.cmd]||(frappe.request.logs[r.cmd]=[]);for(let e of frappe.request.logs[r.cmd])if(new Date-e.timestamp<t&&frappe.utils.deep_equal(r,e.args))return console.log("throttled"),!0;return frappe.request.logs[r.cmd].push({args:r,timestamp:new Date}),!1};frappe.request.prepare=function(r){$("body").attr("data-ajax-state","triggered"),r.btn&&$(r.btn).prop("disabled",!0),r.freeze&&frappe.dom.freeze(r.freeze_message);for(var t in r.args)r.args[t]&&($.isPlainObject(r.args[t])||$.isArray(r.args[t]))&&(r.args[t]=JSON.stringify(r.args[t]));if(!r.args.cmd&&!r.url)throw console.log(r),"Incomplete Request";r.success_callback=r.success,r.error_callback=r.error,delete r.success,delete r.error};frappe.request.cleanup=function(r,t){if(r.btn&&$(r.btn).prop("disabled",!1),$("body").attr("data-ajax-state","complete"),r.freeze&&frappe.dom.unfreeze(),t){if(t.session_expired||frappe.session.user==="Guest"&&frappe.session.logged_in_user!=="Guest"){frappe.app.handle_session_expired();return}let e=frappe.request.error_handlers[t.exc_type]||[],i=r.error_handlers?r.error_handlers[t.exc_type]:null,n=[].concat(e,i).filter(Boolean);t.exc_type&&n.forEach(o=>{o(t)}),t._server_messages&&!r.silent&&n.length===0&&(t._server_messages=JSON.parse(t._server_messages),frappe.hide_msgprint(),frappe.msgprint(t._server_messages)),t.exc&&(t.exc=JSON.parse(t.exc),t.exc instanceof Array?t.exc.forEach(o=>{o&&console.error(o)}):console.error(t.exc)),t._debug_messages&&(r.args&&(console.log("======== arguments ========"),console.log(r.args),console.log("========")),$.each(JSON.parse(t._debug_messages),function(o,a){console.log(a)}),console.log("======== response ========"),delete t._debug_messages,console.log(t),console.log("========"))}frappe.last_response=t};frappe.after_server_call=()=>frappe.request.ajax_count?new Promise(r=>{frappe.request.waiting_for_ajax.push(()=>{r()})}):null;frappe.after_ajax=function(r){return new Promise(t=>{if(frappe.request.ajax_count)frappe.request.waiting_for_ajax.push(()=>{if(r)return t(r());t()});else{if(r)return t(r());t()}})};frappe.request.report_error=function(r,t){var e=JSON.parse(r.responseText),i;if(e.exc){try{i=(JSON.parse(e.exc)||[]).join(`
`)}catch(s){i=e.exc}delete e.exc}else i="";let n=()=>{let s=u=>"```\n"+u+"\n```",l=["### App Versions",s(JSON.stringify(frappe.boot.versions,null,"	")),"### Route",s(frappe.get_route_str()),"### Trackeback",s(i),"### Request Data",s(JSON.stringify(t,null,"	")),"### Response Data",s(JSON.stringify(e,null,"	"))].join(`
`);frappe.utils.copy_to_clipboard(l)};var o=function(){var s=["<h5>Please type some additional information that could help us reproduce this issue:</h5>",'<div style="min-height: 100px; border: 1px solid #bbb; 				border-radius: 5px; padding: 15px; margin-bottom: 15px;"></div>',"<hr>","<h5>App Versions</h5>","<pre>"+JSON.stringify(frappe.boot.versions,null,"	")+"</pre>","<h5>Route</h5>","<pre>"+frappe.get_route_str()+"</pre>","<hr>","<h5>Error Report</h5>","<pre>"+i+"</pre>","<hr>","<h5>Request Data</h5>","<pre>"+JSON.stringify(t,null,"	")+"</pre>","<hr>","<h5>Response JSON</h5>","<pre>"+JSON.stringify(e,null,"	")+"</pre>"].join(`
`),l=new frappe.views.CommunicationComposer({subject:"Error Report ["+frappe.datetime.nowdate()+"]",recipients:a,message:s,doc:{doctype:"User",name:frappe.session.user}});l.dialog.$wrapper.css("z-index",cint(frappe.msg_dialog.$wrapper.css("z-index"))+1)};if(i){var a=frappe.boot.error_report_email;t=frappe.request.cleanup_request_opts(t),frappe.error_dialog||(frappe.error_dialog=new frappe.ui.Dialog({title:__("Server Error"),primary_action_label:__("Report"),primary_action:()=>{a?o():frappe.msgprint(__("Support Email Address Not Specified")),frappe.error_dialog.hide()},secondary_action_label:__("Copy error to clipboard"),secondary_action:()=>{n(),frappe.error_dialog.hide()}}),frappe.error_dialog.wrapper.classList.add("msgprint-dialog"));let s=strip(i).split(`
`);frappe.error_dialog.$body.html(s[s.length-1]),frappe.error_dialog.show()}};frappe.request.cleanup_request_opts=function(r){var t=(r.args||{}).doc;return t&&(t=JSON.parse(t),$.each(Object.keys(t),function(e,i){i.indexOf("password")!==-1&&t[i]&&(t[i]="*****")}),r.args.doc=JSON.stringify(t)),r};frappe.request.on_error=function(r,t){frappe.request.error_handlers[r]=frappe.request.error_handlers[r]||[],frappe.request.error_handlers[r].push(t)};$(document).ajaxSend(function(){frappe.request.ajax_count++});$(document).ajaxComplete(function(){frappe.request.ajax_count--,frappe.request.ajax_count||($.each(frappe.request.waiting_for_ajax||[],function(r,t){t()}),frappe.request.waiting_for_ajax=[])});var ar=Object.create(null);ar.open="0";ar.close="1";ar.ping="2";ar.pong="3";ar.message="4";ar.upgrade="5";ar.noop="6";var ri=Object.create(null);Object.keys(ar).forEach(r=>{ri[ar[r]]=r});var Ca={type:"error",data:"parser error"};var gp=typeof Blob=="function"||typeof Blob!="undefined"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",vp=typeof ArrayBuffer=="function",bp=r=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(r):r&&r.buffer instanceof ArrayBuffer,yp=({type:r,data:t},e,i)=>gp&&t instanceof Blob?e?i(t):Sa(t,i):vp&&(t instanceof ArrayBuffer||bp(t))?e?i(t):Sa(new Blob([t]),i):i(ar[r]+(t||"")),Sa=(r,t)=>{let e=new FileReader;return e.onload=function(){let i=e.result.split(",")[1];t("b"+i)},e.readAsDataURL(r)},Di=yp;var Ta="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ii=typeof Uint8Array=="undefined"?[]:new Uint8Array(256);for(let r=0;r<Ta.length;r++)ii[Ta.charCodeAt(r)]=r;var Ea=r=>{let t=r.length*.75,e=r.length,i,n=0,o,a,s,l;r[r.length-1]==="="&&(t--,r[r.length-2]==="="&&t--);let u=new ArrayBuffer(t),c=new Uint8Array(u);for(i=0;i<e;i+=4)o=ii[r.charCodeAt(i)],a=ii[r.charCodeAt(i+1)],s=ii[r.charCodeAt(i+2)],l=ii[r.charCodeAt(i+3)],c[n++]=o<<2|a>>4,c[n++]=(a&15)<<4|s>>2,c[n++]=(s&3)<<6|l&63;return u};var wp=typeof ArrayBuffer=="function",kp=(r,t)=>{if(typeof r!="string")return{type:"message",data:Aa(r,t)};let e=r.charAt(0);return e==="b"?{type:"message",data:xp(r.substring(1),t)}:ri[e]?r.length>1?{type:ri[e],data:r.substring(1)}:{type:ri[e]}:Ca},xp=(r,t)=>{if(wp){let e=Ea(r);return Aa(e,t)}else return{base64:!0,data:r}},Aa=(r,t)=>{switch(t){case"blob":return r instanceof ArrayBuffer?new Blob([r]):r;case"arraybuffer":default:return r}},ji=kp;var $a=String.fromCharCode(30),Oa=(r,t)=>{let e=r.length,i=new Array(e),n=0;r.forEach((o,a)=>{Di(o,!1,s=>{i[a]=s,++n===e&&t(i.join($a))})})},Ra=(r,t)=>{let e=r.split($a),i=[];for(let n=0;n<e.length;n++){let o=ji(e[n],t);if(i.push(o),o.type==="error")break}return i},Gn=4;function ht(r){if(r)return Cp(r)}function Cp(r){for(var t in ht.prototype)r[t]=ht.prototype[t];return r}ht.prototype.on=ht.prototype.addEventListener=function(r,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+r]=this._callbacks["$"+r]||[]).push(t),this};ht.prototype.once=function(r,t){function e(){this.off(r,e),t.apply(this,arguments)}return e.fn=t,this.on(r,e),this};ht.prototype.off=ht.prototype.removeListener=ht.prototype.removeAllListeners=ht.prototype.removeEventListener=function(r,t){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var e=this._callbacks["$"+r];if(!e)return this;if(arguments.length==1)return delete this._callbacks["$"+r],this;for(var i,n=0;n<e.length;n++)if(i=e[n],i===t||i.fn===t){e.splice(n,1);break}return e.length===0&&delete this._callbacks["$"+r],this};ht.prototype.emit=function(r){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),e=this._callbacks["$"+r],i=1;i<arguments.length;i++)t[i-1]=arguments[i];if(e){e=e.slice(0);for(var i=0,n=e.length;i<n;++i)e[i].apply(this,t)}return this};ht.prototype.emitReserved=ht.prototype.emit;ht.prototype.listeners=function(r){return this._callbacks=this._callbacks||{},this._callbacks["$"+r]||[]};ht.prototype.hasListeners=function(r){return!!this.listeners(r).length};var Zt=(()=>typeof self!="undefined"?self:typeof window!="undefined"?window:Function("return this")())();function zi(r,...t){return t.reduce((e,i)=>(r.hasOwnProperty(i)&&(e[i]=r[i]),e),{})}var Sp=setTimeout,Tp=clearTimeout;function mr(r,t){t.useNativeTimers?(r.setTimeoutFn=Sp.bind(Zt),r.clearTimeoutFn=Tp.bind(Zt)):(r.setTimeoutFn=setTimeout.bind(Zt),r.clearTimeoutFn=clearTimeout.bind(Zt))}var Ep=1.33;function La(r){return typeof r=="string"?Ap(r):Math.ceil((r.byteLength||r.size)*Ep)}function Ap(r){let t=0,e=0;for(let i=0,n=r.length;i<n;i++)t=r.charCodeAt(i),t<128?e+=1:t<2048?e+=2:t<55296||t>=57344?e+=3:(i++,e+=4);return e}var Ba=class extends Error{constructor(t,e,i){super(t);this.description=e,this.context=i,this.type="TransportError"}},Br=class extends ht{constructor(t){super();this.writable=!1,mr(this,t),this.opts=t,this.query=t.query,this.readyState="",this.socket=t.socket}onError(t,e,i){return super.emitReserved("error",new Ba(t,e,i)),this}open(){return(this.readyState==="closed"||this.readyState==="")&&(this.readyState="opening",this.doOpen()),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(t){this.readyState==="open"&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(t){let e=ji(t,this.socket.binaryType);this.onPacket(e)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}};var Pa="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),Xn=64,$p={},Ia=0,Fi=0,Ma;function Na(r){let t="";do t=Pa[r%Xn]+t,r=Math.floor(r/Xn);while(r>0);return t}function Hi(){let r=Na(+new Date);return r!==Ma?(Ia=0,Ma=r):r+"."+Na(Ia++)}for(;Fi<Xn;Fi++)$p[Pa[Fi]]=Fi;function qi(r){let t="";for(let e in r)r.hasOwnProperty(e)&&(t.length&&(t+="&"),t+=encodeURIComponent(e)+"="+encodeURIComponent(r[e]));return t}function Da(r){let t={},e=r.split("&");for(let i=0,n=e.length;i<n;i++){let o=e[i].split("=");t[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}return t}var ja=!1;try{ja=typeof XMLHttpRequest!="undefined"&&"withCredentials"in new XMLHttpRequest}catch(r){}var za=ja;function Kn(r){let t=r.xdomain;try{if(typeof XMLHttpRequest!="undefined"&&(!t||za))return new XMLHttpRequest}catch(e){}if(!t)try{return new Zt[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch(e){}}function Op(){}var Rp=function(){return new Kn({xdomain:!1}).responseType!=null}(),Jn=class extends Br{constructor(t){super(t);if(this.polling=!1,typeof location!="undefined"){let i=location.protocol==="https:",n=location.port;n||(n=i?"443":"80"),this.xd=typeof location!="undefined"&&t.hostname!==location.hostname||n!==t.port,this.xs=t.secure!==i}let e=t&&t.forceBase64;this.supportsBinary=Rp&&!e}get name(){return"polling"}doOpen(){this.poll()}pause(t){this.readyState="pausing";let e=()=>{this.readyState="paused",t()};if(this.polling||!this.writable){let i=0;this.polling&&(i++,this.once("pollComplete",function(){--i||e()})),this.writable||(i++,this.once("drain",function(){--i||e()}))}else e()}poll(){this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(t){let e=i=>{if(this.readyState==="opening"&&i.type==="open"&&this.onOpen(),i.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(i)};Ra(t,this.socket.binaryType).forEach(e),this.readyState!=="closed"&&(this.polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this.poll())}doClose(){let t=()=>{this.write([{type:"close"}])};this.readyState==="open"?t():this.once("open",t)}write(t){this.writable=!1,Oa(t,e=>{this.doWrite(e,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){let t=this.query||{},e=this.opts.secure?"https":"http",i="";this.opts.timestampRequests!==!1&&(t[this.opts.timestampParam]=Hi()),!this.supportsBinary&&!t.sid&&(t.b64=1),this.opts.port&&(e==="https"&&Number(this.opts.port)!==443||e==="http"&&Number(this.opts.port)!==80)&&(i=":"+this.opts.port);let n=qi(t),o=this.opts.hostname.indexOf(":")!==-1;return e+"://"+(o?"["+this.opts.hostname+"]":this.opts.hostname)+i+this.opts.path+(n.length?"?"+n:"")}request(t={}){return Object.assign(t,{xd:this.xd,xs:this.xs},this.opts),new sr(this.uri(),t)}doWrite(t,e){let i=this.request({method:"POST",data:t});i.on("success",e),i.on("error",(n,o)=>{this.onError("xhr post error",n,o)})}doPoll(){let t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(e,i)=>{this.onError("xhr poll error",e,i)}),this.pollXhr=t}},sr=class extends ht{constructor(t,e){super();mr(this,e),this.opts=e,this.method=e.method||"GET",this.uri=t,this.async=e.async!==!1,this.data=e.data!==void 0?e.data:null,this.create()}create(){let t=zi(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this.opts.xd,t.xscheme=!!this.opts.xs;let e=this.xhr=new Kn(t);try{e.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders){e.setDisableHeaderCheck&&e.setDisableHeaderCheck(!0);for(let i in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(i)&&e.setRequestHeader(i,this.opts.extraHeaders[i])}}catch(i){}if(this.method==="POST")try{e.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(i){}try{e.setRequestHeader("Accept","*/*")}catch(i){}"withCredentials"in e&&(e.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(e.timeout=this.opts.requestTimeout),e.onreadystatechange=()=>{e.readyState===4&&(e.status===200||e.status===1223?this.onLoad():this.setTimeoutFn(()=>{this.onError(typeof e.status=="number"?e.status:0)},0))},e.send(this.data)}catch(i){this.setTimeoutFn(()=>{this.onError(i)},0);return}typeof document!="undefined"&&(this.index=sr.requestsCount++,sr.requests[this.index]=this)}onError(t){this.emitReserved("error",t,this.xhr),this.cleanup(!0)}cleanup(t){if(!(typeof this.xhr=="undefined"||this.xhr===null)){if(this.xhr.onreadystatechange=Op,t)try{this.xhr.abort()}catch(e){}typeof document!="undefined"&&delete sr.requests[this.index],this.xhr=null}}onLoad(){let t=this.xhr.responseText;t!==null&&(this.emitReserved("data",t),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}};sr.requestsCount=0;sr.requests={};if(typeof document!="undefined"){if(typeof attachEvent=="function")attachEvent("onunload",Fa);else if(typeof addEventListener=="function"){let r="onpagehide"in Zt?"pagehide":"unload";addEventListener(r,Fa,!1)}}function Fa(){for(let r in sr.requests)sr.requests.hasOwnProperty(r)&&sr.requests[r].abort()}var Ha=(()=>typeof Promise=="function"&&typeof Promise.resolve=="function"?t=>Promise.resolve().then(t):(t,e)=>e(t,0))(),ni=Zt.WebSocket||Zt.MozWebSocket,Ui=!0,qa="arraybuffer";var Ua=typeof navigator!="undefined"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative",Zn=class extends Br{constructor(t){super(t);this.supportsBinary=!t.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;let t=this.uri(),e=this.opts.protocols,i=Ua?{}:zi(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(i.headers=this.opts.extraHeaders);try{this.ws=Ui&&!Ua?e?new ni(t,e):new ni(t):new ni(t,e,i)}catch(n){return this.emitReserved("error",n)}this.ws.binaryType=this.socket.binaryType||qa,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let e=0;e<t.length;e++){let i=t[e],n=e===t.length-1;Di(i,this.supportsBinary,o=>{let a={};Ui||(i.options&&(a.compress=i.options.compress),this.opts.perMessageDeflate&&(typeof o=="string"?Buffer.byteLength(o):o.length)<this.opts.perMessageDeflate.threshold&&(a.compress=!1));try{Ui?this.ws.send(o):this.ws.send(o,a)}catch(s){}n&&Ha(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws!="undefined"&&(this.ws.close(),this.ws=null)}uri(){let t=this.query||{},e=this.opts.secure?"wss":"ws",i="";this.opts.port&&(e==="wss"&&Number(this.opts.port)!==443||e==="ws"&&Number(this.opts.port)!==80)&&(i=":"+this.opts.port),this.opts.timestampRequests&&(t[this.opts.timestampParam]=Hi()),this.supportsBinary||(t.b64=1);let n=qi(t),o=this.opts.hostname.indexOf(":")!==-1;return e+"://"+(o?"["+this.opts.hostname+"]":this.opts.hostname)+i+this.opts.path+(n.length?"?"+n:"")}check(){return!!ni}};var Qn={websocket:Zn,polling:Jn};var Lp=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Bp=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Ir(r){let t=r,e=r.indexOf("["),i=r.indexOf("]");e!=-1&&i!=-1&&(r=r.substring(0,e)+r.substring(e,i).replace(/:/g,";")+r.substring(i,r.length));let n=Lp.exec(r||""),o={},a=14;for(;a--;)o[Bp[a]]=n[a]||"";return e!=-1&&i!=-1&&(o.source=t,o.host=o.host.substring(1,o.host.length-1).replace(/;/g,":"),o.authority=o.authority.replace("[","").replace("]","").replace(/;/g,":"),o.ipv6uri=!0),o.pathNames=Ip(o,o.path),o.queryKey=Mp(o,o.query),o}function Ip(r,t){let e=/\/{2,9}/g,i=t.replace(e,"/").split("/");return(t.substr(0,1)=="/"||t.length===0)&&i.splice(0,1),t.substr(t.length-1,1)=="/"&&i.splice(i.length-1,1),i}function Mp(r,t){let e={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(i,n,o){n&&(e[n]=o)}),e}var Qt=class extends ht{constructor(t,e={}){super();t&&typeof t=="object"&&(e=t,t=null),t?(t=Ir(t),e.hostname=t.host,e.secure=t.protocol==="https"||t.protocol==="wss",e.port=t.port,t.query&&(e.query=t.query)):e.host&&(e.hostname=Ir(e.host).host),mr(this,e),this.secure=e.secure!=null?e.secure:typeof location!="undefined"&&location.protocol==="https:",e.hostname&&!e.port&&(e.port=this.secure?"443":"80"),this.hostname=e.hostname||(typeof location!="undefined"?location.hostname:"localhost"),this.port=e.port||(typeof location!="undefined"&&location.port?location.port:this.secure?"443":"80"),this.transports=e.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!0},e),this.opts.path=this.opts.path.replace(/\/$/,"")+"/",typeof this.opts.query=="string"&&(this.opts.query=Da(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,typeof addEventListener=="function"&&(this.opts.closeOnBeforeunload&&addEventListener("beforeunload",()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},!1),this.hostname!=="localhost"&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(t){let e=Object.assign({},this.opts.query);e.EIO=Gn,e.transport=t,this.id&&(e.sid=this.id);let i=Object.assign({},this.opts.transportOptions[t],this.opts,{query:e,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return new Qn[t](i)}open(){let t;if(this.opts.rememberUpgrade&&Qt.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1)t="websocket";else if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}else t=this.transports[0];this.readyState="opening";try{t=this.createTransport(t)}catch(e){this.transports.shift(),this.open();return}t.open(),this.setTransport(t)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",e=>this.onClose("transport close",e))}probe(t){let e=this.createTransport(t),i=!1;Qt.priorWebsocketSuccess=!1;let n=()=>{i||(e.send([{type:"ping",data:"probe"}]),e.once("packet",h=>{if(!i)if(h.type==="pong"&&h.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",e),!e)return;Qt.priorWebsocketSuccess=e.name==="websocket",this.transport.pause(()=>{i||this.readyState!=="closed"&&(c(),this.setTransport(e),e.send([{type:"upgrade"}]),this.emitReserved("upgrade",e),e=null,this.upgrading=!1,this.flush())})}else{let p=new Error("probe error");p.transport=e.name,this.emitReserved("upgradeError",p)}}))};function o(){i||(i=!0,c(),e.close(),e=null)}let a=h=>{let p=new Error("probe error: "+h);p.transport=e.name,o(),this.emitReserved("upgradeError",p)};function s(){a("transport closed")}function l(){a("socket closed")}function u(h){e&&h.name!==e.name&&o()}let c=()=>{e.removeListener("open",n),e.removeListener("error",a),e.removeListener("close",s),this.off("close",l),this.off("upgrading",u)};e.once("open",n),e.once("error",a),e.once("close",s),this.once("close",l),this.once("upgrading",u),e.open()}onOpen(){if(this.readyState="open",Qt.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush(),this.readyState==="open"&&this.opts.upgrade&&this.transport.pause){let t=0,e=this.upgrades.length;for(;t<e;t++)this.probe(this.upgrades[t])}}onPacket(t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":let e=new Error("server error");e.code=t.data,this.onError(e);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data);break}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this.upgrades=this.filterUpgrades(t.upgrades),this.pingInterval=t.pingInterval,this.pingTimeout=t.pingTimeout,this.maxPayload=t.maxPayload,this.onOpen(),this.readyState!=="closed"&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn(()=>{this.onClose("ping timeout")},this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){let t=this.getWritablePackets();this.transport.send(t),this.prevBufferLen=t.length,this.emitReserved("flush")}}getWritablePackets(){if(!(this.maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let e=1;for(let i=0;i<this.writeBuffer.length;i++){let n=this.writeBuffer[i].data;if(n&&(e+=La(n)),i>0&&e>this.maxPayload)return this.writeBuffer.slice(0,i);e+=2}return this.writeBuffer}write(t,e,i){return this.sendPacket("message",t,e,i),this}send(t,e,i){return this.sendPacket("message",t,e,i),this}sendPacket(t,e,i,n){if(typeof e=="function"&&(n=e,e=void 0),typeof i=="function"&&(n=i,i=null),this.readyState==="closing"||this.readyState==="closed")return;i=i||{},i.compress=i.compress!==!1;let o={type:t,data:e,options:i};this.emitReserved("packetCreate",o),this.writeBuffer.push(o),n&&this.once("flush",n),this.flush()}close(){let t=()=>{this.onClose("forced close"),this.transport.close()},e=()=>{this.off("upgrade",e),this.off("upgradeError",e),t()},i=()=>{this.once("upgrade",e),this.once("upgradeError",e)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?i():t()}):this.upgrading?i():t()),this}onError(t){Qt.priorWebsocketSuccess=!1,this.emitReserved("error",t),this.onClose("transport error",t)}onClose(t,e){(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")&&(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),typeof removeEventListener=="function"&&removeEventListener("offline",this.offlineEventListener,!1),this.readyState="closed",this.id=null,this.emitReserved("close",t,e),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(t){let e=[],i=0,n=t.length;for(;i<n;i++)~this.transports.indexOf(t[i])&&e.push(t[i]);return e}};Qt.protocol=Gn;var JS=Qt.protocol;function Wa(r,t="",e){let i=r;e=e||typeof location!="undefined"&&location,r==null&&(r=e.protocol+"//"+e.host),typeof r=="string"&&(r.charAt(0)==="/"&&(r.charAt(1)==="/"?r=e.protocol+r:r=e.host+r),/^(https?|wss?):\/\//.test(r)||(typeof e!="undefined"?r=e.protocol+"//"+r:r="https://"+r),i=Ir(r)),i.port||(/^(http|ws)$/.test(i.protocol)?i.port="80":/^(http|ws)s$/.test(i.protocol)&&(i.port="443")),i.path=i.path||"/";let o=i.host.indexOf(":")!==-1?"["+i.host+"]":i.host;return i.id=i.protocol+"://"+o+":"+i.port+t,i.href=i.protocol+"://"+o+(e&&e.port===i.port?"":":"+i.port),i}var ro={};fp(ro,{Decoder:()=>Wi,Encoder:()=>Ka,PacketType:()=>it,protocol:()=>Xa});var Np=typeof ArrayBuffer=="function",Pp=r=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(r):r.buffer instanceof ArrayBuffer,Va=Object.prototype.toString,Dp=typeof Blob=="function"||typeof Blob!="undefined"&&Va.call(Blob)==="[object BlobConstructor]",jp=typeof File=="function"||typeof File!="undefined"&&Va.call(File)==="[object FileConstructor]";function ai(r){return Np&&(r instanceof ArrayBuffer||Pp(r))||Dp&&r instanceof Blob||jp&&r instanceof File}function oi(r,t){if(!r||typeof r!="object")return!1;if(Array.isArray(r)){for(let e=0,i=r.length;e<i;e++)if(oi(r[e]))return!0;return!1}if(ai(r))return!0;if(r.toJSON&&typeof r.toJSON=="function"&&arguments.length===1)return oi(r.toJSON(),!0);for(let e in r)if(Object.prototype.hasOwnProperty.call(r,e)&&oi(r[e]))return!0;return!1}function Ya(r){let t=[],e=r.data,i=r;return i.data=eo(e,t),i.attachments=t.length,{packet:i,buffers:t}}function eo(r,t){if(!r)return r;if(ai(r)){let e={_placeholder:!0,num:t.length};return t.push(r),e}else if(Array.isArray(r)){let e=new Array(r.length);for(let i=0;i<r.length;i++)e[i]=eo(r[i],t);return e}else if(typeof r=="object"&&!(r instanceof Date)){let e={};for(let i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=eo(r[i],t));return e}return r}function Ga(r,t){return r.data=to(r.data,t),r.attachments=void 0,r}function to(r,t){if(!r)return r;if(r&&r._placeholder)return t[r.num];if(Array.isArray(r))for(let e=0;e<r.length;e++)r[e]=to(r[e],t);else if(typeof r=="object")for(let e in r)Object.prototype.hasOwnProperty.call(r,e)&&(r[e]=to(r[e],t));return r}var Xa=5,it;(function(r){r[r.CONNECT=0]="CONNECT",r[r.DISCONNECT=1]="DISCONNECT",r[r.EVENT=2]="EVENT",r[r.ACK=3]="ACK",r[r.CONNECT_ERROR=4]="CONNECT_ERROR",r[r.BINARY_EVENT=5]="BINARY_EVENT",r[r.BINARY_ACK=6]="BINARY_ACK"})(it||(it={}));var Ka=class{constructor(t){this.replacer=t}encode(t){return(t.type===it.EVENT||t.type===it.ACK)&&oi(t)?(t.type=t.type===it.EVENT?it.BINARY_EVENT:it.BINARY_ACK,this.encodeAsBinary(t)):[this.encodeAsString(t)]}encodeAsString(t){let e=""+t.type;return(t.type===it.BINARY_EVENT||t.type===it.BINARY_ACK)&&(e+=t.attachments+"-"),t.nsp&&t.nsp!=="/"&&(e+=t.nsp+","),t.id!=null&&(e+=t.id),t.data!=null&&(e+=JSON.stringify(t.data,this.replacer)),e}encodeAsBinary(t){let e=Ya(t),i=this.encodeAsString(e.packet),n=e.buffers;return n.unshift(i),n}},Wi=class extends ht{constructor(t){super();this.reviver=t}add(t){let e;if(typeof t=="string")e=this.decodeString(t),e.type===it.BINARY_EVENT||e.type===it.BINARY_ACK?(this.reconstructor=new Ja(e),e.attachments===0&&super.emitReserved("decoded",e)):super.emitReserved("decoded",e);else if(ai(t)||t.base64)if(this.reconstructor)e=this.reconstructor.takeBinaryData(t),e&&(this.reconstructor=null,super.emitReserved("decoded",e));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+t)}decodeString(t){let e=0,i={type:Number(t.charAt(0))};if(it[i.type]===void 0)throw new Error("unknown packet type "+i.type);if(i.type===it.BINARY_EVENT||i.type===it.BINARY_ACK){let o=e+1;for(;t.charAt(++e)!=="-"&&e!=t.length;);let a=t.substring(o,e);if(a!=Number(a)||t.charAt(e)!=="-")throw new Error("Illegal attachments");i.attachments=Number(a)}if(t.charAt(e+1)==="/"){let o=e+1;for(;++e&&!(t.charAt(e)===","||e===t.length););i.nsp=t.substring(o,e)}else i.nsp="/";let n=t.charAt(e+1);if(n!==""&&Number(n)==n){let o=e+1;for(;++e;){let a=t.charAt(e);if(a==null||Number(a)!=a){--e;break}if(e===t.length)break}i.id=Number(t.substring(o,e+1))}if(t.charAt(++e)){let o=this.tryParse(t.substr(e));if(Wi.isPayloadValid(i.type,o))i.data=o;else throw new Error("invalid payload")}return i}tryParse(t){try{return JSON.parse(t,this.reviver)}catch(e){return!1}}static isPayloadValid(t,e){switch(t){case it.CONNECT:return typeof e=="object";case it.DISCONNECT:return e===void 0;case it.CONNECT_ERROR:return typeof e=="string"||typeof e=="object";case it.EVENT:case it.BINARY_EVENT:return Array.isArray(e)&&e.length>0;case it.ACK:case it.BINARY_ACK:return Array.isArray(e)}}destroy(){this.reconstructor&&this.reconstructor.finishedReconstruction()}},Ja=class{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){let e=Ga(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}};function Yt(r,t,e){return r.on(t,e),function(){r.off(t,e)}}var zp=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1}),si=class extends ht{constructor(t,e,i){super();this.connected=!1,this.receiveBuffer=[],this.sendBuffer=[],this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=e,i&&i.auth&&(this.auth=i.auth),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;let t=this.io;this.subs=[Yt(t,"open",this.onopen.bind(this)),Yt(t,"packet",this.onpacket.bind(this)),Yt(t,"error",this.onerror.bind(this)),Yt(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...e){if(zp.hasOwnProperty(t))throw new Error('"'+t+'" is a reserved event name');e.unshift(t);let i={type:it.EVENT,data:e};if(i.options={},i.options.compress=this.flags.compress!==!1,typeof e[e.length-1]=="function"){let a=this.ids++,s=e.pop();this._registerAckCallback(a,s),i.id=a}let n=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!n||!this.connected)||(this.connected?(this.notifyOutgoingListeners(i),this.packet(i)):this.sendBuffer.push(i)),this.flags={},this}_registerAckCallback(t,e){let i=this.flags.timeout;if(i===void 0){this.acks[t]=e;return}let n=this.io.setTimeoutFn(()=>{delete this.acks[t];for(let o=0;o<this.sendBuffer.length;o++)this.sendBuffer[o].id===t&&this.sendBuffer.splice(o,1);e.call(this,new Error("operation has timed out"))},i);this.acks[t]=(...o)=>{this.io.clearTimeoutFn(n),e.apply(this,[null,...o])}}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){typeof this.auth=="function"?this.auth(t=>{this.packet({type:it.CONNECT,data:t})}):this.packet({type:it.CONNECT,data:this.auth})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t,e){this.connected=!1,delete this.id,this.emitReserved("disconnect",t,e)}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case it.CONNECT:if(t.data&&t.data.sid){let n=t.data.sid;this.onconnect(n)}else this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case it.EVENT:case it.BINARY_EVENT:this.onevent(t);break;case it.ACK:case it.BINARY_ACK:this.onack(t);break;case it.DISCONNECT:this.ondisconnect();break;case it.CONNECT_ERROR:this.destroy();let i=new Error(t.data.message);i.data=t.data.data,this.emitReserved("connect_error",i);break}}onevent(t){let e=t.data||[];t.id!=null&&e.push(this.ack(t.id)),this.connected?this.emitEvent(e):this.receiveBuffer.push(Object.freeze(e))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){let e=this._anyListeners.slice();for(let i of e)i.apply(this,t)}super.emit.apply(this,t)}ack(t){let e=this,i=!1;return function(...n){i||(i=!0,e.packet({type:it.ACK,id:t,data:n}))}}onack(t){let e=this.acks[t.id];typeof e=="function"&&(e.apply(this,t.data),delete this.acks[t.id])}onconnect(t){this.id=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(t=>this.emitEvent(t)),this.receiveBuffer=[],this.sendBuffer.forEach(t=>{this.notifyOutgoingListeners(t),this.packet(t)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(t=>t()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:it.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){let e=this._anyListeners;for(let i=0;i<e.length;i++)if(t===e[i])return e.splice(i,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this}prependAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this}offAnyOutgoing(t){if(!this._anyOutgoingListeners)return this;if(t){let e=this._anyOutgoingListeners;for(let i=0;i<e.length;i++)if(t===e[i])return e.splice(i,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){let e=this._anyOutgoingListeners.slice();for(let i of e)i.apply(this,t.data)}}};function Ar(r){r=r||{},this.ms=r.min||100,this.max=r.max||1e4,this.factor=r.factor||2,this.jitter=r.jitter>0&&r.jitter<=1?r.jitter:0,this.attempts=0}Ar.prototype.duration=function(){var r=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),e=Math.floor(t*this.jitter*r);r=(Math.floor(t*10)&1)==0?r-e:r+e}return Math.min(r,this.max)|0};Ar.prototype.reset=function(){this.attempts=0};Ar.prototype.setMin=function(r){this.ms=r};Ar.prototype.setMax=function(r){this.max=r};Ar.prototype.setJitter=function(r){this.jitter=r};var li=class extends ht{constructor(t,e){var i;super();this.nsps={},this.subs=[],t&&typeof t=="object"&&(e=t,t=void 0),e=e||{},e.path=e.path||"/socket.io",this.opts=e,mr(this,e),this.reconnection(e.reconnection!==!1),this.reconnectionAttempts(e.reconnectionAttempts||1/0),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor((i=e.randomizationFactor)!==null&&i!==void 0?i:.5),this.backoff=new Ar({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(e.timeout==null?2e4:e.timeout),this._readyState="closed",this.uri=t;let n=e.parser||ro;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this._autoConnect=e.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,this):this._reconnection}reconnectionAttempts(t){return t===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var e;return t===void 0?this._reconnectionDelay:(this._reconnectionDelay=t,(e=this.backoff)===null||e===void 0||e.setMin(t),this)}randomizationFactor(t){var e;return t===void 0?this._randomizationFactor:(this._randomizationFactor=t,(e=this.backoff)===null||e===void 0||e.setJitter(t),this)}reconnectionDelayMax(t){var e;return t===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,(e=this.backoff)===null||e===void 0||e.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new Qt(this.uri,this.opts);let e=this.engine,i=this;this._readyState="opening",this.skipReconnect=!1;let n=Yt(e,"open",function(){i.onopen(),t&&t()}),o=Yt(e,"error",a=>{i.cleanup(),i._readyState="closed",this.emitReserved("error",a),t?t(a):i.maybeReconnectOnOpen()});if(this._timeout!==!1){let a=this._timeout;a===0&&n();let s=this.setTimeoutFn(()=>{n(),e.close(),e.emit("error",new Error("timeout"))},a);this.opts.autoUnref&&s.unref(),this.subs.push(function(){clearTimeout(s)})}return this.subs.push(n),this.subs.push(o),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");let t=this.engine;this.subs.push(Yt(t,"ping",this.onping.bind(this)),Yt(t,"data",this.ondata.bind(this)),Yt(t,"error",this.onerror.bind(this)),Yt(t,"close",this.onclose.bind(this)),Yt(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){this.decoder.add(t)}ondecoded(t){this.emitReserved("packet",t)}onerror(t){this.emitReserved("error",t)}socket(t,e){let i=this.nsps[t];return i||(i=new si(this,t,e),this.nsps[t]=i),i}_destroy(t){let e=Object.keys(this.nsps);for(let i of e)if(this.nsps[i].active)return;this._close()}_packet(t){let e=this.encoder.encode(t);for(let i=0;i<e.length;i++)this.engine.write(e[i],t.options)}cleanup(){this.subs.forEach(t=>t()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(t,e){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,e),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;let t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{let e=this.backoff.duration();this._reconnecting=!0;let i=this.setTimeoutFn(()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),!t.skipReconnect&&t.open(n=>{n?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",n)):t.onreconnect()}))},e);this.opts.autoUnref&&i.unref(),this.subs.push(function(){clearTimeout(i)})}}onreconnect(){let t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}};var ci={};function $r(r,t){typeof r=="object"&&(t=r,r=void 0),t=t||{};let e=Wa(r,t.path||"/socket.io"),i=e.source,n=e.id,o=e.path,a=ci[n]&&o in ci[n].nsps,s=t.forceNew||t["force new connection"]||t.multiplex===!1||a,l;return s?l=new li(i,t):(ci[n]||(ci[n]=new li(i,t)),l=ci[n]),e.query&&!t.query&&(t.query=e.queryKey),l.socket(e.path,t)}Object.assign($r,{Manager:li,Socket:si,io:$r,connect:$r});frappe.socketio={open_tasks:{},open_docs:[],emit_queue:[],init:function(r=3e3){if(!frappe.boot.disable_async&&!frappe.socketio.socket){if(window.location.protocol=="https:"?frappe.socketio.socket=$r.connect(frappe.socketio.get_host(r),{secure:!0,withCredentials:!0}):window.location.protocol=="http:"?frappe.socketio.socket=$r.connect(frappe.socketio.get_host(r),{withCredentials:!0}):window.location.protocol=="file:"&&(frappe.socketio.socket=$r.connect(window.localStorage.server,{withCredentials:!0})),!frappe.socketio.socket){console.log("Unable to connect to "+frappe.socketio.get_host(r));return}frappe.socketio.socket.on("msgprint",function(t){frappe.msgprint(t)}),frappe.socketio.socket.on("progress",function(t){t.progress&&(t.percent=flt(t.progress[0])/t.progress[1]*100),t.percent&&(t.percent==100?frappe.hide_progress():frappe.show_progress(t.title||__("Progress"),t.percent,100,t.description))}),frappe.socketio.setup_listeners(),frappe.socketio.setup_reconnect(),$(document).on("form-load form-rename",function(t,e){if(!(!e.doc||e.is_new())){for(var i=0,n=frappe.socketio.open_docs.length;i<n;i++){var o=frappe.socketio.open_docs[i];if(e.doctype==o.doctype&&e.docname==o.name)return!1}frappe.socketio.doc_subscribe(e.doctype,e.docname)}}),$(document).on("form-refresh",function(t,e){!e.doc||e.is_new()||frappe.socketio.doc_open(e.doctype,e.docname)}),$(document).on("form-unload",function(t,e){!e.doc||e.is_new()||frappe.socketio.doc_close(e.doctype,e.docname)}),$(document).on("form-typing",function(t,e){frappe.socketio.form_typing(e.doctype,e.docname)}),$(document).on("form-stopped-typing",function(t,e){frappe.socketio.form_stopped_typing(e.doctype,e.docname)}),window.addEventListener("beforeunload",()=>{!cur_frm||!cur_frm.doc||cur_frm.is_new()||frappe.socketio.doc_close(cur_frm.doctype,cur_frm.docname)})}},get_host:function(r=3e3){var t=window.location.origin;if(window.dev_server){var e=t.split(":");r=frappe.boot.socketio_port||r.toString()||"3000",e.length>2&&(t=e[0]+":"+e[1]),t=t+":"+r}return t},subscribe:function(r,t){frappe.socketio.socket.emit("task_subscribe",r),frappe.socketio.socket.emit("progress_subscribe",r),frappe.socketio.open_tasks[r]=t},task_subscribe:function(r){frappe.socketio.socket.emit("task_subscribe",r)},task_unsubscribe:function(r){frappe.socketio.socket.emit("task_unsubscribe",r)},doc_subscribe:function(r,t){if(frappe.flags.doc_subscribe){console.log("throttled");return}frappe.flags.doc_subscribe=!0,setTimeout(function(){frappe.flags.doc_subscribe=!1},1e3),frappe.socketio.socket.emit("doc_subscribe",r,t),frappe.socketio.open_docs.push({doctype:r,docname:t})},doc_unsubscribe:function(r,t){frappe.socketio.socket.emit("doc_unsubscribe",r,t),frappe.socketio.open_docs=$.filter(frappe.socketio.open_docs,function(e){return e.doctype===r&&e.name===t?null:e})},doc_open:function(r,t){(!frappe.socketio.last_doc||frappe.socketio.last_doc[0]!=r||frappe.socketio.last_doc[1]!=t)&&(frappe.socketio.socket.emit("doc_open",r,t),frappe.socketio.last_doc&&frappe.socketio.doc_close(frappe.socketio.last_doc[0],frappe.socketio.last_doc[1])),frappe.socketio.last_doc=[r,t]},doc_close:function(r,t){frappe.socketio.socket.emit("doc_close",r,t),frappe.socketio.socket.emit("doc_typing_stopped",r,t)},form_typing:function(r,t){frappe.socketio.socket.emit("doc_typing",r,t)},form_stopped_typing:function(r,t){frappe.socketio.socket.emit("doc_typing_stopped",r,t)},setup_listeners:function(){frappe.socketio.socket.on("task_status_change",function(r){frappe.socketio.process_response(r,r.status.toLowerCase())}),frappe.socketio.socket.on("task_progress",function(r){frappe.socketio.process_response(r,"progress")})},setup_reconnect:function(){frappe.socketio.socket.on("connect",function(){setTimeout(function(){$.each(frappe.socketio.open_tasks,function(r,t){frappe.socketio.subscribe(r,t)}),$.each(frappe.socketio.open_docs,function(r){locals[r.doctype]&&locals[r.doctype][r.name]&&frappe.socketio.doc_subscribe(r.doctype,r.name)}),cur_frm&&cur_frm.doc&&frappe.socketio.doc_open(cur_frm.doc.doctype,cur_frm.doc.name)},5e3)})},process_response:function(r,t){if(!!r){var e=frappe.socketio.open_tasks[r.task_id];e[t]&&e[t](r),t==="success"&&e.callback&&e.callback(r),frappe.request.cleanup(e,r),e.always&&e.always(r),r.status_code&&r.status_code>400&&e.error&&e.error(r)}}};frappe.provide("frappe.realtime");frappe.realtime.on=function(r,t){frappe.socketio.socket&&frappe.socketio.socket.on(r,t)};frappe.realtime.off=function(r,t){frappe.socketio.socket&&frappe.socketio.socket.off(r,t)};frappe.realtime.publish=function(r,t){frappe.socketio.socket&&frappe.socketio.socket.emit(r,t)};var td=Vt(ts());var io={default:[{divisor:1e12,symbol:__("T",null,"Number system")},{divisor:1e9,symbol:__("B",null,"Number system")},{divisor:1e6,symbol:__("M",null,"Number system")},{divisor:1e3,symbol:__("K",null,"Number system")}],indian:[{divisor:1e7,symbol:__("Cr",null,"Number system")},{divisor:1e5,symbol:__("Lakh",null,"Number system")},{divisor:1e3,symbol:__("K",null,"Number system")}]};var rd=Vt(ed());frappe.provide("frappe.utils");Array.prototype.uniqBy||(Object.defineProperty(Array.prototype,"uniqBy",{value:function(r){var t={};return this.filter(function(e){var i=r(e);return i in t?!1:t[i]=!0})}}),Object.defineProperty(Array.prototype,"move",{value:function(r,t){this.splice(t,0,this.splice(r,1)[0])}}));Object.defineProperty(Object.prototype,"setDefault",{value:function(r,t){return r in this||(this[r]=t),this[r]},writable:!0});String.prototype.plural=function(r){let t={"(quiz)$":"$1zes","^(ox)$":"$1en","([m|l])ouse$":"$1ice","(matr|vert|ind)ix|ex$":"$1ices","(x|ch|ss|sh)$":"$1es","([^aeiouy]|qu)y$":"$1ies","(hive)$":"$1s","(?:([^f])fe|([lr])f)$":"$1$2ves","(shea|lea|loa|thie)f$":"$1ves",sis$:"ses","([ti])um$":"$1a","(tomat|potat|ech|her|vet)o$":"$1oes","(bu)s$":"$1ses","(alias)$":"$1es","(octop)us$":"$1i","(ax|test)is$":"$1es","(us)$":"$1es","([^s]+)$":"$1s"},e={"(quiz)zes$":"$1","(matr)ices$":"$1ix","(vert|ind)ices$":"$1ex","^(ox)en$":"$1","(alias)es$":"$1","(octop|vir)i$":"$1us","(cris|ax|test)es$":"$1is","(shoe)s$":"$1","(o)es$":"$1","(bus)es$":"$1","([m|l])ice$":"$1ouse","(x|ch|ss|sh)es$":"$1","(m)ovies$":"$1ovie","(s)eries$":"$1eries","([^aeiouy]|qu)ies$":"$1y","([lr])ves$":"$1f","(tive)s$":"$1","(hive)s$":"$1","(li|wi|kni)ves$":"$1fe","(shea|loa|lea|thie)ves$":"$1f","(^analy)ses$":"$1sis","((a)naly|(b)a|(d)iagno|(p)arenthe|(p)rogno|(s)ynop|(t)he)ses$":"$1$2sis","([ti])a$":"$1um","(n)ews$":"$1ews","(h|bl)ouses$":"$1ouse","(corpse)s$":"$1","(us)es$":"$1",s$:""},i={move:"moves",foot:"feet",goose:"geese",sex:"sexes",child:"children",man:"men",tooth:"teeth",person:"people"};if(["sheep","fish","deer","moose","series","species","money","rice","information","equipment"].indexOf(this.toLowerCase())>=0)return this;let o,a,s;for(o in i)if(r?(a=new RegExp(i[o]+"$","i"),s=o):(a=new RegExp(o+"$","i"),s=i[o]),a.test(this))return this.replace(a,s);let l;r?l=e:l=t;let u;for(u in l)if(a=new RegExp(u,"i"),a.test(this))return this.replace(a,l[u]);return this};Object.assign(frappe.utils,{get_random:function(r){for(var t="",e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",i=0;i<r;i++)t+=e.charAt(Math.floor(Math.random()*e.length));return t},get_file_link:function(r){return r=cstr(r),frappe.utils.is_url(r)?r:r.indexOf("/")===-1?"files/"+r:r},replace_newlines(r){return r?r.replace(/\n/g,"<br>"):""},is_html:function(r){return!(!r||r.indexOf("<br>")==-1&&r.indexOf("<p")==-1&&r.indexOf("<img")==-1&&r.indexOf("<div")==-1&&!r.includes("<span"))},is_mac:function(){return window.navigator.platform==="MacIntel"},is_xs:function(){return $(document).width()<768},is_sm:function(){return $(document).width()<991&&$(document).width()>=768},is_md:function(){return $(document).width()<1199&&$(document).width()>=991},is_json:function(r){try{JSON.parse(r)}catch(t){return!1}return!0},parse_json:function(r){let t="";try{t=JSON.parse(r)}catch(e){return r}return t},strip_whitespace:function(r){return(r||"").replace(/<p>\s*<\/p>/g,"").replace(/<br>(\s*<br>\s*)+/g,"<br><br>")},encode_tags:function(r){var t={"&":"&amp;","<":"&lt;",">":"&gt;"};function e(i){return t[i]||i}return r.replace(/[&<>]/g,e)},strip_original_content:function(r){var t=[],e=[],i=r.indexOf("<br>")===-1?`
`:"<br>";return $.each(r.split(i),function(n,o){var a=strip(o);a&&(a.substr(0,1)===">"||a.substr(0,4)==="&gt;")?e.push(o):(t=t.concat(e),t.push(o),e=[])}),t.join(i)},escape_html:function(r){let t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};return String(r).replace(/[&<>"'`=/]/g,e=>t[e]||e)},unescape_html:function(r){let t={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#x2F;":"/","&#x60;":"`","&#x3D;":"="};return String(r).replace(/&amp;|&lt;|&gt;|&quot;|&#39;|&#x2F;|&#x60;|&#x3D;/g,e=>t[e]||e)},html2text:function(r){let t=document.createElement("div");return t.innerHTML=r,t.textContent},is_url:function(r){return r.toLowerCase().substr(0,7)=="http://"||r.toLowerCase().substr(0,8)=="https://"},to_title_case:function(r,t=!1){let e=r.toLowerCase().replace(/(?:^|[\s-/])\w/g,function(n){return n.toUpperCase()}),i=t?" ":"";return e.replace(/-|_/g,i)},toggle_blockquote:function(r){if(!r)return r;var t=$("<div></div>").html(r);return t.find("blockquote").parent("blockquote").addClass("hidden").before('<p><a class="text-muted btn btn-default toggle-blockquote" style="padding: 2px 7px 0px; line-height: 1;"> 					\u2022 \u2022 \u2022 				</a></p>'),t.html()},scroll_to:function(r,t=!0,e,i,n,o=!1){if(frappe.flags.disable_auto_scroll)return;i=i||$("html, body");let a=0;r&&(a=typeof r=="number"?r-cint(e):this.get_scroll_position(r,e)),a<0&&(a=0),a!=i.scrollTop()&&(t?i.animate({scrollTop:a}).promise().then(()=>{o&&($(r).addClass("highlight"),document.addEventListener("click",function(){$(r).removeClass("highlight")},{once:!0})),n&&n()}):i.scrollTop(a))},get_scroll_position:function(r,t){let e=$(".navbar").height()+$(".page-head:visible").height()||$(".navbar").height();return $(r).offset().top-e-cint(t)},filter_dict:function(r,t){var e=[];return typeof t=="string"?[r[t]]:($.each(r,function(i,n){for(var o in t)if($.isArray(t[o])){if(t[o][0]=="in"){if(t[o][1].indexOf(n[o])==-1)return}else if(t[o][0]=="not in"){if(t[o][1].indexOf(n[o])!=-1)return}else if(t[o][0]=="<"){if(!(n[o]<t[o]))return}else if(t[o][0]=="<="){if(!(n[o]<=t[o]))return}else if(t[o][0]==">"){if(!(n[o]>t[o]))return}else if(t[o][0]==">="&&!(n[o]>=t[o]))return}else if(n[o]!=t[o])return;e.push(n)}),e)},comma_or:function(r){return frappe.utils.comma_sep(r," "+__("or")+" ")},comma_and:function(r){return frappe.utils.comma_sep(r," "+__("and")+" ")},comma_sep:function(r,t){return r instanceof Array?r.length==0?"":r.length==1?r[0]:r.slice(0,r.length-1).join(", ")+t+r.slice(-1)[0]:r},set_footnote:function(r,t,e){return r||(r=$('<div class="text-muted footnote-area level">').appendTo(t)),e?r.html(e):(r.remove(),r=null),r},get_args_dict_from_url:function(r){var t={};return $.each(decodeURIComponent(r).split("&"),function(e,i){i=i.split("="),t[i[0]]=i[1]}),t},get_url_from_dict:function(r){return $.map(r,function(t,e){return t!==null?encodeURIComponent(e)+"="+encodeURIComponent(t):null}).join("&")||""},validate_type:function(r,t){var e;switch(t){case"phone":e=/^([0-9 +_\-,.*#()]){1,20}$/;break;case"name":e=/^[\w][\w'-]*([ \w][\w'-]+)*$/;break;case"number":e=/^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/;break;case"digits":e=/^\d+$/;break;case"alphanum":e=/^\w+$/;break;case"email":e=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;break;case"url":e=/^((([A-Za-z0-9.+-]+:(?:\/\/)?)(?:[-;:&=\+\,\w]@)?[A-Za-z0-9.-]+(:[0-9]+)?|(?:www.|[-;:&=\+\$,\w]+@)[A-Za-z0-9.-]+)((?:\/[\+~%\/.\w-_]*)?\??(?:[-\+=&;%@.\w_]*)#?(?:[\w]*))?)$/i;break;case"dateIso":e=/^(\d{4})\D?(0[1-9]|1[0-2])\D?([12]\d|0[1-9]|3[01])$/;break;default:return!1}return r!==""?e.test(r):!1},guess_style:function(r,t,e){var i=t||"default",n="gray";return r&&(has_words(["Pending","Review","Medium","Not Approved"],r)?(i="warning",n="orange"):has_words(["Open","Urgent","High","Failed","Rejected","Error"],r)?(i="danger",n="red"):has_words(["Closed","Finished","Converted","Completed","Complete","Confirmed","Approved","Yes","Active","Available","Paid","Success"],r)?(i="success",n="green"):has_words(["Submitted"],r)&&(i="info",n="blue")),e?n:i},guess_colour:function(r){return frappe.utils.guess_style(r,null,!0)},get_indicator_color:function(r){return frappe.db.get_list("Workflow State",{filters:{name:r},fields:["name","style"]}).then(t=>{let e=t[0];if(!e.style)return frappe.utils.guess_colour(e.name);let i=e.style;return{Success:"green",Warning:"orange",Danger:"red",Primary:"blue"}[i]})},sort:function(r,t,e,i){if(!r||r.length<2)return r||[];var n={string:function(o,a){return cstr(o[t]).localeCompare(cstr(a[t]))},number:function(o,a){return flt(o[t])-flt(a[t])}};return e||(e=typeof r[0][t]=="string"?"string":"number"),r.sort(n[e]),i&&r.reverse(),r},unique:function(r){for(var t={},e=[],i=0,n=r.length;i<n;i++)r[i]in t||(t[r[i]]=null,e.push(r[i]));return e},remove_nulls:function(r){for(var t=[],e=0,i=r.length;e<i;e++)is_null(r[e])||t.push(r[e]);return t},all:function(r){for(var t=0,e=r.length;t<e;t++)if(!r[t])return!1;return!0},dict:function(r,t){var e=[];return $.each(t,function(i,n){var o={};$.each(r,function(a,s){o[s]=n[a]}),e.push(o)}),e},sum:function(r){return r.reduce(function(t,e){return flt(t)+flt(e)},0)},arrays_equal:function(r,t){if(!r||!t||r.length!=t.length)return!1;for(var e=0;e<r.length;e++)if($.isArray(r[e])){if(!frappe.utils.arrays_equal(r[e],t[e]))return!1}else if(r[e]!==t[e])return!1;return!0},intersection:function(r,t){var e=0,i=0,n=new Array;for(r=[].concat(r).sort(),t=[].concat(t).sort();e<r.length&&i<t.length;)r[e]<t[i]?e++:(r[e]>t[i]||(n.push(r[e]),e++),i++);return n},resize_image:function(r,t,e,i){var n=new Image;e||(e=600),i||(i=400),n.src=r.result,n.onload=function(){var o=n.width,a=n.height;o>a?o>e&&(a*=e/o,o=e):a>i&&(o*=i/a,a=i);var s=document.createElement("canvas");s.width=o,s.height=a;var l=s.getContext("2d");l.drawImage(this,0,0,o,a);var u=s.toDataURL("image/jpeg");setTimeout(function(){t(u)},10)}},csv_to_array:function(r,t){t=t||",";for(var e=new RegExp("(\\"+t+'|\\r?\\n|\\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^"\\'+t+"\\r\\n]*))","gi"),i=[[]],n=null;n=e.exec(r);){var o=n[1];o.length&&o!==t&&i.push([]);var a;n[2]?a=n[2].replace(new RegExp('""',"g"),'"'):a=n[3],i[i.length-1].push(a)}return i},warn_page_name_change:function(){frappe.msgprint(__("Note: Changing the Page Name will break previous URL to this page."))},notify:function(r,t,e,i){console.log("push notifications are evil and deprecated")},set_title:function(r){frappe._original_title=r,frappe._title_prefix&&(r=frappe._title_prefix+" "+r.replace(/<[^>]*>/g,"")),document.title=r;let t=frappe.router.get_sub_path();frappe.route_titles[t]=r},set_title_prefix:function(r){frappe._title_prefix=r,frappe.utils.set_title(frappe._original_title)},is_image_file:function(r){return r?(r=r.split("?")[0],/\.(gif|jpg|jpeg|tiff|png|svg)$/i.test(r)):!1},play_sound:function(r){try{if(frappe.boot.user.mute_sounds)return;var t=$("#sound-"+r)[0];t.volume=t.getAttribute("volume"),t.play()}catch(e){console.log("Cannot play sound",r,e)}},split_emails:function(r){var t=[];return r&&r.split(/[,\n](?=(?:[^"]|"[^"]*")*$)/g).forEach(function(e){e=e.trim(),e&&t.push(e)}),t},supportsES6:function(){try{return new Function("(a = 0) => a"),!0}catch(r){return!1}}(),throttle:function(r,t,e){var i,n,o,a=null,s=0;e||(e={});let l=function(){s=e.leading===!1?0:Date.now(),a=null,o=r.apply(i,n),a||(i=n=null)};return function(){var u=Date.now();!s&&e.leading===!1&&(s=u);let c=t-(u-s);return i=this,n=arguments,c<=0||c>t?(a&&(clearTimeout(a),a=null),s=u,o=r.apply(i,n),a||(i=n=null)):!a&&e.trailing!==!1&&(a=setTimeout(l,c)),o}},debounce:function(r,t,e){var i;return function(){var n=this,o=arguments,a=function(){i=null,e||r.apply(n,o)},s=e&&!i;clearTimeout(i),i=setTimeout(a,t),s&&r.apply(n,o)}},get_form_link:function(r,t,e=!1,i=null,n=null){i=i||t,t=encodeURIComponent(t);let o=`/app/${encodeURIComponent(r.toLowerCase().replace(/ /g,"-"))}/${t}`;return n&&(o+=frappe.utils.make_query_string(n)),e?`<a href="${o}">${i}</a>`:o},get_route_label(r){let t=r.split("/");return t[2]==="Report"||t[0]==="query-report"?__("{0} Report",[t[3]||t[1]]):t[0]==="List"?__("{0} List",[t[1]]):t[0]==="modules"?__("{0} Modules",[t[1]]):t[0]==="dashboard"?__("{0} Dashboard",[t[1]]):__(frappe.utils.to_title_case(t[0],!0))},report_column_total:function(r,t,e){return t.column.disable_total?"":r.length>0?t.column.fieldtype=="Percent"||e==="mean"?r.reduce((i,n)=>i+flt(n))/r.length:t.column.fieldtype=="Int"?r.reduce((i,n)=>i+cint(n)):frappe.model.is_numeric_field(t.column.fieldtype)?r.reduce((i,n)=>i+flt(n)):null:null},setup_search(r,t,e,i){let n=r.find('[data-element="search"]').show();n.focus().val("");let o=r.find(t).show();n.off("keyup").on("keyup",()=>{let a=n.val().toLowerCase();a=a.replace(/^\s+|\s+$/g,"");for(let s=0;s<o.length;s++){let l=o.eq(s).find(e),u=l.text().toLowerCase(),c="";i&&l.attr(i)&&(c=l.attr(i).toLowerCase()),u.includes(a)||c.includes(a)?o.eq(s).css("display",""):o.eq(s).css("display","none")}})},setup_timer(r,t,e){let i=t>r,n=r,o=setInterval(()=>{if(i?n++:n--,i?n>t:n<t){clearInterval(o);return}e.text(n)},1e3)},deep_equal(r,t){return(0,td.default)(r,t)},deep_clone(r,t){return(0,rd.default)(r,t)},file_name_ellipsis(r,t){let e=t*2/3,i=t-e,n=r.split("."),o=n.pop(),a=n.join(""),s=a.slice(0,e),l=a.slice(-i);return a.length>t?`${s}...${l}.${o}`:r},get_decoded_string(r){let e=r.split(",")[1],i=atob(e);try{let n=escape(i);i=decodeURIComponent(n)}catch(n){}return i},copy_to_clipboard(r){let t=()=>{frappe.show_alert({indicator:"green",message:__("Copied to clipboard.")})};if(navigator.clipboard&&window.isSecureContext)navigator.clipboard.writeText(r).then(t);else{let e=$("<textarea>");$("body").append(e),e.val(r).select(),document.execCommand("copy"),t(),e.remove()}},is_rtl(r=null){return["ar","he","fa","ps"].includes(r||frappe.boot.lang)},bind_actions_with_object(r,t){return $(r).off("click.class_actions"),$(r).on("click.class_actions","[data-action]",e=>{let i=$(e.currentTarget),n=i.data("action");t[n]&&t[n](e,i)}),r},eval(r,t={}){let e=Object.keys(t),i=Object.values(t);r=`let out = ${r}; return out`;try{return new Function(...e,r)(...i)}catch(n){throw console.log("Error evaluating the following expression:"),console.error(r),n}},get_browser(){let r=navigator.userAgent,t,e=r.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(e[1])?(t=/\brv[ :]+(\d+)/g.exec(r)||[],{name:"IE",version:t[1]||""}):e[1]==="Chrome"&&(t=r.match(/\bOPR|Edge\/(\d+)/),t!=null)?{name:"Opera",version:t[1]}:(e=e[2]?[e[1],e[2]]:[navigator.appName,navigator.appVersion,"-?"],(t=r.match(/version\/(\d+)/i))!=null&&e.splice(1,1,t[1]),{name:e[0],version:e[1]})},get_formatted_duration(r,t=null){let e="";if(t||(t={hide_days:0,hide_seconds:0}),r){let i=frappe.utils.seconds_to_duration(r,t);i.days&&(e+=i.days+__("d",null,"Days (Field: Duration)")),i.hours&&(e+=e.length?" ":"",e+=i.hours+__("h",null,"Hours (Field: Duration)")),i.minutes&&(e+=e.length?" ":"",e+=i.minutes+__("m",null,"Minutes (Field: Duration)")),i.seconds&&(e+=e.length?" ":"",e+=i.seconds+__("s",null,"Seconds (Field: Duration)"))}return e},seconds_to_duration(r,t){let e=r>0?Math.floor:Math.ceil,i={days:e(r/86400),hours:e(r%86400/3600),minutes:e(r%3600/60),seconds:e(r%60)};return t&&t.hide_days&&(i.hours=e(r/3600),i.days=0),i},duration_to_seconds(r=0,t=0,e=0,i=0){let n=0;return r&&(n+=r*24*60*60),t&&(n+=t*60*60),e&&(n+=e*60),i&&(n+=i),n},get_duration_options:function(r){return{hide_days:r.hide_days,hide_seconds:r.hide_seconds}},get_number_system:function(r){return["Bangladesh","India","Myanmar","Pakistan"].includes(r)?io.indian:io.default},map_defaults:{center:[19.08,72.8961],zoom:13,tiles:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",options:{attribution:'&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'}},icon(r,t="sm",e="",i="",n=""){let o="";return typeof t=="object"?i+=` width: ${t.width}; height: ${t.height}`:o=`icon-${t}`,`<svg class="icon ${n} ${o}" style="${i}">
			<use class="${e}" href="#icon-${r}"></use>
		</svg>`},flag(r){return`<img
		src="https://flagcdn.com/${r}.svg"
		width="20" height="15">`},make_chart(r,t={}){let e={type:"bar",colors:["light-blue"],axisOptions:{xIsSeries:1,shortenYAxisNumbers:1,xAxisMode:"tick",numberFormatter:frappe.utils.format_chart_axis_number}};for(let i in t)typeof e[i]=="object"&&typeof t[i]=="object"?e[i]=Object.assign(e[i],t[i]):e[i]=t[i];return new frappe.Chart(r,e)},format_chart_axis_number(r,t){let e=frappe.sys_defaults.country;return frappe.utils.shorten_number(r,t||e,3)},generate_route(r){let t=r.type.toLowerCase();t==="doctype"&&(r.doctype=r.name);let e="";if(r.route)e=r.route;else if(r.link)e=strip(r.link,"#");else if(t==="doctype"){let i=frappe.router.slug(r.doctype);if(frappe.model.is_single(r.doctype))e=i;else switch(r.doc_view||(frappe.model.is_tree(r.doctype)?r.doc_view="Tree":r.doc_view="List"),r.doc_view){case"List":r.filters&&(frappe.route_options=r.filters),e=i;break;case"Tree":e=`${i}/view/tree`;break;case"Report Builder":e=`${i}/view/report`;break;case"Dashboard":e=`${i}/view/dashboard`;break;case"New":e=`${i}/new`;break;case"Calendar":e=`${i}/view/calendar/default`;break;default:frappe.throw({message:__("Not a valid view:")+r.doc_view,title:__("Unknown View")}),e=""}}else t==="report"?r.is_query_report?e="query-report/"+r.name:r.doctype?e=frappe.router.slug(r.doctype)+"/view/report/"+r.name:e="/report/"+r.name:t==="page"?e=r.name:t==="dashboard"&&(e=`dashboard-view/${r.name}`);return r.route_options&&(e+="?"+$.map(r.route_options,function(i,n){return encodeURIComponent(n)+"="+encodeURIComponent(i)}).join("&")),`/app/${e}`},shorten_number:function(r,t,e=4,i=2){if(String(r).match(/\d/g).length<e)return r.toString();let o=this.get_number_system(t),a=Math.abs(Math.round(r));for(let s of o)if(a>=s.divisor){let l=r/s.divisor;return l=this.get_number_of_decimals(l)>i?l.toFixed(i):l,l+" "+s.symbol}return r.toFixed(i)},get_number_of_decimals:function(r){return Math.floor(r)===r?0:r.toString().split(".")[1].length||0},build_summary_item(r){if(r.type=="separator")return $(`<div class="summary-separator">
				<div class="summary-value ${r.color?r.color.toLowerCase():"text-muted"}">${r.value}</div>
			</div>`);let t={fieldtype:r.datatype},e=null;r.datatype=="Currency"&&(t.options="currency",e={currency:r.currency});let i=frappe.format(r.value,t,{only_value:!0},e),n=r.indicator?r.indicator.toLowerCase():r.color?r.color.toLowerCase():"";return $(`<div class="summary-item">
			<span class="summary-label">${r.label}</span>
			<div class="summary-value ${n}">${i}</div>
		</div>`)},print(r,t,e,i,n){if(!window.open(frappe.urllib.get_full_url("/printview?doctype="+encodeURIComponent(r)+"&name="+encodeURIComponent(t)+"&trigger_print=1&format="+encodeURIComponent(e)+"&no_letterhead="+(i?"0":"1")+"&letterhead="+encodeURIComponent(i)+(n?"&_lang="+n:"")))){frappe.msgprint(__("Please enable pop-ups"));return}},get_clipboard_data(r){let t=r;return(t.clipboardData||window.clipboardData||t.originalEvent.clipboardData).getData("Text")},add_custom_button(r,t,e="",i="",n,o,a){n||(n="btn-secondary");let s=$(`<button class="btn ${n} btn-xs ${e}" title="${i}">${r}</button>`);s.click(l=>{l.stopPropagation(),t&&t(l)}),!a&&s.appendTo(o),a&&o.prepend(s)},sleep(r){return new Promise(t=>setTimeout(t,r))},parse_array(r){if(r&&r.length!==0)return r},range(r,t){t||(t=r,r=0);let e=[];for(let i=r;i<t;i++)e.push(i);return e},get_link_title(r,t){if(!(!r||!t||!frappe._link_titles))return frappe._link_titles[r+"::"+t]},add_link_title(r,t,e){!r||!t||(frappe._link_titles||(frappe._link_titles={}),frappe._link_titles[r+"::"+t]=e)},fetch_link_title(r,t){try{return frappe.xcall("frappe.desk.search.get_link_title",{doctype:r,docname:t}).then(e=>(frappe.utils.add_link_title(r,t,e),e))}catch(e){return console.log("Error while fetching link title."),console.log(e),Promise.resolve(t)}},only_allow_num_decimal(r){r.on("input",t=>{let e=$(t.target);e.val(e.val().replace(/[^0-9.]/g,"")),(t.which!=46||e.val().indexOf(".")!=-1)&&(t.which<48||t.which>57)&&t.preventDefault()})},string_to_boolean(r){switch(r.toLowerCase().trim()){case"t":case"true":case"y":case"yes":case"1":return!0;case"f":case"false":case"n":case"no":case"0":case null:return!1;default:return r}},get_filter_as_json(r){let t=null;return r.length&&(t={},r.forEach(e=>{t[e[1]]=[e[2],e[3]]}),t=JSON.stringify(t)),t},get_filter_from_json(r,t){if(r){if(!r.length)return[];let e=new Function(`return ${r}`)();return t?Object.keys(e).map(i=>{let n=e[i];return[t,i,n[0],n[1],!1]}):e||[]}},load_video_player(){return frappe.require("video_player.bundle.js")},is_current_user(r){return r===frappe.session.user},debug:{watch_property(r,t,e=console.trace){if(!frappe.boot.developer_mode)return;console.warn("Adding property watcher, make sure to remove it after debugging.");let i="$_"+t+"_$";r[i]=r[t],Object.defineProperty(r,t,{get:function(){return r[i]},set:function(n){e(),r[i]=n}})}}});frappe.provide("frappe.utils");var pw={init(){this.jq=jQuery({})},trigger(r,t){!this.jq&&this.init(),this.jq.trigger(r,t)},once(r,t){!this.jq&&this.init(),this.jq.one(r,(e,i)=>t(i))},on(r,t){!this.jq&&this.init(),this.jq.bind(r,(e,i)=>t(i))},off(r,t){!this.jq&&this.init(),this.jq.unbind(r,(e,i)=>t(i))}};frappe.utils.make_event_emitter=function(r){return Object.assign(r,pw),r};frappe.provide("frappe.views");frappe.re_route={"#login":""};frappe.route_titles={};frappe.route_flags={};frappe.route_history=[];frappe.view_factory={};frappe.view_factories=[];frappe.route_options=null;frappe.route_hooks={};$(window).on("hashchange",function(r){if(window.location.hash&&!frappe.router.is_app_route(r.currentTarget.pathname)){let t=frappe.router.get_sub_path(window.location.hash);return frappe.router.push_state(t),!1}});window.addEventListener("popstate",r=>(frappe.router.route(),r.preventDefault(),!1));$("body").on("click","a",function(r){let t=i=>(r.preventDefault(),frappe.set_route(i),!1),e=r.currentTarget.getAttribute("href");if(!(r.currentTarget.getAttribute("onclick")||r.ctrlKey||r.metaKey||e==="#")){if(e==="")return t("/app");if(e&&e.startsWith("#"))return t(r.currentTarget.hash);if(frappe.router.is_app_route(r.currentTarget.pathname)){if(r.currentTarget.search){frappe.route_options={};let i=new URLSearchParams(r.currentTarget.search);for(let[n,o]of i)frappe.route_options[n]=o}return t(r.currentTarget.pathname+r.currentTarget.hash)}}});frappe.router={current_route:null,routes:{},factory_views:["form","list","report","tree","print","dashboard"],list_views:["list","kanban","report","calendar","tree","gantt","dashboard","image","inbox"],layout_mapped:{},is_app_route(r){if(r.substr(0,1)==="/"&&(r=r.substr(1)),r=r.split("/"),r[0])return r[0]==="app"},setup(){for(let r of frappe.boot.user.can_read)this.routes[this.slug(r)]={doctype:r};if(frappe.boot.doctype_layouts)for(let r of frappe.boot.doctype_layouts)this.routes[this.slug(r.name)]={doctype:r.document_type,doctype_layout:r.name}},route(){if(!frappe.app)return;let r=this.get_sub_path();this.re_route(r)||(this.current_sub_path=r,this.current_route=this.parse(),this.set_history(r),this.render(),this.set_title(r),this.trigger("change"))},parse(r){return r=this.get_sub_path_string(r).split("/"),r?(r=$.map(r,this.decode_component),this.set_route_options_from_url(),this.convert_to_standard_route(r)):[]},convert_to_standard_route(r){let t=r[1]&&`${r[1]}-${frappe.user.name.toLowerCase()}`;return frappe.workspaces[r[0]]?r=["Workspaces",frappe.workspaces[r[0]].title]:r[0]=="private"&&frappe.workspaces[t]?r=["Workspaces","private",frappe.workspaces[t].title]:this.routes[r[0]]&&(r=this.set_doctype_route(r)),r},doctype_route_exist(r){return r=this.get_sub_path_string(r).split("/"),this.routes[r[0]]},set_doctype_route(r){let t=this.routes[r[0]];if(r[1])if(r[2]&&r[1]==="view")r=this.get_standard_route_for_list(r,t);else{let e=r[1];r.length>2&&(e=r.slice(1).join("/")),r=["Form",t.doctype,e]}else frappe.model.is_single(t.doctype)?r=["Form",t.doctype,t.doctype]:r=["List",t.doctype,"List"];return t.doctype_layout&&(this.doctype_layout=t.doctype_layout),r},get_standard_route_for_list(r,t){let e;return r[2].toLowerCase()==="tree"?e=["Tree",t.doctype]:(e=["List",t.doctype,frappe.utils.to_title_case(r[2])],r[3]&&e.push(...r.slice(3,r.length))),e},set_history(){frappe.route_history.push(this.current_route),frappe.ui.hide_open_dialog()},render(){this.current_route[0]?this.render_page():frappe.views.pageview.show("")},render_page(){let r=this.current_route,t=frappe.utils.to_title_case(r[0]);if(r[1]&&frappe.views[t+"Factory"])r[0]=t,frappe.view_factory[t]||(frappe.view_factory[t]=new frappe.views[t+"Factory"]),frappe.view_factory[t].show();else{let e=frappe.utils.xss_sanitise(r[0]);frappe.views.pageview&&frappe.views.pageview.show(e)}},re_route(r){if(frappe.re_route[r]!==void 0){let t=this.get_sub_path(frappe.re_route[r]);return t===this.current_sub_path?window.history.back():frappe.set_route(t),!0}},set_title(r){frappe.route_titles[r]&&frappe.utils.set_title(frappe.route_titles[r])},set_route(){let r=Array.from(arguments);return new Promise(t=>{r=this.get_route_from_arguments(r),r=this.convert_from_standard_route(r);let e=this.make_url(r);this.push_state(e),setTimeout(()=>{frappe.after_ajax&&frappe.after_ajax(()=>{t()})},100)}).finally(()=>frappe.route_flags={})},get_route_from_arguments(r){return r.length===1&&$.isArray(r[0])&&(r=r[0]),r.length===1&&r[0]&&r[0].includes("/")&&(r=$.map(r[0].split("/"),this.decode_component)),r&&r[0]==""&&r.shift(),r&&["desk","app"].includes(r[0])&&r.shift(),r},convert_from_standard_route(r){let t=r[0]?r[0].toLowerCase():"",e=r;return t==="list"?r[2]&&r[2]!=="list"&&!$.isPlainObject(r[2])?(e=[this.slug(r[1]),"view",r[2].toLowerCase()],r[3]&&e.push(...r.slice(3,r.length))):($.isPlainObject(r[2])&&(frappe.route_options=r[2]),e=[this.slug(r[1])]):t==="form"?(e=[this.slug(r[1])],r[2]&&e.push(r[2])):t==="tree"&&(e=[this.slug(r[1]),"view","tree"]),e},slug_parts(r){return r[0]&&this.factory_views.includes(r[0].toLowerCase())&&(r[0]=r[0].toLowerCase(),r[1]=this.slug(r[1])),r},make_url(r){let t=$.map(r,function(n){return $.isPlainObject(n)?(frappe.route_options=n,null):(n=String(n),n&&n.match(/[%'"#\s\t]/)&&(n=encodeURIComponent(n)),n)}).join("/"),i=frappe.workspaces[`home-${frappe.user.name.toLowerCase()}`]?"private/home":frappe.workspaces.home?"home":Object.keys(frappe.workspaces)[0];return"/app/"+(t||i)},push_state(r){if(window.location.pathname!==r){let t=frappe.route_flags.replace_route?"replaceState":"pushState";history[t](null,null,r),this.route()}},get_sub_path_string(r){return r||(r=window.location.pathname,r.includes("app#")&&(r=window.location.hash)),this.strip_prefix(r)},strip_prefix(r){return r.substr(0,1)=="/"&&(r=r.substr(1)),r.startsWith("app/")&&(r=r.substr(4)),r=="app"&&(r=r.substr(4)),r.substr(0,1)=="/"&&(r=r.substr(1)),r.substr(0,1)=="#"&&(r=r.substr(1)),r.substr(0,1)=="!"&&(r=r.substr(1)),r},get_sub_path(r){var t=this.get_sub_path_string(r);return r=$.map(t.split("/"),this.decode_component).join("/"),r},set_route_options_from_url(){let r=window.location.search;frappe.route_options||(frappe.route_options={});let t=new URLSearchParams(r);for(let[e,i]of t)frappe.route_options[e]=i},decode_component(r){try{return decodeURIComponent(r)}catch(t){if(t instanceof URIError)return r;throw t}},slug(r){return r.toLowerCase().replace(/ /g,"-")}};frappe.get_route=()=>frappe.router.current_route;frappe.get_route_str=()=>frappe.router.current_route.join("/");frappe.set_route=function(){return frappe.router.set_route.apply(frappe.router,arguments)};frappe.get_prev_route=function(){return frappe.route_history&&frappe.route_history.length>1?frappe.route_history[frappe.route_history.length-2]:[]};frappe.set_re_route=function(){var r=frappe.router.get_sub_path();frappe.set_route.apply(null,arguments),frappe.re_route[r]=frappe.router.get_sub_path()};frappe.has_route_options=function(){return Boolean(Object.keys(frappe.route_options||{}).length)};frappe.utils.make_event_emitter(frappe.router);frappe.route_history_queue=[];var hw=["Form","social","setup-wizard","recorder"],_w=frappe.utils.debounce(()=>{if(frappe.session.user==="Guest")return;let r=frappe.route_history_queue;!r.length||(frappe.route_history_queue=[],frappe.xcall("frappe.desk.doctype.route_history.route_history.deferred_insert",{routes:r}).catch(()=>{frappe.route_history_queue.concat(r)}))},1e4);frappe.router.on("change",()=>{let r=frappe.get_route();mw(r)&&(frappe.route_history_queue.push({creation:frappe.datetime.now_datetime(),route:frappe.get_route_str()}),_w())});function mw(r){return r[1]?!(r[0]==="List"&&!r[2]||hw.includes(r[0])):!1}frappe.defaults={get_user_default:function(r){var t=frappe.boot.user.defaults,e=t[r];if(!e&&frappe.defaults.is_a_user_permission_key(r)&&(e=t[frappe.model.scrub(r)]),$.isArray(e)&&(e=e[0]),!!frappe.defaults.in_user_permission(r,e))return e},get_user_defaults:function(r){var t=frappe.boot.user.defaults,e=t[r];return frappe.defaults.is_a_user_permission_key(r)&&(e&&$.isArray(e)&&e.length===1?e=e[0]:e=t[r]||t[frappe.model.scrub(r)]),$.isArray(e)||(e=[e]),e.filter(i=>{if(frappe.defaults.in_user_permission(r,i))return i}),e},get_global_default:function(r){var t=frappe.sys_defaults[r];return $.isArray(t)&&(t=t[0]),t},get_global_defaults:function(r){var t=frappe.sys_defaults[r];return $.isArray(t)||(t=[t]),t},set_user_default_local:function(r,t){frappe.boot.user.defaults[r]=t},get_default:function(r){var t=frappe.boot.user.defaults,e=t[r];if(frappe.defaults.is_a_user_permission_key(r)&&(e&&$.isArray(e)&&e.length===1?e=e[0]:e=t[frappe.model.scrub(r)]),!!frappe.defaults.in_user_permission(r,e)&&e)try{return JSON.parse(e)}catch(i){return e}},is_a_user_permission_key:function(r){return r.indexOf(":")===-1&&r!==frappe.model.scrub(r)},in_user_permission:function(r,t){let e=this.get_user_permissions()[frappe.model.unscrub(r)];return e&&e.length?e.some(n=>n.doc===t):!0},get_user_permissions:function(){return this._user_permissions||{}},update_user_permissions:function(){let r="frappe.core.doctype.user_permission.user_permission.get_user_permissions";frappe.call(r).then(t=>{t.message&&(this._user_permissions=Object.assign({},t.message))})}};frappe.RoleEditor=class{constructor(r,t,e){this.frm=t,this.wrapper=r,this.disable=e;let i=this.frm.doc.roles.map(o=>o.role);this.multicheck=frappe.ui.form.make_control({parent:r,df:{fieldname:"roles",fieldtype:"MultiCheck",select_all:!0,columns:3,get_data:()=>frappe.xcall("frappe.core.doctype.user.user.get_all_roles").then(o=>o.map(a=>({label:__(a),value:a,checked:i.includes(a)}))),on_change:()=>{this.set_roles_in_table(),this.frm.dirty()}},render_input:!0});let n=this.multicheck.make_checkboxes;this.multicheck.make_checkboxes=()=>{n.call(this.multicheck),this.multicheck.$wrapper.find(".label-area").click(o=>{let a=$(o.target).data("unit");a&&this.show_permissions(a),o.preventDefault()})}}set_enable_disable(){$(this.wrapper).find('input[type="checkbox"]').attr("disabled",!!this.disable)}show_permissions(r){return this.perm_dialog||this.make_perm_dialog(),$(this.perm_dialog.body).empty(),frappe.xcall("frappe.core.doctype.user.user.get_perm_info",{role:r}).then(t=>{let e=$(this.perm_dialog.body);t.length?(e.append(`
						<table class="user-perm">
							<thead>
								<tr>
									<th> ${__("Document Type")} </th>
									<th> ${__("Level")} </th>
									${frappe.perm.rights.map(i=>`<th> ${frappe.unscrub(i)}</th>`).join("")}
								</tr>
							</thead>
							<tbody></tbody>
						</table>
					`),t.forEach(i=>{e.find("tbody").append(`
							<tr>
								<td>${i.parent}</td>
								<td>${i.permlevel}</td>
								${frappe.perm.rights.map(n=>`<td class="text-muted bold">${i[n]?frappe.utils.icon("check","xs"):"-"}</td>`).join("")}
							</tr>
						`)})):e.append(`<div class="text-muted text-center padding">
						${__("{0} role does not have permission on any doctype",[r])}
					</div>`),this.perm_dialog.set_title(r),this.perm_dialog.show()})}make_perm_dialog(){this.perm_dialog=new frappe.ui.Dialog({title:__("Role Permissions")}),this.perm_dialog.$wrapper.find(".modal-dialog").css("width","1200px").css("max-width","80vw")}show(){this.reset(),this.set_enable_disable()}reset(){let r=(this.frm.doc.roles||[]).map(t=>t.role);this.multicheck.selected_options=r,this.multicheck.refresh_input()}set_roles_in_table(){let r=this.frm.doc.roles||[],t=this.multicheck.get_checked_options();r.map(e=>{t.includes(e.role)||frappe.model.clear_doc(e.doctype,e.name)}),t.map(e=>{if(!r.find(i=>i.role===e)){let i=frappe.model.add_child(this.frm.doc,"Has Role","roles");i.role=e}})}get_roles(){return{checked_roles:this.multicheck.get_checked_options(),unchecked_roles:this.multicheck.get_unchecked_options()}}};frappe.ModuleEditor=class{constructor(t,e){this.frm=t,this.wrapper=e;let i=this.frm.doc.block_modules.map(n=>n.module);this.multicheck=frappe.ui.form.make_control({parent:e,df:{fieldname:"block_modules",fieldtype:"MultiCheck",select_all:!0,columns:3,get_data:()=>this.frm.doc.__onload.all_modules.map(n=>({label:__(n),value:n,checked:!i.includes(n)})),on_change:()=>{this.set_modules_in_table(),this.frm.dirty()}},render_input:!0})}show(){let t=this.frm.doc.block_modules.map(i=>i.module),e=this.frm.doc.__onload.all_modules;this.multicheck.selected_options=e.filter(i=>!t.includes(i)),this.multicheck.refresh_input()}set_modules_in_table(){let t=this.frm.doc.block_modules||[],e=this.multicheck.get_unchecked_options();t.map(i=>{e.includes(i.module)||frappe.model.clear_doc(i.doctype,i.name)}),e.map(i=>{if(!t.find(n=>n.module===i)){let n=frappe.model.add_child(this.frm.doc,"Block Module","block_modules");n.module=i}})}};frappe.template={compiled:{},debug:{}};frappe.template.compile=function(r,t){var e=t||r;if(!frappe.template.compiled[e]){let o=function(a,s,l,u,c){var h=frappe.utils.get_random(3),p=frappe.utils.get_random(3);return"{% for (var "+h+"=0, "+p+"="+l+".length; "+h+"<"+p+"; "+h+"++) { var "+s+" = "+l+"["+h+"]; "+s+"._index = "+h+"; %}"};var n=o;r.indexOf("'")!==-1&&r.replace(/'/g,"\\'"),r=r.replace(/{{/g,"{%=").replace(/}}/g,"%}"),r=r.replace(/{%\s?if\s?\s?not\s?([^\(][^%{]+)\s?%}/g,"{% if (! $1) { %}"),r=r.replace(/{%\s?if\s?([^\(][^%{]+)\s?%}/g,"{% if ($1) { %}"),r=r.replace(/{%\s?for\s([a-z._]+)\sin\s([a-z._]+)\s?%}/g,o),r=r.replace(/{%\s?endif\s?%}/g,"{% }; %}"),r=r.replace(/{%\s?else\s?%}/g,"{% } else { %}"),r=r.replace(/{%\s?endfor\s?%}/g,"{% }; %}");var i=`var _p=[],print=function(){_p.push.apply(_p,arguments)};with(obj){
_p.push('`+r.replace(/[\r\t\n]/g," ").split("{%").join("	").replace(/((^|%})[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%}/g,"',$1,'").split("	").join(`');
`).split("%}").join(`
_p.push('`).split("\r").join("\\'")+"');}return _p.join('');";frappe.template.debug[t]=i;try{frappe.template.compiled[e]=new Function("obj",i)}catch(a){console.log("Error in Template:"),console.log(i),a.lineNumber&&(console.log("Error in Line "+a.lineNumber+", Col "+a.columnNumber+":"),console.log(i.split(`
`)[a.lineNumber-1]))}}return frappe.template.compiled[e]};frappe.render=function(r,t,e){return frappe.template.compile(r,e)(t)};frappe.render_template=function(r,t){if(r.indexOf(" ")!==-1)var e=r;else var e=frappe.templates[r];return t===void 0&&(t={}),e||frappe.throw(`Template <b>${r}</b> not found.`),frappe.render(e,t,r)};frappe.render_grid=function(r){r.grid&&(r.columns=r.grid.getColumns(),r.data=r.grid.getData().getItems()),r.print_settings&&r.print_settings.orientation&&r.print_settings.orientation.toLowerCase()==="landscape"&&(r.landscape=!0),r.landscape==null&&(r.columns&&r.columns.length>10?r.landscape=!0:r.landscape=!1),r.content||(r.content=frappe.render_template(r.template||"print_grid",r)),r.base_url=frappe.urllib.get_base_url(),r.print_css=frappe.boot.print_css,r.lang=r.lang||frappe.boot.lang,r.layout_direction=r.layout_direction||frappe.utils.is_rtl()?"rtl":"ltr";var t=frappe.render_template("print_template",r),e=window.open();e||frappe.msgprint(__("Please enable pop-ups in your browser")),e.document.write(t),e.document.close()},frappe.render_tree=function(r){r.base_url=frappe.urllib.get_base_url(),r.landscape=!1,r.print_css=frappe.boot.print_css,r.print_format_css_path=frappe.assets.bundled_asset("print_format.bundle.css");var t=frappe.render_template("print_tree",r),e=window.open();e||frappe.msgprint(__("Please enable pop-ups in your browser")),e.document.write(t),e.document.close()};frappe.render_pdf=function(r,t={}){var e=new FormData;e.append("html",r),t.orientation&&e.append("orientation",t.orientation);var i=new Blob([],{type:"text/xml"});e.append("blob",i);var n=new XMLHttpRequest;n.open("POST","/api/method/frappe.utils.print_format.report_to_pdf"),n.setRequestHeader("X-Frappe-CSRF-Token",frappe.csrf_token),n.responseType="arraybuffer",n.onload=function(o){if(this.status===200){var a=new Blob([o.currentTarget.response],{type:"application/pdf"}),s=URL.createObjectURL(a);window.open(s)}},n.send(e)};frappe.templates.page=`<div class="page-head flex">
	<div class="container">
		<div class="row flex align-center page-head-content justify-between">
			<div class="col-md-4 col-sm-6 col-xs-8 page-title">
				<!-- <div class="title-image hide hidden-md hidden-lg"></div> -->
				<!-- title -->
				<span class="sidebar-toggle-btn">
					<svg class="icon icon-md sidebar-toggle-placeholder">
						<use href="#icon-menu"></use>
					</svg>
					<span class="sidebar-toggle-icon">
						<svg class="icon icon-md">
							<use href="#icon-sidebar-collapse">
							</use>
						</svg>
					</span>
				</span>
				<div class="flex fill-width title-area">
					<div>
						<div class="flex">
							<h3 class="ellipsis title-text"></h3>
							<span class="indicator-pill whitespace-nowrap"></span>
						</div>
						<div class="ellipsis sub-heading hide text-muted"></div>
					</div>
					<button class="btn btn-default more-button hide">
						<svg class="icon icon-sm">
							<use href="#icon-dot-horizontal">
							</use>
						</svg>
					</button>
				</div>
			</div>
			<div class="flex col page-actions justify-content-end">
				<!-- buttons -->
				<div class="custom-actions hide hidden-xs hidden-md"></div>
				<div class="standard-actions flex">
					<span class="page-icon-group hide hidden-xs hidden-sm"></span>
					<div class="menu-btn-group hide">
						<button type="button" class="btn btn-default icon-btn" data-toggle="dropdown" aria-expanded="false">
							<span>
								<span class="menu-btn-group-label">
									<svg class="icon icon-sm">
										<use href="#icon-dot-horizontal">
										</use>
									</svg>
								</span>
							</span>
						</button>
						<ul class="dropdown-menu dropdown-menu-right" role="menu"></ul>
					</div>
					<button class="btn btn-secondary btn-default btn-sm hide"></button>
					<div class="actions-btn-group hide">
						<button type="button" class="btn btn-primary btn-sm" data-toggle="dropdown" aria-expanded="false">
							<span class="hidden-xs">
								<span class="actions-btn-group-label">{%= __("Actions") %}</span>
								<svg class="icon icon-xs">
									<use href="#icon-select">
									</use>
								</svg>
							</span>
						</button>
						<ul class="dropdown-menu dropdown-menu-right" role="menu">
						</ul>
					</div>
					<button class="btn btn-primary btn-sm hide primary-action"></button>
				</div>
			</div>
		</div>
	</div>
</div>
<div class="container page-body">
	<div class="page-toolbar hide">
		<div class="container">
		</div>
	</div>
	<div class="page-wrapper">
		<div class="page-content">
			<div class="workflow-button-area btn-group pull-right hide"></div>
			<div class="clearfix"></div>
		</div>
	</div>
</div>`;frappe.ui.make_app_page=function(r){return r.parent.page=new frappe.ui.Page(r),r.parent.page};frappe.ui.pages={};frappe.ui.Page=class{constructor(t){$.extend(this,t),this.set_document_title=!0,this.buttons={},this.fields_dict={},this.views={},this.make(),frappe.ui.pages[frappe.get_route_str()]=this}make(){this.wrapper=$(this.parent),this.add_main_section(),this.setup_scroll_handler(),this.setup_sidebar_toggle()}setup_scroll_handler(){let t=0;window.addEventListener("scroll",frappe.utils.throttle(()=>{$(".page-head").toggleClass("drop-shadow",!!document.documentElement.scrollTop);let e=document.documentElement.scrollTop;e>0&&t<=e?$(".page-head").css("top","-15px"):$(".page-head").css("top","var(--navbar-height)"),t=e}),500)}get_empty_state(t,e,i){return $(`<div class="page-card-container">
			<div class="page-card">
				<div class="page-card-head">
					<span class="indicator blue">
						${t}</span>
				</div>
				<p>${e}</p>
				<div>
					<button class="btn btn-primary btn-sm">${i}</button>
				</div>
			</div>
		</div>`)}load_lib(t){frappe.require(this.required_libs,t)}add_main_section(){$(frappe.render_template("page",{})).appendTo(this.wrapper),this.single_column?this.add_view("main",'<div class="row layout-main">					<div class="col-md-12 layout-main-section-wrapper">						<div class="layout-main-section"></div>						<div class="layout-footer hide"></div>					</div>				</div>'):this.add_view("main",`
				<div class="row layout-main">
					<div class="col-lg-2 layout-side-section"></div>
					<div class="col layout-main-section-wrapper">
						<div class="layout-main-section"></div>
						<div class="layout-footer hide"></div>
					</div>
				</div>
			`),this.setup_page()}setup_page(){this.$title_area=this.wrapper.find(".title-area"),this.$sub_title_area=this.wrapper.find("h6"),this.title&&this.set_title(this.title),this.icon&&this.get_main_icon(this.icon),this.body=this.main=this.wrapper.find(".layout-main-section"),this.container=this.wrapper.find(".page-body"),this.sidebar=this.wrapper.find(".layout-side-section"),this.footer=this.wrapper.find(".layout-footer"),this.indicator=this.wrapper.find(".indicator-pill"),this.page_actions=this.wrapper.find(".page-actions"),this.btn_primary=this.page_actions.find(".primary-action"),this.btn_secondary=this.page_actions.find(".btn-secondary"),this.menu=this.page_actions.find(".menu-btn-group .dropdown-menu"),this.menu_btn_group=this.page_actions.find(".menu-btn-group"),this.actions=this.page_actions.find(".actions-btn-group .dropdown-menu"),this.actions_btn_group=this.page_actions.find(".actions-btn-group"),this.standard_actions=this.page_actions.find(".standard-actions"),this.custom_actions=this.page_actions.find(".custom-actions"),this.page_form=$('<div class="page-form row hide"></div>').prependTo(this.main),this.inner_toolbar=this.custom_actions,this.icon_group=this.page_actions.find(".page-icon-group"),this.make_page&&this.make_page(),this.card_layout&&this.main.addClass("frappe-card");let t=this.menu_btn_group.find("button");t.attr("title",__("Menu")).tooltip({delay:{show:600,hide:100}}),frappe.ui.keys.get_shortcut_group(this.page_actions[0]).add(t,t.find(".menu-btn-group-label"));let e=this.actions_btn_group.find("button");frappe.ui.keys.get_shortcut_group(this.page_actions[0]).add(e,e.find(".actions-btn-group-label"))}setup_sidebar_toggle(){let t=$(".page-head").find(".sidebar-toggle-btn"),e=this.wrapper.find(".layout-side-section");this.disable_sidebar_toggle||!e.length?t.remove():(t.attr("title",__("Toggle Sidebar")).tooltip({delay:{show:600,hide:100},trigger:"hover"}),t.click(()=>{frappe.utils.is_xs()||frappe.utils.is_sm()?this.setup_overlay_sidebar():e.toggle(),$(document.body).trigger("toggleSidebar"),this.update_sidebar_icon()}))}setup_overlay_sidebar(){let t=this.sidebar.find(".overlay-sidebar").addClass("opened");$('<div class="close-sidebar">').hide().appendTo(this.sidebar).fadeIn();let e=$("html").css("overflow-y","hidden");this.sidebar.find(".close-sidebar").on("click",n=>i(n)),this.sidebar.on("click","button:not(.dropdown-toggle)",n=>i(n));let i=()=>{e.css("overflow-y",""),this.sidebar.find("div.close-sidebar").fadeOut(()=>{t.removeClass("opened").find(".dropdown-toggle").removeClass("text-muted")})}}update_sidebar_icon(){let e=$(".page-head").find(".sidebar-toggle-btn").find(".sidebar-toggle-icon"),i=this.wrapper.find(".layout-side-section"),n=$(i).is(":visible");e.html(frappe.utils.icon(n?"sidebar-collapse":"sidebar-expand","md"))}set_indicator(t,e){this.clear_indicator().removeClass("hide").html(`<span>${t}</span>`).addClass(e)}add_action_icon(t,e,i="",n){let o=$(`
			<button class="text-muted btn btn-default ${i} icon-btn">
				${frappe.utils.icon(t)}
			</button>
		`);return o.appendTo(this.icon_group.removeClass("hide")),o.click(e),o.attr("title",__(n||frappe.unscrub(t))).tooltip({delay:{show:600,hide:100},trigger:"hover"}),o}clear_indicator(){return this.indicator.removeClass().addClass("indicator-pill whitespace-nowrap hide")}get_icon_label(t,e){let i=t,n="xs";return typeof t=="object"&&(i=t.icon,n=t.size||"xs"),`${t?frappe.utils.icon(i,n):""} <span class="hidden-xs"> ${__(e)} </span>`}set_action(t,e){let i=this;e.icon&&(e.label=this.get_icon_label(e.icon,e.label)),this.clear_action_of(t),t.removeClass("hide").prop("disabled",!1).html(e.label).on("click",function(){let o=e.click.apply(this,[t]);i.btn_disable_enable(t,o)}),e.working_label&&t.attr("data-working-label",e.working_label);let n=t.find("span");frappe.ui.keys.get_shortcut_group(this).add(t,n.length?n:t)}set_primary_action(t,e,i,n){return this.set_action(this.btn_primary,{label:t,click:e,icon:i,working_label:n}),this.btn_primary}set_secondary_action(t,e,i,n){return this.set_action(this.btn_secondary,{label:t,click:e,icon:i,working_label:n}),this.btn_secondary}clear_action_of(t){t.addClass("hide").unbind("click").removeAttr("data-working-label")}clear_primary_action(){this.clear_action_of(this.btn_primary)}clear_secondary_action(){this.clear_action_of(this.btn_secondary)}clear_actions(){this.clear_primary_action(),this.clear_secondary_action()}clear_custom_actions(){this.custom_actions.addClass("hide").empty()}clear_icons(){this.icon_group.addClass("hide").empty()}add_menu_item(t,e,i,n){return this.add_dropdown_item({label:t,click:e,standard:i,parent:this.menu,shortcut:n})}add_custom_menu_item(t,e,i,n,o,a=null){return this.add_dropdown_item({label:e,click:i,standard:n,parent:t,shortcut:o,icon:a})}clear_menu(){this.clear_btn_group(this.menu)}show_menu(){this.menu_btn_group.removeClass("hide")}hide_menu(){this.menu_btn_group.addClass("hide")}show_icon_group(){this.icon_group.removeClass("hide")}hide_icon_group(){this.icon_group.addClass("hide")}show_actions_menu(){this.actions_btn_group.removeClass("hide")}hide_actions_menu(){this.actions_btn_group.addClass("hide")}add_action_item(t,e,i){return this.add_dropdown_item({label:t,click:e,standard:i,parent:this.actions})}add_actions_menu_item(t,e,i,n){return this.add_dropdown_item({label:t,click:e,standard:i,shortcut:n,parent:this.actions,show_parent:!1})}clear_actions_menu(){this.clear_btn_group(this.actions)}add_dropdown_item({label:t,click:e,standard:i,parent:n,shortcut:o,show_parent:a=!0,icon:s=null}){a&&n.parent().removeClass("hide");let l=this.is_in_group_button_dropdown(n,"li > a.grey-link > span",t);if(l)return l;let u,c="";if(s&&(c=`<span class="menu-item-icon">${frappe.utils.icon(s)}</span>`),o){let h=this.prepare_shortcut_obj(o,e,t);u=$(`
				<li>
					<a class="grey-link dropdown-item" href="#" onClick="return false;">
						${c}
						<span class="menu-item-label">${t}</span>
						<kbd class="pull-right">
							<span>${h.shortcut_label}</span>
						</kbd>
					</a>
				</li>
			`),frappe.ui.keys.add_shortcut(h)}else u=$(`
				<li>
					<a class="grey-link dropdown-item" href="#" onClick="return false;">
						${c}
						<span class="menu-item-label">${t}</span>
					</a>
				</li>
			`);return l=u.find("a").on("click",e),i?u.appendTo(n):(this.divider=n.find(".dropdown-divider"),this.divider.length||(this.divider=$('<li class="dropdown-divider user-action"></li>').prependTo(n)),u.addClass("user-action").insertBefore(this.divider)),frappe.ui.keys.get_shortcut_group(n.get(0)).add(l,l.find(".menu-item-label")),l}prepare_shortcut_obj(t,e,i){let n;return typeof t=="string"?n={shortcut:t}:n=t,frappe.utils.is_mac()?n.shortcut_label=n.shortcut.replace("Ctrl","\u2318"):n.shortcut_label=n.shortcut,n.shortcut=n.shortcut.toLowerCase(),n.action||(n.action=e),n.description||(n.description=i),n.page=this,n}is_in_group_button_dropdown(t,e,i){if(e||(e="li"),!i||!t)return!1;let n=`${e}[data-label="${encodeURIComponent(i)}"]`,o=$(t).find(n);return(o==null?void 0:o.length)>0&&o}clear_btn_group(t){t.empty(),t.parent().addClass("hide")}add_divider(){return $('<li class="dropdown-divider"></li>').appendTo(this.menu)}get_or_add_inner_group_button(t){var e=this.inner_toolbar.find(`.inner-group-button[data-label="${encodeURIComponent(t)}"]`);return e.length||(e=$(`<div class="inner-group-button" data-label="${encodeURIComponent(t)}">
					<button type="button" class="btn btn-default ellipsis" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
						${t}
						${frappe.utils.icon("select","xs")}
					</button>
					<div role="menu" class="dropdown-menu"></div>
				</div>`).appendTo(this.inner_toolbar)),e}get_inner_group_button(t){return this.inner_toolbar.find(`.inner-group-button[data-label="${encodeURIComponent(t)}"]`)}set_inner_btn_group_as_primary(t){this.get_or_add_inner_group_button(t).find("button").removeClass("btn-default").addClass("btn-primary")}btn_disable_enable(t,e){e&&e.then?(t.prop("disabled",!0),e.then(()=>{t.prop("disabled",!1)})):e&&e.always&&(t.prop("disabled",!0),e.always(()=>{t.prop("disabled",!1)}))}add_inner_button(t,e,i,n="default"){var o=this;let a=function(){let l=$(this),u=e();o.btn_disable_enable(l,u)};if(i){var s=this.get_or_add_inner_group_button(i);if($(this.inner_toolbar).removeClass("hide"),!this.is_in_group_button_dropdown(s.find(".dropdown-menu"),"a",t))return $(`<a class="dropdown-item" href="#" onclick="return false;" data-label="${encodeURIComponent(t)}">${t}</a>`).on("click",a).appendTo(s.find(".dropdown-menu"))}else{let l=this.inner_toolbar.find(`button[data-label="${encodeURIComponent(t)}"]`);return l.length==0&&(l=$(`<button data-label="${encodeURIComponent(t)}" class="btn btn-${n} ellipsis">
					${__(t)}
				</button>`),l.on("click",a),l.appendTo(this.inner_toolbar.removeClass("hide"))),l}}remove_inner_button(t,e){if(typeof t=="string"&&(t=[t]),t=t.map(n=>__(n)),e){var i=this.get_inner_group_button(__(e));i.length&&i.find(`.dropdown-item[data-label="${encodeURIComponent(t)}"]`).remove(),i.find(".dropdown-item").length===0&&i.remove()}else this.inner_toolbar.find(`button[data-label="${encodeURIComponent(t)}"]`).remove()}change_inner_button_type(t,e,i){let n;if(e){var o=this.get_inner_group_button(__(e));o.length&&(n=o.find(`.dropdown-item[data-label="${encodeURIComponent(t)}"]`))}else n=this.inner_toolbar.find(`button[data-label="${encodeURIComponent(t)}"]`);n&&n.removeClass().addClass(`btn btn-${i} ellipsis`)}add_inner_message(t){let e=$(`<span class='inner-page-message text-muted small'>${t}</div>`);return this.inner_toolbar.find(".inner-page-message").remove(),this.inner_toolbar.removeClass("hide").prepend(e),e}clear_inner_toolbar(){this.inner_toolbar.empty().addClass("hide")}add_sidebar_item(t,e,i,n){var o=this.sidebar.find(".sidebar-menu.standard-actions"),a=$("<li>"),s=$("<a>").html(t).on("click",e).appendTo(a);return i?a.insertAfter(o.find(i)):n?a.prependTo(o):a.appendTo(o),s}clear_user_actions(){this.menu.find(".user-action").remove()}get_title_area(){return this.$title_area}set_title(t,e=null,i=!0,n=""){t||(t=""),i&&(t=strip_html(t)),this.title=t,frappe.utils.set_title(n||t),e&&(t=`${frappe.utils.icon(e)} ${t}`);let o=this.$title_area.find(".title-text");o.html(t),o.attr("title",this.title)}set_title_sub(t){this.$sub_title_area.html(t).toggleClass("hide",!t)}get_main_icon(t){return this.$title_area.find(".title-icon").html('<i class="'+t+' fa-fw"></i> ').toggle(!0)}add_help_button(t){}add_button(t,e,i){i||(i={});let n=$(`<button
			class="btn ${i.btn_class||"btn-default"} ${i.btn_size||"btn-sm"} ellipsis">
				${i.icon?frappe.utils.icon(i.icon):""}
				${t}
		</button>`);return this.add_menu_item(t,e,!1).parent().addClass("hidden-xl"),n.appendTo(this.custom_actions),n.on("click",e),this.custom_actions.removeClass("hide"),n}add_custom_button_group(t,e,i){let n=`<span class="hidden-xs">
			<span class="custom-btn-group-label">${__(t)}</span>
			${frappe.utils.icon("select","xs")}
		</span>`;e&&(n=`<span class="hidden-xs">
				${frappe.utils.icon(e)}
				<span class="custom-btn-group-label">${__(t)}</span>
				${frappe.utils.icon("select","xs")}
			</span>
			<span class="visible-xs">
				${frappe.utils.icon(e)}
			</span>`);let o=$(`
			<div class="custom-btn-group">
				<button type="button" class="btn btn-default btn-sm ellipsis" data-toggle="dropdown" aria-expanded="false">
					${n}
				</button>
				<ul class="dropdown-menu" role="menu"></ul>
			</div>
		`);return i||(i=this.custom_actions),i.removeClass("hide").append(o),o.find(".dropdown-menu")}add_dropdown_button(t,e,i,n){frappe.ui.toolbar.add_dropdown_button(t,e,i,n)}add_label(t){return this.show_form(),$("<label class='col-md-1 page-only-label'>"+t+" </label>").appendTo(this.page_form)}add_select(t,e){var i=this.add_field({label:t,fieldtype:"Select"});return i.$wrapper.find("select").empty().add_options(e)}add_data(t){var e=this.add_field({label:t,fieldtype:"Data"});return e.$wrapper.find("input").attr("placeholder",t)}add_date(t,e){var i=this.add_field({label:t,fieldtype:"Date",default:e});return i.$wrapper.find("input").attr("placeholder",t)}add_check(t){return $("<div class='checkbox'><label><input type='checkbox'>"+t+"</label></div>").appendTo(this.page_form).find("input")}add_break(){this.page_form.append('<div class="clearfix invisible-xs"></div>')}add_field(t,e){this.show_form(),t.placeholder||(t.placeholder=t.label),t.input_class="input-xs";var i=frappe.ui.form.make_control({df:t,parent:e||this.page_form,only_input:t.fieldtype!="Check"});if(i.refresh(),$(i.wrapper).addClass("col-md-2").attr("title",__(t.label)).tooltip({delay:{show:600,hide:100},trigger:"hover"}),t.fieldtype!="HTML")return i.$input||i.make_input(),i.$input.attr("placeholder",__(t.label)),t.fieldtype==="Check"&&$(i.wrapper).find(":first-child").removeClass("col-md-offset-4 col-md-8"),t.fieldtype=="Button"&&($(i.wrapper).find(".page-control-label").html("&nbsp;"),i.$input.addClass("btn-xs").css({width:"100%","margin-top":"-1px"})),t.default&&i.set_input(t.default),this.fields_dict[t.fieldname||t.label]=i,i}clear_fields(){this.page_form.empty()}show_form(){this.page_form.removeClass("hide")}hide_form(){this.page_form.addClass("hide")}get_form_values(){var t={};for(let e in this.fields_dict){let i=this.fields_dict[e];t[e]=i.get_value()}return t}add_view(t,e){let i=e;return typeof e=="string"&&(i=$(e)),this.views[t]=i.appendTo($(this.wrapper).find(".page-content")),this.current_view?this.views[t].toggle(!1):this.current_view=this.views[t],this.views[t]}set_view(t){this.current_view_name!==t&&(this.current_view&&this.current_view.toggle(!1),this.current_view=this.views[t],this.previous_view_name=this.current_view_name,this.current_view_name=t,this.views[t].toggle(!0),this.wrapper.trigger("view-change"))}};frappe.provide("frappe.ui");frappe.ui.Slide=class{constructor(t=null){$.extend(this,t),this.setup()}setup(){this.$wrapper=$('<div class="slide-wrapper hidden"></div>').attr({"data-slide-id":this.id,"data-slide-name":this.name}).appendTo(this.parent)}make(){this.before_load&&this.before_load(this),this.$body=$(`<div class="slide-body">
			<div class="content text-center">
				<h1 class="title slide-title">${__(this.title)}</h1>
			</div>
			<div class="form-wrapper">
				<div class="form"></div>
				<div class="add-more text-center" style="margin-top: 5px;">
					<button class="form-more-btn hide btn btn-default btn-xs">
						<span>Add More</span>
					</button>
				</div>
			</div>
		</div>`).appendTo(this.$wrapper),this.$content=this.$body.find(".content"),this.$form=this.$body.find(".form"),this.$primary_btn=this.slides_footer.find(".primary"),this.$form_wrapper=this.$body.find(".form-wrapper"),this.image_src&&this.$content.append($(`<img src="${this.image_src}" style="margin: 20px;">`)),this.help&&this.$content.append($(`<p class="slide-help">${__(this.help)}</p>`)),this.reqd_fields=[],this.refresh(),this.made=!0}refresh(){this.render_parent_dots(),this.done?this.setup_done_state():this.setup_form()}setup_form(){this.form=new frappe.ui.FieldGroup({fields:this.get_atomic_fields(),body:this.$form[0],no_submit_on_enter:!0}),this.form.make(),this.add_more&&this.bind_more_button(),this.set_reqd_fields(),this.onload&&this.onload(this),this.set_reqd_fields()}setup_done_state(){}get_atomic_fields(){var t=JSON.parse(JSON.stringify(this.fields));return this.add_more&&(this.count=1,t=t.map((e,i)=>(e.fieldname&&(e.fieldname+="_1"),i===1&&this.mandatory_entry&&(e.reqd=1),e.static||e.label&&e.label,e))),t}set_reqd_fields(){var t=this.form.fields_dict;this.reqd_fields=[],Object.keys(t).map(e=>{t[e].df.reqd&&this.reqd_fields.push(t[e])})}set_values(t){return this.values=this.form.get_values(t),!(this.values===null||this.validate&&!this.validate())}bind_more_button(){this.$more=this.$body.find(".form-more-btn"),this.$more.removeClass("hide").on("click",()=>{this.count++;var t=JSON.parse(JSON.stringify(this.fields));this.form.add_fields(t.map(e=>(e.fieldname&&(e.fieldname+="_"+this.count),e.static||e.label&&e.label,e.reqd=0,e))),this.count===this.max_count&&this.$more.addClass("hide")})}resetup_primary_button(){this.unbind_primary_action(),this.bind_fields_to_action_btn(),this.reset_action_button_state(),this.bind_primary_action()}bind_fields_to_action_btn(){var t=this;this.reqd_fields.map(e=>{e.$wrapper.on("change input click",()=>{t.reset_action_button_state()}),e.$wrapper.on("keydown","input",i=>{i.key=="Enter"&&t.reset_action_button_state()})})}reset_action_button_state(){var t=this.reqd_fields.filter(e=>!e.get_value());t.length?this.slides_footer.find(".action").addClass("disabled"):this.slides_footer.find(".action").removeClass("disabled")}unbind_primary_action(){this.slides_footer.find(".primary").off()}bind_primary_action(){this.slides_footer.find(".primary").on("click.primary_action",()=>{this.primary_action()})}is_last_slide(){return this.id===this.parent[0].children.length-1}before_show(){}show_slide(){this.$wrapper.removeClass("hidden"),this.before_show(),this.resetup_primary_button(),this.done?this.$primary_btn.hide():(this.$body.find(".form-control").first().focus(),this.$primary_btn.show())}hide_slide(){this.$wrapper.addClass("hidden")}get_input(t){return this.form.get_input(t)}get_field(t){return this.form.get_field(t)}get_value(t){return this.form.get_value(t)}destroy(){this.$body.remove()}primary_action(){}};frappe.ui.Slides=class{constructor({parent:t=null,slides:e=[],slide_class:i=null,unidirectional:n=0,done_state:o=0,before_load:a=null,on_update:s=null}){this.parent=t,this.slides=e,this.slide_class=i,this.unidirectional=n,this.done_state=o,this.before_load=a,this.on_update=s,this.page_name="setup-wizard",this.slide_dict={},this.made_slide_ids=[],this.values={},this.make()}make(){this.$slide_progress=$("<div>").addClass("slides-progress text-center text-extra-muted").appendTo(this.parent),this.container=$("<div>").addClass("slides-wrapper").attr({tabindex:-1}).appendTo(this.parent),this.$body=$("<div>").addClass("slide-container").appendTo(this.container),this.$footer=$("<div>").addClass("slide-footer").appendTo(this.container),this.render_progress_dots(),this.make_prev_next_complete_buttons(),this.before_load&&this.before_load(this.$footer),this.setup(),this.show_slide(0)}setup(){this.slides.map((t,e)=>{this.slide_dict[e]?this.made_slide_ids.includes(e+"")&&(this.slide_dict[e].done=!1,this.slide_dict[e].destroy(),this.slide_dict[e].make()):(this.slide_dict[e]=new this.slide_class($.extend(this.slides[e],{parent:this.$body,slides_footer:this.$footer,render_parent_dots:this.render_progress_dots.bind(this),id:e})),this.unidirectional||this.slide_dict[e].make())})}refresh(t){this.render_progress_dots(),this.make_prev_next_complete_buttons(),this.show_hide_prev_next(t),this.$body.find(".form-control").first().focus()}render_progress_dots(){this.$slide_progress.empty(),!(this.slides.length<=1)&&(this.slides.map((t,e)=>{let i=$(`<div class="slide-step">
				<div class="slide-step-indicator"></div>
				<div class="slide-step-complete">${frappe.utils.icon("tick","xs")}</div>
			</div>`).attr({"data-step-id":e});this.done_state&&(this.slide_dict[e]&&this.slide_dict[e].done||t.done)&&i.addClass("step-success"),this.unidirectional&&e===this.current_id&&i.addClass("active"),this.$slide_progress.append(i)}),this.completed=0,this.slides.map((t,e)=>{this.slide_dict[e]?this.slide_dict[e].done&&this.completed++:t.done&&this.completed++}),this.on_update&&this.on_update(this.completed,this.slides.length),this.unidirectional||this.bind_progress_dots())}make_prev_next_complete_buttons(){this.$footer.empty(),$(`<div class="row">
			<div class="col-sm-4 text-left prev-div">
				<button class="prev-btn btn btn-secondary btn-sm" tabindex="0">${__("Previous",null,"Go to previous slide")}</button>
			</div>
			<div class="col-sm-8 text-right next-div">
				<button class="complete-btn btn btn-sm primary">${__("Complete Setup",null,"Finish the setup wizard")}</button>
				<button class="next-btn btn btn-default btn-sm" tabindex="0">${__("Next",null,"Go to next slide")}</button>
			</div>
		</div>`).appendTo(this.$footer),this.$prev_btn=this.$footer.find(".prev-btn").attr("tabIndex",0).on("click",()=>this.show_slide(this.current_id-1)),this.$next_btn=this.$footer.find(".next-btn").attr("tabIndex",0).on("click",()=>{this.done_state&&(this.slide&&(this.slide.done=!0),this.current_slide&&(this.current_slide.done=!0)),(!this.unidirectional||this.unidirectional&&this.current_slide.set_values())&&this.show_slide(this.current_id+1)}),this.$complete_btn=this.$footer.find(".complete-btn").attr("tabIndex",0)}bind_progress_dots(){var t=this;this.$slide_progress.find(".fa-circle").addClass("link").on("click",function(){let e=$(this).attr("data-step-id");t.show_slide(e)})}before_show_slide(){return!0}show_slide(t){t=cint(t),!(!this.before_show_slide()||this.current_slide&&this.current_id===t)&&(this.update_values(),this.current_slide&&this.current_slide.hide_slide(),this.unidirectional&&!this.slide_dict[t].made&&this.slide_dict[t].make(),this.current_id=t,this.current_slide=this.slide_dict[t],this.current_slide.show_slide(),this.refresh(t))}destroy_slide(t){this.slide_dict[t]&&this.slide_dict[t].destroy(),this.slide_dict[t]=null}on_update(t,e){}show_hide_prev_next(t){t===0?this.$prev_btn.hide():this.$prev_btn.show(),t+1===this.slides.length?this.$next_btn.hide():this.$next_btn.show()}get_values(){var t={};return $.each(this.slide_dict,function(e,i){i.values&&$.extend(t,i.values)}),t}update_values(){this.values=$.extend(this.values,this.get_values())}};frappe.find={page_primary_action:()=>$(".page-actions:visible .btn-primary"),field:(r,t)=>new Promise(e=>{let i=$(`[data-fieldname="${r}"] :input`);t?(i.val(t).trigger("change"),frappe.after_ajax(()=>{e(i)})):e(i)})};frappe.ui.IconBar=class{constructor(t,e){this.parent=t,this.buttons={},this.make(e)}make(t){this.$wrapper=$('<div class="iconbar-wrapper hide"></div>').appendTo(this.parent);for(var e=0;e<t;e++)this.get_group(e+1)}get_group(t){var e=this.$wrapper.find(".iconbar-"+t+" ul");return e.length||(e=$('<div class="iconbar iconbar-'+t+' hide"><ul></ul></div>').appendTo(this.$wrapper).find("ul")),e}add_btn(t,e,i,n){var o=this.get_group(t),a=$('<li><i class="'+e+'"></i></li>').appendTo(o).on("click",function(){return n.apply(this),!1});return a.find("i").attr("title",i).tooltip({delay:{show:600,hide:100},trigger:"hover"}),this.$wrapper.find(".iconbar-"+t).removeClass("hide"),this.show(),a}hide(t){t?(this.$wrapper.find(".iconbar-"+t).addClass("hide"),this.check_if_all_hidden()):this.$wrapper.addClass("hide").trigger("hidden")}show(t){t?(this.$wrapper.find(".iconbar-"+t).removeClass("hide"),this.show()):this.$wrapper.hasClass("hide")&&this.$wrapper.removeClass("hide").trigger("shown")}clear(t){var e=this;this.$wrapper.find(".iconbar-"+t).addClass("hide").find("ul").empty(),this.check_if_all_hidden()}check_if_all_hidden(){this.$wrapper.find(".iconbar:visible").length||this.hide()}};frappe.ui.form.LinkSelector=class{constructor(t){$.extend(this,t);var e=this;this.doctype!="[Select]"?frappe.model.with_doctype(this.doctype,function(i){e.make()}):this.make()}make(){var t=this;this.start=0,this.dialog=new frappe.ui.Dialog({title:__("Select {0}",[this.doctype=="[Select]"?__("value"):__(this.doctype)]),fields:[{fieldtype:"Data",fieldname:"txt",label:__("Beginning with"),description:__("You can use wildcard %")},{fieldtype:"HTML",fieldname:"results"},{fieldtype:"Button",fieldname:"more",label:__("More"),click:()=>{t.start+=20,t.search()}}],primary_action_label:__("Search"),primary_action:function(){t.start=0,t.search()}}),this.txt&&this.dialog.fields_dict.txt.set_input(this.txt),this.dialog.get_input("txt").on("keypress",function(e){e.which===13&&(t.start=0,t.search())}),this.dialog.show(),this.search()}search(){var t={txt:this.dialog.fields_dict.txt.get_value(),searchfield:"name",start:this.start},e=this;this.target.set_custom_query&&this.target.set_custom_query(t),this.target.is_grid&&this.target.fieldinfo[this.fieldname]&&this.target.fieldinfo[this.fieldname].get_query&&$.extend(t,this.target.fieldinfo[this.fieldname].get_query(cur_frm.doc)),frappe.link_search(this.doctype,t,function(i){var n=e.dialog.fields_dict.results.$wrapper;if(t.start===0&&n.empty(),i.values.length?$.each(i.values,function(a,s){var l=$(repl('<div class="row link-select-row">						<div class="col-xs-4">							<b><a href="#">%(name)s</a></b></div>						<div class="col-xs-8">							<span class="text-muted">%(values)s</span></div>						</div>',{name:s[0],values:s.splice(1).join(", ")})).appendTo(n);l.find("a").attr("data-value",s[0]).click(function(){var u=$(this).attr("data-value");return e.target.is_grid?e.set_in_grid(u).then(()=>e.search()):(e.target.doctype?e.target.parse_validate_and_set_in_model(u):(e.target.set_input(u),e.target.$input.trigger("change")),e.dialog.hide()),!1})}):$('<p><br><span class="text-muted">'+__("No Results")+"</span>"+(frappe.model.can_create(e.doctype)?'<br><br><a class="new-doc btn btn-default btn-sm">'+__("Create a new {0}",[__(e.doctype)])+"</a>":"")+"</p>").appendTo(n).find(".new-doc").click(function(){frappe.new_doc(e.doctype)}),i.values.length<20){var o=e.dialog.fields_dict.more.$wrapper;o.hide()}},this.dialog.get_primary_btn())}set_in_grid(t){return new Promise(e=>{if(this.qty_fieldname)frappe.prompt({fieldname:"qty",fieldtype:"Float",label:"Qty",default:1,reqd:1},i=>{if(!(this.target.frm.doc[this.target.df.fieldname]||[]).some(o=>{if(o[this.fieldname]===t)return frappe.model.set_value(o.doctype,o.name,this.qty_fieldname,i.qty).then(()=>{frappe.show_alert(__("Added {0} ({1})",[t,o[this.qty_fieldname]])),e()}),!0})){let o=null;frappe.run_serially([()=>o=this.target.add_new_row(),()=>frappe.timeout(.1),()=>{let a={};return a[this.fieldname]=t,a[this.qty_fieldname]=i.qty,frappe.model.set_value(o.doctype,o.name,a)},()=>frappe.show_alert(__("Added {0} ({1})",[t,i.qty])),()=>e()])}},__("Set Quantity"),__("Set Quantity"));else if(this.dynamic_link_field){let i=this.target.add_new_row();frappe.model.set_value(i.doctype,i.name,this.dynamic_link_field,this.dynamic_link_reference),frappe.model.set_value(i.doctype,i.name,this.fieldname,t).then(()=>{frappe.show_alert(__("{0} {1} added",[this.dynamic_link_reference,t])),e()})}else{let i=this.target.add_new_row();frappe.model.set_value(i.doctype,i.name,this.fieldname,t).then(()=>{frappe.show_alert(__("{0} added",[t])),e()})}})}};frappe.link_search=function(r,t,e,i){t||(t={txt:""}),t.doctype=r,t.searchfield||(t.searchfield="name"),frappe.call({method:"frappe.desk.search.search_widget",type:"GET",args:t,callback:function(n){e&&e(n)},btn:i})};frappe.ui.form.MultiSelectDialog=class{constructor(t){Object.assign(this,t),this.for_select=this.doctype=="[Select]",this.for_select?this.init():frappe.model.with_doctype(this.doctype,()=>this.init())}init(){this.page_length=20,this.child_page_length=20,this.fields=this.get_fields(),this.make()}get_fields(){let t=this.get_primary_filters(),e=this.get_result_fields(),i=this.get_data_fields(),n=this.get_child_selection_fields();return[...t,...e,...i,...n]}get_result_fields(){let t=()=>{this.page_length+=20,this.get_results()};return[{fieldtype:"HTML",fieldname:"results_area"},{fieldtype:"Button",fieldname:"more_btn",label:__("More"),click:t.bind(this)}]}get_data_fields(){return this.data_fields&&this.data_fields.length?[{fieldtype:"Section Break"},...this.data_fields]:[]}get_child_selection_fields(){let t=[];if(this.allow_child_item_selection&&this.child_fieldname){let e=()=>{this.child_page_length+=20,this.show_child_results()};t.push({fieldtype:"HTML",fieldname:"child_selection_area"}),t.push({fieldtype:"Button",fieldname:"more_child_btn",hidden:1,label:__("More"),click:e.bind(this)})}return t}make(){let t=this.doctype.plural(),e=__("Select {0}",[this.for_select?__("value"):__(t)]);this.dialog=new frappe.ui.Dialog({title:e,fields:this.fields,size:this.size,primary_action_label:this.primary_action_label||__("Get Items"),secondary_action_label:__("Make {0}",[__(this.doctype)]),primary_action:()=>{let i=this.get_custom_filters(),n=cur_dialog.get_values(),o=this.get_selected_child_names(),a=[...this.get_checked_values(),...this.get_parent_name_of_selected_children()];this.action(a,Ht(lt(lt(lt({},this.args),n),i),{filtered_children:o}))},secondary_action:this.make_new_document.bind(this)}),this.add_filters_group&&this.make_filter_area(),this.args={},this.setup_results(),this.bind_events(),this.get_results(),this.dialog.show()}make_new_document(t){t&&(this.set_route_options(),frappe.new_doc(this.doctype,!0))}set_route_options(){if(frappe.route_options={},Array.isArray(this.setters))for(let t of this.setters)frappe.route_options[t.fieldname]=this.dialog.fields_dict[t.fieldname].get_value()||void 0;else Object.keys(this.setters).forEach(t=>{frappe.route_options[t]=this.dialog.fields_dict[t].get_value()||void 0})}setup_results(){this.$parent=$(this.dialog.body),this.$wrapper=this.dialog.fields_dict.results_area.$wrapper.append(`<div class="results my-3"
			style="border: 1px solid #d1d8dd; border-radius: 3px; height: 300px; overflow: auto;"></div>`),this.$results=this.$wrapper.find(".results"),this.$results.append(this.make_list_row())}show_child_results(){this.get_child_result().then(t=>{this.child_results=t.message||[],this.render_child_datatable(),this.$wrapper.addClass("hidden"),this.$child_wrapper.removeClass("hidden"),this.dialog.fields_dict.more_btn.$wrapper.hide()})}is_child_selection_enabled(){var t;return(t=this.dialog.fields_dict.allow_child_item_selection)==null?void 0:t.get_value()}toggle_child_selection(){this.is_child_selection_enabled()?this.show_child_results():(this.child_results=[],this.get_results(),this.$wrapper.removeClass("hidden"),this.$child_wrapper.addClass("hidden"))}render_child_datatable(){this.child_datatable?setTimeout(()=>{this.child_datatable.rowmanager.checkMap=[],this.child_datatable.refresh(this.get_child_datatable_rows()),this.$child_wrapper.find(".dt-scrollable").css("height","300px"),this.$child_wrapper.find(".dt-scrollable").css("overflow-y","scroll")},500):this.setup_child_datatable()}get_child_datatable_columns(){return[this.doctype,...this.child_columns].map(e=>({name:frappe.unscrub(e),editable:!1}))}get_child_datatable_rows(){return this.child_results.length>this.child_page_length?this.dialog.fields_dict.more_child_btn.toggle(!0):this.dialog.fields_dict.more_child_btn.toggle(!1),this.child_results.slice(0,this.child_page_length).map(t=>Object.values(t).slice(1))}setup_child_datatable(){let t=this.get_child_datatable_columns(),e=this.get_child_datatable_rows();this.$child_wrapper=this.dialog.fields_dict.child_selection_area.$wrapper,this.$child_wrapper.addClass("my-3"),this.child_datatable=new frappe.DataTable(this.$child_wrapper.get(0),{columns:t,data:e,layout:"fluid",inlineFilters:!0,serialNoColumn:!1,checkboxColumn:!0,cellHeight:35,noDataMessage:__("No Data"),disableReorderColumn:!0}),this.$child_wrapper.find(".dt-scrollable").css("height","300px")}get_primary_filters(){let t=[],e=new Array(3);return e[0]=[{fieldtype:"Data",label:__("Name"),fieldname:"search_term"}],e[1]=[],e[2]=[],$.isArray(this.setters)?this.setters.forEach((i,n)=>{e[(n+1)%3].push(i)}):Object.keys(this.setters).forEach((i,n)=>{let o=frappe.meta.docfield_map[this.doctype][i];e[(n+1)%3].push({fieldtype:o.fieldtype,label:o.label,fieldname:i,options:o.options,default:this.setters[i]})}),Object.seal&&Object.seal(e),this.allow_child_item_selection&&(this.child_doctype=frappe.meta.get_docfield(this.doctype,this.child_fieldname).options,e[0].push({fieldtype:"Check",label:__("Select {0}",[this.child_doctype]),fieldname:"allow_child_item_selection",onchange:this.toggle_child_selection.bind(this)})),t=[...e[0],{fieldtype:"Column Break"},...e[1],{fieldtype:"Column Break"},...e[2],{fieldtype:"Section Break",fieldname:"primary_filters_sb"}],this.add_filters_group&&t.push({fieldtype:"HTML",fieldname:"filter_area"}),t}make_filter_area(){this.filter_group=new frappe.ui.FilterGroup({parent:this.dialog.get_field("filter_area").$wrapper,doctype:this.doctype,on_change:()=>{this.is_child_selection_enabled()?this.show_child_results():this.get_results()}}),this.filter_group.wrapper.find(".apply-filters").hide()}get_custom_filters(){return this.add_filters_group&&this.filter_group?this.filter_group.get_filters().reduce((t,e)=>Object.assign(t,{[e[1]]:[e[2],e[3]]}),{}):{}}bind_events(){let t=this;this.$results.on("click",".list-item-container",function(e){!$(e.target).is(":checkbox")&&!$(e.target).is("a")&&$(this).find(":checkbox").trigger("click")}),this.$results.on("click",".list-item--head :checkbox",e=>{this.$results.find(".list-item-container .list-row-check").prop("checked",$(e.target).is(":checked"))}),this.$parent.find(".input-with-feedback").on("change",()=>{frappe.flags.auto_scroll=!1,this.is_child_selection_enabled()?this.show_child_results():this.get_results()}),this.$parent.find('[data-fieldtype="Data"]').on("input",()=>{var e=$(this);clearTimeout(e.data("timeout")),e.data("timeout",setTimeout(function(){frappe.flags.auto_scroll=!1,t.is_child_selection_enabled()?t.show_child_results():(t.empty_list(),t.get_results())},300))})}get_parent_name_of_selected_children(){return!this.child_datatable||!this.child_datatable.datamanager.rows.length?[]:this.child_datatable.rowmanager.checkMap.reduce((e,i,n)=>{if(i==1){let o=this.child_results[n].parent;e.includes(o)||e.push(o)}return e},[])}get_selected_child_names(){return!this.child_datatable||!this.child_datatable.datamanager.rows.length?[]:this.child_datatable.rowmanager.checkMap.reduce((e,i,n)=>{if(i==1){let o=this.child_results[n].name;e.push(o)}return e},[])}get_checked_values(){return this.$results.find(".list-item-container").map(function(){if($(this).find(".list-row-check:checkbox:checked").length>0)return $(this).attr("data-item-name")}).get()}get_checked_items(){let t=this.get_checked_values();return this.results.filter(e=>t.includes(e.name))}get_datatable_columns(){return this.get_query&&this.get_query().query&&this.columns?this.columns:Array.isArray(this.setters)?["name",...this.setters.map(t=>t.fieldname)]:["name",...Object.keys(this.setters)]}make_list_row(t={}){var e=this;let i=Object.keys(t).length===0,n="";this.get_datatable_columns().forEach(function(a){n+=`<div class="list-item__content ellipsis">
				${i?`<span class="ellipsis text-muted" title="${__(frappe.model.unscrub(a))}">${__(frappe.model.unscrub(a))}</span>`:a!=="name"?`<span class="ellipsis result-row" title="${__(t[a]||"")}">${__(t[a]||"")}</span>`:`<a href="${"/app/"+frappe.router.slug(e.doctype)+"/"+t[a]||""}" class="list-id ellipsis" title="${__(t[a]||"")}">
							${__(t[a]||"")}</a>`}
			</div>`});let o=$(`<div class="list-item">
			<div class="list-item__content" style="flex: 0 0 10px;">
				<input type="checkbox" class="list-row-check" data-item-name="${t.name}" ${t.checked?"checked":""}>
			</div>
			${n}
		</div>`);return i?o.addClass("list-item--head"):o=$(`<div class="list-item-container" data-item-name="${t.name}"></div>`).append(o),o}render_result_list(t,e=0,i=!0){var n=this,o=n.dialog.fields_dict.more_btn.$wrapper;if(!frappe.flags.auto_scroll&&i&&this.empty_list(),o.hide(),$(".modal-dialog .list-item--head").css("z-index",1),t.length===0)return;e&&o.show();let a=this.get_checked_values();t.filter(s=>!a.includes(s.name)).forEach(s=>{n.$results.append(n.make_list_row(s))}),this.$results.find(".list-item--head").css("z-index",1),frappe.flags.auto_scroll&&this.$results.animate({scrollTop:n.$results.prop("scrollHeight")},500)}empty_list(){let t=this.get_checked_items().map(e=>Ht(lt({},e),{checked:!0}));this.$results.find(".list-item-container").remove(),this.render_result_list(t,0,!1)}get_filters_from_setters(){let t=this,e=(this.get_query?this.get_query().filters:{})||{},i=[];if($.isArray(this.setters))for(let n of this.setters)e[n.fieldname]=t.dialog.fields_dict[n.fieldname].get_value()||void 0,t.args[n.fieldname]=e[n.fieldname],i.push(n.fieldname);else Object.keys(this.setters).forEach(function(n){var o=t.dialog.fields_dict[n].get_value();t.dialog.fields_dict[n].df.fieldtype=="Data"&&o?e[n]=["like","%"+o+"%"]:(e[n]=o||void 0,t.args[n]=e[n],i.push(n))});return[e,i]}get_args_for_search(){let[t,e]=this.get_filters_from_setters(),i=this.get_custom_filters();return Object.assign(t,i),{doctype:this.doctype,txt:this.dialog.fields_dict.search_term.get_value(),filters:t,filter_fields:e,page_length:this.page_length+5,query:this.get_query?this.get_query().query:"",as_dict:1}}async perform_search(t){let e=await frappe.call({type:"GET",method:"frappe.desk.search.search_widget",no_spinner:!0,args:t}),i=e.values.length&&e.values.length>this.page_length?1:0;return[e,i]}async get_results(){let t=this.get_args_for_search(),[e,i]=await this.perform_search(t);i&&(e.values=e.values.splice(0,this.page_length)),this.results=[],e.values.length&&e.values.forEach(n=>{n.checked=0,this.results.push(n)}),this.render_result_list(this.results,i)}async get_filtered_parents_for_child_search(){let t=this.get_args_for_search();t.filter_fields=["name"];let[e,i]=await this.perform_search(t),n=[];return e.values.length&&(n=e.values.map(o=>o.name)),n}async add_parent_filters(t){let e=await this.get_filtered_parents_for_child_search();e.length&&t.push(["parent","in",e])}add_custom_child_filters(t){this.add_filters_group&&this.filter_group&&this.filter_group.get_filters().forEach(e=>{e[0]==this.child_doctype&&t.push([e[1],e[2],e[3]])})}async get_child_result(){let t=[["parentfield","=",this.child_fieldname]];return await this.add_parent_filters(t),this.add_custom_child_filters(t),frappe.call({method:"frappe.client.get_list",args:{doctype:this.child_doctype,filters:t,fields:["name","parent",...this.child_columns],parent:this.doctype,limit_page_length:this.child_page_length+5,order_by:"parent"}})}};frappe._.get_data_uri=r=>{let t=r.videoWidth,e=r.videoHeight,i=$("<canvas/>");return i[0].width=t,i[0].height=e,i[0].getContext("2d").drawImage(r,0,0,t,e),i[0].toDataURL("image/png")};function gw(){let r=document.createElement("input");return r.setAttribute("type","file"),r.setAttribute("accept","image/*"),r.setAttribute("multiple",""),r}function vw(r){return new Promise((t,e)=>{let i=new FileReader;i.onload=()=>t(i.result),i.onerror=e,i.readAsDataURL(r)})}frappe.ui.Capture=class{constructor(r={}){this.options=frappe.ui.Capture.OPTIONS,this.set_options(r),this.facing_mode="environment",this.images=[]}set_options(r){return this.options=lt(lt({},frappe.ui.Capture.OPTIONS),r),this}show(){this.build_dialog(),frappe.is_mobile()?this.show_for_mobile():this.show_for_desktop()}build_dialog(){let r=this;r.dialog=new frappe.ui.Dialog({title:this.options.title,animate:this.options.animate,fields:[{fieldtype:"HTML",fieldname:"capture"},{fieldtype:"HTML",fieldname:"total_count"}],on_hide:this.stop_media_stream()}),r.$template=$(frappe.ui.Capture.TEMPLATE);let t=r.dialog.get_field("capture");$(t.wrapper).html(r.$template),r.dialog.get_close_btn().on("click",()=>{r.hide()})}show_for_mobile(){let r=this;r.input||(r.input=gw()),r.input.onchange=async()=>{for(let t of r.input.files){let e=await vw(t);r.images.push(e)}r.render_preview(),r.dialog.show()},r.input.click()}show_for_desktop(){let r=this;this.render_stream().then(()=>{r.dialog.show()}).catch(t=>{throw r.options.error&&frappe.show_alert(frappe.ui.Capture.ERR_MESSAGE,3),t})}render_stream(){let r=this,t={video:{facingMode:this.facing_mode}};return navigator.mediaDevices.getUserMedia(t).then(e=>{r.stream=e,r.dialog.custom_actions.empty(),r.dialog.get_primary_btn().off("click"),r.setup_take_photo_action(),r.setup_preview_action(),r.setup_toggle_camera(),r.$template.find(".fc-stream-container").show(),r.$template.find(".fc-preview-container").hide(),r.video=r.$template.find("video")[0],r.video.srcObject=r.stream,r.video.load(),r.video.play()})}render_preview(){this.stop_media_stream(),this.$template.find(".fc-stream-container").hide(),this.$template.find(".fc-preview-container").show(),this.dialog.get_primary_btn().off("click");let r="";this.images.forEach((t,e)=>{r+=`
				<div class="mt-1 p-1 rounded col-md-3 col-sm-4 col-xs-4" data-idx="${e}">
					<span class="capture-remove-btn" data-idx="${e}">
						${frappe.utils.icon("close","lg")}
					</span>
					<img class="rounded" src="${t}" data-idx="${e}">
				</div>
			`}),this.$template.find(".fc-preview-container").empty(),$(this.$template.find(".fc-preview-container")).html(`<div class="row">
				${r}
			</div>`),this.setup_capture_action(),this.setup_submit_action(),this.setup_remove_action(),this.update_count(),this.dialog.custom_actions.empty()}setup_take_photo_action(){let r=this;this.dialog.set_primary_action(__("Take Photo"),()=>{let t=frappe._.get_data_uri(r.video);r.images.push(t),r.setup_preview_action(),r.update_count()})}setup_preview_action(){let r=this;!this.images.length||(this.dialog.set_secondary_action_label(__("Preview")),this.dialog.set_secondary_action(()=>{r.dialog.get_primary_btn().off("click"),r.render_preview()}))}setup_remove_action(){let r=this;this.$template[0].getElementsByClassName("capture-remove-btn").forEach(e=>{e.onclick=()=>{let i=parseInt(e.getAttribute("data-idx"));r.images.splice(i,1),r.render_preview()}})}update_count(){let r=this.dialog.get_field("total_count"),t=`${__("Total Images")}: <b>${this.images.length}`;this.images.length===0&&(t=__("No Images")),$(r.wrapper).html(`
			<div class="row mt-2">
				<div class="offset-4 col-4 d-flex justify-content-center">${t}</b></div>
			</div>
		`)}setup_toggle_camera(){let r=this;this.dialog.add_custom_action(__("Switch Camera"),()=>{r.facing_mode=r.facing_mode=="environment"?"user":"environment",frappe.show_alert({message:__("Switching Camera")}),r.stop_media_stream(),r.render_stream()},"btn-switch")}setup_capture_action(){let r=this;this.dialog.set_secondary_action_label(__("Capture")),this.dialog.set_secondary_action(()=>{frappe.is_mobile()?r.show_for_mobile():r.render_stream()})}setup_submit_action(){let r=this;this.dialog.set_primary_action(__("Submit"),()=>{r.hide(),r.callback&&r.callback(r.images)})}hide(){this.dialog&&this.dialog.hide(),this.stop_media_stream()}stop_media_stream(){this.stream&&this.stream.getTracks().forEach(r=>{r.stop()})}submit(r){this.callback=r}};frappe.ui.Capture.OPTIONS={title:__("Camera"),animate:!1,error:!1};frappe.ui.Capture.ERR_MESSAGE=__("Unable to load camera.");frappe.ui.Capture.TEMPLATE=`
<div class="frappe-capture">
	<div class="embed-responsive embed-responsive-16by9 fc-stream-container">
		<video class="fc-stream embed-responsive-item">${frappe.ui.Capture.ERR_MESSAGE}</video>
	</div>
	<div class="fc-preview-container px-2" style="display: none;">

	</div>
</div>
`;frappe.provide("frappe.ui");frappe.ui.app_icon={get_html:function(r,t){var e=r.icon,i=r.color;e&&e.match(/([\uE000-\uF8FF]|\uD83C[\uDF00-\uDFFF]|\uD83D[\uDC00-\uDDFF])/g)&&(r.emoji=r.icon);var n="";return r.reverse&&(n="color: #36414C;"),i||(i="#4aa3df"),!e||r.emoji?e='<span class="inner" '+(r.reverse?'style="'+n+'"':"")+">"+(r.emoji||r._label[0].toUpperCase())+"</span>":e.split(".").slice(-1)[0]==="svg"?($.ajax({url:frappe.urllib.get_full_url(e),dataType:"text",async:!1,success:function(o){e=o}}),e='<object class="app-icon-svg">'+e+"</object>"):e='<i class="'+e+'" title="'+r._label+'" style="'+n+'"></i>','<div class="app-icon'+(t?" app-icon-small":"")+'" style="background-color: '+i+'" title="'+r._label+'">'+e+"</div>"}};frappe.provide("frappe.ui");frappe.ui.ThemeSwitcher=class{constructor(){this.setup_dialog(),this.refresh()}setup_dialog(){this.dialog=new frappe.ui.Dialog({title:__("Switch Theme")}),this.body=$('<div class="theme-grid"></div>').appendTo(this.dialog.$body),this.bind_events()}bind_events(){this.dialog.$wrapper.on("keydown",t=>{if(!this.themes)return;let e=frappe.ui.keys.get_key(t),i;if(e==="right")i=1;else if(e==="left")i=-1;else if(t.keyCode===13)this.hide();else return;let n=this.themes.findIndex(a=>a.name===this.current_theme),o=this.themes[n+i];if(!!o)return o.$html.click(),!1})}refresh(){this.current_theme=document.documentElement.getAttribute("data-theme-mode")||"light",this.fetch_themes().then(()=>{this.render()})}fetch_themes(){return new Promise(t=>{this.themes=[{name:"light",label:__("Frappe Light"),info:__("Light Theme")},{name:"dark",label:__("Timeless Night"),info:__("Dark Theme")},{name:"automatic",label:__("Automatic"),info:__("Uses system's theme to switch between light and dark mode")}],t(this.themes)})}render(){this.themes.forEach(t=>{let e=this.get_preview_html(t);e.appendTo(this.body),t.$html=e})}get_preview_html(t){let e=t.name==="automatic",i=$(`<div class="${this.current_theme==t.name?"selected":""}">
			<div data-theme=${e?"light":t.name}
				data-is-auto-theme="${e}" title="${t.info}">
				<div class="background">
					<div>
						<div class="preview-check" data-theme=${e?"dark":t.name}>
							${frappe.utils.icon("tick","xs")}
						</div>
					</div>
					<div class="navbar"></div>
					<div class="p-2">
						<div class="toolbar">
							<span class="text"></span>
							<span class="primary"></span>
						</div>
						<div class="foreground"></div>
						<div class="foreground"></div>
					</div>
				</div>
			</div>
			<div class="mt-3 text-center">
				<h5 class="theme-title">${t.label}</h5>
			</div>
		</div>`);return i.on("click",()=>{this.current_theme!==t.name&&(this.themes.forEach(n=>{n.$html.removeClass("selected")}),i.addClass("selected"),this.toggle_theme(t.name))}),i}toggle_theme(t){this.current_theme=t.toLowerCase(),document.documentElement.setAttribute("data-theme-mode",this.current_theme),frappe.show_alert(__("Theme Changed"),3),frappe.xcall("frappe.core.doctype.user.user.switch_theme",{theme:toTitle(t)})}show(){this.dialog.show()}hide(){this.dialog.hide()}};frappe.ui.add_system_theme_switch_listener=()=>{frappe.ui.dark_theme_media_query.addEventListener("change",()=>{frappe.ui.set_theme()})};frappe.ui.dark_theme_media_query=window.matchMedia("(prefers-color-scheme: dark)");frappe.ui.set_theme=r=>{let t=document.documentElement,e=t.getAttribute("data-theme-mode");r||e==="automatic"&&(r=frappe.ui.dark_theme_media_query.matches?"dark":"light"),t.setAttribute("data-theme",r||e)};var dA=Vt(id());frappe.db={get_list:function(r,t){return t||(t={}),t.doctype=r,t.fields||(t.fields=["name"]),"limit"in t||(t.limit=20),new Promise(e=>{frappe.call({method:"frappe.desk.reportview.get_list",args:t,type:"GET",callback:function(i){e(i.message)}})})},exists:function(r,t){return new Promise(e=>{frappe.db.get_value(r,{name:t},"name").then(i=>{i.message&&i.message.name?e(!0):e(!1)})})},get_value:function(r,t,e,i,n){return frappe.call({method:"frappe.client.get_value",type:"GET",args:{doctype:r,fieldname:e,filters:t,parent:n},callback:function(o){i&&i(o.message)}})},get_single_value:(r,t)=>new Promise(e=>{frappe.call({method:"frappe.client.get_single_value",args:{doctype:r,field:t},type:"GET"}).then(i=>e(i?i.message:null))}),set_value:function(r,t,e,i,n){return frappe.call({method:"frappe.client.set_value",args:{doctype:r,name:t,fieldname:e,value:i},callback:function(o){n&&n(o.message)}})},get_doc:function(r,t,e){return new Promise((i,n)=>{frappe.call({method:"frappe.client.get",type:"GET",args:{doctype:r,name:t,filters:e},callback:o=>{frappe.model.sync(o.message),i(o.message)}}).fail(n)})},insert:function(r){return frappe.xcall("frappe.client.insert",{doc:r})},delete_doc:function(r,t){return new Promise(e=>{frappe.call("frappe.client.delete",{doctype:r,name:t},i=>e(i.message))})},count:function(r,t={}){let e=t.filters||{},i=Array.isArray(e)&&e.some(o=>o[0]!==r),n=[];return frappe.xcall("frappe.desk.reportview.get_count",{doctype:r,filters:e,fields:n,distinct:i})},get_link_options(r,t="",e={}){return new Promise(i=>{frappe.call({type:"GET",method:"frappe.desk.search.search_link",args:{doctype:r,txt:t,filters:e},callback(n){i(n.results)}})})}};frappe.provide("frappe.meta.docfield_map");frappe.provide("frappe.meta.docfield_copy");frappe.provide("frappe.meta.docfield_list");frappe.provide("frappe.meta.doctypes");frappe.provide("frappe.meta.precision_map");frappe.get_meta=function(r){return locals.DocType?locals.DocType[r]:null};$.extend(frappe.meta,{sync:function(r){$.each(r.fields,function(t,e){frappe.meta.add_field(e)}),frappe.meta.sync_messages(r),r.__print_formats&&frappe.model.sync(r.__print_formats),r.__workflow_docs&&frappe.model.sync(r.__workflow_docs)},add_field:function(r){frappe.provide("frappe.meta.docfield_map."+r.parent),frappe.meta.docfield_map[r.parent][r.fieldname||r.label]=r,frappe.meta.docfield_list[r.parent]||(frappe.meta.docfield_list[r.parent]=[]);for(var t in frappe.meta.docfield_list[r.parent]){var e=frappe.meta.docfield_list[r.parent][t];if(r.fieldname==e.fieldname)return}frappe.meta.docfield_list[r.parent].push(r)},make_docfield_copy_for:function(r,t,e=null){var i=frappe.meta.docfield_copy;i[r]||(i[r]={}),i[r][t]||(i[r][t]={}),e=e||frappe.meta.docfield_list[r]||[];for(var n=0,o=e.length;n<o;n++){var a=e[n];i[r][t][a.fieldname||a.label]=copy_dict(a)}},get_field:function(r,t,e){var i=frappe.meta.get_docfield(r,t,e);return i||frappe.model.std_fields.every(function(n){return n.fieldname===t?(i=n,!1):!0}),i},get_docfield:function(r,t,e){var i=frappe.meta.get_docfield_copy(r,e);return i?i[t]:null},set_formatter:function(r,t,e,i){frappe.meta.get_docfield(r,t,e).formatter=i},set_indicator_formatter:function(r,t,e,i,n){frappe.meta.get_docfield(r,t,e).formatter=function(o,a,s,l){return repl('<span class="indicator %(color)s">%(name)s</span>',{color:n(),name:i()})}},get_docfields:function(r,t,e){var i=frappe.meta.get_docfield_copy(r,t),n=frappe.meta.sort_docfields(i);return e&&(n=frappe.utils.filter_dict(n,e)),n},get_linked_fields:function(r){return $.map(frappe.get_meta(r).fields,function(t){return t.fieldtype=="Link"?t.options:null})},get_fields_to_check_permissions:function(r){var t=$.map(frappe.meta.get_docfields(r,name),function(e){return e.fieldtype==="Link"&&e.ignore_user_permissions!==1?e:null});return t=t.concat({label:"ID",fieldname:name,options:r}),t},sort_docfields:function(r){return $.map(r,function(t){return t}).sort(function(t,e){return t.idx-e.idx})},get_docfield_copy:function(r,t){return t?(frappe.meta.docfield_copy[r]&&frappe.meta.docfield_copy[r][t]||frappe.meta.make_docfield_copy_for(r,t),frappe.meta.docfield_copy[r][t]):frappe.meta.docfield_map[r]},get_fieldnames:function(r,t,e){return $.map(frappe.utils.filter_dict(frappe.meta.docfield_map[r],e),function(i){return i.fieldname})},has_field:function(r,t){let e=frappe.meta.docfield_map[r];return e&&e[t]},get_table_fields:function(r){return $.map(frappe.meta.docfield_list[r],function(t){return frappe.model.table_fields.includes(t.fieldtype)?t:null})},get_doctype_for_field:function(r,t){var e=null;return in_list(frappe.model.std_fields_list,t)||frappe.meta.has_field(r,t)?e=r:(frappe.meta.get_table_fields(r).every(function(i){return frappe.meta.has_field(i.options,t)||in_list(frappe.model.child_table_field_list,t)?(e=i.options,!1):!0}),e||console.log(__("Warning: Unable to find {0} in any table related to {1}",[t,__(r)]))),e},get_parentfield:function(r,t){var e=(frappe.get_doc("DocType",r).fields||[]).filter(i=>frappe.model.table_fields.includes(i.fieldtype)&&i.options===t);if(!e.length)throw"parentfield not found for "+r+", "+t;return e[0].fieldname},get_label:function(r,t,e){var i={name:__("ID"),creation:__("Created On"),docstatus:__("Document Status"),idx:__("Index"),modified:__("Last Updated On"),modified_by:__("Last Updated By"),owner:__("Created By"),_user_tags:__("Tags"),_liked_by:__("Liked By"),_comments:__("Comments"),_assign:__("Assigned To")};if(i[t])return i[t];var n=this.get_docfield(r,t,e);return(n?n.label:"")||t},get_print_sizes:function(){return["A0","A1","A2","A3","A4","A5","A6","A7","A8","A9","B0","B1","B2","B3","B4","B5","B6","B7","B8","B9","B10","C5E","Comm10E","DLE","Executive","Folio","Ledger","Legal","Letter","Tabloid","Custom"]},get_print_formats:function(r){var t=["Standard"],e=locals.DocType[r].default_print_format;let i=frappe.model.get_doc(":Print Settings","Print Settings").enable_raw_printing;var n=frappe.get_list("Print Format",{doc_type:r}).sort(function(a,s){return a>s?1:-1});if($.each(n,function(a,s){!in_list(t,s.name)&&s.print_format_type!=="JS"&&(cint(i)||!s.raw_printing)&&t.push(s.name)}),e&&e!="Standard"){var o=t.indexOf(e);t.splice(o,1).sort(),t.unshift(e)}return t},sync_messages:function(r){r.__messages&&$.extend(frappe._messages,r.__messages)},get_field_currency:function(r,t){var e=frappe.boot.sysdefaults.currency;if(!t&&cur_frm&&(t=cur_frm.doc),r&&r.options)if(t&&r.options.indexOf(":")!=-1){var i=r.options.split(":");if(i.length==3){var n=t[i[1]];!n&&cur_frm&&(n=cur_frm.doc[i[1]]),e=frappe.model.get_value(i[0],n,i[2])||frappe.model.get_value(":"+i[0],n,i[2])||e}}else t&&t[r.options]?e=t[r.options]:cur_frm&&cur_frm.doc[r.options]&&(e=cur_frm.doc[r.options]);return e},get_field_precision:function(r,t){var e=null;if(r&&r.precision)e=cint(r.precision);else if(r&&r.fieldtype==="Currency"){if(e=cint(frappe.defaults.get_default("currency_precision")),!e){var i=get_number_format(),n=get_number_format_info(i);e=n.precision}}else e=cint(frappe.defaults.get_default("float_precision"))||3;return e}});Object.assign(frappe.model,{docinfo:{},sync:function(r){var t;if(!r.docs&&!r.docinfo&&(r={docs:r}),t=$.isPlainObject(r.docs),t&&(r.docs=[r.docs]),r.docs)for(var e=0,i=r.docs.length;e<i;e++){var n=r.docs[e];locals[n.doctype]&&locals[n.doctype][n.name]?frappe.model.update_in_locals(n):frappe.model.add_to_locals(n),n.__last_sync_on=new Date,n.doctype==="DocType"&&frappe.meta.sync(n),n.localname&&frappe.model.rename_after_save(n,e)}return frappe.model.sync_docinfo(r),r.docs},rename_after_save:(r,t)=>{frappe.model.new_names[r.localname]=r.name,$(document).trigger("rename",[r.doctype,r.localname,r.name]),delete locals[r.doctype][r.localname],t===0&&(frappe.model.docinfo[r.doctype][r.name]=frappe.model.docinfo[r.doctype][r.localname],frappe.model.docinfo[r.doctype][r.localname]=void 0)},sync_docinfo:r=>{if(r.docinfo){let{doctype:t,name:e}=r.docinfo;frappe.model.docinfo[t]||(frappe.model.docinfo[t]={}),frappe.model.docinfo[t][e]=r.docinfo,Object.assign(frappe.boot.user_info,r.docinfo.user_info)}return r.docs},add_to_locals:function(r){locals[r.doctype]||(locals[r.doctype]={}),!r.name&&r.__islocal&&(r.parentfield||frappe.model.clear_doc(r),r.name=frappe.model.get_new_name(r.doctype),r.parentfield||frappe.provide("frappe.model.docinfo."+r.doctype+"."+r.name)),locals[r.doctype][r.name]=r;let t=frappe.get_meta(r.doctype);if(!(t?t.istable:r.parentfield))for(var i in r){var n=r[i];if($.isArray(n))for(var o=0,a=n.length;o<a;o++){var s=n[o];typeof s=="object"&&!s.parent&&(s.parent=r.name),frappe.model.add_to_locals(s)}}},update_in_locals:function(r){let t=locals[r.doctype][r.name],e=function(i,n){Object.keys(n).map(o=>{i[o]==null&&delete n[o]})};for(let i in r){let n=frappe.meta.get_field(r.doctype,i);if(n&&frappe.model.table_fields.includes(n.fieldtype)){r[i]instanceof Array||(r[i]=[]),t[i]instanceof Array||(t[i]=[]);for(let o=0;o<r[i].length;o++){let a=r[i][o],s=t[i][o];s?(locals[a.doctype]||(locals[a.doctype]={}),a.name||(a.name=frappe.model.get_new_name(r.doctype)),locals[a.doctype][a.name]||(delete locals[a.doctype][s.name],locals[a.doctype][a.name]=s),Object.assign(s,a),e(a,s)):(t[i].push(a),a.parent||(a.parent=r.name),frappe.model.add_to_locals(a))}if(t[i].length>r[i].length){for(let o=r[i].length;o<t[i].length;o++){let a=t[i][o];locals[a.doctype]&&locals[a.doctype][a.name]&&delete locals[a.doctype][a.name]}t[i].length=r[i].length}}else t[i]=r[i]}e(r,t)}});frappe.provide("frappe.model");$.extend(frappe.model,{new_names:{},new_name_count:{},get_new_doc:function(r,t,e,i){frappe.provide("locals."+r);var n={docstatus:0,doctype:r,name:frappe.model.get_new_name(r),__islocal:1,__unsaved:1,owner:frappe.session.user};if(frappe.model.set_default_values(n,t),t?($.extend(n,{parent:t.name,parentfield:e,parenttype:t.doctype}),t[e]||(t[e]=[]),n.idx=t[e].length+1,t[e].push(n)):frappe.provide("frappe.model.docinfo."+r+"."+n.name),frappe.model.add_to_locals(n),i&&frappe.model.create_mandatory_children(n),t||(n.__run_link_triggers=1),frappe.route_options&&frappe.route_options.name_field){var o=frappe.get_meta(r);o.autoname&&o.autoname.indexOf("field:")!==-1?n[o.autoname.substr(6)]=frappe.route_options.name_field:o.title_field&&(n[o.title_field]=frappe.route_options.name_field),delete frappe.route_options.name_field}return frappe.route_options&&!n.parent&&($.each(frappe.route_options,function(a,s){var l=frappe.meta.has_field(r,a);l&&in_list(["Link","Data","Select","Dynamic Link"],l.fieldtype)&&!l.no_copy&&(n[a]=s)}),frappe.route_options=null),n},make_new_doc_and_get_name:function(r,t){return frappe.model.get_new_doc(r,null,null,t).name},get_new_name:function(r){var t=frappe.model.new_name_count;return t[r]||(t[r]=0),t[r]++,frappe.router.slug(`new-${r}-${t[r]}`)},set_default_values:function(r,t){for(var e=r.doctype,i=frappe.meta.get_docfields(e),n=[],o=0;o<i.length;o++){var a=i[o];if(!in_list(frappe.model.no_value_type,a.fieldtype)&&r[a.fieldname]==null){if(a.no_default)continue;var s=frappe.model.get_default_value(a,r,t);s?(in_list(["Int","Check"],a.fieldtype)?s=cint(s):in_list(["Currency","Float"],a.fieldtype)&&(s=flt(s)),r[a.fieldname]=s,n.push(a.fieldname)):a.fieldtype=="Select"&&a.options&&typeof a.options=="string"&&!in_list(["[Select]","Loading..."],a.options)&&(r[a.fieldname]=a.options.split(`
`)[0])}}return n},create_mandatory_children:function(r){var t=frappe.get_meta(r.doctype);t&&t.istable||frappe.meta.get_docfields(r.doctype).forEach(function(e){e.fieldtype==="Table"&&e.reqd&&frappe.model.add_child(r,e.fieldname)})},get_default_value:function(r,t,e){var i="",n=frappe.defaults.get_user_permissions();let o=[],a=null,s=null;n&&({allowed_records:o,default_doc:a}=frappe.perm.filter_allowed_docs_for_doctype(n[r.options],t.doctype));var l=frappe.get_meta(t.doctype),u=r.fieldtype==="Link"&&!$.isEmptyObject(n)&&r.ignore_user_permissions!=1&&o.length;if(r.fieldtype==="Link"&&r.options!=="User")if(u&&a)s=a;else{if(!r.ignore_user_permissions){var c=frappe.defaults.get_user_defaults(r.options);c&&c.length===1&&(i=c[0])}i?!i&&r.remember_last_selected_value&&frappe.boot.user.last_selected_values&&(i=frappe.boot.user.last_selected_values[r.options]):i=frappe.defaults.get_user_default(r.fieldname);var h=i&&(!u||o.includes(i));h&&(s=i)}if(!s||r.default){let v=String(r.default);if(v=="__user"||v.toLowerCase()=="user")s=frappe.session.user;else if(v=="user_fullname")s=frappe.session.user_fullname;else if(v=="Today")s=frappe.datetime.get_today();else if((v||"").toLowerCase()==="now")r.fieldtype=="Time"?s=frappe.datetime.now_time():s=frappe.datetime.system_datetime();else if(v[0]===":"){var p=frappe.model.get_default_from_boot_docs(r,t,e),g=!u||o.includes(p);g&&(s=p)}else if(r.fieldname===l.title_field)s="";else{var b=!u||o.includes(r.default);(r.fieldtype!=="Link"||r.options==="User"||b)&&(s=r.default)}}else r.fieldtype=="Time"&&(s=frappe.datetime.now_time());return r.__default_value=s,s},get_default_from_boot_docs:function(r,t,e){if(frappe.get_list(r.default).length>0){var i=r.default.slice(1).toLowerCase().replace(" ","_"),n=e?e[i]:frappe.defaults.get_user_default(i),o=n?frappe.get_doc(r.default,n):null;if(o&&o[r.fieldname])return o[r.fieldname]}},add_child:function(r,t,e,i){arguments.length===2&&(e=t,t=frappe.meta.get_field(r.doctype,e).options),i=i?i-.1:(r[e]||[]).length+1;var n=frappe.model.get_new_doc(t,r,e);if(n.idx=i,i!==cint(i))for(var o=r[e].sort(function(u,c){return u.idx-c.idx}),a=0,s=o.length;a<s;a++){var l=o[a];l.idx=a+1}return cur_frm&&cur_frm.doc==r&&cur_frm.dirty(),n},copy_doc:function(r,t,e,i){var n=["name","amended_from","amendment_date","cancel_reason"],o=frappe.model.get_new_doc(r.doctype,e,i);for(var a in r){var s=frappe.meta.get_docfield(r.doctype,a);if(s&&a.substr(0,2)!="__"&&!in_list(n,a)&&!(s&&!t&&cint(s.no_copy)==1)){var l=r[a]||[];if(frappe.model.table_fields.includes(s.fieldtype))for(var u=0,c=l.length;u<c;u++){var h=l[u];frappe.model.copy_doc(h,t,o,s.fieldname)}else o[a]=r[a]}}var p=frappe.session.user;return o.__islocal=1,o.docstatus=0,o.owner=p,o.creation="",o.modified_by=p,o.modified="",o.lft=null,o.rgt=null,o},open_mapped_doc:function(r){return r.frm&&r.frm.doc.__unsaved?frappe.throw(__("You have unsaved changes in this form. Please save before you continue.")):!r.source_name&&r.frm?r.source_name=r.frm.doc.name:!r.frm&&!r.source_name&&(r.source_name=null),frappe.call({type:"POST",method:"frappe.model.mapper.make_mapped_doc",args:{method:r.method,source_name:r.source_name,args:r.args||null,selected_children:r.frm?r.frm.get_selected():null},freeze:!0,freeze_message:r.freeze_message||"",callback:function(t){t.exc||(frappe.model.sync(t.message),r.run_link_triggers&&(frappe.get_doc(t.message.doctype,t.message.name).__run_link_triggers=!0),frappe.set_route("Form",t.message.doctype,t.message.name))}})}});frappe.create_routes={};frappe.new_doc=function(r,t,e){if(r==="File"){new frappe.ui.FileUploader({folder:t?t.folder:"Home"});return}return new Promise(i=>{t&&$.isPlainObject(t)&&(frappe.route_options=t),frappe.model.with_doctype(r,function(){frappe.create_routes[r]?frappe.set_route(frappe.create_routes[r]).then(()=>i()):frappe.ui.form.make_quick_entry(r,null,e).then(()=>i())})})};frappe.provide("frappe.perm");Object.assign(window,{READ:"read",WRITE:"write",CREATE:"create",DELETE:"delete",SUBMIT:"submit",CANCEL:"cancel",AMEND:"amend"});$.extend(frappe.perm,{rights:["select","read","write","create","delete","submit","cancel","amend","report","import","export","print","email","share","set_user_permissions"],doctype_perm:{},has_perm:(r,t,e,i)=>{t||(t=0),frappe.perm.doctype_perm[r]||(frappe.perm.doctype_perm[r]=frappe.perm.get_perm(r));let n=frappe.perm.doctype_perm[r];if(!n||!n[t])return!1;let o=!!n[t][e];if(t===0&&o&&i){let a=frappe.model.get_docinfo(r,i.name);a&&!a.permissions[e]&&(o=!1)}return o},get_perm:(r,t)=>{let e=[{read:0,permlevel:0}],i=frappe.get_doc("DocType",r),n=frappe.session.user;if((n==="Administrator"||frappe.user_roles.includes("Administrator"))&&(e[0].read=1),!i)return e;if(e=frappe.perm.get_role_permissions(i),t){let o=frappe.model.get_docinfo(r,t.name);if(o&&o.permissions&&Object.keys(o.permissions).forEach(a=>{e[0][a]=o.permissions[a]}),$.isEmptyObject(e[0].if_owner)||(t.owner===n?$.extend(e[0],e[0].if_owner):$.each(e[0].if_owner,a=>{e[0].if_owner[a]&&(e[0][a]=0)})),o&&o.shared)for(let a=0;a<o.shared.length;a++){let s=o.shared[a];s.user===n&&(e[0].read=e[0].read||s.read,e[0].write=e[0].write||s.write,e[0].submit=e[0].submit||s.submit,e[0].share=e[0].share||s.share,s.read&&(e[0].email=frappe.boot.user.can_email.indexOf(r)!==-1?1:0,e[0].print=frappe.boot.user.can_print.indexOf(r)!==-1?1:0))}}return frappe.model.can_read(r)&&!e[0].read&&(e[0].read=1),e},get_role_permissions:r=>{let t=[{read:0,permlevel:0}];return(r.permissions||[]).forEach(e=>{let i=cint(e.permlevel);t[i]||(t[i]={},t[i].permlevel=i),frappe.user_roles.includes(e.role)&&frappe.perm.rights.forEach(n=>{let o=t[i][n]||e[n]||0;o&&(t[i][n]=o)})}),t=t.map(e=>e||{}),t},get_match_rules:(r,t)=>{let e=[];t||(t="read");let i=frappe.perm.get_perm(r),n=frappe.defaults.get_user_permissions();if(n&&!$.isEmptyObject(n)){let o={},a=frappe.meta.get_fields_to_check_permissions(r);$.each(a,(s,l)=>{let u=n[l.options]||[],c=frappe.perm.get_allowed_docs_for_doctype(u,r);c.length&&(o[l.label]=c)}),$.isEmptyObject(o)||e.push(o)}return i[0].if_owner&&i[0].read&&e.push({Owner:frappe.session.user}),e},get_field_display_status:(r,t,e,i)=>{if(!e&&t&&(e=frappe.perm.get_perm(t.doctype,t)),!e)return r&&(cint(r.hidden)||cint(r.hidden_due_to_dependency))?"None":"Write";r.permlevel||(r.permlevel=0);let n=e[r.permlevel],o="None";if(n&&(n.write&&!r.disabled?o="Write":n.read&&(o="Read")),i&&console.log("By Permission:"+o),cint(r.hidden)&&(o="None"),i&&console.log("By Hidden:"+o),cint(r.hidden_due_to_dependency)&&(o="None"),i&&console.log("By Hidden Due To Dependency:"+o),!t)return o;o==="Write"&&cint(t.docstatus)>0&&(o="Read"),i&&console.log("By Submit:"+o);let a=cint(r.allow_on_submit);return o==="Read"&&a&&cint(t.docstatus)===1&&n.write&&(o="Write"),i&&console.log("By Allow on Submit:"+o),o==="Read"&&cur_frm&&cur_frm.state_fieldname&&(cint(cur_frm.read_only)||in_list(cur_frm.states.update_fields,r.fieldname)||r.fieldname==cur_frm.state_fieldname)&&(o="Read"),i&&console.log("By Workflow:"+o),o==="Write"&&(cint(r.read_only)||r.fieldtype==="Read Only")&&(o="Read"),i&&console.log("By Read Only:"+o),o==="Write"&&r.set_only_once&&!t.__islocal&&(o="Read"),i&&console.log("By Set Only Once:"+o),o},is_visible:(r,t,e)=>(typeof r=="string"&&(r=frappe.meta.get_docfield(t.doctype,r,t.parent||t.name)),frappe.perm.get_field_display_status(r,t,e)!=="None"),get_allowed_docs_for_doctype:(r,t)=>frappe.perm.filter_allowed_docs_for_doctype(r,t,!1),filter_allowed_docs_for_doctype:(r,t,e=!0)=>{let i=(r||[]).filter(o=>o.applicable_for===t||!o.applicable_for),n=i.map(o=>o.doc);if(e){let o=n.length===1?n:i.filter(a=>a.is_default).map(a=>a.doc);return{allowed_records:n,default_doc:o[0]}}else return n}});frappe.provide("frappe.workflow");frappe.workflow={state_fields:{},workflows:{},setup:function(r){var t=frappe.get_list("Workflow",{document_type:r});t.length?(frappe.workflow.workflows[r]=t[0],frappe.workflow.state_fields[r]=t[0].workflow_state_field):frappe.workflow.state_fields[r]=null},get_state_fieldname:function(r){return frappe.workflow.state_fields[r]===void 0&&frappe.workflow.setup(r),frappe.workflow.state_fields[r]},get_default_state:function(r,t){frappe.workflow.setup(r);var e=null;return $.each(frappe.workflow.workflows[r].states,function(i,n){if(cint(n.doc_status)===cint(t))return e=n.state,!1}),e},get_transitions:function(r){return frappe.workflow.setup(r.doctype),frappe.xcall("frappe.model.workflow.get_transitions",{doc:r})},get_document_state:function(r,t){return frappe.workflow.setup(r),frappe.get_children(frappe.workflow.workflows[r],"states",{state:t})[0]},is_self_approval_enabled:function(r){return frappe.workflow.workflows[r].allow_self_approval},is_read_only:function(r,t){var e=frappe.workflow.get_state_fieldname(r);if(e){var i=locals[r][t];if(!i||i.__islocal)return!1;var n=i[e]||frappe.workflow.get_default_state(r,i.docstatus),o=n?frappe.workflow.get_document_state(r,n)&&frappe.workflow.get_document_state(r,n).allow_edit:null;if(!frappe.user_roles.includes(o))return!0}return!1},get_update_fields:function(r){var t=$.unique($.map(frappe.workflow.workflows[r].states||[],function(e){return e.update_field}));return t},get_state(r){let t=this.get_state_fieldname(r.doctype),e=r[t];return e||(e=this.get_default_state(r.doctype,r.docstatus)),e},get_all_transitions(r){return frappe.workflow.workflows[r].transitions||[]},get_all_transition_actions(r){return this.get_all_transitions(r).map(e=>e.action)}};frappe.provide("frappe.model.user_settings");$.extend(frappe.model.user_settings,{get:function(r){return frappe.call("frappe.model.utils.user_settings.get",{doctype:r}).then(t=>JSON.parse(t.message||"{}"))},save:function(r,t,e){if(frappe.session.user==="Guest")return Promise.resolve();let i=frappe.model.user_settings[r]||{},n=$.extend(!0,{},i);$.isPlainObject(e)?(n[t]=n[t]||{},$.extend(n[t],e)):n[t]=e;let o=JSON.stringify(i),a=JSON.stringify(n);return o!==a?this.update(r,n):Promise.resolve(n)},remove:function(r,t){var e=frappe.model.user_settings[r]||{};return delete e[t],this.update(r,e)},update:function(r,t){return frappe.session.user==="Guest"?Promise.resolve():frappe.call({method:"frappe.model.utils.user_settings.save",args:{doctype:r,user_settings:t},callback:function(e){frappe.model.user_settings[r]=e.message}})}});frappe.get_user_settings=function(r,t){var e=frappe.model.user_settings[r]||{};return t&&(e=e[t]||{}),e};frappe.user_info=function(r){if(r||(r=frappe.session.user),frappe.boot.user_info&&frappe.boot.user_info[r])var t=frappe.boot.user_info[r];else var t={fullname:r||"Unknown"};return t.abbr=frappe.get_abbr(t.fullname),t.color=frappe.get_palette(t.fullname),t};frappe.update_user_info=function(r){for(let t in r)frappe.boot.user_info[t]?Object.assign(frappe.boot.user_info[t],r[t]):frappe.boot.user_info[t]=r[t]};frappe.provide("frappe.user");$.extend(frappe.user,{name:"Guest",full_name:function(r){return r===frappe.session.user?__("You",null,"Name of the current user. For example: You edited this 5 hours ago."):frappe.user_info(r).fullname},image:function(r){return frappe.user_info(r).image},abbr:function(r){return frappe.user_info(r).abbr},has_role:function(r){typeof r=="string"&&(r=[r]);for(var t in r)if((frappe.boot?frappe.boot.user.roles:["Guest"]).indexOf(r[t])!=-1)return!0},get_desktop_items:function(){var r=$.map(frappe.boot.allowed_modules,function(t){var e=t.module_name,i=frappe.modules[e]&&frappe.modules[e].type;if(frappe.boot.user.allow_modules.indexOf(e)===-1)return null;var n=null;return i==="module"?(frappe.boot.user.allow_modules.indexOf(e)!=-1||frappe.modules[e].is_help)&&(n=e):i==="page"?frappe.boot.allowed_pages.indexOf(frappe.modules[e].link)!=-1&&(n=e):i==="list"?frappe.model.can_read(frappe.modules[e]._doctype)&&(n=e):i==="view"?n=e:i==="setup"?(frappe.user.has_role("System Manager")||frappe.user.has_role("Administrator"))&&(n=e):n=e,n});return r},is_report_manager:function(){return frappe.user.has_role(["Administrator","System Manager","Report Manager"])},get_formatted_email:function(r){var t=frappe.user.full_name(r);if(t){var e="";return t.search(/[\[\]\\()<>@,:;".]/)!==-1&&(e='"'),repl("%(quote)s%(fullname)s%(quote)s <%(email)s>",{fullname:t,email:r,quote:e})}else return r},get_emails:()=>Object.keys(frappe.boot.user_info).map(r=>frappe.boot.user_info[r].email),toString:function(){return this.name}});frappe.session_alive=!0;$(document).bind("mousemove",function(){frappe.session_alive===!1&&$(document).trigger("session_alive"),frappe.session_alive=!0,frappe.session_alive_timeout&&clearTimeout(frappe.session_alive_timeout),frappe.session_alive_timeout=setTimeout("frappe.session_alive=false;",3e4)});var Oo=Vt(dd());frappe.avatar=function(r,t,e,i=null,n=!1,o=!1){let a;if(r)a=frappe.user_info(r);else{let l=e||frappe.get_cookie("full_name");a={image:i===null?frappe.get_cookie("user_image"):i,fullname:l,abbr:frappe.get_abbr(l),color:frappe.get_palette(l)}}e||(e=a.fullname);let s="";return o&&(t+=" filterable",s=`data-filter="_assign,like,%${r}%"`),frappe.get_avatar(t,e,i||a.image,n,s)};frappe.get_avatar=function(r,t,e=null,i,n){if(r||(r="avatar-small"),e){let o=window.cordova&&e.indexOf("http")===-1?frappe.base_url+e:e;return`<span class="avatar ${r}" title="${t}" ${n}>
				<span class="avatar-frame" style='background-image: url("${o}")'
					title="${t}"></span>
			</span>`}else{let o=frappe.get_abbr(t),a="";if(!i){let s=frappe.get_palette(t);a=`background-color: var(${s[0]}); color: var(${s[1]})`}return(r==="avatar-small"||r=="avatar-xs")&&(o=o.substr(0,1)),`<span class="avatar ${r}" title="${t}" ${n}>
			<div class="avatar-frame standard-image"
				style="${a}">
					${o}
			</div>
		</span>`}};frappe.avatar_group=function(r,t=4,e={}){let i="",n=r.slice(0,t),o=r.slice(t),a=e.css_class||"",s=n.map(u=>frappe.avatar(u,"avatar-small "+a,null,null,!1,e.filterable)).join("");o.length===1?s+=frappe.avatar(o[0],"avatar-small "+a,null,null,!1,e.filterable):o.length>1&&(s=`
			${s}
			<span class="avatar avatar-small ${a}">
				<div class="avatar-frame standard-image avatar-extra-count"
					title="${o.map(u=>frappe.user_info(u).fullname).join(", ")}">
					+${o.length}
				</div>
			</span>
		`),e.action_icon&&(i=`
			<span class="avatar avatar-small">
				<div class="avatar-frame avatar-action">
					${frappe.utils.icon(e.action_icon,"sm")}
				</div>
			</span>
		`);let l=$(`<div class="avatar-group ${e.align||"right"} ${e.overlap!=!1?"overlap":""}">
			${s}
			${i}
		</div>`);return l.find(".avatar-action").on("click",e.action),l};frappe.ui.scroll=function(r,t,e){var i=$(".navbar").height()+$(".page-head").height(),n=$(r).offset().top-i-cint(e);t?$("html, body").animate({scrollTop:n}):$(window).scrollTop(n)};frappe.palette=[["--orange-avatar-bg","--orange-avatar-color"],["--pink-avatar-bg","--pink-avatar-color"],["--blue-avatar-bg","--blue-avatar-color"],["--green-avatar-bg","--green-avatar-color"],["--dark-green-avatar-bg","--dark-green-avatar-color"],["--red-avatar-bg","--red-avatar-color"],["--yellow-avatar-bg","--yellow-avatar-color"],["--purple-avatar-bg","--purple-avatar-color"],["--gray-avatar-bg","--gray-avatar-color0"]];frappe.get_palette=function(r){var t=cint((parseInt((0,Oo.default)(r).substr(4,2),16)+1)/5.33);return frappe.palette[t%8]};frappe.get_abbr=function(r,t){if(!r)return"";var e="";return $.each(r.split(" "),function(i,n){if(e.length>=(t||2))return!1;if(!n.trim().length)return!0;e+=n.trim()[0]}),e||"?"};frappe.gravatars={};frappe.get_gravatar=function(r,t=0){var e=t?"s="+t:"d=retro";return frappe.gravatars[r]||(frappe.gravatars[r]="https://secure.gravatar.com/avatar/"+(0,Oo.default)(r)+"?"+e),frappe.gravatars[r]};window.repl=function(t,e){if(t==null)return"";for(var i in e)t=t.split("%("+i+")s").join(e[i]);return t};window.replace_all=function(r,t,e){return r.split(t).join(e)};window.strip_html=function(r){return cstr(r).replace(/<[^>]*>/g,"")};window.strip=function(r,t){if(r)return r=lstrip(r,t),r=rstrip(r,t),r};window.lstrip=function(t,e){e||(e=[`
`,"	"," "]);let i=t.substr(0,1);for(;in_list(e,i);)t=t.substr(1),i=t.substr(0,1);return t};window.rstrip=function(r,t){t||(t=[`
`,"	"," "]);let e=r.substr(r.length-1);for(;in_list(t,e);)r=r.substr(0,r.length-1),e=r.substr(r.length-1);return r};frappe.get_cookie=function(t){return frappe.get_cookies()[t]};frappe.get_cookies=function(){var t=document.cookie,e=0,i={};return document.cookie.match(/^\s*\$Version=(?:"1"|1);\s*(.*)/)&&(t=RegExp.$1,e=1),e===0?t.split(/[,;]/).map(function(n){var o=n.split(/=/,2),a=decodeURIComponent(o[0].trimLeft()),s=o.length>1?decodeURIComponent(o[1].trimRight()):null;s&&s.charAt(0)==='"'&&(s=s.substr(1,s.length-2)),i[a]=s}):t.match(/(?:^|\s+)([!#$%&'*+\-.0-9A-Z^`a-z|~]+)=([!#$%&'*+\-.0-9A-Z^`a-z|~]*|"(?:[\x20-\x7E\x80\xFF]|\\[\x00-\x7F])*")(?=\s*[,;]|$)/g).map(function(n,o){var a=n,s=o.charAt(0)==='"'?o.substr(1,-1).replace(/\\(.)/g,"$1"):o;i[a]=s}),i};frappe.is_mobile=function(){return $(document).width()<768};frappe.utils.xss_sanitise=function(r,t){let e=r,i={strategies:["html","js"]},n={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"},o=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,a=/confirm\(.*\)|alert\(.*\)|prompt\(.*\)/gi;if(t=Object.assign({},i,t),t.strategies.includes("js")&&(e=e.replace(o,""),e=e.replace(a,"")),t.strategies.includes("html"))for(let s in n){let l=n[s],u=new RegExp(s,"g");e=e.replace(u,l)}return e};frappe.utils.sanitise_redirect=r=>{let t=(()=>i=>{function n(a){let s=/^(?:https?:\/\/)?(?:[^@\n]+@)?(?:www\.)?([^:/\n?]+)/gim.exec(a);return s==null?"":s[1]}function o(a){return/^(?:[a-z]+:)?\/\//i.test(a)}return o(i)?n(location.href)!==n(i):!1})(),e=i=>{let n=/j[\s]*(&#x.{1,7})?a[\s]*(&#x.{1,7})?v[\s]*(&#x.{1,7})?a[\s]*(&#x.{1,7})?s[\s]*(&#x.{1,7})?c[\s]*(&#x.{1,7})?r[\s]*(&#x.{1,7})?i[\s]*(&#x.{1,7})?p[\s]*(&#x.{1,7})?t/gi;return i.replace(n,"")};return r=frappe.utils.strip_url(r),t(r)?"":e(frappe.utils.xss_sanitise(r,{strategies:["js"]}))};frappe.utils.strip_url=r=>r.replace(/^[^A-Za-z0-9(//)#]+/g,"");frappe.utils.new_auto_repeat_prompt=function(r){let t=[{fieldname:"frequency",fieldtype:"Select",label:__("Frequency"),reqd:1,options:[{label:__("Daily"),value:"Daily"},{label:__("Weekly"),value:"Weekly"},{label:__("Monthly"),value:"Monthly"},{label:__("Quarterly"),value:"Quarterly"},{label:__("Half-yearly"),value:"Half-yearly"},{label:__("Yearly"),value:"Yearly"}]},{fieldname:"start_date",fieldtype:"Date",label:__("Start Date"),reqd:1,default:frappe.datetime.nowdate()},{fieldname:"end_date",fieldtype:"Date",label:__("End Date")}];frappe.prompt(t,function(e){frappe.call({method:"frappe.automation.doctype.auto_repeat.auto_repeat.make_auto_repeat",args:{doctype:r.doc.doctype,docname:r.doc.name,frequency:e.frequency,start_date:e.start_date,end_date:e.end_date},callback:function(i){i.message&&(frappe.show_alert({message:__("Auto Repeat created for this document"),indicator:"green"}),r.reload_doc())}})},__("Auto Repeat"),__("Save"))};frappe.utils.get_page_view_count=function(r){return frappe.call("frappe.website.doctype.web_page_view.web_page_view.get_page_view_count",{path:r})};frappe.urllib={get_arg:function(r){r=r.replace(/[[]/,"\\[").replace(/[\]]/,"\\]");var t="[\\?&]"+r+"=([^&#]*)",e=new RegExp(t),i=e.exec(window.location.href);return i==null?"":decodeURIComponent(i[1])},get_dict:function(){var r={},t=window.location.href.split("?")[1];if(!t||(t.indexOf("#")!=-1&&(t=t.split("#")[0]),!t))return r;t=t.split("&");for(var e=0;e<t.length;e++){var i=t[e].split("=");r[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return r},get_base_url:function(){var r=frappe.base_url||window.location.origin;return r.substr(r.length-1,1)=="/"&&(r=r.substr(0,r.length-1)),r},get_full_url:function(r){return r.indexOf("http://")===0||r.indexOf("https://")===0?r:r.substr(0,1)==="/"?frappe.urllib.get_base_url()+r:frappe.urllib.get_base_url()+"/"+r}};window.open_url_post=function(t,e,i){if(window.cordova){let l=t+"api/method/"+e.cmd+frappe.utils.make_query_string(e,!1);window.location.href=l}else{var n=document.createElement("form");n.action=t,n.method="POST",n.style.display="none",i&&(n.target="_blank"),e.csrf_token=frappe.csrf_token;for(var o in e){var a=document.createElement("textarea");a.name=o;var s=e[o];typeof s!="string"&&(s=JSON.stringify(s)),a.value=s,n.appendChild(a)}return document.body.appendChild(n),n.submit(),n}};window.get_url_arg=frappe.urllib.get_arg;window.get_url_dict=frappe.urllib.get_dict;function Ro(r,t){if(!r)return"";typeof r=="string"&&(r=frappe.datetime.convert_to_user_tz(r),r=new Date((r||"").replace(/-/g,"/").replace(/[TZ]/g," ").replace(/\.[0-9]*/,"")));let e=(new Date(frappe.datetime.now_datetime()).getTime()-r.getTime())/1e3,i=Math.floor(e/86400);if(isNaN(i)||i<0)return"";if(t)if(i==0){if(e<60)return __("now");if(e<3600)return __("{0} m",[Math.floor(e/60)]);if(e<86400)return __("{0} h",[Math.floor(e/3600)])}else return i<7?__("{0} d",[i]):i<31?__("{0} w",[Math.floor(i/7)]):i<365?__("{0} M",[Math.floor(i/30)]):__("{0} y",[Math.floor(i/365)]);else if(i==0){if(e<60)return __("just now");if(e<120)return __("1 minute ago");if(e<3600)return __("{0} minutes ago",[Math.floor(e/60)]);if(e<7200)return __("1 hour ago");if(e<86400)return __("{0} hours ago",[Math.floor(e/3600)])}else return i==1?__("yesterday"):i<7?__("{0} days ago",[i]):i<14?__("1 week ago"):i<31?__("{0} weeks ago",[Math.floor(i/7)]):i<62?__("1 month ago"):i<365?__("{0} months ago",[Math.floor(i/30)]):i<730?__("1 year ago"):__("{0} years ago",[Math.floor(i/365)])}frappe.provide("frappe.datetime");window.comment_when=function(r,t){var e=frappe.datetime.str_to_user?frappe.datetime.str_to_user(r):r;return'<span class="frappe-timestamp '+(t?" mini":"")+'" data-timestamp="'+r+'" title="'+e+'">'+Ro(r,t)+"</span>"};frappe.datetime.comment_when=comment_when;frappe.datetime.prettyDate=Ro;frappe.datetime.refresh_when=function(){jQuery&&$(".frappe-timestamp").each(function(){$(this).html(Ro($(this).attr("data-timestamp"),$(this).hasClass("mini")))})};setInterval(function(){frappe.datetime.refresh_when()},6e4);var hd=Vt(pd());frappe.provide("frappe.tools");frappe.tools.downloadify=function(r,t,e){if(t&&t.length&&!has_common(t,t)){frappe.msgprint(__("Export not allowed. You need {0} role to export.",[frappe.utils.comma_or(t)]));return}var i=e+".csv",n=frappe.tools.to_csv(r),o=document.createElement("a");if("download"in o){var a=new Blob([n],{type:"text/csv;charset=UTF-8"});o.href=URL.createObjectURL(a),o.download=i}else o.href="data:attachment/csv,"+encodeURIComponent(n),o.download=i,o.target="_blank";document.body.appendChild(o),o.click(),document.body.removeChild(o)};frappe.markdown=function(r){for(frappe.md2html||(frappe.md2html=new hd.default.Converter);r.substr(0,1)===`
`;)r=r.substr(1);for(var t=0,e=r.split(`
`)[0];[`
`,"	"].indexOf(e.substr(0,1))!==-1;)t++,e=e.substr(1);if(t&&t!=e.length){var i=[];$.each(r.split(`
`),function(n,o){i.push(o.substr(t))}),r=i.join(`
`)}return frappe.md2html.makeHtml(r)};frappe.tools.to_csv=function(r){var t=[];return $.each(r,function(e,i){i=$.map(i,function(n){return n==null&&(n=""),typeof n=="string"?'"'+$("<i>").html(n.replace(/"/g,'""')).text()+'"':n}),t.push(i.join(","))}),t.join(`
`)};frappe.provide("frappe.datetime");frappe.defaultDateFormat="YYYY-MM-DD";frappe.defaultTimeFormat="HH:mm:ss";frappe.defaultDatetimeFormat=frappe.defaultDateFormat+" "+frappe.defaultTimeFormat;moment.defaultFormat=frappe.defaultDateFormat;frappe.provide("frappe.datetime");$.extend(frappe.datetime,{convert_to_user_tz:function(r,t){let e=null;return frappe.boot.time_zone&&frappe.boot.time_zone.system&&frappe.boot.time_zone.user?e=moment.tz(r,frappe.boot.time_zone.system).clone().tz(frappe.boot.time_zone.user):e=moment(r),t===!1?e:e.format(frappe.defaultDatetimeFormat)},convert_to_system_tz:function(r,t){let e=null;return frappe.boot.time_zone&&frappe.boot.time_zone.system&&frappe.boot.time_zone.user?e=moment.tz(r,frappe.boot.time_zone.user).clone().tz(frappe.boot.time_zone.system):e=moment(r),t===!1?e:e.format(frappe.defaultDatetimeFormat)},is_system_time_zone:function(){return frappe.boot.time_zone&&frappe.boot.time_zone.system&&frappe.boot.time_zone.user?moment().tz(frappe.boot.time_zone.system).utcOffset()===moment().tz(frappe.boot.time_zone.user).utcOffset():!0},is_timezone_same:function(){return frappe.datetime.is_system_time_zone()},str_to_obj:function(r){return moment(r,frappe.defaultDatetimeFormat)._d},obj_to_str:function(r){return moment(r).locale("en").format()},obj_to_user:function(r){return moment(r).format(frappe.datetime.get_user_date_fmt().toUpperCase())},get_diff:function(r,t){return moment(r).diff(t,"days")},get_hour_diff:function(r,t){return moment(r).diff(t,"hours")},get_day_diff:function(r,t){return moment(r).diff(t,"days")},add_days:function(r,t){return moment(r).add(t,"days").format()},add_months:function(r,t){return moment(r).add(t,"months").format()},week_start:function(){return moment().startOf("week").format()},week_end:function(){return moment().endOf("week").format()},month_start:function(){return moment().startOf("month").format()},month_end:function(){return moment().endOf("month").format()},quarter_start:function(){return moment().startOf("quarter").format()},quarter_end:function(){return moment().endOf("quarter").format()},year_start:function(){return moment().startOf("year").format()},year_end:function(){return moment().endOf("year").format()},get_user_time_fmt:function(){return frappe.sys_defaults&&frappe.sys_defaults.time_format||"HH:mm:ss"},get_user_date_fmt:function(){return frappe.sys_defaults&&frappe.sys_defaults.date_format||"yyyy-mm-dd"},get_user_fmt:function(){return frappe.sys_defaults&&frappe.sys_defaults.date_format||"yyyy-mm-dd"},str_to_user:function(r,t=!1,e=!1){if(!r)return"";let i=frappe.datetime.get_user_date_fmt().toUpperCase(),n=frappe.datetime.get_user_time_fmt(),o=n;if(t)return moment(r,frappe.defaultTimeFormat).format(o);if(e)return moment(r,frappe.defaultDateFormat).format(i);{let a=moment.tz(r,frappe.boot.time_zone.system);return typeof r!="string"||r.indexOf(" ")===-1?o=i:o=i+" "+n,a.clone().tz(frappe.boot.time_zone.user).format(o)}},get_datetime_as_string:function(r){return moment(r).format("YYYY-MM-DD HH:mm:ss")},user_to_str:function(r,t=!1){var e=frappe.datetime.get_user_time_fmt();if(t)return moment(r,e).format(frappe.defaultTimeFormat);var i=frappe.datetime.get_user_date_fmt().toUpperCase(),n="YYYY-MM-DD";return r.indexOf(" ")!==-1&&(i+=" "+e,n+=" HH:mm:ss"),moment(r,[i.replace("YYYY","YY"),i]).locale("en").format(n)},user_to_obj:function(r){return frappe.datetime.str_to_obj(frappe.datetime.user_to_str(r))},global_date_format:function(r){var t=moment(r);return t._f&&t._f.indexOf("HH")!==-1?t.format("Do MMMM YYYY, hh:mm A"):t.format("Do MMMM YYYY")},now_date:function(r=!1){return frappe.datetime._date(frappe.defaultDateFormat,r)},now_time:function(r=!1){return frappe.datetime._date(frappe.defaultTimeFormat,r)},now_datetime:function(r=!1){return frappe.datetime._date(frappe.defaultDatetimeFormat,r)},system_datetime:function(r=!1){return frappe.datetime._date(frappe.defaultDatetimeFormat,r,!0)},_date:function(r,t=!1,e=!1){var o,a;let i=((o=frappe.boot.time_zone)==null?void 0:o.system)||frappe.sys_defaults.time_zone;e||(i=((a=frappe.boot.time_zone)==null?void 0:a.user)||i);let n=moment.tz(i);return t?frappe.datetime.moment_to_date_obj(n):n.format(r)},moment_to_date_obj:function(r){let t=new Date,e=r.toArray();return t.setFullYear(e[0]),t.setMonth(e[1]),t.setDate(e[2]),t.setHours(e[3]),t.setMinutes(e[4]),t.setSeconds(e[5]),t.setMilliseconds(e[6]),t},nowdate:function(){return frappe.datetime.now_date()},get_today:function(){return frappe.datetime.now_date()},get_time:r=>moment(r).format("hh:mm A"),validate:function(r){return moment(r,[frappe.defaultDateFormat,frappe.defaultDatetimeFormat,frappe.defaultTimeFormat],!0).isValid()},get_first_day_of_the_week_index(){let r=frappe.sys_defaults.first_day_of_the_week||"Sunday";return moment.weekdays().indexOf(r)}});Object.defineProperties(window,{dateutil:{get:function(){return console.warn("Please use `frappe.datetime` instead of `dateutil`. It will be deprecated soon."),frappe.datetime},configurable:!0},date:{get:function(){return console.warn("Please use `frappe.datetime` instead of `date`. It will be deprecated soon."),frappe.datetime},configurable:!0},get_today:{get:function(){return console.warn("Please use `frappe.datetime.get_today` instead of `get_today`. It will be deprecated soon."),frappe.datetime.get_today},configurable:!0}});window.cstr=function(r){return r==null?"":r+""};window.cint=function(r,t){return r===!0?1:r===!1?0:(r=r+"",r!=="0"&&(r=lstrip(r,["0"])),r=parseInt(r),isNaN(r)&&(r=t===void 0?0:t),r)};window.toTitle=function(r){var t=r.split(" "),e=[];for(var i in t)e[i]=t[i].charAt(0).toUpperCase()+t[i].slice(1);return e.join(" ")};window.is_null=function(r){if(r==null||cstr(r).trim()==="")return!0};window.copy_dict=function(r){var t={};for(var e in r)t[e]=r[e];return t};window.validate_email=function(r){return frappe.utils.validate_type(r,"email")};window.validate_phone=function(r){return frappe.utils.validate_type(r,"phone")};window.validate_name=function(r){return frappe.utils.validate_type(r,"name")};window.validate_url=function(r){return frappe.utils.validate_type(r,"url")};window.nth=function(r){r=cint(r);var t="th";return(r+"").substr(-1)=="1"&&(t="st"),(r+"").substr(-1)=="2"&&(t="nd"),(r+"").substr(-1)=="3"&&(t="rd"),r+t};window.has_words=function(r,t){if(!t)return!0;if(!r)return!1;for(var e=0,i=r.length;e<i;e++)if(t.indexOf(r[e])!=-1)return!0;return!1};window.has_common=function(r,t){if(!r||!t)return!1;for(var e=0,i=r.length;e<i;e++)if(in_list(t,r[e]))return!0;return!1};window.frappe||(window.frappe={});function an(r,t,e){if(r==null||r=="")return 0;if(!(typeof r=="number"||String(parseFloat(r))==r)){if(r=r+"",r.indexOf(" ")!=-1){var i=r.split(" ");r=isNaN(parseFloat(i[0]))?i.slice(i.length-1).join(" "):r}r=_d(r,e),r=parseFloat(r),isNaN(r)&&(r=0)}return r=parseFloat(r),t!=null?ln(r,t):r}function _d(r,t){t||(t=sn());var e=Lo(t),i=new RegExp(e.group_sep==="."?"\\.":e.group_sep,"g");if(r=r.replace(i,""),e.decimal_str!=="."&&e.decimal_str!==""){var n=new RegExp(e.decimal_str,"g");r=r.replace(n,".")}return r}frappe.number_format_info={"#,###.##":{decimal_str:".",group_sep:","},"#.###,##":{decimal_str:",",group_sep:"."},"# ###.##":{decimal_str:".",group_sep:" "},"# ###,##":{decimal_str:",",group_sep:" "},"#'###.##":{decimal_str:".",group_sep:"'"},"#, ###.##":{decimal_str:".",group_sep:", "},"#,##,###.##":{decimal_str:".",group_sep:","},"#,###.###":{decimal_str:".",group_sep:","},"#.###":{decimal_str:"",group_sep:"."},"#,###":{decimal_str:"",group_sep:","}};window.format_number=function(r,t,e){t||(t=sn(),e==null&&(e=cint(frappe.defaults.get_default("float_precision"))||3));var i=Lo(t);e==null&&(e=i.precision),r=an(r,e,t);let n=!1;r<0&&(n=!0),r=Math.abs(r),r=r.toFixed(e);var o=r.split("."),a=i.group_sep?3:0;if(a){for(var s=o[0],l="",u=s.length%a,c=s.length;c>=0;c--){var h=replace_all(l,i.group_sep,"").length;t=="#,##,###.##"&&l.indexOf(",")!=-1&&(a=2,h+=1),l+=s.charAt(c),h&&!((h+1)%a)&&c!=0&&(l+=i.group_sep)}o[0]=l.split("").reverse().join("")}return o[0]+""==""&&(o[0]="0"),o[1]=o[1]&&i.decimal_str?i.decimal_str+o[1]:"",(n?"-":"")+o[0]+o[1]};function md(r,t,e){var a;let i=sn(t),n=gd(t),o=(a=frappe.model.get_value(":Currency",t,"symbol_on_right"))!=null?a:!1;return e===void 0&&(e=frappe.boot.sysdefaults.currency_precision||null),n?o?format_number(r,i,e)+" "+__(n):__(n)+" "+format_number(r,i,e):format_number(r,i,e)}function gd(r){return frappe.boot?frappe.boot.sysdefaults&&frappe.boot.sysdefaults.hide_currency_symbol=="Yes"?null:(r||(r=frappe.boot.sysdefaults.currency),frappe.model.get_value(":Currency",r,"symbol")||r):frappe.currency_symbols[r]}function sn(r){return frappe.boot&&frappe.boot.sysdefaults&&frappe.boot.sysdefaults.number_format||"#,###.##"}function Lo(r){var t=frappe.number_format_info[r];return t||(t={decimal_str:".",group_sep:","}),t.precision=r.split(t.decimal_str).slice(1)[0].length,t}function ln(r,t){var e=r<0,i=cint(t),n=Math.pow(10,i),o=+(i?Math.abs(r)*n:Math.abs(r)).toFixed(8),a=Math.floor(o),s=o-a,l=!t&&s==.5?a%2==0?a:a+1:Math.round(o);return l=i?l/n:l,e?-l:l}function yw(r,t){return ln(r,t)}function ww(r,t){if(cur_frm){t||(t=cur_frm.doc);var e=frappe.meta.get_docfield(t.doctype,r,t.parent||t.name);return e||console.log(r+": could not find docfield in method precision()"),frappe.meta.get_field_precision(e,t)}else return frappe.boot.sysdefaults.float_precision}function kw(r,t){return r.includes(t)}function vd(r,t,e){e=cint(e);var i=Math.pow(10,e);if(e)var n=r*i%(t*i)/i;else var n=r%t;return an(n,e)}function xw(r,t,e){var i=an(frappe.model.get_value(":Currency",t,"smallest_currency_fraction_value"));if(i){var n=vd(r,i,e);n>i/2?r+=i-n:r-=n}else r=ln(r);return r}function Cw(r,t){return md(r,t)}Object.assign(window,{flt:an,cint,strip_number_groups:_d,format_currency:md,fmt_money:Cw,get_currency_symbol:gd,get_number_format:sn,get_number_format_info:Lo,_round:ln,roundNumber:yw,precision:ww,remainder:vd,round_based_on_smallest_currency_fraction:xw,in_list:kw});frappe.provide("frappe.help");frappe.help.youtube_id={};frappe.help.has_help=function(r){return frappe.help.youtube_id[r]};frappe.help.show=function(r){frappe.help.youtube_id[r]&&frappe.help.show_video(frappe.help.youtube_id[r])};frappe.help.show_video=function(r,t){if(frappe.utils.is_url(r)){let o='(?:youtube.com/(?:[^/]+/.+/|(?:v|e(?:mbed)?)/|.*[?&]v=)|youtu.be/)([^"&?\\s]{11})';r=r.match(o)[1]}let e=new frappe.ui.Dialog({title:t||__("Help"),size:"large"}),i=$(`<div class="video-player" data-plyr-provider="youtube" data-plyr-embed-id="${r}"></div>`);i.appendTo(e.body),e.show(),e.$wrapper.addClass("video-modal");let n;frappe.utils.load_video_player().then(()=>{n=new frappe.Plyr(i[0],{hideControls:!0,resetOnEnd:!0})}),e.onhide=()=>{n==null||n.destroy()}};$("body").on("click","a.help-link",function(){var r=$(this).attr("data-doctype");r&&frappe.help.show(r)});frappe.provide("frappe.help.help_links");frappe.help.help_links["data-import-tool"]=[{label:"Importing and Exporting Data",url:"https://frappe.github.io/erpnext/user/manual/en/setting-up/data/data-import-tool.html"}];frappe.help.help_links["modules/Setup"]=[{label:"Users and Permissions",url:"http://frappe.github.io/erpnext/user/manual/en/setting-up/users-and-permissions/"},{label:"Settings",url:"http://frappe.github.io/erpnext/user/manual/en/setting-up/settings/"},{label:"Data Management",url:"http://frappe.github.io/erpnext/user/manual/en/setting-up/data/"},{label:"Email",url:"http://frappe.github.io/erpnext/user/manual/en/setting-up/email/"},{label:"Printing",url:"http://frappe.github.io/erpnext/user/manual/en/setting-up/print/"}];frappe.help.help_links["List/User"]=[{label:"Adding Users",url:"https://frappe.github.io/erpnext/user/manual/en/setting-up/users-and-permissions/adding-users"},{label:"Rename User",url:"https://frappe.github.io/erpnext/user/manual/en/setting-up/articles/rename-user"}];frappe.help.help_links["permission-manager"]=[{label:"Role Permissions Manager",url:"https://frappe.github.io/erpnext/user/manual/en/setting-up/users-and-permissions/role-based-permissions"}];frappe.help.help_links["user-permissions"]=[{label:"User Permissions",url:"https://frappe.github.io/erpnext/user/manual/en/setting-up/users-and-permissions/user-permissions"}];frappe.help.help_links["Form/System Settings"]=[{label:"System Settings",url:"https://frappe.github.io/erpnext/user/manual/en/setting-up/settings/system-settings"}];frappe.help.help_links["List/Email Account"]=[{label:"Email Account",url:"https://frappe.github.io/erpnext/user/manual/en/setting-up/email/email-account"}];frappe.help.help_links["List/Notification"]=[{label:"Notification",url:"https://frappe.github.io/erpnext/user/manual/en/setting-up/email/email-alerts"}];frappe.help.help_links["Form/Print Settings"]=[{label:"Print Settings",url:"https://frappe.github.io/erpnext/user/manual/en/setting-up/print/print-settings"}];frappe.help.help_links["print-format-builder"]=[{label:"Print Format Builder",url:"https://frappe.github.io/erpnext/user/manual/en/setting-up/print/print-format-builder"}];frappe.provide("frappe.contacts");$.extend(frappe.contacts,{clear_address_and_contact:function(r){$(r.fields_dict.address_html.wrapper).html(""),r.fields_dict.contact_html&&$(r.fields_dict.contact_html.wrapper).html("")},render_address_and_contact:function(r){r.fields_dict.address_html&&"addr_list"in r.doc.__onload&&$(r.fields_dict.address_html.wrapper).html(frappe.render_template("address_list",r.doc.__onload)).find(".btn-address").on("click",function(){frappe.new_doc("Address")}),r.fields_dict.contact_html&&"contact_list"in r.doc.__onload&&$(r.fields_dict.contact_html.wrapper).html(frappe.render_template("contact_list",r.doc.__onload)).find(".btn-contact").on("click",function(){frappe.new_doc("Contact")})},get_last_doc:function(r){let e=frappe.route_history.slice().reverse().find(o=>o[0]==="Form"&&o[1]!==r.doctype),i=e&&e[1],n=e&&e[2];return e&&e.length>3&&(n=e.slice(2).join("/")),{doctype:i,docname:n}}});frappe.preview_email=function(r,t,e,i=!1,n=!1){return frappe.call({method:"frappe.email.email_body.get_email_html",args:{subject:"Test",template:r,args:t,header:e,with_container:i}}).then(o=>{var a=o.message;if(a=a.replace(/embed=/,"src="),n)return a;var s=frappe.msgprint({message:'<iframe width="100%" height="600px" style="border: none;"></iframe>',wide:!0});setTimeout(()=>{s.$wrapper.find("iframe").contents().find("html").html(a),s.$wrapper.find(".modal-dialog").css("width","70%")},1e3)})};frappe.provide("frappe.file_manager");frappe.file_manager=function(){let r=[],t=null,e=null;function i(a,s){r=a,t=s}function n(a){return new Promise((s,l)=>{if(r.length===0||!t){o(),s();return}e=a,frappe.call({method:"frappe.core.api.file.move_file",args:{file_list:r,new_parent:e,old_parent:t},callback:u=>{o(),s(u)}}).fail(l)})}function o(){r=[],t=null,e=null}return{cut:i,paste:n,get can_paste(){return Boolean(r.length>0&&t)},get old_folder(){return t},get files_to_move(){return r}}}();frappe.provide("frappe.ui");frappe.ui.DiffView=class{constructor(t,e,i){this.dialog=null,this.handler=null,this.doctype=t,this.fieldname=e,this.docname=i,this.dialog=this.make_dialog(),this.set_empty_state(),this.dialog.show()}make_dialog(){let t=()=>({query:"frappe.utils.diff.version_query",filters:{docname:this.docname,ref_doctype:this.doctype}}),e=()=>this.compute_diff();return new frappe.ui.Dialog({title:__("Compare Versions"),fields:[{label:__("From version"),fieldtype:"Link",fieldname:"from_version",options:"Version",reqd:1,get_query:t,onchange:e},{fieldtype:"Column Break",fieldname:"cb"},{label:__("To version"),fieldtype:"Link",fieldname:"to_version",options:"Version",reqd:1,get_query:t,onchange:e},{fieldtype:"Section Break",fieldname:"sb"},{label:__("Diff"),fieldtype:"HTML",fieldname:"diff"}],size:"extra-large"})}compute_diff(){let t=this.dialog.get_value("from_version"),e=this.dialog.get_value("to_version"),i=this.fieldname;t&&e?frappe.xcall("frappe.utils.diff.get_version_diff",{from_version:t,to_version:e,fieldname:i}).then(n=>{this.dialog.set_value("diff",this.prettify_diff(n))}):this.set_empty_state()}prettify_diff(t){let e="";return t.forEach(i=>{let n="";i.startsWith("+")?n="insert":i.startsWith("-")&&(n="delete"),e+=`<div class="${n} text-wrap">${i}</div>`}),`<div class='diffview'>${e}</div>`}set_empty_state(){this.dialog.set_value("diff",__("Select two versions to view the diff."))}};frappe.provide("frappe.utils.datatable");frappe.utils.datatable.get_translations=function(){let r={};return r[frappe.boot.lang]={"Sort Ascending":__("Sort Ascending"),"Sort Descending":__("Sort Descending"),"Reset sorting":__("Reset sorting"),"Remove column":__("Remove column"),"No Data":__("No Data"),"{count} cells copied":{1:__("{count} cell copied"),default:__("{count} cells copied")},"{count} rows selected":{1:__("{count} row selected"),default:__("{count} rows selected")}},r};var Sw={name:"ProgressRing",props:{primary:String,secondary:String,radius:Number,progress:Number,stroke:Number},data(){let r=this.radius-this.stroke*2,t=r*2*Math.PI;return{normalizedRadius:r,circumference:t}},computed:{strokeDashoffset(){return this.circumference-this.progress/100*this.circumference}}},bd=function(){var r=this,t=r.$createElement,e=r._self._c||t;return e("svg",{attrs:{height:r.radius*2,width:r.radius*2}},[e("circle",{style:{stroke:r.secondary,strokeDashoffset:0},attrs:{"stroke-dasharray":r.circumference+" "+r.circumference,"stroke-width":r.stroke,fill:"transparent",r:r.normalizedRadius,cx:r.radius,cy:r.radius}}),r._v(" "),e("circle",{style:{stroke:r.primary,strokeDashoffset:r.strokeDashoffset},attrs:{"stroke-dasharray":r.circumference+" "+r.circumference,"stroke-width":r.stroke,fill:"transparent",r:r.normalizedRadius,cx:r.radius,cy:r.radius}}),r._v(" "),e("text",{style:{color:"var(--text-color)",fontSize:"var(--text-xs)",fontWeight:"var(--text-bold)"},attrs:{"dominant-baseline":"middle","text-anchor":"middle",x:r.radius,y:r.radius}},[r._v(`
		`+r._s(r.progress)+`%
	`)])])},Tw=[];bd._withStripped=!0;var Ew=function(r){!r||r("data-v-0f538d8f_0",{source:`
circle[data-v-0f538d8f] {
	transition: stroke-dashoffset 0.35s;
	transform: rotate(-90deg);
	transform-origin: 50% 50%;
}
`,map:{version:3,sources:["frappe/public/js/frappe/file_uploader/ProgressRing.vue"],names:[],mappings:";AAsEA;CACA,mCAAA;CACA,yBAAA;CACA,yBAAA;AACA",file:"ProgressRing.vue",sourcesContent:[`<template>
	<svg :height="radius * 2" :width="radius * 2">
		<circle
			:stroke-dasharray="circumference + ' ' + circumference"
			:style="{
				stroke: secondary,
				strokeDashoffset: 0
			}"
			:stroke-width="stroke"
			fill="transparent"
			:r="normalizedRadius"
			:cx="radius"
			:cy="radius"
		/>
		<circle
			:stroke-dasharray="circumference + ' ' + circumference"
			:style="{
				stroke: primary,
				strokeDashoffset: strokeDashoffset
			}"
			:stroke-width="stroke"
			fill="transparent"
			:r="normalizedRadius"
			:cx="radius"
			:cy="radius"
		/>
		<text
			dominant-baseline="middle"
			text-anchor="middle"
			:x="radius"
			:y="radius"
			:style="{
				color: 'var(--text-color)',
				fontSize: 'var(--text-xs)',
				fontWeight: 'var(--text-bold)'
			}"
		>
			{{ progress }}%
		</text>
	</svg>
</template>
<script>
export default {
	name: "ProgressRing",
	props: {
		primary: String,
		secondary: String,
		radius: Number,
		progress: Number,
		stroke: Number
	},
	data() {
		const normalizedRadius = this.radius - this.stroke * 2;
		const circumference = normalizedRadius * 2 * Math.PI;

		return {
			normalizedRadius,
			circumference
		};
	},
	computed: {
		strokeDashoffset() {
			return (
				this.circumference - (this.progress / 100) * this.circumference
			);
		}
	}
};
<\/script>
<style scoped>
circle {
	transition: stroke-dashoffset 0.35s;
	transform: rotate(-90deg);
	transform-origin: 50% 50%;
}
</style>
`]},media:void 0})},Aw="data-v-0f538d8f",$w=void 0,Ow=!1;function Rw(r,t,e,i,n,o,a,s,l,u){let c=(typeof e=="function"?e.options:e)||{};c.__file="frappe/public/js/frappe/file_uploader/ProgressRing.vue",c.render||(c.render=r.render,c.staticRenderFns=r.staticRenderFns,c._compiled=!0,n&&(c.functional=!0)),c._scopeId=i;{let h;if(t&&(h=a?function(p){t.call(this,u(p,this.$root.$options.shadowRoot))}:function(p){t.call(this,s(p))}),h!==void 0)if(c.functional){let p=c.render;c.render=function(b,v){return h.call(v),p(b,v)}}else{let p=c.beforeCreate;c.beforeCreate=p?[].concat(p,h):[h]}}return c}function Bo(){let r=Bo.styles||(Bo.styles={}),t=typeof navigator!="undefined"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(i,n){if(document.querySelector('style[data-vue-ssr-id~="'+i+'"]'))return;let o=t?n.media||"default":i,a=r[o]||(r[o]={ids:[],parts:[],element:void 0});if(!a.ids.includes(i)){let s=n.source,l=a.ids.length;if(a.ids.push(i),t&&(a.element=a.element||document.querySelector("style[data-group="+o+"]")),!a.element){let u=document.head||document.getElementsByTagName("head")[0],c=a.element=document.createElement("style");c.type="text/css",n.media&&c.setAttribute("media",n.media),t&&(c.setAttribute("data-group",o),c.setAttribute("data-next-index","0")),u.appendChild(c)}if(t&&(l=parseInt(a.element.getAttribute("data-next-index")),a.element.setAttribute("data-next-index",l+1)),a.element.styleSheet)a.parts.push(s),a.element.styleSheet.cssText=a.parts.filter(Boolean).join(`
`);else{let u=document.createTextNode(s),c=a.element.childNodes;c[l]&&a.element.removeChild(c[l]),c.length?a.element.insertBefore(u,c[l]):a.element.appendChild(u)}}}}var Lw=Rw({render:bd,staticRenderFns:Tw},Ew,Sw,Aw,Ow,$w,!1,Bo,void 0,void 0),yd=Lw;var Bw={name:"FilePreview",props:["file"],components:{ProgressRing:yd},data(){return{src:null,optimize:this.file.optimize}},mounted(){if(this.is_image&&window.FileReader){let r=new FileReader;r.onload=()=>this.src=r.result,r.readAsDataURL(this.file.file_obj)}},filters:{file_size(r){return frappe.form.formatters.FileSize(r)},file_name(r){return r}},computed:{is_private(){return this.file.doc?this.file.doc.is_private:this.file.private},uploaded(){return this.file.request_succeeded},is_image(){return this.file.file_obj.type.startsWith("image")},is_optimizable(){let r=this.file.file_obj.type=="image/svg+xml";return this.is_image&&!r&&!this.uploaded&&!this.file.failed},is_cropable(){let r=["image/jpeg","image/png"];return!this.uploaded&&!this.file.uploading&&!this.file.failed&&r.includes(this.file.file_obj.type)},progress(){let r=Math.round(this.file.progress*100/this.file.total);return isNaN(r)&&(r=0),r}}},wd=function(){var r=this,t=r.$createElement,e=r._self._c||t;return e("div",{staticClass:"file-preview"},[e("div",{staticClass:"file-icon"},[r.is_image?e("img",{attrs:{src:r.src,alt:r.file.name}}):e("div",{staticClass:"fallback",domProps:{innerHTML:r._s(r.frappe.utils.icon("file","md"))}})]),r._v(" "),e("div",[e("div",[r.file.doc?e("a",{staticClass:"flex",attrs:{href:r.file.doc.file_url,target:"_blank"}},[e("span",{staticClass:"file-name"},[r._v(r._s(r._f("file_name")(r.file.name)))])]):e("span",{staticClass:"file-name"},[r._v(r._s(r._f("file_name")(r.file.name)))])]),r._v(" "),e("div",[e("span",{staticClass:"file-size"},[r._v(`
				`+r._s(r._f("file_size")(r.file.file_obj.size))+`
			`)])]),r._v(" "),e("div",{staticClass:"flex config-area"},[r.is_optimizable?e("label",{staticClass:"frappe-checkbox"},[e("input",{attrs:{type:"checkbox"},domProps:{checked:r.optimize},on:{change:function(i){return r.$emit("toggle_optimize")}}}),r._v("Optimize")]):r._e(),r._v(" "),e("label",{staticClass:"frappe-checkbox"},[e("input",{attrs:{type:"checkbox"},domProps:{checked:r.file.private},on:{change:function(i){return r.$emit("toggle_private")}}}),r._v("Private")])]),r._v(" "),e("div",[r.file.error_message?e("span",{staticClass:"file-error text-danger"},[r._v(`
				`+r._s(r.file.error_message)+`
			`)]):r._e()])]),r._v(" "),e("div",{staticClass:"file-actions"},[e("ProgressRing",{directives:[{name:"show",rawName:"v-show",value:r.file.uploading&&!r.uploaded&&!r.file.failed,expression:"file.uploading && !uploaded && !file.failed"}],attrs:{primary:"var(--primary-color)",secondary:"var(--gray-200)",radius:24,progress:r.progress,stroke:3}}),r._v(" "),r.uploaded?e("div",{domProps:{innerHTML:r._s(r.frappe.utils.icon("solid-success","lg"))}}):r._e(),r._v(" "),r.file.failed?e("div",{domProps:{innerHTML:r._s(r.frappe.utils.icon("solid-error","lg"))}}):r._e(),r._v(" "),e("div",{staticClass:"file-action-buttons"},[r.is_cropable?e("button",{staticClass:"btn btn-crop muted",domProps:{innerHTML:r._s(r.frappe.utils.icon("crop","md"))},on:{click:function(i){return r.$emit("toggle_image_cropper")}}}):r._e(),r._v(" "),!r.uploaded&&!r.file.uploading&&!r.file.failed?e("button",{staticClass:"btn muted",domProps:{innerHTML:r._s(r.frappe.utils.icon("delete","md"))},on:{click:function(i){return r.$emit("remove")}}}):r._e()])],1)])},Iw=[];wd._withStripped=!0;var Mw=function(r){!r||r("data-v-78fcc692_0",{source:`
.file-preview {
	display: flex;
	align-items: center;
	padding: 0.75rem;
	border: 1px solid transparent;
}
.file-preview + .file-preview {
	border-top-color: var(--border-color);
}
.file-preview:hover {
	background-color: var(--bg-color);
	border-color: var(--dark-border-color);
	border-radius: var(--border-radius);
}
.file-preview:hover + .file-preview {
	border-top-color: transparent;
}
.file-icon {
	border-radius: var(--border-radius);
	width: 2.625rem;
	height: 2.625rem;
	overflow: hidden;
	margin-right: var(--margin-md);
	flex-shrink: 0;
}
.file-icon img {
	width: 100%;
	height: 100%;
	object-fit: cover;
}
.file-icon .fallback {
	width: 100%;
	height: 100%;
	display: flex;
	align-items: center;
	justify-content: center;
	border: 1px solid var(--border-color);
	border-radius: var(--border-radius);
}
.file-name {
	font-size: var(--text-base);
	font-weight: var(--text-bold);
	color: var(--text-color);
	display: -webkit-box;
	-webkit-line-clamp: 1;
	-webkit-box-orient: vertical;
	overflow: hidden;
}
.file-size {
	font-size: var(--text-sm);
	color: var(--text-light);
}
.file-actions {
	width: 3rem;
	flex-shrink: 0;
	margin-left: auto;
	text-align: center;
}
.file-actions .btn {
	padding: var(--padding-xs);
	box-shadow: none;
}
.file-action-buttons {
	display: flex;
	justify-content: flex-end;
}
.muted {
	opacity: 0.5;
	transition: 0.3s;
}
.muted:hover {
	opacity: 1;
}
.frappe-checkbox {
	font-size: var(--text-sm);
	color: var(--text-light);
	display: flex;
	align-items: center;
	padding-top: 0.25rem;
}
.config-area {
	gap: 0.5rem;
}
.file-error {
	font-size: var(--text-sm);
	font-weight: var(--text-bold);
}
`,map:{version:3,sources:["frappe/public/js/frappe/file_uploader/FilePreview.vue"],names:[],mappings:";AAoHA;CACA,aAAA;CACA,mBAAA;CACA,gBAAA;CACA,6BAAA;AACA;AAEA;CACA,qCAAA;AACA;AAEA;CACA,iCAAA;CACA,sCAAA;CACA,mCAAA;AACA;AAEA;CACA,6BAAA;AACA;AAEA;CACA,mCAAA;CACA,eAAA;CACA,gBAAA;CACA,gBAAA;CACA,8BAAA;CACA,cAAA;AACA;AAEA;CACA,WAAA;CACA,YAAA;CACA,iBAAA;AACA;AAEA;CACA,WAAA;CACA,YAAA;CACA,aAAA;CACA,mBAAA;CACA,uBAAA;CACA,qCAAA;CACA,mCAAA;AACA;AAEA;CACA,2BAAA;CACA,6BAAA;CACA,wBAAA;CACA,oBAAA;CACA,qBAAA;CACA,4BAAA;CACA,gBAAA;AACA;AAEA;CACA,yBAAA;CACA,wBAAA;AACA;AAEA;CACA,WAAA;CACA,cAAA;CACA,iBAAA;CACA,kBAAA;AACA;AAEA;CACA,0BAAA;CACA,gBAAA;AACA;AAEA;CACA,aAAA;CACA,yBAAA;AACA;AAEA;CACA,YAAA;CACA,gBAAA;AACA;AAEA;CACA,UAAA;AACA;AAEA;CACA,yBAAA;CACA,wBAAA;CACA,aAAA;CACA,mBAAA;CACA,oBAAA;AACA;AAEA;CACA,WAAA;AACA;AAEA;CACA,yBAAA;CACA,6BAAA;AACA",file:"FilePreview.vue",sourcesContent:[`<template>
	<div class="file-preview">
		<div class="file-icon">
			<img
				v-if="is_image"
				:src="src"
				:alt="file.name"
			>
			<div class="fallback" v-else v-html="frappe.utils.icon('file', 'md')">
			</div>
		</div>
		<div>
			<div>
				<a class="flex" :href="file.doc.file_url" v-if="file.doc" target="_blank">
					<span class="file-name">{{ file.name | file_name }}</span>
				</a>
				<span class="file-name" v-else>{{ file.name | file_name }}</span>
			</div>

			<div>
				<span class="file-size">
					{{ file.file_obj.size | file_size }}
				</span>
			</div>

			<div class="flex config-area">
				<label v-if="is_optimizable" class="frappe-checkbox"><input type="checkbox" :checked="optimize" @change="$emit('toggle_optimize')">Optimize</label>
				<label class="frappe-checkbox"><input type="checkbox" :checked="file.private" @change="$emit('toggle_private')">Private</label>
			</div>
			<div>
				<span v-if="file.error_message" class="file-error text-danger">
					{{ file.error_message }}
				</span>
			</div>
		</div>
		<div class="file-actions">
			<ProgressRing
				v-show="file.uploading && !uploaded && !file.failed"
				primary="var(--primary-color)"
				secondary="var(--gray-200)"
				:radius="24"
				:progress="progress"
				:stroke="3"
			/>
			<div v-if="uploaded" v-html="frappe.utils.icon('solid-success', 'lg')"></div>
			<div v-if="file.failed" v-html="frappe.utils.icon('solid-error', 'lg')"></div>
			<div class="file-action-buttons">
				<button v-if="is_cropable" class="btn btn-crop muted" @click="$emit('toggle_image_cropper')" v-html="frappe.utils.icon('crop', 'md')"></button>
				<button v-if="!uploaded && !file.uploading && !file.failed" class="btn muted" @click="$emit('remove')" v-html="frappe.utils.icon('delete', 'md')"></button>
			</div>
		</div>
	</div>
</template>

<script>
import ProgressRing from './ProgressRing.vue';
export default {
	name: 'FilePreview',
	props: ['file'],
	components: {
		ProgressRing
	},
	data() {
		return {
			src: null,
			optimize: this.file.optimize
		}
	},
	mounted() {
		if (this.is_image) {
			if (window.FileReader) {
				let fr = new FileReader();
				fr.onload = () => this.src = fr.result;
				fr.readAsDataURL(this.file.file_obj);
			}
		}
	},
	filters: {
		file_size(value) {
			return frappe.form.formatters.FileSize(value);
		},
		file_name(value) {
			return value;
			// return frappe.utils.file_name_ellipsis(value, 9);
		}
	},
	computed: {
		is_private() {
			return this.file.doc ? this.file.doc.is_private : this.file.private;
		},
		uploaded() {
			return this.file.request_succeeded;
		},
		is_image() {
			return this.file.file_obj.type.startsWith('image');
		},
		is_optimizable() {
			let is_svg = this.file.file_obj.type == 'image/svg+xml';
			return this.is_image && !is_svg && !this.uploaded && !this.file.failed;
		},
		is_cropable() {
			let croppable_types = ['image/jpeg', 'image/png'];
			return !this.uploaded && !this.file.uploading && !this.file.failed && croppable_types.includes(this.file.file_obj.type);
		},
		progress() {
			let value = Math.round((this.file.progress * 100) / this.file.total);
			if (isNaN(value)) {
				value = 0;
			}
			return value;
		}
	}
}
<\/script>

<style>
.file-preview {
	display: flex;
	align-items: center;
	padding: 0.75rem;
	border: 1px solid transparent;
}

.file-preview + .file-preview {
	border-top-color: var(--border-color);
}

.file-preview:hover {
	background-color: var(--bg-color);
	border-color: var(--dark-border-color);
	border-radius: var(--border-radius);
}

.file-preview:hover + .file-preview {
	border-top-color: transparent;
}

.file-icon {
	border-radius: var(--border-radius);
	width: 2.625rem;
	height: 2.625rem;
	overflow: hidden;
	margin-right: var(--margin-md);
	flex-shrink: 0;
}

.file-icon img {
	width: 100%;
	height: 100%;
	object-fit: cover;
}

.file-icon .fallback {
	width: 100%;
	height: 100%;
	display: flex;
	align-items: center;
	justify-content: center;
	border: 1px solid var(--border-color);
	border-radius: var(--border-radius);
}

.file-name {
	font-size: var(--text-base);
	font-weight: var(--text-bold);
	color: var(--text-color);
	display: -webkit-box;
	-webkit-line-clamp: 1;
	-webkit-box-orient: vertical;
	overflow: hidden;
}

.file-size {
	font-size: var(--text-sm);
	color: var(--text-light);
}

.file-actions {
	width: 3rem;
	flex-shrink: 0;
	margin-left: auto;
	text-align: center;
}

.file-actions .btn {
	padding: var(--padding-xs);
	box-shadow: none;
}

.file-action-buttons {
	display: flex;
	justify-content: flex-end;
}

.muted {
	opacity: 0.5;
	transition: 0.3s;
}

.muted:hover {
	opacity: 1;
}

.frappe-checkbox {
	font-size: var(--text-sm);
	color: var(--text-light);
	display: flex;
	align-items: center;
	padding-top: 0.25rem;
}

.config-area {
	gap: 0.5rem;
}

.file-error {
	font-size: var(--text-sm);
	font-weight: var(--text-bold);
}
</style>
`]},media:void 0})},Nw=void 0,Pw=void 0,Dw=!1;function jw(r,t,e,i,n,o,a,s,l,u){let c=(typeof e=="function"?e.options:e)||{};c.__file="frappe/public/js/frappe/file_uploader/FilePreview.vue",c.render||(c.render=r.render,c.staticRenderFns=r.staticRenderFns,c._compiled=!0,n&&(c.functional=!0)),c._scopeId=i;{let h;if(t&&(h=a?function(p){t.call(this,u(p,this.$root.$options.shadowRoot))}:function(p){t.call(this,s(p))}),h!==void 0)if(c.functional){let p=c.render;c.render=function(b,v){return h.call(v),p(b,v)}}else{let p=c.beforeCreate;c.beforeCreate=p?[].concat(p,h):[h]}}return c}function Io(){let r=Io.styles||(Io.styles={}),t=typeof navigator!="undefined"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(i,n){if(document.querySelector('style[data-vue-ssr-id~="'+i+'"]'))return;let o=t?n.media||"default":i,a=r[o]||(r[o]={ids:[],parts:[],element:void 0});if(!a.ids.includes(i)){let s=n.source,l=a.ids.length;if(a.ids.push(i),t&&(a.element=a.element||document.querySelector("style[data-group="+o+"]")),!a.element){let u=document.head||document.getElementsByTagName("head")[0],c=a.element=document.createElement("style");c.type="text/css",n.media&&c.setAttribute("media",n.media),t&&(c.setAttribute("data-group",o),c.setAttribute("data-next-index","0")),u.appendChild(c)}if(t&&(l=parseInt(a.element.getAttribute("data-next-index")),a.element.setAttribute("data-next-index",l+1)),a.element.styleSheet)a.parts.push(s),a.element.styleSheet.cssText=a.parts.filter(Boolean).join(`
`);else{let u=document.createTextNode(s),c=a.element.childNodes;c[l]&&a.element.removeChild(c[l]),c.length?a.element.insertBefore(u,c[l]):a.element.appendChild(u)}}}}var zw=jw({render:wd,staticRenderFns:Iw},Mw,Bw,Nw,Dw,Pw,!1,Io,void 0,void 0),kd=zw;var Fw={name:"TreeNode",props:["node","selected_node"],components:{TreeNode:()=>frappe.ui.components.TreeNode},computed:{icon(){let r={open:frappe.utils.icon("folder-open","md"),closed:frappe.utils.icon("folder-normal","md"),leaf:frappe.utils.icon("primitive-dot","xs"),search:frappe.utils.icon("search")};return this.node.by_search?r.search:this.node.is_leaf?r.leaf:this.node.open?r.open:r.closed}}},xd=function(){var r=this,t=r.$createElement,e=r._self._c||t;return e("div",{staticClass:"tree-node",class:{opened:r.node.open}},[e("span",{staticClass:"tree-link",class:{active:r.node.value===r.selected_node.value},attrs:{disabled:r.node.fetching},on:{click:function(i){return r.$emit("node-click",r.node)}}},[e("div",{domProps:{innerHTML:r._s(r.icon)}}),r._v(" "),e("a",{staticClass:"tree-label"},[r._v(r._s(r.node.label))])]),r._v(" "),e("ul",{directives:[{name:"show",rawName:"v-show",value:r.node.open,expression:"node.open"}],staticClass:"tree-children"},[r._l(r.node.children,function(i){return e("TreeNode",{key:i.value,attrs:{node:i,selected_node:r.selected_node},on:{"node-click":function(n){return r.$emit("node-click",n)},"load-more":function(n){return r.$emit("load-more",n)}}})}),r._v(" "),r.node.has_more_children?e("button",{staticClass:"btn btn-xs btn-load-more",attrs:{disabled:r.node.children_loading},on:{click:function(i){return r.$emit("load-more",r.node)}}},[r._v(`
			`+r._s(r.node.children_loading?r.__("Loading..."):r.__("Load more"))+`
		`)]):r._e()],2)])},Hw=[];xd._withStripped=!0;var qw=function(r){!r||r("data-v-23974a16_0",{source:`
.btn-load-more[data-v-23974a16] {
	margin-left: 1.6rem;
	margin-top: 0.5rem;
}
`,map:{version:3,sources:["frappe/public/js/frappe/file_uploader/TreeNode.vue"],names:[],mappings:";AAwDA;CACA,mBAAA;CACA,kBAAA;AACA",file:"TreeNode.vue",sourcesContent:[`<template>
	<div class="tree-node" :class="{ opened: node.open }">
		<span
			class="tree-link"
			@click="$emit('node-click', node)"
			:class="{ active: node.value === selected_node.value }"
			:disabled="node.fetching"
		>
			<div v-html="icon"></div>
			<a class="tree-label">{{ node.label }}</a>
		</span>
		<ul class="tree-children" v-show="node.open">
			<TreeNode
				v-for="n in node.children"
				:key="n.value"
				:node="n"
				:selected_node="selected_node"
				@node-click="n => $emit('node-click', n)"
				@load-more="n => $emit('load-more', n)"
			/>
			<button
				class="btn btn-xs btn-load-more"
				v-if="node.has_more_children"
				@click="$emit('load-more', node)"
				:disabled="node.children_loading"
			>
				{{ node.children_loading ? __("Loading...") : __("Load more") }}
			</button>
		</ul>
	</div>
</template>
<script>
export default {
	name: "TreeNode",
	props: ["node", "selected_node"],
	components: {
		TreeNode: () => frappe.ui.components.TreeNode
	},
	computed: {
		icon() {
			let icons = {
				open: frappe.utils.icon("folder-open", "md"),
				closed: frappe.utils.icon("folder-normal", "md"),
				leaf: frappe.utils.icon("primitive-dot", "xs"),
				search: frappe.utils.icon("search")
			};

			if (this.node.by_search) return icons.search;
			if (this.node.is_leaf) return icons.leaf;
			if (this.node.open) return icons.open;
			return icons.closed;
		}
	}
};
<\/script>
<style scoped>
.btn-load-more {
	margin-left: 1.6rem;
	margin-top: 0.5rem;
}
</style>
`]},media:void 0})},Uw="data-v-23974a16",Ww=void 0,Vw=!1;function Yw(r,t,e,i,n,o,a,s,l,u){let c=(typeof e=="function"?e.options:e)||{};c.__file="frappe/public/js/frappe/file_uploader/TreeNode.vue",c.render||(c.render=r.render,c.staticRenderFns=r.staticRenderFns,c._compiled=!0,n&&(c.functional=!0)),c._scopeId=i;{let h;if(t&&(h=a?function(p){t.call(this,u(p,this.$root.$options.shadowRoot))}:function(p){t.call(this,s(p))}),h!==void 0)if(c.functional){let p=c.render;c.render=function(b,v){return h.call(v),p(b,v)}}else{let p=c.beforeCreate;c.beforeCreate=p?[].concat(p,h):[h]}}return c}function Mo(){let r=Mo.styles||(Mo.styles={}),t=typeof navigator!="undefined"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(i,n){if(document.querySelector('style[data-vue-ssr-id~="'+i+'"]'))return;let o=t?n.media||"default":i,a=r[o]||(r[o]={ids:[],parts:[],element:void 0});if(!a.ids.includes(i)){let s=n.source,l=a.ids.length;if(a.ids.push(i),t&&(a.element=a.element||document.querySelector("style[data-group="+o+"]")),!a.element){let u=document.head||document.getElementsByTagName("head")[0],c=a.element=document.createElement("style");c.type="text/css",n.media&&c.setAttribute("media",n.media),t&&(c.setAttribute("data-group",o),c.setAttribute("data-next-index","0")),u.appendChild(c)}if(t&&(l=parseInt(a.element.getAttribute("data-next-index")),a.element.setAttribute("data-next-index",l+1)),a.element.styleSheet)a.parts.push(s),a.element.styleSheet.cssText=a.parts.filter(Boolean).join(`
`);else{let u=document.createTextNode(s),c=a.element.childNodes;c[l]&&a.element.removeChild(c[l]),c.length?a.element.insertBefore(u,c[l]):a.element.appendChild(u)}}}}var Gw=Yw({render:xd,staticRenderFns:Hw},qw,Fw,Uw,Vw,Ww,!1,Mo,void 0,void 0),Cd=Gw;var Xw={name:"FileBrowser",components:{TreeNode:Cd},data(){return{node:{label:__("Home"),value:"Home",children:[],children_start:0,children_loading:!1,is_leaf:!1,fetching:!1,fetched:!1,open:!1,filtered:!0},selected_node:{},search_text:"",page_length:10}},mounted(){this.toggle_node(this.node)},methods:{toggle_node(r){!r.fetched&&!r.is_leaf?(r.fetching=!0,r.children_start=0,r.children_loading=!1,this.get_files_in_folder(r.value,0).then(({files:t,has_more:e})=>{r.open=!0,r.children=t,r.fetched=!0,r.fetching=!1,r.children_start+=this.page_length,r.has_more_children=e})):(r.open=!r.open,this.select_node(r))},load_more(r){if(r.has_more_children){let t=r.children_start;r.children_loading=!0,this.get_files_in_folder(r.value,t).then(({files:e,has_more:i})=>{r.children=r.children.concat(e),r.children_start+=this.page_length,r.has_more_children=i,r.children_loading=!1})}},select_node(r){r.is_leaf&&(this.selected_node=r)},get_files_in_folder(r,t){return frappe.call("frappe.core.api.file.get_files_in_folder",{folder:r,start:t,page_length:this.page_length}).then(e=>{let{files:i=[],has_more:n=!1}=e.message||{};return i.sort((o,a)=>o.is_folder&&a.is_folder?o.modified<a.modified?-1:1:o.is_folder?-1:a.is_folder?1:0),i=i.map(o=>this.make_file_node(o)),{files:i,has_more:n}})},search_by_name:frappe.utils.debounce(function(){if(this.search_text===""){this.node=this.folder_node;return}this.search_text.length<3||frappe.call("frappe.core.api.file.get_files_by_search_text",{text:this.search_text}).then(r=>{let t=r.message||[];t=t.map(e=>this.make_file_node(e)),this.folder_node||(this.folder_node=this.node),this.node={label:__("Search Results"),value:"",children:t,by_search:!0,open:!0,filtered:!0}})},300),make_file_node(r){let t=r.file_name||r.name;return{label:frappe.utils.file_name_ellipsis(t,40),filename:t,file_url:r.file_url,value:r.name,is_leaf:!r.is_folder,fetched:!r.is_folder,children:[],children_loading:!1,children_start:0,open:!1,fetching:!1,filtered:!0}}}},Sd=function(){var r=this,t=r.$createElement,e=r._self._c||t;return e("div",{staticClass:"file-browser"},[e("div",[e("a",{staticClass:"text-muted text-medium",attrs:{href:""},on:{click:function(i){return i.preventDefault(),r.$emit("hide-browser")}}},[r._v(`
			`+r._s(r.__("\u2190 Back to upload files"))+`
		`)])]),r._v(" "),e("div",{staticClass:"file-browser-list"},[e("div",{staticClass:"file-filter"},[e("input",{directives:[{name:"model",rawName:"v-model",value:r.search_text,expression:"search_text"}],staticClass:"form-control input-xs",attrs:{type:"search",placeholder:r.__("Search by filename or extension")},domProps:{value:r.search_text},on:{input:[function(i){i.target.composing||(r.search_text=i.target.value)},r.search_by_name]}})]),r._v(" "),e("TreeNode",{staticClass:"tree with-skeleton",attrs:{node:r.node,selected_node:r.selected_node},on:{"node-click":function(i){return r.toggle_node(i)},"load-more":function(i){return r.load_more(i)}}})],1)])},Kw=[];Sd._withStripped=!0;var Jw=function(r){!r||r("data-v-1c4eadd2_0",{source:`
.file-browser-list {
	height: 300px;
	overflow: hidden;
	margin-top: 10px;
}
.file-filter {
	padding: 3px;
}
.tree {
	overflow: auto;
	height: 100%;
	padding-left: 0;
	padding-right: 0;
	padding-bottom: 4rem;
}
`,map:{version:3,sources:["frappe/public/js/frappe/file_uploader/FileBrowser.vue"],names:[],mappings:";AAkLA;CACA,aAAA;CACA,gBAAA;CACA,gBAAA;AACA;AAEA;CACA,YAAA;AACA;AAEA;CACA,cAAA;CACA,YAAA;CACA,eAAA;CACA,gBAAA;CACA,oBAAA;AACA",file:"FileBrowser.vue",sourcesContent:[`<template>
	<div class="file-browser">
		<div>
			<a
				href=""
				class="text-muted text-medium"
				@click.prevent="$emit('hide-browser')"
			>
				{{ __("\u2190 Back to upload files") }}
			</a>
		</div>
		<div class="file-browser-list">
			<div class="file-filter">
				<input
					type="search"
					class="form-control input-xs"
					:placeholder="__('Search by filename or extension')"
					v-model="search_text"
					@input="search_by_name"
				/>
			</div>
			<TreeNode
				class="tree with-skeleton"
				:node="node"
				:selected_node="selected_node"
				@node-click="n => toggle_node(n)"
				@load-more="n => load_more(n)"
			/>
		</div>
	</div>
</template>
<script>
import TreeNode from "./TreeNode.vue";

export default {
	name: "FileBrowser",
	components: {
		TreeNode
	},
	data() {
		return {
			node: {
				label: __("Home"),
				value: "Home",
				children: [],
				children_start: 0,
				children_loading: false,
				is_leaf: false,
				fetching: false,
				fetched: false,
				open: false,
				filtered: true
			},
			selected_node: {},
			search_text: "",
			page_length: 10
		};
	},
	mounted() {
		this.toggle_node(this.node);
	},
	methods: {
		toggle_node(node) {
			if (!node.fetched && !node.is_leaf) {
				node.fetching = true;
				node.children_start = 0;
				node.children_loading = false;
				this.get_files_in_folder(node.value, 0).then(
					({ files, has_more }) => {
						node.open = true;
						node.children = files;
						node.fetched = true;
						node.fetching = false;
						node.children_start += this.page_length;
						node.has_more_children = has_more;
					}
				);
			} else {
				node.open = !node.open;
				this.select_node(node);
			}
		},
		load_more(node) {
			if (node.has_more_children) {
				let start = node.children_start;
				node.children_loading = true;
				this.get_files_in_folder(node.value, start).then(
					({ files, has_more }) => {
						node.children = node.children.concat(files);
						node.children_start += this.page_length;
						node.has_more_children = has_more;
						node.children_loading = false;
					}
				);
			}
		},
		select_node(node) {
			if (node.is_leaf) {
				this.selected_node = node;
			}
		},
		get_files_in_folder(folder, start) {
			return frappe
				.call("frappe.core.api.file.get_files_in_folder", {
					folder,
					start,
					page_length: this.page_length
				})
				.then(r => {
					let { files = [], has_more = false } = r.message || {};
					files.sort((a, b) => {
						if (a.is_folder && b.is_folder) {
							return a.modified < b.modified ? -1 : 1;
						}
						if (a.is_folder) {
							return -1;
						}
						if (b.is_folder) {
							return 1;
						}
						return 0;
					});
					files = files.map(file => this.make_file_node(file));
					return { files, has_more };
				});
		},
		search_by_name: frappe.utils.debounce(function() {
			if (this.search_text === "") {
				this.node = this.folder_node;
				return;
			}
			if (this.search_text.length < 3) return;
			frappe
				.call(
					"frappe.core.api.file.get_files_by_search_text",
					{
						text: this.search_text
					}
				)
				.then(r => {
					let files = r.message || [];
					files = files.map(file => this.make_file_node(file));
					if (!this.folder_node) {
						this.folder_node = this.node;
					}
					this.node = {
						label: __("Search Results"),
						value: "",
						children: files,
						by_search: true,
						open: true,
						filtered: true
					};
				});
		}, 300),
		make_file_node(file) {
			let filename = file.file_name || file.name;
			let label = frappe.utils.file_name_ellipsis(filename, 40);
			return {
				label: label,
				filename: filename,
				file_url: file.file_url,
				value: file.name,
				is_leaf: !file.is_folder,
				fetched: !file.is_folder, // fetched if node is leaf
				children: [],
				children_loading: false,
				children_start: 0,
				open: false,
				fetching: false,
				filtered: true
			};
		}
	}
};
<\/script>

<style>
.file-browser-list {
	height: 300px;
	overflow: hidden;
	margin-top: 10px;
}

.file-filter {
	padding: 3px;
}

.tree {
	overflow: auto;
	height: 100%;
	padding-left: 0;
	padding-right: 0;
	padding-bottom: 4rem;
}
</style>
`]},media:void 0})},Zw=void 0,Qw=void 0,e0=!1;function t0(r,t,e,i,n,o,a,s,l,u){let c=(typeof e=="function"?e.options:e)||{};c.__file="frappe/public/js/frappe/file_uploader/FileBrowser.vue",c.render||(c.render=r.render,c.staticRenderFns=r.staticRenderFns,c._compiled=!0,n&&(c.functional=!0)),c._scopeId=i;{let h;if(t&&(h=a?function(p){t.call(this,u(p,this.$root.$options.shadowRoot))}:function(p){t.call(this,s(p))}),h!==void 0)if(c.functional){let p=c.render;c.render=function(b,v){return h.call(v),p(b,v)}}else{let p=c.beforeCreate;c.beforeCreate=p?[].concat(p,h):[h]}}return c}function No(){let r=No.styles||(No.styles={}),t=typeof navigator!="undefined"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(i,n){if(document.querySelector('style[data-vue-ssr-id~="'+i+'"]'))return;let o=t?n.media||"default":i,a=r[o]||(r[o]={ids:[],parts:[],element:void 0});if(!a.ids.includes(i)){let s=n.source,l=a.ids.length;if(a.ids.push(i),t&&(a.element=a.element||document.querySelector("style[data-group="+o+"]")),!a.element){let u=document.head||document.getElementsByTagName("head")[0],c=a.element=document.createElement("style");c.type="text/css",n.media&&c.setAttribute("media",n.media),t&&(c.setAttribute("data-group",o),c.setAttribute("data-next-index","0")),u.appendChild(c)}if(t&&(l=parseInt(a.element.getAttribute("data-next-index")),a.element.setAttribute("data-next-index",l+1)),a.element.styleSheet)a.parts.push(s),a.element.styleSheet.cssText=a.parts.filter(Boolean).join(`
`);else{let u=document.createTextNode(s),c=a.element.childNodes;c[l]&&a.element.removeChild(c[l]),c.length?a.element.insertBefore(u,c[l]):a.element.appendChild(u)}}}}var r0=t0({render:Sd,staticRenderFns:Kw},Jw,Xw,Zw,e0,Qw,!1,No,void 0,void 0),Td=r0;var i0={name:"WebLink",data(){return{url:""}}},Ed=function(){var r=this,t=r.$createElement,e=r._self._c||t;return e("div",{staticClass:"file-web-link margin-bottom"},[e("a",{staticClass:"text-muted text-medium",attrs:{href:""},on:{click:function(i){return i.preventDefault(),r.$emit("hide-web-link")}}},[r._v(`
		`+r._s(r.__("\u2190 Back to upload files"))+`
	`)]),r._v(" "),e("div",{staticClass:"input-group"},[e("input",{directives:[{name:"model",rawName:"v-model",value:r.url,expression:"url"}],staticClass:"form-control",attrs:{type:"text",placeholder:r.__("Attach a web link")},domProps:{value:r.url},on:{input:function(i){i.target.composing||(r.url=i.target.value)}}})])])},n0=[];Ed._withStripped=!0;var o0=function(r){!r||r("data-v-3d6cb693_0",{source:`
.file-web-link .input-group {
	margin-top: 10px;
}
`,map:{version:3,sources:["frappe/public/js/frappe/file_uploader/WebLink.vue"],names:[],mappings:";AA6BA;CACA,gBAAA;AACA",file:"WebLink.vue",sourcesContent:[`<template>
	<div class="file-web-link margin-bottom">
		<a href class="text-muted text-medium"
			@click.prevent="$emit('hide-web-link')"
		>
			{{ __('\u2190 Back to upload files') }}
		</a>
		<div class="input-group">
			<input
				type="text"
				class="form-control"
				:placeholder="__('Attach a web link')"
				v-model="url"
			>
		</div>
	</div>
</template>
<script>
export default {
	name: 'WebLink',
	data() {
		return {
			url: '',
		}
	}
}
<\/script>

<style>
.file-web-link .input-group {
	margin-top: 10px;
}
</style>
`]},media:void 0})},a0=void 0,s0=void 0,l0=!1;function c0(r,t,e,i,n,o,a,s,l,u){let c=(typeof e=="function"?e.options:e)||{};c.__file="frappe/public/js/frappe/file_uploader/WebLink.vue",c.render||(c.render=r.render,c.staticRenderFns=r.staticRenderFns,c._compiled=!0,n&&(c.functional=!0)),c._scopeId=i;{let h;if(t&&(h=a?function(p){t.call(this,u(p,this.$root.$options.shadowRoot))}:function(p){t.call(this,s(p))}),h!==void 0)if(c.functional){let p=c.render;c.render=function(b,v){return h.call(v),p(b,v)}}else{let p=c.beforeCreate;c.beforeCreate=p?[].concat(p,h):[h]}}return c}function Po(){let r=Po.styles||(Po.styles={}),t=typeof navigator!="undefined"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(i,n){if(document.querySelector('style[data-vue-ssr-id~="'+i+'"]'))return;let o=t?n.media||"default":i,a=r[o]||(r[o]={ids:[],parts:[],element:void 0});if(!a.ids.includes(i)){let s=n.source,l=a.ids.length;if(a.ids.push(i),t&&(a.element=a.element||document.querySelector("style[data-group="+o+"]")),!a.element){let u=document.head||document.getElementsByTagName("head")[0],c=a.element=document.createElement("style");c.type="text/css",n.media&&c.setAttribute("media",n.media),t&&(c.setAttribute("data-group",o),c.setAttribute("data-next-index","0")),u.appendChild(c)}if(t&&(l=parseInt(a.element.getAttribute("data-next-index")),a.element.setAttribute("data-next-index",l+1)),a.element.styleSheet)a.parts.push(s),a.element.styleSheet.cssText=a.parts.filter(Boolean).join(`
`);else{let u=document.createTextNode(s),c=a.element.childNodes;c[l]&&a.element.removeChild(c[l]),c.length?a.element.insertBefore(u,c[l]):a.element.appendChild(u)}}}}var u0=c0({render:Ed,staticRenderFns:n0},o0,i0,a0,l0,s0,!1,Po,void 0,void 0),Ad=u0;var cn=class{constructor({pickerCallback:t,enabled:e,appId:i,developerKey:n,clientId:o}={}){this.scope=["https://www.googleapis.com/auth/drive.readonly"],this.pickerApiLoaded=!1,this.enabled=e,this.appId=i,this.pickerCallback=t,this.developerKey=n,this.clientId=o}loadPicker(){$.ajax({method:"GET",url:"https://apis.google.com/js/api.js",dataType:"script",cache:!0}).done(this.loadGapi.bind(this))}loadGapi(){frappe.boot.user.google_drive_token||gapi.load("auth",this.onAuthApiLoad.bind(this)),gapi.load("picker",this.onPickerApiLoad.bind(this))}onAuthApiLoad(){gapi.auth.authorize({client_id:this.clientId,scope:this.scope,immediate:!1},this.handleAuthResult.bind(this))}handleAuthResult(t){let e={popup_closed_by_user:__("Google Authentication was closed abruptly by the user")};if(t&&!t.error)frappe.boot.user.google_drive_token=t.access_token,this.createPicker();else{let i=e[t.error]||__("Google Authentication Error");frappe.throw(i)}}onPickerApiLoad(){this.pickerApiLoaded=!0,this.createPicker()}createPicker(){this.pickerApiLoaded&&frappe.boot.user.google_drive_token&&(this.view=new google.picker.DocsView(google.picker.ViewId.DOCS).setParent("root").setIncludeFolders(!0),this.picker=new google.picker.PickerBuilder().setAppId(this.appId).setDeveloperKey(this.developerKey).setOAuthToken(frappe.boot.user.google_drive_token).addView(this.view).setLocale(frappe.boot.lang).setCallback(this.pickerCallback).build(),this.picker.setVisible(!0),this.setupHide())}setupHide(){let t=$(".picker-dialog-bg");for(let e of t)e.onclick=()=>{this.picker.setVisible(!1),this.picker.Ob({action:google.picker.Action.CANCEL})}}};var Od=Vt($d()),d0={name:"ImageCropper",props:["file","fixed_aspect_ratio"],data(){let r=this.fixed_aspect_ratio!=null?this.fixed_aspect_ratio:NaN;return{src:null,cropper:null,image:null,aspect_ratio:r}},watch:{aspect_ratio(r){this.cropper&&this.cropper.setAspectRatio(r)}},mounted(){if(window.FileReader){let t=new FileReader;t.onload=()=>this.src=t.result,t.readAsDataURL(this.file.cropper_file)}let r=this.file.crop_box_data;this.image=this.$refs.image,this.image.onload=()=>{this.cropper=new Od.default(this.image,{zoomable:!1,scalable:!1,viewMode:1,data:r,aspectRatio:this.aspect_ratio}),window.cropper=this.cropper}},computed:{aspect_ratio_buttons(){return[{label:__("1:1"),value:1},{label:__("4:3"),value:4/3},{label:__("16:9"),value:16/9},{label:__("Free"),value:NaN}]}},methods:{crop_image(){this.file.crop_box_data=this.cropper.getData();let r=this.cropper.getCroppedCanvas(),t=this.file.file_obj.type;r.toBlob(e=>{var i=new File([e],this.file.name,{type:e.type});this.file.file_obj=i,this.$emit("toggle_image_cropper")},t)}}},Rd=function(){var r=this,t=r.$createElement,e=r._self._c||t;return e("div",[e("div",[e("img",{ref:"image",attrs:{src:r.src,alt:r.file.name}})]),r._v(" "),e("div",{staticClass:"image-cropper-actions"},[e("div",[r.fixed_aspect_ratio==null?e("div",{staticClass:"btn-group"},r._l(r.aspect_ratio_buttons,function(i){return e("button",{key:i.label,staticClass:"btn btn-default btn-sm",class:{active:isNaN(r.aspect_ratio)?isNaN(i.value):i.value===r.aspect_ratio},attrs:{type:"button"},on:{click:function(n){r.aspect_ratio=i.value}}},[r._v(`
					`+r._s(i.label)+`
				`)])}),0):r._e()]),r._v(" "),e("div",[r.fixed_aspect_ratio==null?e("button",{staticClass:"btn btn-sm margin-right",on:{click:function(i){return r.$emit("toggle_image_cropper")}}},[r._v(`
				`+r._s(r.__("Back"))+`
			`)]):r._e(),r._v(" "),e("button",{staticClass:"btn btn-primary btn-sm",on:{click:r.crop_image}},[r._v(`
				`+r._s(r.__("Crop"))+`
			`)])])])])},f0=[];Rd._withStripped=!0;var p0=function(r){!r||r("data-v-07cb5b9d_0",{source:`
img {
	display: block;
	max-width: 100%;
	max-height: 600px;
}
.image-cropper-actions {
	display: flex;
	align-items: center;
	justify-content: space-between;
	margin-top: var(--margin-md);
}
`,map:{version:3,sources:["frappe/public/js/frappe/file_uploader/ImageCropper.vue"],names:[],mappings:";AAwHA;CACA,cAAA;CACA,eAAA;CACA,iBAAA;AACA;AAEA;CACA,aAAA;CACA,mBAAA;CACA,8BAAA;CACA,4BAAA;AACA",file:"ImageCropper.vue",sourcesContent:[`<template>
	<div>
		<div>
			<img ref="image" :src="src" :alt="file.name" />
		</div>
		<div class="image-cropper-actions">
			<div>
				<div class="btn-group" v-if="fixed_aspect_ratio == null">
					<button
						v-for="button in aspect_ratio_buttons"
						type="button"
						class="btn btn-default btn-sm"
						:class="{
							active: isNaN(aspect_ratio)
								? isNaN(button.value)
								: button.value === aspect_ratio
						}"
						:key="button.label"
						@click="aspect_ratio = button.value"
					>
						{{ button.label }}
					</button>
				</div>
			</div>
			<div>
				<button
					class="btn btn-sm margin-right"
					@click="$emit('toggle_image_cropper')"
					v-if="fixed_aspect_ratio == null"
				>
					{{ __("Back") }}
				</button>
				<button class="btn btn-primary btn-sm" @click="crop_image">
					{{ __("Crop") }}
				</button>
			</div>
		</div>
	</div>
</template>

<script>
import Cropper from "cropperjs";
export default {
	name: "ImageCropper",
	props: ["file", "fixed_aspect_ratio"],
	data() {
		let aspect_ratio =
			this.fixed_aspect_ratio != null ? this.fixed_aspect_ratio : NaN;
		return {
			src: null,
			cropper: null,
			image: null,
			aspect_ratio
		};
	},
	watch: {
		aspect_ratio(value) {
			if (this.cropper) {
				this.cropper.setAspectRatio(value);
			}
		}
	},
	mounted() {
		if (window.FileReader) {
			let fr = new FileReader();
			fr.onload = () => (this.src = fr.result);
			fr.readAsDataURL(this.file.cropper_file);
		}
		let crop_box = this.file.crop_box_data;
		this.image = this.$refs.image;
		this.image.onload = () => {
			this.cropper = new Cropper(this.image, {
				zoomable: false,
				scalable: false,
				viewMode: 1,
				data: crop_box,
				aspectRatio: this.aspect_ratio
			});
			window.cropper = this.cropper;
		};
	},
	computed: {
		aspect_ratio_buttons() {
			return [
				{
					label: __("1:1"),
					value: 1
				},
				{
					label: __("4:3"),
					value: 4 / 3
				},
				{
					label: __("16:9"),
					value: 16 / 9
				},
				{
					label: __("Free"),
					value: NaN
				}
			];
		}
	},
	methods: {
		crop_image() {
			this.file.crop_box_data = this.cropper.getData();
			const canvas = this.cropper.getCroppedCanvas();
			const file_type = this.file.file_obj.type;
			canvas.toBlob(blob => {
				var cropped_file_obj = new File([blob], this.file.name, {
					type: blob.type
				});
				this.file.file_obj = cropped_file_obj;
				this.$emit("toggle_image_cropper");
			}, file_type);
		}
	}
};
<\/script>
<style>
img {
	display: block;
	max-width: 100%;
	max-height: 600px;
}

.image-cropper-actions {
	display: flex;
	align-items: center;
	justify-content: space-between;
	margin-top: var(--margin-md);
}
</style>
`]},media:void 0})},h0=void 0,_0=void 0,m0=!1;function g0(r,t,e,i,n,o,a,s,l,u){let c=(typeof e=="function"?e.options:e)||{};c.__file="frappe/public/js/frappe/file_uploader/ImageCropper.vue",c.render||(c.render=r.render,c.staticRenderFns=r.staticRenderFns,c._compiled=!0,n&&(c.functional=!0)),c._scopeId=i;{let h;if(t&&(h=a?function(p){t.call(this,u(p,this.$root.$options.shadowRoot))}:function(p){t.call(this,s(p))}),h!==void 0)if(c.functional){let p=c.render;c.render=function(b,v){return h.call(v),p(b,v)}}else{let p=c.beforeCreate;c.beforeCreate=p?[].concat(p,h):[h]}}return c}function zo(){let r=zo.styles||(zo.styles={}),t=typeof navigator!="undefined"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(i,n){if(document.querySelector('style[data-vue-ssr-id~="'+i+'"]'))return;let o=t?n.media||"default":i,a=r[o]||(r[o]={ids:[],parts:[],element:void 0});if(!a.ids.includes(i)){let s=n.source,l=a.ids.length;if(a.ids.push(i),t&&(a.element=a.element||document.querySelector("style[data-group="+o+"]")),!a.element){let u=document.head||document.getElementsByTagName("head")[0],c=a.element=document.createElement("style");c.type="text/css",n.media&&c.setAttribute("media",n.media),t&&(c.setAttribute("data-group",o),c.setAttribute("data-next-index","0")),u.appendChild(c)}if(t&&(l=parseInt(a.element.getAttribute("data-next-index")),a.element.setAttribute("data-next-index",l+1)),a.element.styleSheet)a.parts.push(s),a.element.styleSheet.cssText=a.parts.filter(Boolean).join(`
`);else{let u=document.createTextNode(s),c=a.element.childNodes;c[l]&&a.element.removeChild(c[l]),c.length?a.element.insertBefore(u,c[l]):a.element.appendChild(u)}}}}var v0=g0({render:Rd,staticRenderFns:f0},p0,d0,h0,m0,_0,!1,zo,void 0,void 0),Ld=v0;var b0={name:"FileUploader",props:{show_upload_button:{default:!0},disable_file_browser:{default:!1},allow_multiple:{default:!0},as_dataurl:{default:!1},doctype:{default:null},docname:{default:null},fieldname:{default:null},folder:{default:"Home"},method:{default:null},on_success:{default:null},make_attachments_public:{default:null},restrictions:{default:()=>({max_file_size:null,max_number_of_files:null,allowed_file_types:[],crop_image_aspect_ratio:null})},attach_doc_image:{default:!1},upload_notes:{default:null}},components:{FilePreview:kd,FileBrowser:Td,WebLink:Ad,ImageCropper:Ld},data(){return{files:[],is_dragging:!1,currently_uploading:-1,show_file_browser:!1,show_web_link:!1,show_image_cropper:!1,crop_image_with_index:-1,trigger_upload:!1,close_dialog:!1,hide_dialog_footer:!1,allow_take_photo:!1,allow_web_link:!0,google_drive_settings:{enabled:!1},wrapper_ready:!1}},created(){var r;this.allow_take_photo=window.navigator.mediaDevices,frappe.user_id!=="Guest"&&frappe.call({method:"frappe.integrations.doctype.google_settings.google_settings.get_file_picker_settings",callback:t=>{t.exc||(this.google_drive_settings=t.message)}}),this.restrictions.max_file_size==null&&frappe.call("frappe.core.api.file.get_max_file_size").then(t=>{this.restrictions.max_file_size=Number(t.message)}),this.restrictions.max_number_of_files==null&&this.doctype&&(this.restrictions.max_number_of_files=(r=frappe.get_meta(this.doctype))==null?void 0:r.max_attachments)},watch:{files(r,t){!this.allow_multiple&&r.length>1&&(this.files=[r[r.length-1]])}},computed:{upload_complete(){return this.files.length>0&&this.files.every(r=>r.total!==0&&r.progress===r.total)}},methods:{dragover(){this.is_dragging=!0},dragleave(){this.is_dragging=!1},dropfiles(r){this.is_dragging=!1,this.add_files(r.dataTransfer.files)},browse_files(){this.$refs.file_input.click()},on_file_input(r){this.add_files(this.$refs.file_input.files)},remove_file(r){this.files=this.files.filter(t=>t!==r)},toggle_image_cropper(r){this.crop_image_with_index=this.show_image_cropper?-1:r,this.hide_dialog_footer=!this.show_image_cropper,this.show_image_cropper=!this.show_image_cropper},toggle_all_private(){let r;this.files.filter(e=>e.private).length<this.files.length?r=!0:r=!1,this.files=this.files.map(e=>(e.private=r,e))},show_max_files_number_warning(r){console.warn(`File skipped because it exceeds the allowed specified limit of ${max_number_of_files} uploads`,r),this.doctype?MSG=__('File "{0}" was skipped because only {1} uploads are allowed for DocType "{2}"',[r.name,max_number_of_files,this.doctype]):MSG=__('File "{0}" was skipped because only {1} uploads are allowed',[r.name,max_number_of_files]),frappe.show_alert({message:MSG,indicator:"orange"})},add_files(r){let t=Array.from(r).filter(this.check_restrictions).map(e=>{let i=e.type.startsWith("image"),n=e.size/1024;return{file_obj:e,cropper_file:e,crop_box_data:null,optimize:n>200&&i&&!e.type.includes("svg"),name:e.name,doc:null,progress:0,total:0,failed:!1,request_succeeded:!1,error_message:null,uploading:!1,private:!this.make_attachments_public}});max_number_of_files=this.restrictions.max_number_of_files,max_number_of_files&&t.length>max_number_of_files&&(t.slice(max_number_of_files).forEach(e=>{this.show_max_files_number_warning(e,this.doctype)}),t=t.slice(0,max_number_of_files)),this.files=this.files.concat(t),this.files.length===1&&!this.allow_multiple&&this.restrictions.crop_image_aspect_ratio!=null&&(this.files[0].file_obj.type.includes("svg")||this.toggle_image_cropper(0))},check_restrictions(r){let{max_file_size:t,allowed_file_types:e=[]}=this.restrictions,i=!0,n=!0;return e&&e.length&&(i=e.some(o=>o.includes("/")?r.type?r.type.match(o):!1:o[0]==="."?r.name.endsWith(o):!1)),t&&r.size!=null&&(n=r.size<t),i||(console.warn("File skipped because of invalid file type",r),frappe.show_alert({message:__('File "{0}" was skipped because of invalid file type',[r.name]),indicator:"orange"})),n||(console.warn("File skipped because of invalid file size",r.size,r),frappe.show_alert({message:__('File "{0}" was skipped because size exceeds {1} MB',[r.name,t/(1024*1024)]),indicator:"orange"})),i&&n},upload_files(){return this.show_file_browser?this.upload_via_file_browser():this.show_web_link?this.upload_via_web_link():this.as_dataurl?this.return_as_dataurl():frappe.run_serially(this.files.map((r,t)=>()=>this.upload_file(r,t)))},upload_via_file_browser(){let r=this.$refs.file_browser.selected_node;return r.value?(this.close_dialog=!0,this.upload_file({file_url:r.file_url})):(frappe.msgprint(__("Click on a file to select it.")),this.close_dialog=!0,Promise.reject())},upload_via_web_link(){let r=this.$refs.web_link.url;return r?(r=decodeURI(r),this.close_dialog=!0,this.upload_file({file_url:r})):(frappe.msgprint(__("Invalid URL")),this.close_dialog=!0,Promise.reject())},return_as_dataurl(){let r=this.files.map(t=>frappe.dom.file_to_base64(t.file_obj).then(e=>{t.dataurl=e,this.on_success&&this.on_success(t)}));return this.close_dialog=!0,Promise.all(r)},upload_file(r,t){return this.currently_uploading=t,new Promise((e,i)=>{let n=new XMLHttpRequest;n.upload.addEventListener("loadstart",a=>{r.uploading=!0}),n.upload.addEventListener("progress",a=>{a.lengthComputable&&(r.progress=a.loaded,r.total=a.total)}),n.upload.addEventListener("load",a=>{r.uploading=!1,e()}),n.addEventListener("error",a=>{r.failed=!0,i()}),n.onreadystatechange=()=>{if(n.readyState==XMLHttpRequest.DONE)if(n.status===200){r.request_succeeded=!0;let a=null,s=null;try{a=JSON.parse(n.responseText),a.message.doctype==="File"&&(s=a.message)}catch(l){a=n.responseText}r.doc=s,this.on_success&&this.on_success(s,a),t==this.files.length-1&&this.files.every(l=>l.request_succeeded)&&(this.close_dialog=!0)}else if(n.status===403){r.failed=!0;let a=JSON.parse(n.responseText);r.error_message=`Not permitted. ${a._error_message||""}`}else if(n.status===413)r.failed=!0,r.error_message="Size exceeds the maximum allowed file size.";else{r.failed=!0,r.error_message=n.status===0?"XMLHttpRequest Error":`${n.status} : ${n.statusText}`;let a=null;try{a=JSON.parse(n.responseText)}catch(s){}frappe.request.cleanup({},a)}},n.open("POST","/api/method/upload_file",!0),n.setRequestHeader("Accept","application/json"),n.setRequestHeader("X-Frappe-CSRF-Token",frappe.csrf_token);let o=new FormData;r.file_obj&&o.append("file",r.file_obj,r.name),o.append("is_private",+r.private),o.append("folder",this.folder),r.file_url&&o.append("file_url",r.file_url),r.file_name&&o.append("file_name",r.file_name),this.doctype&&this.docname&&(o.append("doctype",this.doctype),o.append("docname",this.docname)),this.fieldname&&o.append("fieldname",this.fieldname),this.method&&o.append("method",this.method),r.optimize&&o.append("optimize",!0),this.attach_doc_image&&(o.append("max_width",200),o.append("max_height",200)),n.send(o)})},capture_image(){let r=new frappe.ui.Capture({animate:!1,error:!0});r.show(),r.submit(t=>{t.forEach(e=>{let i=`capture_${frappe.datetime.now_datetime().replaceAll(/[: -]/g,"_")}.png`;this.url_to_file(e,i,"image/png").then(n=>this.add_files([n]))})})},show_google_drive_picker(){this.close_dialog=!0,new cn(lt({pickerCallback:t=>this.google_drive_callback(t)},this.google_drive_settings)).loadPicker()},google_drive_callback(r){r.action==google.picker.Action.PICKED?this.upload_file({file_url:r.docs[0].url,file_name:r.docs[0].name}):r.action==google.picker.Action.CANCEL&&cur_frm.attachments.new_attachment()},url_to_file(r,t,e){return fetch(r).then(i=>i.arrayBuffer()).then(i=>new File([i],t,{type:e}))}}},Bd=function(){var r=this,t=r.$createElement,e=r._self._c||t;return e("div",{staticClass:"file-uploader",on:{dragover:function(i){return i.preventDefault(),r.dragover.apply(null,arguments)},dragleave:function(i){return i.preventDefault(),r.dragleave.apply(null,arguments)},drop:function(i){return i.preventDefault(),r.dropfiles.apply(null,arguments)}}},[e("div",{directives:[{name:"show",rawName:"v-show",value:r.files.length===0&&!r.show_file_browser&&!r.show_web_link,expression:"files.length === 0 && !show_file_browser && !show_web_link"}],staticClass:"file-upload-area"},[r.is_dragging?e("div",[r._v(`
			`+r._s(r.__("Drop files here"))+`
		`)]):e("div",[e("div",{staticClass:"text-center"},[r._v(`
				`+r._s(r.__("Drag and drop files here or upload from"))+`
			`)]),r._v(" "),e("div",{staticClass:"mt-2 text-center"},[e("button",{staticClass:"btn btn-file-upload",on:{click:r.browse_files}},[e("svg",{attrs:{width:"30",height:"30",viewBox:"0 0 30 30",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[e("circle",{attrs:{cx:"15",cy:"15",r:"15",fill:"url(#paint0_linear)"}}),r._v(" "),e("path",{attrs:{d:"M13.5 22V19",stroke:"white","stroke-linecap":"round","stroke-linejoin":"round"}}),r._v(" "),e("path",{attrs:{d:"M16.5 22V19",stroke:"white","stroke-linecap":"round","stroke-linejoin":"round"}}),r._v(" "),e("path",{attrs:{d:"M10.5 22H19.5",stroke:"white","stroke-linecap":"round","stroke-linejoin":"round"}}),r._v(" "),e("path",{attrs:{d:"M7.5 16H22.5",stroke:"white","stroke-linecap":"round","stroke-linejoin":"round"}}),r._v(" "),e("path",{attrs:{d:"M21 8H9C8.17157 8 7.5 8.67157 7.5 9.5V17.5C7.5 18.3284 8.17157 19 9 19H21C21.8284 19 22.5 18.3284 22.5 17.5V9.5C22.5 8.67157 21.8284 8 21 8Z",stroke:"white","stroke-linecap":"round","stroke-linejoin":"round"}}),r._v(" "),e("defs",[e("linearGradient",{attrs:{id:"paint0_linear",x1:"0",y1:"0",x2:"0",y2:"30",gradientUnits:"userSpaceOnUse"}},[e("stop",{attrs:{"stop-color":"#2C9AF1"}}),r._v(" "),e("stop",{attrs:{offset:"1","stop-color":"#2490EF"}})],1)],1)]),r._v(" "),e("div",{staticClass:"mt-1"},[r._v(r._s(r.__("My Device")))])]),r._v(" "),e("input",{ref:"file_input",staticClass:"hidden",attrs:{type:"file",multiple:r.allow_multiple,accept:(r.restrictions.allowed_file_types||[]).join(", ")},on:{change:r.on_file_input}}),r._v(" "),r.disable_file_browser?r._e():e("button",{staticClass:"btn btn-file-upload",on:{click:function(i){r.show_file_browser=!0}}},[e("svg",{attrs:{width:"30",height:"30",viewBox:"0 0 30 30",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[e("circle",{attrs:{cx:"15",cy:"15",r:"15",fill:"#48BB74"}}),r._v(" "),e("path",{attrs:{d:"M13.0245 11.5H8C7.72386 11.5 7.5 11.7239 7.5 12V20C7.5 21.1046 8.39543 22 9.5 22H20.5C21.6046 22 22.5 21.1046 22.5 20V14.5C22.5 14.2239 22.2761 14 22 14H15.2169C15.0492 14 14.8926 13.9159 14.8 13.776L13.4414 11.724C13.3488 11.5841 13.1922 11.5 13.0245 11.5Z",stroke:"white","stroke-miterlimit":"10","stroke-linecap":"square"}}),r._v(" "),e("path",{attrs:{d:"M8.87939 9.5V8.5C8.87939 8.22386 9.10325 8 9.37939 8H20.6208C20.8969 8 21.1208 8.22386 21.1208 8.5V12",stroke:"white","stroke-miterlimit":"10","stroke-linecap":"round","stroke-linejoin":"round"}})]),r._v(" "),e("div",{staticClass:"mt-1"},[r._v(r._s(r.__("Library")))])]),r._v(" "),r.allow_web_link?e("button",{staticClass:"btn btn-file-upload",on:{click:function(i){r.show_web_link=!0}}},[e("svg",{attrs:{width:"30",height:"30",viewBox:"0 0 30 30",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[e("circle",{attrs:{cx:"15",cy:"15",r:"15",fill:"#ECAC4B"}}),r._v(" "),e("path",{attrs:{d:"M12.0469 17.9543L17.9558 12.0454",stroke:"white","stroke-linecap":"round","stroke-linejoin":"round"}}),r._v(" "),e("path",{attrs:{d:"M13.8184 11.4547L15.7943 9.47873C16.4212 8.85205 17.2714 8.5 18.1578 8.5C19.0443 8.5 19.8945 8.85205 20.5214 9.47873V9.47873C21.1481 10.1057 21.5001 10.9558 21.5001 11.8423C21.5001 12.7287 21.1481 13.5789 20.5214 14.2058L18.5455 16.1818",stroke:"white","stroke-linecap":"round","stroke-linejoin":"round"}}),r._v(" "),e("path",{attrs:{d:"M11.4547 13.8184L9.47873 15.7943C8.85205 16.4212 8.5 17.2714 8.5 18.1578C8.5 19.0443 8.85205 19.8945 9.47873 20.5214V20.5214C10.1057 21.1481 10.9558 21.5001 11.8423 21.5001C12.7287 21.5001 13.5789 21.1481 14.2058 20.5214L16.1818 18.5455",stroke:"white","stroke-linecap":"round","stroke-linejoin":"round"}})]),r._v(" "),e("div",{staticClass:"mt-1"},[r._v(r._s(r.__("Link")))])]):r._e(),r._v(" "),r.allow_take_photo?e("button",{staticClass:"btn btn-file-upload",on:{click:r.capture_image}},[e("svg",{attrs:{width:"30",height:"30",viewBox:"0 0 30 30",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[e("circle",{attrs:{cx:"15",cy:"15",r:"15",fill:"#CE315B"}}),r._v(" "),e("path",{attrs:{d:"M11.5 10.5H9.5C8.67157 10.5 8 11.1716 8 12V20C8 20.8284 8.67157 21.5 9.5 21.5H20.5C21.3284 21.5 22 20.8284 22 20V12C22 11.1716 21.3284 10.5 20.5 10.5H18.5L17.3 8.9C17.1111 8.64819 16.8148 8.5 16.5 8.5H13.5C13.1852 8.5 12.8889 8.64819 12.7 8.9L11.5 10.5Z",stroke:"white","stroke-linejoin":"round"}}),r._v(" "),e("circle",{attrs:{cx:"15",cy:"16",r:"2.5",stroke:"white"}})]),r._v(" "),e("div",{staticClass:"mt-1"},[r._v(r._s(r.__("Camera")))])]):r._e(),r._v(" "),r.google_drive_settings.enabled?e("button",{staticClass:"btn btn-file-upload",on:{click:r.show_google_drive_picker}},[e("svg",{attrs:{width:"30",height:"30"}},[e("image",{attrs:{href:"/assets/frappe/icons/social/google_drive.svg",width:"30",height:"30"}})]),r._v(" "),e("div",{staticClass:"mt-1"},[r._v(r._s(r.__("Google Drive")))])]):r._e()]),r._v(" "),e("div",{staticClass:"text-muted text-medium"},[r._v(`
				`+r._s(r.upload_notes)+`
			`)])])]),r._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:r.files.length&&!r.show_file_browser&&!r.show_web_link,expression:"files.length && !show_file_browser && !show_web_link"}],staticClass:"file-preview-area"},[r.show_image_cropper?r._e():e("div",{staticClass:"file-preview-container"},r._l(r.files,function(i,n){return e("FilePreview",{key:i.name,attrs:{file:i},on:{remove:function(o){return r.remove_file(i)},toggle_private:function(o){i.private=!i.private},toggle_optimize:function(o){i.optimize=!i.optimize},toggle_image_cropper:function(o){return r.toggle_image_cropper(n)}}})}),1),r._v(" "),r.show_upload_button&&r.currently_uploading===-1?e("div",{staticClass:"flex align-center"},[e("button",{staticClass:"btn btn-primary btn-sm margin-right",on:{click:r.upload_files}},[r.files.length===1?e("span",[r._v(`
					`+r._s(r.__("Upload file"))+`
				`)]):e("span",[r._v(`
					`+r._s(r.__("Upload {0} files",[r.files.length]))+`
				`)])]),r._v(" "),e("div",{staticClass:"text-muted text-medium"},[r._v(`
				`+r._s(r.__("Click on the lock icon to toggle public/private"))+`
			`)])]):r._e()]),r._v(" "),r.show_image_cropper&&r.wrapper_ready?e("ImageCropper",{attrs:{file:r.files[r.crop_image_with_index],fixed_aspect_ratio:r.restrictions.crop_image_aspect_ratio},on:{toggle_image_cropper:function(i){return r.toggle_image_cropper(-1)},upload_after_crop:function(i){r.trigger_upload=!0}}}):r._e(),r._v(" "),r.show_file_browser&&!r.disable_file_browser?e("FileBrowser",{ref:"file_browser",on:{"hide-browser":function(i){r.show_file_browser=!1}}}):r._e(),r._v(" "),r.show_web_link?e("WebLink",{ref:"web_link",on:{"hide-web-link":function(i){r.show_web_link=!1}}}):r._e()],1)},y0=[];Bd._withStripped=!0;var w0=function(r){!r||r("data-v-ae1e69a6_0",{source:`
.file-upload-area {
	min-height: 16rem;
	display: flex;
	align-items: center;
	justify-content: center;
	border: 1px dashed var(--dark-border-color);
	border-radius: var(--border-radius);
	cursor: pointer;
	background-color: var(--bg-color);
}
.btn-file-upload {
	background-color: transparent;
	border: none;
	box-shadow: none;
	font-size: var(--text-xs);
}
`,map:{version:3,sources:["frappe/public/js/frappe/file_uploader/FileUploader.vue"],names:[],mappings:";AAulBA;CACA,iBAAA;CACA,aAAA;CACA,mBAAA;CACA,uBAAA;CACA,2CAAA;CACA,mCAAA;CACA,eAAA;CACA,iCAAA;AACA;AAEA;CACA,6BAAA;CACA,YAAA;CACA,gBAAA;CACA,yBAAA;AACA",file:"FileUploader.vue",sourcesContent:[`<template>
	<div class="file-uploader"
		@dragover.prevent="dragover"
		@dragleave.prevent="dragleave"
		@drop.prevent="dropfiles"
	>
		<div
			class="file-upload-area"
			v-show="files.length === 0 && !show_file_browser && !show_web_link"
		>
			<div v-if="!is_dragging">
				<div class="text-center">
					{{ __('Drag and drop files here or upload from') }}
				</div>
				<div class="mt-2 text-center">
					<button class="btn btn-file-upload" @click="browse_files">
						<svg width="30" height="30" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">
							<circle cx="15" cy="15" r="15" fill="url(#paint0_linear)"/>
							<path d="M13.5 22V19" stroke="white" stroke-linecap="round" stroke-linejoin="round"/>
							<path d="M16.5 22V19" stroke="white" stroke-linecap="round" stroke-linejoin="round"/>
							<path d="M10.5 22H19.5" stroke="white" stroke-linecap="round" stroke-linejoin="round"/>
							<path d="M7.5 16H22.5" stroke="white" stroke-linecap="round" stroke-linejoin="round"/>
							<path d="M21 8H9C8.17157 8 7.5 8.67157 7.5 9.5V17.5C7.5 18.3284 8.17157 19 9 19H21C21.8284 19 22.5 18.3284 22.5 17.5V9.5C22.5 8.67157 21.8284 8 21 8Z" stroke="white" stroke-linecap="round" stroke-linejoin="round"/>
							<defs>
							<linearGradient id="paint0_linear" x1="0" y1="0" x2="0" y2="30" gradientUnits="userSpaceOnUse">
							<stop stop-color="#2C9AF1"/>
							<stop offset="1" stop-color="#2490EF"/>
							</linearGradient>
							</defs>
						</svg>
						<div class="mt-1">{{ __('My Device') }}</div>
					</button>
					<input
						type="file"
						class="hidden"
						ref="file_input"
						@change="on_file_input"
						:multiple="allow_multiple"
						:accept="(restrictions.allowed_file_types || []).join(', ')"
					>
					<button class="btn btn-file-upload" v-if="!disable_file_browser" @click="show_file_browser = true">
						<svg width="30" height="30" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">
							<circle cx="15" cy="15" r="15" fill="#48BB74"/>
							<path d="M13.0245 11.5H8C7.72386 11.5 7.5 11.7239 7.5 12V20C7.5 21.1046 8.39543 22 9.5 22H20.5C21.6046 22 22.5 21.1046 22.5 20V14.5C22.5 14.2239 22.2761 14 22 14H15.2169C15.0492 14 14.8926 13.9159 14.8 13.776L13.4414 11.724C13.3488 11.5841 13.1922 11.5 13.0245 11.5Z" stroke="white" stroke-miterlimit="10" stroke-linecap="square"/>
							<path d="M8.87939 9.5V8.5C8.87939 8.22386 9.10325 8 9.37939 8H20.6208C20.8969 8 21.1208 8.22386 21.1208 8.5V12" stroke="white" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/>
						</svg>
						<div class="mt-1">{{ __('Library') }}</div>
					</button>
					<button class="btn btn-file-upload" v-if="allow_web_link" @click="show_web_link = true">
						<svg width="30" height="30" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">
							<circle cx="15" cy="15" r="15" fill="#ECAC4B"/>
							<path d="M12.0469 17.9543L17.9558 12.0454" stroke="white" stroke-linecap="round" stroke-linejoin="round"/>
							<path d="M13.8184 11.4547L15.7943 9.47873C16.4212 8.85205 17.2714 8.5 18.1578 8.5C19.0443 8.5 19.8945 8.85205 20.5214 9.47873V9.47873C21.1481 10.1057 21.5001 10.9558 21.5001 11.8423C21.5001 12.7287 21.1481 13.5789 20.5214 14.2058L18.5455 16.1818" stroke="white" stroke-linecap="round" stroke-linejoin="round"/>
							<path d="M11.4547 13.8184L9.47873 15.7943C8.85205 16.4212 8.5 17.2714 8.5 18.1578C8.5 19.0443 8.85205 19.8945 9.47873 20.5214V20.5214C10.1057 21.1481 10.9558 21.5001 11.8423 21.5001C12.7287 21.5001 13.5789 21.1481 14.2058 20.5214L16.1818 18.5455" stroke="white" stroke-linecap="round" stroke-linejoin="round"/>
						</svg>
						<div class="mt-1">{{ __('Link') }}</div>
					</button>
					<button v-if="allow_take_photo" class="btn btn-file-upload" @click="capture_image">
						<svg width="30" height="30" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">
							<circle cx="15" cy="15" r="15" fill="#CE315B"/>
							<path d="M11.5 10.5H9.5C8.67157 10.5 8 11.1716 8 12V20C8 20.8284 8.67157 21.5 9.5 21.5H20.5C21.3284 21.5 22 20.8284 22 20V12C22 11.1716 21.3284 10.5 20.5 10.5H18.5L17.3 8.9C17.1111 8.64819 16.8148 8.5 16.5 8.5H13.5C13.1852 8.5 12.8889 8.64819 12.7 8.9L11.5 10.5Z" stroke="white" stroke-linejoin="round"/>
							<circle cx="15" cy="16" r="2.5" stroke="white"/>
						</svg>
						<div class="mt-1">{{ __('Camera') }}</div>
					</button>
					<button v-if="google_drive_settings.enabled" class="btn btn-file-upload" @click="show_google_drive_picker">
						<svg width="30" height="30">
							<image href="/assets/frappe/icons/social/google_drive.svg" width="30" height="30"/>
						</svg>
						<div class="mt-1">{{ __('Google Drive') }}</div>
					</button>
				</div>
				<div class="text-muted text-medium">
					{{ upload_notes }}
				</div>
			</div>
			<div v-else>
				{{ __('Drop files here') }}
			</div>
		</div>
		<div class="file-preview-area" v-show="files.length && !show_file_browser && !show_web_link">
			<div class="file-preview-container" v-if="!show_image_cropper">
				<FilePreview
					v-for="(file, i) in files"
					:key="file.name"
					:file="file"
					@remove="remove_file(file)"
					@toggle_private="file.private = !file.private"
					@toggle_optimize="file.optimize = !file.optimize"
					@toggle_image_cropper="toggle_image_cropper(i)"
				/>
			</div>
			<div class="flex align-center" v-if="show_upload_button && currently_uploading === -1">
				<button
					class="btn btn-primary btn-sm margin-right"
					@click="upload_files"
				>
					<span v-if="files.length === 1">
						{{ __('Upload file') }}
					</span>
					<span v-else>
						{{ __('Upload {0} files', [files.length]) }}
					</span>
				</button>
				<div class="text-muted text-medium">
					{{ __('Click on the lock icon to toggle public/private') }}
				</div>
			</div>
		</div>
		<ImageCropper
			v-if="show_image_cropper && wrapper_ready"
			:file="files[crop_image_with_index]"
			:fixed_aspect_ratio="restrictions.crop_image_aspect_ratio"
			@toggle_image_cropper="toggle_image_cropper(-1)"
			@upload_after_crop="trigger_upload=true"
		/>
		<FileBrowser
			ref="file_browser"
			v-if="show_file_browser && !disable_file_browser"
			@hide-browser="show_file_browser = false"
		/>
		<WebLink
			ref="web_link"
			v-if="show_web_link"
			@hide-web-link="show_web_link = false"
		/>
	</div>
</template>

<script>
import FilePreview from './FilePreview.vue';
import FileBrowser from './FileBrowser.vue';
import WebLink from './WebLink.vue';
import GoogleDrivePicker from '../../integrations/google_drive_picker';
import ImageCropper from './ImageCropper.vue';

export default {
	name: 'FileUploader',
	props: {
		show_upload_button: {
			default: true
		},
		disable_file_browser: {
			default: false
		},
		allow_multiple: {
			default: true
		},
		as_dataurl: {
			default: false
		},
		doctype: {
			default: null
		},
		docname: {
			default: null
		},
		fieldname: {
			default: null
		},
		folder: {
			default: 'Home'
		},
		method: {
			default: null
		},
		on_success: {
			default: null
		},
		make_attachments_public: {
			default: null,
		},
		restrictions: {
			default: () => ({
				max_file_size: null, // 2048 -> 2KB
				max_number_of_files: null,
				allowed_file_types: [], // ['image/*', 'video/*', '.jpg', '.gif', '.pdf'],
				crop_image_aspect_ratio: null // 1, 16 / 9, 4 / 3, NaN (free)
			})
		},
		attach_doc_image: {
			default: false
		},
		upload_notes: {
			default: null // "Images or video, upto 2MB"
		}
	},
	components: {
		FilePreview,
		FileBrowser,
		WebLink,
		ImageCropper
	},
	data() {
		return {
			files: [],
			is_dragging: false,
			currently_uploading: -1,
			show_file_browser: false,
			show_web_link: false,
			show_image_cropper: false,
			crop_image_with_index: -1,
			trigger_upload: false,
			close_dialog: false,
			hide_dialog_footer: false,
			allow_take_photo: false,
			allow_web_link: true,
			google_drive_settings: {
				enabled: false
			},
			wrapper_ready: false
		}
	},
	created() {
		this.allow_take_photo = window.navigator.mediaDevices;
		if (frappe.user_id !== "Guest") {
			frappe.call({
				// method only available after login
				method: "frappe.integrations.doctype.google_settings.google_settings.get_file_picker_settings",
				callback: (resp) => {
					if (!resp.exc) {
						this.google_drive_settings = resp.message;
					}
				}
			});
		}
		if (this.restrictions.max_file_size == null) {
			frappe.call('frappe.core.api.file.get_max_file_size')
				.then(res => {
					this.restrictions.max_file_size = Number(res.message);
				});
		}
		if (this.restrictions.max_number_of_files == null && this.doctype) {
			this.restrictions.max_number_of_files = frappe.get_meta(this.doctype)?.max_attachments;
		}
	},
	watch: {
		files(newvalue, oldvalue) {
			if (!this.allow_multiple && newvalue.length > 1) {
				this.files = [newvalue[newvalue.length - 1]];
			}
		}
	},
	computed: {
		upload_complete() {
			return this.files.length > 0
				&& this.files.every(
					file => file.total !== 0 && file.progress === file.total);
		}
	},
	methods: {
		dragover() {
			this.is_dragging = true;
		},
		dragleave() {
			this.is_dragging = false;
		},
		dropfiles(e) {
			this.is_dragging = false;
			this.add_files(e.dataTransfer.files);
		},
		browse_files() {
			this.$refs.file_input.click();
		},
		on_file_input(e) {
			this.add_files(this.$refs.file_input.files);
		},
		remove_file(file) {
			this.files = this.files.filter(f => f !== file);
		},
		toggle_image_cropper(index) {
			this.crop_image_with_index = this.show_image_cropper ? -1 : index;
			this.hide_dialog_footer = !this.show_image_cropper;
			this.show_image_cropper = !this.show_image_cropper;
		},
		toggle_all_private() {
			let flag;
			let private_values = this.files.filter(file => file.private);
			if (private_values.length < this.files.length) {
				// there are some private and some public
				// set all to private
				flag = true;
			} else {
				// all are private, set all to public
				flag = false;
			}
			this.files = this.files.map(file => {
				file.private = flag;
				return file;
			});
		},
		show_max_files_number_warning(file) {
			console.warn(
				\`File skipped because it exceeds the allowed specified limit of \${max_number_of_files} uploads\`,
				file,
			);
			if (this.doctype) {
				MSG = __('File "{0}" was skipped because only {1} uploads are allowed for DocType "{2}"', [file.name, max_number_of_files, this.doctype])
			} else {
				MSG = __('File "{0}" was skipped because only {1} uploads are allowed', [file.name, max_number_of_files])
			}
			frappe.show_alert({
				message: MSG,
				indicator: "orange",
			});
		},
		add_files(file_array) {
			let files = Array.from(file_array)
				.filter(this.check_restrictions)
				.map(file => {
					let is_image = file.type.startsWith('image');
					let size_kb = file.size / 1024;
					return {
						file_obj: file,
						cropper_file: file,
						crop_box_data: null,
						optimize: size_kb > 200 && is_image && !file.type.includes('svg'),
						name: file.name,
						doc: null,
						progress: 0,
						total: 0,
						failed: false,
						request_succeeded: false,
						error_message: null,
						uploading: false,
						private: !this.make_attachments_public,
					};
				});

			// pop extra files as per FileUploader.restrictions.max_number_of_files
			max_number_of_files = this.restrictions.max_number_of_files;
			if (max_number_of_files && files.length > max_number_of_files) {
				files.slice(max_number_of_files).forEach(file => {
					this.show_max_files_number_warning(file, this.doctype);
				});

				files = files.slice(0, max_number_of_files);
			}

			this.files = this.files.concat(files);
			// if only one file is allowed and crop_image_aspect_ratio is set, open cropper immediately
			if (this.files.length === 1 && !this.allow_multiple && this.restrictions.crop_image_aspect_ratio != null) {
				if (!this.files[0].file_obj.type.includes('svg')) {
					this.toggle_image_cropper(0);
				}
			}
		},
		check_restrictions(file) {
			let { max_file_size, allowed_file_types = [] } = this.restrictions;

			let is_correct_type = true;
			let valid_file_size = true;

			if (allowed_file_types && allowed_file_types.length) {
				is_correct_type = allowed_file_types.some((type) => {
					// is this is a mime-type
					if (type.includes('/')) {
						if (!file.type) return false;
						return file.type.match(type);
					}

					// otherwise this is likely an extension
					if (type[0] === '.') {
						return file.name.endsWith(type);
					}
					return false;
				});
			}

			if (max_file_size && file.size != null) {
				valid_file_size = file.size < max_file_size;
			}

			if (!is_correct_type) {
				console.warn('File skipped because of invalid file type', file);
				frappe.show_alert({
					message: __('File "{0}" was skipped because of invalid file type', [file.name]),
					indicator: 'orange'
				});
			}
			if (!valid_file_size) {
				console.warn('File skipped because of invalid file size', file.size, file);
				frappe.show_alert({
					message: __('File "{0}" was skipped because size exceeds {1} MB', [file.name, max_file_size / (1024 * 1024)]),
					indicator: 'orange'
				});
			}

			return is_correct_type && valid_file_size;
		},
		upload_files() {
			if (this.show_file_browser) {
				return this.upload_via_file_browser();
			}
			if (this.show_web_link) {
				return this.upload_via_web_link();
			}
			if (this.as_dataurl) {
				return this.return_as_dataurl();
			}
			return frappe.run_serially(
				this.files.map(
					(file, i) =>
						() => this.upload_file(file, i)
				)
			);
		},
		upload_via_file_browser() {
			let selected_file = this.$refs.file_browser.selected_node;
			if (!selected_file.value) {
				frappe.msgprint(__('Click on a file to select it.'));
				this.close_dialog = true;
				return Promise.reject();
			}
			this.close_dialog = true;
			return this.upload_file({
				file_url: selected_file.file_url
			});
		},
		upload_via_web_link() {
			let file_url = this.$refs.web_link.url;
			if (!file_url) {
				frappe.msgprint(__('Invalid URL'));
				this.close_dialog = true;
				return Promise.reject();
			}
			file_url = decodeURI(file_url)
			this.close_dialog = true;
			return this.upload_file({
				file_url
			});
		},
		return_as_dataurl() {
			let promises = this.files.map(file =>
				frappe.dom.file_to_base64(file.file_obj)
					.then(dataurl => {
						file.dataurl = dataurl;
						this.on_success && this.on_success(file);
					})
			);
			this.close_dialog = true;
			return Promise.all(promises);
		},
		upload_file(file, i) {
			this.currently_uploading = i;

			return new Promise((resolve, reject) => {
				let xhr = new XMLHttpRequest();
				xhr.upload.addEventListener('loadstart', (e) => {
					file.uploading = true;
				})
				xhr.upload.addEventListener('progress', (e) => {
					if (e.lengthComputable) {
						file.progress = e.loaded;
						file.total = e.total;
					}
				})
				xhr.upload.addEventListener('load', (e) => {
					file.uploading = false;
					resolve();
				})
				xhr.addEventListener('error', (e) => {
					file.failed = true;
					reject();
				})
				xhr.onreadystatechange = () => {
					if (xhr.readyState == XMLHttpRequest.DONE) {
						if (xhr.status === 200) {
							file.request_succeeded = true;
							let r = null;
							let file_doc = null;
							try {
								r = JSON.parse(xhr.responseText);
								if (r.message.doctype === 'File') {
									file_doc = r.message;
								}
							} catch(e) {
								r = xhr.responseText;
							}

							file.doc = file_doc;

							if (this.on_success) {
								this.on_success(file_doc, r);
							}

							if (i == this.files.length - 1 && this.files.every(file => file.request_succeeded)) {
								this.close_dialog = true;
							}

						} else if (xhr.status === 403) {
							file.failed = true;
							let response = JSON.parse(xhr.responseText);
							file.error_message = \`Not permitted. \${response._error_message || ''}\`;

						} else if (xhr.status === 413) {
							file.failed = true;
							file.error_message = 'Size exceeds the maximum allowed file size.';

						} else {
							file.failed = true;
							file.error_message = xhr.status === 0 ? 'XMLHttpRequest Error' : \`\${xhr.status} : \${xhr.statusText}\`;

							let error = null;
							try {
								error = JSON.parse(xhr.responseText);
							} catch(e) {
								// pass
							}
							frappe.request.cleanup({}, error);
						}
					}
				}
				xhr.open('POST', '/api/method/upload_file', true);
				xhr.setRequestHeader('Accept', 'application/json');
				xhr.setRequestHeader('X-Frappe-CSRF-Token', frappe.csrf_token);

				let form_data = new FormData();
				if (file.file_obj) {
					form_data.append('file', file.file_obj, file.name);
				}
				form_data.append('is_private', +file.private);
				form_data.append('folder', this.folder);

				if (file.file_url) {
					form_data.append('file_url', file.file_url);
				}

				if (file.file_name) {
					form_data.append('file_name', file.file_name);
				}

				if (this.doctype && this.docname) {
					form_data.append('doctype', this.doctype);
					form_data.append('docname', this.docname);
				}

				if (this.fieldname) {
					form_data.append('fieldname', this.fieldname);
				}

				if (this.method) {
					form_data.append('method', this.method);
				}

				if (file.optimize) {
					form_data.append('optimize', true);
				}

				if (this.attach_doc_image) {
					form_data.append('max_width', 200);
					form_data.append('max_height', 200);
				}

				xhr.send(form_data);
			});
		},
		capture_image() {
			const capture = new frappe.ui.Capture({
				animate: false,
				error: true
			});
			capture.show();
			capture.submit(data_urls => {
				data_urls.forEach(data_url => {
					let filename = \`capture_\${frappe.datetime.now_datetime().replaceAll(/[: -]/g, '_')}.png\`;
					this.url_to_file(data_url, filename, 'image/png').then((file) =>
						this.add_files([file])
					);
				});
			});
		},
		show_google_drive_picker() {
			this.close_dialog = true;
			let google_drive = new GoogleDrivePicker({
				pickerCallback: data => this.google_drive_callback(data),
				...this.google_drive_settings
			});
			google_drive.loadPicker();
		},
		google_drive_callback(data) {
			if (data.action == google.picker.Action.PICKED) {
				this.upload_file({
					file_url: data.docs[0].url,
					file_name: data.docs[0].name
				});
			} else if (data.action == google.picker.Action.CANCEL) {
				cur_frm.attachments.new_attachment()
			}
		},
		url_to_file(url, filename, mime_type) {
			return fetch(url)
					.then(res => res.arrayBuffer())
					.then(buffer => new File([buffer], filename, { type: mime_type }));
		},
	}
}
<\/script>
<style>
.file-upload-area {
	min-height: 16rem;
	display: flex;
	align-items: center;
	justify-content: center;
	border: 1px dashed var(--dark-border-color);
	border-radius: var(--border-radius);
	cursor: pointer;
	background-color: var(--bg-color);
}

.btn-file-upload {
	background-color: transparent;
	border: none;
	box-shadow: none;
	font-size: var(--text-xs);
}
</style>
`]},media:void 0})},k0=void 0,x0=void 0,C0=!1;function S0(r,t,e,i,n,o,a,s,l,u){let c=(typeof e=="function"?e.options:e)||{};c.__file="frappe/public/js/frappe/file_uploader/FileUploader.vue",c.render||(c.render=r.render,c.staticRenderFns=r.staticRenderFns,c._compiled=!0,n&&(c.functional=!0)),c._scopeId=i;{let h;if(t&&(h=a?function(p){t.call(this,u(p,this.$root.$options.shadowRoot))}:function(p){t.call(this,s(p))}),h!==void 0)if(c.functional){let p=c.render;c.render=function(b,v){return h.call(v),p(b,v)}}else{let p=c.beforeCreate;c.beforeCreate=p?[].concat(p,h):[h]}}return c}function Fo(){let r=Fo.styles||(Fo.styles={}),t=typeof navigator!="undefined"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(i,n){if(document.querySelector('style[data-vue-ssr-id~="'+i+'"]'))return;let o=t?n.media||"default":i,a=r[o]||(r[o]={ids:[],parts:[],element:void 0});if(!a.ids.includes(i)){let s=n.source,l=a.ids.length;if(a.ids.push(i),t&&(a.element=a.element||document.querySelector("style[data-group="+o+"]")),!a.element){let u=document.head||document.getElementsByTagName("head")[0],c=a.element=document.createElement("style");c.type="text/css",n.media&&c.setAttribute("media",n.media),t&&(c.setAttribute("data-group",o),c.setAttribute("data-next-index","0")),u.appendChild(c)}if(t&&(l=parseInt(a.element.getAttribute("data-next-index")),a.element.setAttribute("data-next-index",l+1)),a.element.styleSheet)a.parts.push(s),a.element.styleSheet.cssText=a.parts.filter(Boolean).join(`
`);else{let u=document.createTextNode(s),c=a.element.childNodes;c[l]&&a.element.removeChild(c[l]),c.length?a.element.insertBefore(u,c[l]):a.element.appendChild(u)}}}}var T0=S0({render:Bd,staticRenderFns:y0},w0,b0,k0,C0,x0,!1,Fo,void 0,void 0),Id=T0;var un=class{constructor({wrapper:t,method:e,on_success:i,doctype:n,docname:o,fieldname:a,files:s,folder:l,restrictions:u={},upload_notes:c,allow_multiple:h,as_dataurl:p,disable_file_browser:g,dialog_title:b,attach_doc_image:v,frm:k,make_attachments_public:C}={}){k&&k.attachments.max_reached(!0),t?this.wrapper=t.get?t.get(0):t:this.make_dialog(b),this.$fileuploader=new Vue({el:this.wrapper,render:O=>O(Id,{props:{show_upload_button:!Boolean(this.dialog),doctype:n,docname:o,fieldname:a,method:e,folder:l,on_success:i,restrictions:u,upload_notes:c,allow_multiple:h,as_dataurl:p,disable_file_browser:g,attach_doc_image:v,make_attachments_public:C}})}),this.uploader=this.$fileuploader.$children[0],this.dialog||(this.uploader.wrapper_ready=!0),this.uploader.$watch("files",O=>{let d=O.every(_=>_.private);this.dialog&&this.dialog.set_secondary_action_label(d?__("Set all public"):__("Set all private"))},{deep:!0}),this.uploader.$watch("trigger_upload",O=>{O&&this.upload_files()}),this.uploader.$watch("close_dialog",O=>{O&&this.dialog&&this.dialog.hide()}),this.uploader.$watch("hide_dialog_footer",O=>{O?(this.dialog&&this.dialog.footer.addClass("hide"),this.dialog.$wrapper.data("bs.modal")._config.backdrop="static"):(this.dialog&&this.dialog.footer.removeClass("hide"),this.dialog.$wrapper.data("bs.modal")._config.backdrop=!0)}),s&&s.length&&this.uploader.add_files(s)}upload_files(){return this.dialog&&this.dialog.get_primary_btn().prop("disabled",!0),this.dialog&&this.dialog.get_secondary_btn().prop("disabled",!0),this.uploader.upload_files()}make_dialog(t){this.dialog=new frappe.ui.Dialog({title:t||__("Upload"),primary_action_label:__("Upload"),primary_action:()=>this.upload_files(),secondary_action_label:__("Set all private"),secondary_action:()=>{this.uploader.toggle_all_private()},on_page_show:()=>{this.uploader.wrapper_ready=!0}}),this.wrapper=this.dialog.body,this.dialog.show(),this.dialog.$wrapper.on("hidden.bs.modal",function(){$(this).data("bs.modal",null),$(this).remove()})}};frappe.provide("frappe.ui");frappe.ui.FileUploader=un;frappe.provide("frappe.ui");frappe.ui.Tree=class{constructor({parent:r,label:t,root_value:e,icon_set:i,toolbar:n,expandable:o,with_skeleton:a=1,args:s,method:l,get_label:u,on_render:c,on_click:h}){$.extend(this,arguments[0]),e==null&&(this.root_value=t),this.setup_treenode_class(),this.nodes={},this.wrapper=$('<div class="tree">').appendTo(this.parent),a&&this.wrapper.addClass("with-skeleton"),i||(this.icon_set={open:frappe.utils.icon("folder-open","md"),closed:frappe.utils.icon("folder-normal","md"),leaf:frappe.utils.icon("primitive-dot","xs")}),this.setup_root_node()}get_nodes(r,t){var e=Object.assign({},this.args);return e.parent=r,e.is_root=t,new Promise(i=>{frappe.call({method:this.method,args:e,callback:n=>{this.on_get_node&&this.on_get_node(n.message),i(n.message)}})})}get_all_nodes(r,t,e){var i=Object.assign({},this.args);return i.label=e||r,i.parent=r,i.is_root=t,i.tree_method=this.method,new Promise(n=>{frappe.call({method:"frappe.desk.treeview.get_all_nodes",args:i,callback:o=>{this.on_get_node&&this.on_get_node(o.message,!0),n(o.message)}})})}setup_treenode_class(){let r=this;this.TreeNode=class{constructor({parent:t,label:e,parent_label:i,expandable:n,is_root:o,data:a}){$.extend(this,arguments[0]),this.loaded=0,this.expanded=0,this.parent_label&&(this.parent_node=r.nodes[this.parent_label]),r.nodes[this.label]=this,r.make_node_element(this),r.on_render&&r.on_render(this)}}}setup_root_node(){this.root_node=new this.TreeNode({parent:this.wrapper,label:this.label,parent_label:null,expandable:!0,is_root:!0,data:{value:this.root_value}}),this.expand_node(this.root_node,!1)}refresh(){this.selected_node.parent_node&&this.load_children(this.selected_node.parent_node,!0)}make_node_element(r){r.$tree_link=$('<span class="tree-link">').attr("data-label",r.label).data("node",r).appendTo(r.parent),r.$ul=$('<ul class="tree-children">').hide().appendTo(r.parent),this.make_icon_and_label(r),this.toolbar&&(r.$toolbar=this.get_toolbar(r).insertAfter(r.$tree_link))}add_node(r,t){var e=$('<li class="tree-node">');return new this.TreeNode({parent:e.appendTo(r.$ul),parent_label:r.label,label:t.value,title:t.title,expandable:t.expandable,data:t})}reload_node(r){return this.load_children(r)}toggle(){this.get_selected_node().toggle()}get_selected_node(){return this.selected_node}set_selected_node(r){this.selected_node=r}load_children(r,t=!1){let e=r.data.value,i=r.is_root;return t?frappe.run_serially([()=>this.get_all_nodes(e,i,r.label),n=>this.render_children_of_all_nodes(n),()=>this.set_selected_node(r)]):frappe.run_serially([()=>this.get_nodes(e,i),n=>this.render_node_children(r,n),()=>this.set_selected_node(r)])}render_children_of_all_nodes(r){r.map(t=>this.render_node_children(this.nodes[t.parent],t.data))}render_node_children(r,t){r.$ul.empty(),t&&$.each(t,(e,i)=>{var n=this.add_node(r,i);n.$tree_link.data("node-data",i).data("node",n)}),r.expanded=!1,r.loaded=!0,this.expand_node(r)}on_node_click(r){this.expand_node(r),frappe.dom.activate(this.wrapper,r.$tree_link,"tree-link"),r.$toolbar&&this.show_toolbar(r)}expand_node(r,t=!0){this.set_selected_node(r),t&&this.on_click&&this.on_click(r),r.expandable&&this.toggle_node(r),this.select_link(r),r.expanded=!r.expanded,r.parent.toggleClass("opened",r.expanded)}toggle_node(r){if(r.expandable&&this.get_nodes&&!r.loaded)return this.load_children(r);r.$ul&&(r.$ul.children().length&&r.$ul.toggle(!r.expanded),this.icon_set&&(r.expanded?r.$tree_link.find(".icon").parent().addClass("node-parent").html(this.icon_set.closed):r.$tree_link.find(".icon").parent().html(this.icon_set.open)))}select_link(r){this.wrapper.find(".selected").removeClass("selected"),r.$tree_link.toggleClass("selected")}show_toolbar(r){this.cur_toolbar&&$(this.cur_toolbar).hide(),this.cur_toolbar=r.$toolbar,r.$toolbar.show()}get_node_label(r){return this.get_label?this.get_label(r):r.title&&r.title!=r.label?__(r.title)+` <span class='text-muted'>(${r.label})</span>`:__(r.title||r.label)}make_icon_and_label(r){let t="";this.icon_set&&(r.expandable?t=`<span class="node-parent">${this.icon_set.closed}</span>`:t=`<span>${this.icon_set.leaf}</span>`),$(t).appendTo(r.$tree_link),$(`<a class="tree-label"> ${this.get_node_label(r)}</a>`).appendTo(r.$tree_link),r.$tree_link.on("click",()=>{setTimeout(()=>{this.on_node_click(r)},100)}),r.$tree_link.hover(function(){$(this).parent().addClass("hover-active")},function(){$(this).parent().removeClass("hover-active")})}get_toolbar(r){let t=$('<span class="tree-node-toolbar btn-group"></span>').hide();return Object.keys(this.toolbar).map(e=>{let i=this.toolbar[e];if(!!i.label&&!(i.condition&&!i.condition(r))){var n=i.get_label?i.get_label():i.label,o=$("<button class='btn btn-default btn-xs'></button>").html(n).addClass("tree-toolbar-button "+(i.btnClass||"")).appendTo(t);o.on("click",()=>{i.click(r)})}}),t}};frappe.provide("frappe.pages");frappe.provide("frappe.views");window.cur_page=null;frappe.views.Container=class{constructor(){this.container=$("#body").get(0),this.page=null,this.pagewidth=$(this.container).width(),this.pagemargin=50;var t=this;$(document).on("page-change",function(){var e=frappe.get_route_str();$("body").attr("data-route",e),$("body").attr("data-sidebar",t.has_sidebar()?1:0)}),$(document).bind("rename",function(e,i,n,o){frappe.breadcrumbs.rename(i,n,o)})}add_page(t){var e=$('<div class="content page-container"></div>').attr("id","page-"+t).attr("data-page-route",t).hide().appendTo(this.container).get(0);return e.label=t,frappe.pages[t]=e,e}change_to(t){if(cur_page=this,t.tagName)var e=t;else var e=frappe.pages[t];if(!e){console.log(__("Page not found")+": "+t);return}return window.cur_dialog&&cur_dialog.display&&!cur_dialog.keep_open&&(cur_dialog.minimizable?cur_dialog.is_minimized||cur_dialog.toggle_minimize():cur_dialog.hide()),this.page&&this.page!=e&&($(this.page).hide(),$(this.page).trigger("hide")),(!this.page||this.page!=e)&&(this.page=e,$(this.page).show()),$(document).trigger("page-change"),this.page._route=frappe.router.get_sub_path(),$(this.page).trigger("show"),!this.page.disable_scroll_to_top&&frappe.utils.scroll_to(0),frappe.breadcrumbs.update(),this.page}has_sidebar(){var t=0,e=frappe.get_route_str();if(t=frappe.ui.pages[e]&&!frappe.ui.pages[e].single_column,!t){var i=e.split("/").slice(0,2).join("/");t=$(`.page-container[data-page-route="${i}"] .layout-side-section`).length?1:0}return t}};frappe.breadcrumbs={all:{},preferred:{File:"",Dashboard:"Customization","Dashboard Chart":"Customization","Dashboard Chart Source":"Customization"},module_map:{Core:"Settings",Email:"Settings",Custom:"Settings",Workflow:"Settings",Printing:"Settings",Setup:"Settings","Event Streaming":"Tools",Automation:"Tools"},set_doctype_module(r,t){localStorage["preferred_breadcrumbs:"+r]=t},get_doctype_module(r){return localStorage["preferred_breadcrumbs:"+r]},add(r,t,e){let i;typeof r=="object"?i=r:i={module:r,doctype:t,type:e},this.all[frappe.breadcrumbs.current_page()]=i,this.update()},current_page(){return frappe.get_route_str()},update(){var r=this.all[frappe.breadcrumbs.current_page()];if(this.clear(),!r)return this.toggle(!1);if(r.type==="Custom")this.set_custom_breadcrumbs(r);else{this.set_workspace_breadcrumb(r);let t=frappe.get_route()[0];t=t?t.toLowerCase():null,r.doctype&&["print","form"].includes(t)?(this.set_list_breadcrumb(r),this.set_form_breadcrumb(r,t)):r.doctype&&t==="list"?this.set_list_breadcrumb(r):r.doctype&&t=="dashboard-view"&&(this.set_list_breadcrumb(r),this.set_dashboard_breadcrumb(r))}this.toggle(!0)},set_custom_breadcrumbs(r){let t=`<li><a href="${r.route}">${r.label}</a></li>`;this.$breadcrumbs.append(t)},set_workspace_breadcrumb(r){r.workspace||this.set_workspace(r),r.workspace&&!r.module_info.blocked&&frappe.visible_modules.includes(r.module_info.module)&&$(`<li><a href="/app/${frappe.router.slug(r.workspace)}">${__(r.workspace)}</a></li>`).appendTo(this.$breadcrumbs)},set_workspace(r){this.setup_modules();var t=this.get_doctype_module(r.doctype);t?r.module=t:this.preferred[r.doctype]!==void 0&&(r.module=this.preferred[r.doctype]),r.module&&(this.module_map[r.module]&&(r.module=this.module_map[r.module]),r.module_info=frappe.get_module(r.module),r.module_info&&frappe.boot.module_page_map[r.module]&&(r.workspace=frappe.boot.module_page_map[r.module]))},set_list_breadcrumb(r){let t=r.doctype,e=frappe.get_doc("DocType",t);if(!(t==="User"&&!frappe.user.has_role("System Manager")||e&&e.issingle)){let i,n=frappe.router.slug(frappe.router.doctype_layout||t);if(frappe.boot.treeviews.indexOf(t)!==-1){let o=frappe.model.user_settings[t].last_view||"Tree";i=`${n}/view/${o}`}else i=n;$(`<li><a href="/app/${i}">${__(t)}</a></li>`).appendTo(this.$breadcrumbs)}},set_form_breadcrumb(r,t){let e=r.doctype,i=frappe.get_route().slice(2).join("/"),n=`/app/${frappe.router.slug(e)}/${i}`;if($(`<li><a href="${n}">${__(i)}</a></li>`).appendTo(this.$breadcrumbs),t==="form"){let o=this.$breadcrumbs.find("li").last();o.addClass("disabled"),o.css("cursor","copy"),o.click(a=>{a.stopImmediatePropagation(),frappe.utils.copy_to_clipboard(o.text())})}},set_dashboard_breadcrumb(r){let t=r.doctype,e=frappe.get_route()[1],i=`/app/${frappe.router.slug(t)}/${e}`;$(`<li><a href="${i}">${__(e)}</a></li>`).appendTo(this.$breadcrumbs)},setup_modules(){frappe.visible_modules||(frappe.visible_modules=$.map(frappe.boot.allowed_workspaces,r=>r.module))},rename(r,t,e){var i=["Form",r,t].join("/"),n=["Form",r,e].join("/");this.all[n]=this.all[i],delete frappe.breadcrumbs.all[i],this.update()},clear(){this.$breadcrumbs=$("#navbar-breadcrumbs").empty()},toggle(r){r?$("body").addClass("no-breadcrumbs"):$("body").removeClass("no-breadcrumbs")}};frappe.provide("frappe.pages");frappe.provide("frappe.views");frappe.views.Factory=class{constructor(t){$.extend(this,t)}show(){this.route=frappe.get_route(),this.page_name=frappe.get_route_str(),!(this.before_show&&this.before_show()===!1)&&(frappe.pages[this.page_name]?(frappe.container.change_to(this.page_name),this.on_show&&this.on_show()):this.route[1]?this.make(this.route):frappe.show_not_found(this.route))}make_page(t,e){return frappe.make_page(t,e)}};frappe.make_page=function(r,t){t||(t=frappe.get_route_str());let e=frappe.container.add_page(t);return frappe.ui.make_app_page({parent:e,single_column:!r}),frappe.container.change_to(t),e};frappe.provide("frappe.views.pageview");frappe.provide("frappe.standard_pages");frappe.views.pageview={with_page:function(r,t){if(frappe.standard_pages[r]){frappe.pages[r]||frappe.standard_pages[r](),t();return}if(locals.Page&&locals.Page[r]&&locals.Page[r].script||r==window.page_name)t();else if(localStorage["_page:"+r]&&frappe.boot.developer_mode!=1)frappe.model.sync(JSON.parse(localStorage["_page:"+r])),t();else if(r)return frappe.call({method:"frappe.desk.desk_page.getpage",args:{name:r},callback:function(e){e.docs._dynamic_page||(localStorage["_page:"+r]=JSON.stringify(e.docs)),t()},freeze:!0})},show:function(r){r||(r=frappe.boot?frappe.boot.home_page:window.page_name),frappe.model.with_doctype("Page",function(){frappe.views.pageview.with_page(r,function(t){t&&t.exc?t["403"]||frappe.show_not_found(r):frappe.pages[r]||new frappe.views.Page(r),frappe.container.change_to(r)})})}};frappe.views.Page=class{constructor(t){this.name=t;var e=this;if(t==window.page_name)this.wrapper=document.getElementById("page-"+t),this.wrapper.label=document.title||window.page_name,this.wrapper.page_name=window.page_name,frappe.pages[window.page_name]=this.wrapper;else{if(this.pagedoc=locals.Page[this.name],!this.pagedoc){frappe.show_not_found(t);return}this.wrapper=frappe.container.add_page(this.name),this.wrapper.page_name=this.pagedoc.name,this.pagedoc.content&&(this.wrapper.innerHTML=this.pagedoc.content),frappe.dom.eval(this.pagedoc.__script||this.pagedoc.script||""),frappe.dom.set_style(this.pagedoc.style||""),frappe.breadcrumbs.add(this.pagedoc.module||null)}this.trigger_page_event("on_page_load"),$(this.wrapper).on("show",function(){window.cur_frm=null,e.trigger_page_event("on_page_show"),e.trigger_page_event("refresh")})}trigger_page_event(t){var e=this;e.wrapper[t]&&e.wrapper[t](e.wrapper)}};frappe.show_not_found=function(r){frappe.show_message_page({page_name:r,message:__("Sorry! I could not find what you were looking for."),img:"/assets/frappe/images/ui/bubble-tea-sorry.svg"})};frappe.show_not_permitted=function(r){frappe.show_message_page({page_name:r,message:__("Sorry! You are not permitted to view this page."),img:"/assets/frappe/images/ui/bubble-tea-sorry.svg"})};frappe.show_message_page=function(r){r.page_name||(r.page_name=frappe.get_route_str()),r.icon?r.img=repl('<span class="%(icon)s message-page-icon"></span> ',r):r.img&&(r.img=repl('<img src="%(img)s" class="message-page-image">',r));var t=frappe.pages[r.page_name]||frappe.container.add_page(r.page_name);$(t).html(repl('<div class="page message-page">			<div class="text-center message-page-content">				%(img)s				<p class="lead">%(message)s</p>				<a class="btn btn-default btn-sm btn-home" href="/app">%(home)s</a>			</div>		</div>',{img:r.img||"",message:r.message||"",home:__("Home")})),frappe.container.change_to(r.page_name)};var jA=Vt(Md());frappe.provide("frappe.search");frappe.ui.Notifications=class{constructor(){this.tabs={},this.notification_settings=frappe.boot.notification_settings,this.make()}make(){this.dropdown=$(".navbar").find(".dropdown-notifications").removeClass("hidden"),this.dropdown_list=this.dropdown.find(".notifications-list"),this.header_items=this.dropdown_list.find(".header-items"),this.header_actions=this.dropdown_list.find(".header-actions"),this.body=this.dropdown_list.find(".notification-list-body"),this.panel_events=this.dropdown_list.find(".panel-events"),this.panel_notifications=this.dropdown_list.find(".panel-notifications"),this.user=frappe.session.user,this.setup_headers(),this.setup_dropdown_events()}setup_headers(){$(`<span class="notification-settings pull-right" data-action="go_to_settings">
			${frappe.utils.icon("setting-gear")}
		</span>`).on("click",i=>{i.stopImmediatePropagation(),this.dropdown.dropdown("hide"),frappe.set_route("Form","Notification Settings",frappe.session.user)}).appendTo(this.header_actions).attr("title",__("Notification Settings")).tooltip({delay:{show:600,hide:100},trigger:"hover"}),$(`<span class="mark-all-read pull-right" data-action="mark_all_as_read">
			${frappe.utils.icon("mark-as-read")}
		</span>`).on("click",i=>this.mark_all_as_read(i)).appendTo(this.header_actions).attr("title",__("Mark all as read")).tooltip({delay:{show:600,hide:100},trigger:"hover"}),this.categories=[{label:__("Notifications"),id:"notifications",view:Nd,el:this.panel_notifications},{label:__("Today's Events"),id:"todays_events",view:Pd,el:this.panel_events}];let t=i=>`<li class="notifications-category ${i.id=="notifications"?"active":""}"
					id="${i.id}"
					data-toggle="collapse"
				>${i.label}</li>`,e=$('<ul class="notification-item-tabs nav nav-tabs" role="tablist"></ul>');this.categories=this.categories.map(i=>(i.$tab=$(t(i)),i.$tab.on("click",n=>{n.stopImmediatePropagation(),this.switch_tab(i)}),e.append(i.$tab),i)),e.appendTo(this.header_items),this.categories.forEach(i=>{this.make_tab_view(i)}),this.switch_tab(this.categories[0])}switch_tab(t){this.categories.forEach(e=>{e.$tab.removeClass("active")}),t.$tab.addClass("active"),Object.keys(this.tabs).forEach(e=>this.tabs[e].hide()),this.tabs[t.id].show()}make_tab_view(t){let e=new t.view(t.el,this.dropdown,this.notification_settings);this.tabs[t.id]=e}mark_all_as_read(t){t.stopImmediatePropagation(),this.dropdown_list.find(".unread").removeClass("unread"),frappe.call("frappe.desk.doctype.notification_log.notification_log.mark_all_as_read")}setup_dropdown_events(){this.dropdown.on("hide.bs.dropdown",t=>{let e=$(t.currentTarget).data("closable");return $(t.currentTarget).data("closable",!0),e}),this.dropdown.on("click",t=>{$(t.currentTarget).data("closable",!0)})}};frappe.ui.notifications={get_notification_config(){return frappe.xcall("frappe.desk.notifications.get_notification_info").then(r=>(frappe.ui.notifications.config=r,r))},show_open_count_list(r){frappe.ui.notifications.config?this.route_to_list_with_filters(r):this.get_notification_config().then(()=>{this.route_to_list_with_filters(r)})},route_to_list_with_filters(r){let t=frappe.ui.notifications.config.conditions[r];t&&$.isPlainObject(t)&&(frappe.route_options||(frappe.route_options={}),$.extend(frappe.route_options,t)),frappe.set_route("List",r)}};var Ho=class{constructor(t,e,i){this.wrapper=t,this.parent=e,this.settings=i,this.max_length=20,this.container=$("<div></div>").appendTo(this.wrapper),this.make()}show(){this.container.show()}hide(){this.container.hide()}},Nd=class extends Ho{make(){this.notifications_icon=this.parent.find(".notifications-icon"),this.notifications_icon.attr("title",__("Notifications")).tooltip({delay:{show:600,hide:100},trigger:"hover"}),this.setup_notification_listeners(),this.get_notifications_list(this.max_length).then(t=>{!t.message||(this.dropdown_items=t.message.notification_logs,frappe.update_user_info(t.message.user_info),this.render_notifications_dropdown(),this.settings.seen==0&&this.dropdown_items.length>0&&this.toggle_notification_icon(!1))})}update_dropdown(){this.get_notifications_list(1).then(t=>{if(!t.message)return;let e=t.message.notification_logs[0];frappe.update_user_info(t.message.user_info),this.dropdown_items.unshift(e),this.dropdown_items.length>this.max_length&&(this.container.find(".recent-notification").last().remove(),this.dropdown_items.pop()),this.insert_into_dropdown()})}change_activity_status(){this.container.find(".activity-status")&&this.container.find(".activity-status").replaceWith(`<a class="recent-item text-center text-muted"
					href="/app/List/Notification Log">
					<div class="full-log-btn">${__("View Full Log")}</div>
				</a>`)}mark_as_read(t,e){frappe.call("frappe.desk.doctype.notification_log.notification_log.mark_as_read",{docname:t}).then(()=>{e.removeClass("unread")})}insert_into_dropdown(){let t=this.dropdown_items[0],e=this.get_dropdown_item_html(t);$(e).prependTo(this.container),this.change_activity_status()}get_dropdown_item_html(t){let e=this.get_item_link(t),i=t.read?"":"unread",n=t.subject,o=n.match(/<b class="subject-title">(.*?)<\/b>/);n=o?n.replace(o[1],frappe.ellipsis(strip_html(o[1]),100)):n;let a=frappe.datetime.comment_when(t.creation),s=`<div class="message">
			<div>${n}</div>
			<div class="notification-timestamp text-muted">
				${a}
			</div>
		</div>`,l=t.from_user,u=frappe.avatar(l,"avatar-medium user-avatar"),c=$(`<a class="recent-item notification-item ${i}"
				href="${e}"
				data-name="${t.name}"
			>
				<div class="notification-body">
					${u}
					${s}
				</div>
				<div class="mark-as-read" title="${__("Mark as Read")}">
				</div>
			</a>`);if(!t.read){let h=c.find(".mark-as-read");h.tooltip({delay:{show:600,hide:100},trigger:"hover"}),h.on("click",p=>{p.preventDefault(),p.stopImmediatePropagation(),this.mark_as_read(t.name,c)})}return c.on("click",()=>{!t.read&&this.mark_as_read(t.name,c),this.notifications_icon.trigger("click")}),c}render_notifications_dropdown(){this.settings&&!this.settings.enabled?this.container.html(`<li class="recent-item notification-item">
				<span class="text-muted">
					${__("Notifications Disabled")}
				</span></li>`):this.dropdown_items.length?(this.container.empty(),this.dropdown_items.forEach(t=>{this.container.append(this.get_dropdown_item_html(t))}),this.container.append(`<a class="list-footer"
					href="/app/List/Notification Log">
						<div class="full-log-btn">${__("See all Activity")}</div>
					</a>`)):this.container.append($(`<div class="notification-null-state">
					<div class="text-center">
						<img src="/assets/frappe/images/ui-states/notification-empty-state.svg" alt="Generic Empty State" class="null-state">
						<div class="title">${__("No New notifications")}</div>
						<div class="subtitle">
							${__("Looks like you haven\u2019t received any notifications.")}
					</div></div></div>`))}get_notifications_list(t){return frappe.call("frappe.desk.doctype.notification_log.notification_log.get_notification_logs",{limit:t})}get_item_link(t){let e=t.document_type?t.document_type:"Notification Log",i=t.document_name?t.document_name:t.name;return frappe.utils.get_form_link(e,i)}toggle_notification_icon(t){this.notifications_icon.find(".notifications-seen").toggle(t),this.notifications_icon.find(".notifications-unseen").toggle(!t)}toggle_seen(t){frappe.call("frappe.desk.doctype.notification_settings.notification_settings.set_seen_value",{value:cint(t),user:frappe.session.user})}setup_notification_listeners(){frappe.realtime.on("notification",()=>{this.toggle_notification_icon(!1),this.update_dropdown()}),frappe.realtime.on("indicator_hide",()=>{this.toggle_notification_icon(!0)}),this.parent.on("show.bs.dropdown",()=>{this.toggle_seen(!0),this.notifications_icon.find(".notifications-unseen").is(":visible")&&(this.toggle_notification_icon(!0),frappe.call("frappe.desk.doctype.notification_log.notification_log.trigger_indicator_hide"))})}},Pd=class extends Ho{make(){let t=frappe.datetime.get_today();frappe.xcall("frappe.desk.doctype.event.event.get_events",{start:t,end:t}).then(e=>{this.render_events_html(e)})}render_events_html(t){let e="";if(t.length){let i=n=>{let o=__("All Day");if(!n.all_day){let l=frappe.datetime.get_time(n.starts_on),u=frappe.datetime.get_day_diff(n.ends_on,n.starts_on),c=frappe.datetime.get_time(n.ends_on);u>1&&(c=__("Rest of the day")),o=`${l} - ${c}`}let a="";n.particpants&&(a=frappe.avatar_group(n.particpants,3));let s="";return n.location&&(s=`, ${n.location}`),`<a class="recent-item event" href="/app/event/${n.name}">
					<div class="event-border" style="border-color: ${n.color}"></div>
					<div class="event-item">
						<div class="event-subject">${n.subject}</div>
						<div class="event-time">${o}${s}</div>
						${a}
					</div>
				</a>`};e=t.map(i).join("")}else e=`
				<div class="notification-null-state">
					<div class="text-center">
					<img src="/assets/frappe/images/ui-states/event-empty-state.svg" alt="Generic Empty State" class="null-state">
					<div class="title">${__("No Upcoming Events")}</div>
					<div class="subtitle">
						${__("There are no upcoming events for you.")}
				</div></div></div>
			`;this.container.html(e)}};frappe.provide("frappe.search");frappe.search.SearchDialog=class{constructor(r){$.extend(this,r),this.make()}make(){this.search_dialog=new frappe.ui.Dialog({minimizable:!0,size:"large"}),this.set_header(),this.$wrapper=$(this.search_dialog.$wrapper).addClass("search-dialog"),this.$body=$(this.search_dialog.body),this.$input=this.$wrapper.find(".search-input"),this.setup()}set_header(){this.search_dialog.header.addClass("search-header").find(".title-section").html(`<div class="input-group text-muted">
					<input type="text" class="form-control search-input">
				</div>
				<span class="search-icon">
					${frappe.utils.icon("search")}
				</span>`)}setup(){this.modal_state=0,this.current_keyword="",this.more_count=20,this.full_lists={},this.nav_lists={},this.init_search_objects(),this.bind_input(),this.bind_events()}init_search_objects(){this.searches={global_search:{input_placeholder:__("Search"),empty_state_text:__("Search for anything"),no_results_status:()=>__("No Results found"),get_results:(r,t)=>{let e=0,i=1e3,n=frappe.search.utils.get_nav_results(r);frappe.search.utils.get_global_results(r,e,i).then(o=>{n=n.concat(o),t(n,r)},o=>{console.error(o)})}},tags:{input_placeholder:__("Search"),empty_state_text:__("Search for anything"),no_results_status:r=>"<div>"+__("No documents found tagged with {0}",[r])+"</div>",get_results:(r,t)=>{var e=frappe.search.utils.get_nav_results(r);frappe.tags.utils.get_tag_results(r).then(i=>{e=e.concat(i),t(e,r)},i=>{console.error(i)})}}}}update(r){this.$wrapper.find(".loading-state").addClass("hide"),this.$body.append(r),this.$body.find(".search-results").length>1?(this.$body.find(".search-results").first().addClass("hide"),r.removeClass("hide"),this.$body.find(".search-results").first().remove()):r.removeClass("hide")}put_placeholder(r){var t=$(`<div class="row search-results hide">
			<div class="empty-state">
				<div class="text-center">
					<img src="/assets/frappe/images/ui-states/search-empty-state.svg"
						alt="Generic Empty State"
						class="null-state"
					>
					<div class="empty-state-text">${r}</div>
				</div>
			</div>
		</div>`);this.update(t)}bind_input(){this.$input.on("input",r=>{let t=$(r.currentTarget);clearTimeout(t.data("timeout")),t.data("timeout",setTimeout(()=>{if(this.$input.val()===this.current_keyword)return;let e=this.$input.val();e.length>1?this.get_results(e):(this.current_keyword="",this.put_placeholder(this.search.empty_state_text))},300))})}bind_events(){this.$body.on("click",".list-link",r=>{let t=$(r.currentTarget);this.$body.find(".search-sidebar").find(".list-link").removeClass("active selected"),t.addClass("active selected");let e=t.attr("data-category");this.$body.find(".results-area").empty().html(this.full_lists[e]),this.$body.find(".module-section-link").first().focus()}),this.$body.on("click",".section-more",r=>{let e=$(r.currentTarget).attr("data-category");this.$body.find(".search-sidebar").find('*[data-category="'+e+'"]').trigger("click")}),this.$body.on("click",".all-results-link",()=>{this.$body.find(".search-sidebar").find('*[data-category="All Results"]').trigger("click")}),this.$body.on("click",".list-more",r=>{let t=$(r.currentTarget),e=t.attr("data-category"),i=t.attr("data-search");var n=this.$body.find(".result").length;if(i==="Global")frappe.search.utils.get_global_results(this.current_keyword,n,this.more_count,e).then(o=>{o.length&&this.add_more_results(o)},o=>{console.error(o)});else{let o=this.nav_lists[e].slice(0,this.more_count);this.nav_lists[e].splice(0,this.more_count),this.add_more_results([{title:e,results:o}])}}),this.$body.on("click",".switch-to-global-search",()=>{this.search=this.searches.global_search,this.$input.attr("placeholder",this.search.input_placeholder),this.put_placeholder(this.search.empty_state_text),this.get_results(this.current_keyword)})}init_search(r,t){this.search=this.searches[t],this.$input.attr("placeholder",this.search.input_placeholder),this.put_placeholder(this.search.empty_state_text),this.get_results(r),this.search_dialog.show(),this.$input.val(r),setTimeout(()=>this.$input.select(),500)}get_results(r){this.current_keyword=r,this.$body.find(".empty-state").length>0?this.put_placeholder(__("Searching ...")):this.$wrapper.find(".loading-state").removeClass("hide"),this.current_keyword.charAt(0)==="#"?this.search=this.searches.tags:this.search=this.searches.global_search,this.search.get_results(r,this.parse_results.bind(this))}parse_results(r,t){r=r.filter(function(e){return e.results.length>0}),r.length>0?this.render_data(r):this.put_placeholder(this.search.no_results_status(t))}render_data(r){let t=$(frappe.render_template("search")).addClass("hide"),e=t.find(".search-sidebar").empty(),i='<li class="search-sidebar-item standard-sidebar-item list-link" data-category="{0}"><a><span class="ellipsis">{1}</span></a></li>';this.modal_state=0,this.full_lists={"All Results":$('<div class="results-summary"></div>')},this.nav_lists={},r.forEach(n=>{e.append($(__(i,[n.title,__(n.title)]))),this.add_section_to_summary(n.title,n.results),this.full_lists[n.title]=this.render_full_list(n.title,n.results,n.fetch_type)}),r.length>1&&e.prepend($(__(i,["All Results",__("All Results")]))),this.update(t.clone()),this.$body.find(".list-link").first().trigger("click")}render_full_list(r,t,e){let i=20,n=$(`<div class="results-summary">
			<div class="result-section full-list ${r}-section col-sm-12">
				<div class="result-title"> ${__(r)}</div>
				<div class="result-body">
				</div>
			</div>
		</div>`);return t.slice(0,i).forEach(o=>{n.find(".result-body").append(this.render_result(r,o))}),t.length>0&&(e==="Nav"&&(this.nav_lists[r]=t),t.length>i&&$(`<a class="list-more" data-search="${e}"
					data-category="${r}" data-count="${i}">
						${__("More")}
				</a>`).appendTo(n.find(".result-body"))),n}add_section_to_summary(r,t){let e=4,i="",n=a=>this.render_result(r,a);t.length>e&&(i=`<div>
				<a class="section-more" data-category="${r}">${__("More")}</a>
			</div>`),$(`<div class="col-sm-12 result-section" data-type="${r}">
			<div class="result-title">${__(r)}</div>
			<div class="result-body">
				${i}
			</div>
		</div>`).appendTo(this.full_lists["All Results"]).find(".result-body").prepend(t.slice(0,e).map(n))}get_link(r){let t="";return r.route?t=`href="/app/${r.route.join("/")}"`:r.data_path&&(t=`data-path=${r.data_path}"`),t}render_result(r,t){let e="";if(t.image!==void 0){let s=frappe.get_avatar("avatar-medium",t.label,t.image);e=`<a ${this.get_link(t)}>
				<div class="result-image">
					${s}
				</div>
			</a>`}let i=`<a ${this.get_link(t)} class="result-section-link">${t.label}</a>`,o=`<div class="result-text">
			${t.description?`<b>${i}</b><div class="description"> ${t.description} </div>`:i}
		</div>`,a=$(`<div class="result ${r}-result">
			${e}
			${o}
			${t.subtypes||""}
		</div>`);return t.description||this.handle_result_click(t,a),a}handle_result_click(r,t){r.route_options&&(frappe.route_options=r.route_options),t.on("click",()=>{if(r.onclick)r.onclick(r.match);else{var e=window.location.hash;frappe.set_route(r.route),window.location.hash==e&&frappe.router.route()}})}add_more_results(r){let t=$('<div class="more-results last"></div>');if(r[0].results&&r[0].results.forEach(e=>{t.append(this.render_result(r[0].title,e))}),this.$body.find(".list-more").before(t),r[0].results.length<this.more_count){this.$body.find(".list-more").hide();let e=this.$body.find(".result").length,i=$('<div class="results-status">'+e+" results found</div>");this.$body.find(".more-results:last").append(i)}this.$body.find(".more-results.last").slideDown(200,function(){})}};frappe.provide("frappe.tags");frappe.tags.utils={get_tags:function(r){r=r.slice(1);let t=[];for(let e in frappe.tags.tags){let i=frappe.tags.tags[e],n=frappe.search.utils.fuzzy_search(r,i);n&&t.push({type:"Tag",label:__("#{0}",[frappe.search.utils.bolden_match_part(__(i),r)]),value:__("#{0}",[__(i)]),index:1+n,match:i,onclick(){frappe.searchdialog.search.init_search("#".concat(i),"tags")}})}return t},fetch_tags(){frappe.call({method:"frappe.desk.doctype.tag.tag.get_tags_list_for_awesomebar",callback:function(r){r&&r.message&&(frappe.tags.tags=$.extend([],r.message))}})},get_tag_results:function(r){function t(e){var i=[],n,o;function a(l){return i.find(function(u){return u.title===l})}function s(l){var u=110,c=null;if(l.length>u)c=l.slice(0,u)+"...";else{var h=l.length;c=l.slice(0,h)+"..."}return c}return e.forEach(function(l){var u="";l.content&&(u=s(l.content)),n={label:l.name,value:l.name,description:u,route:["Form",l.doctype,l.name]},o=a(l.doctype),o?o.results.push(n):(o={title:l.doctype,results:[n],fetch_type:"Global"},i.push(o))}),i}return new Promise(function(e){frappe.call({method:"frappe.desk.doctype.tag.tag.get_documents_for_tag",args:{tag:r},callback:function(i){i.message?e(t(i.message)):e([])}})})}};frappe.templates.search=`<div class="search-results flex">
	<div class="col-md-3 col-sm-3 hidden-xs layout-side-section">
		<ul class="overlay-sidebar list-unstyled search-sidebar"></ul>
	</div>
	<div class="col-md-9 col-sm-9 layout-main-section results-area">

	</div>
</div>
`;function qo(r,t){return Dd(r,t,0,0,null,[],256,0,0,10)}function Dd(r,t,e,i,n,o,a,s,l,u){let c=0;if(++l>=u)return[!1,c];if(e===r.length||i===t.length)return[!1,c];let h=!1,p=[],g=0,b=!0;for(;e<r.length&&i<t.length;){if(r[e].toLowerCase()===t[i].toLowerCase()){if(s>=a)return[!1,c];b&&n&&(o=[...n],b=!1);let k=[],[C,O]=Dd(r,t,e,i+1,o,k,a,s,l,u);C&&((!h||O>g)&&(p=[...k],g=O),h=!0),o[s++]=i,++e}++i}let v=e===r.length;if(v){c=100;let k=-5*o[0];k=k<-15?-15:k,c+=k;let C=t.length-s;c+=-1*C;for(let O=0;O<s;O++){let d=o[O];if(O>0){let _=o[O-1];d==_+1&&(c+=15)}if(d>0){let _=t[d-1],m=t[d];_!==_.toUpperCase()&&m!==m.toLowerCase()&&(c+=30),(_=="_"||_==" ")&&(c+=30)}else c+=15}return h&&(!v||g>c)?(o=[...p],c=g,[!0,c]):v?[!0,c]:[!1,c]}return[!1,c]}frappe.provide("frappe.search");frappe.search.utils={setup_recent:function(){this.recent=JSON.parse(frappe.boot.user.recent||"[]")||[]},get_recent_pages:function(r){r===null&&(r="");var t=this,e=[],i=[];function n(o,a,s){o.forEach(function(l,u){var c=$.isArray(l)?l[0]:l;if(c=__(c||"").toLowerCase().replace(/-/g," "),a===c||c.indexOf(a)!==-1){var h=s(l);h&&($.isPlainObject(h)&&(h=[h]),h.forEach(function(p){p.match=l,p.recent=!0}),i=h.concat(i))}})}return t.recent.forEach(function(o,a){e.push([o[1],["Form",o[0],o[1]]])}),e=e.reverse(),frappe.route_history.forEach(function(o,a){o[0]==="Form"?e.push([o[2],o]):["List","Tree","Workspaces","query-report"].includes(o[0])||o[2]==="Report"?o[1]&&e.push([o[1],o]):o[0]&&e.push([frappe.route_titles[o.join("/")]||o[0],o])}),n(e,r,function(o){var a={route:o[1]};if(o[1][0]==="Form")o[1].length>2&&o[1][1]!==o[1][2]?(a.label=__(o[1][1])+" "+o[1][2].bold(),a.value=__(o[1][1])+" "+o[1][2]):(a.label=__(o[1][1]).bold(),a.value=__(o[1][1]));else if(["List","Tree","Workspaces","query-report"].includes(o[1][0])&&o[1].length>1){var s=o[1][0],l=s;s==="Workspaces"?l="Workspace":(s==="query-report"||o[1][2]==="Report")&&(l="Report"),a.label=__(`{0} ${l}`,[__(o[1][1]).bold()]),a.value=__(`{0} ${l}`,[__(o[1][1])])}else o[0]?(a.label=o[0].bold(),a.value=o[0]):console.log("Illegal match",o);return a.index=80,a}),i},get_frequent_links(){let r=[];return frappe.boot.frequently_visited_links.forEach(t=>{let e=frappe.utils.get_route_label(t.route);r.push({route:t.route,label:e,value:e,index:t.count})}),r.length?r:this.get_recent_pages("")},get_search_in_list:function(r){var t=this,e=[];if(in_list(r.split(" "),"in")&&r.slice(-2)!=="in"){var i=r.split(" in ");frappe.boot.user.can_read.forEach(function(n){if(frappe.boot.user.can_search.includes(n)){var o=t.fuzzy_search(i[1],n);o&&e.push({type:"In List",label:__("Find {0} in {1}",[__(i[0]),t.bolden_match_part(__(n),i[1])]),value:__("Find {0} in {1}",[__(i[0]),__(n)]),route_options:{name:["like","%"+i[0]+"%"]},index:1+o,route:["List",n]})}})}return e},get_creatables:function(r){var t=this,e=[],i=r.split(" ")[0];return i.toLowerCase()===__("new")&&frappe.boot.user.can_create.forEach(function(n){var o=t.fuzzy_search(r.substr(4),n);o&&e.push({type:"New",label:__("New {0}",[t.bolden_match_part(__(n),r.substr(4))]),value:__("New {0}",[__(n)]),index:1+o,match:n,onclick:function(){frappe.new_doc(n,!0)}})}),e},get_doctypes:function(r){var t=this,e=[],i,n,o=function(a,s,l){let u=a==="List"&&n.endsWith("List"),c=t.bolden_match_part(__(n),r);if(u)var h=c;else h=__(`{0} ${u?"":a}`,[c]);return{type:a,label:h,value:__(`{0} ${a}`,[n]),index:i+l,match:n,route:s}};return frappe.boot.user.can_read.forEach(function(a){if(i=t.fuzzy_search(r,a),i){if(n=a,in_list(frappe.boot.single_types,a))e.push(o("",["Form",a,a],.05));else if(frappe.boot.user.can_search.includes(a)){if(in_list(frappe.boot.user.can_create,a)){var s=a;e.push({type:"New",label:__("New {0}",[t.bolden_match_part(__(a),r)]),value:__("New {0}",[__(a)]),index:i+.015,match:a,onclick:function(){frappe.new_doc(s,!0)}})}in_list(frappe.boot.treeviews,a)?e.push(o("Tree",["Tree",a],.05)):(e.push(o("List",["List",a],.05)),frappe.model.can_get_report(a)&&e.push(o("Report",["List",a,"Report"],.04)))}}}),e},get_reports:function(r){var t=this,e=[],i;return Object.keys(frappe.boot.user.all_reports).forEach(function(n){var o=t.fuzzy_search(r,n);if(o>0){var a=frappe.boot.user.all_reports[n];a.report_type=="Report Builder"?i=["List",a.ref_doctype,"Report",n]:i=["query-report",n],e.push({type:"Report",label:__("Report {0}",[t.bolden_match_part(__(n),r)]),value:__("Report {0}",[__(n)]),index:o,route:i})}}),e},get_pages:function(r){var t=this,e=[];this.pages={},$.each(frappe.boot.page_info,function(n,o){t.pages[o.title]=o,o.name=n}),Object.keys(this.pages).forEach(function(n){if(!(n=="Hub"||n=="hub")){var o=t.fuzzy_search(r,n);if(o){var a=t.pages[n];e.push({type:"Page",label:__("Open {0}",[t.bolden_match_part(__(n),r)]),value:__("Open {0}",[__(n)]),match:n,index:o,route:[a.route||a.name]})}}});var i="Calendar";return __("calendar").indexOf(r.toLowerCase())===0&&e.push({type:"Calendar",value:__("Open {0}",[__(i)]),index:t.fuzzy_search(r,"Calendar"),match:i,route:["List","Event",i]}),i="Hub",__("hub").indexOf(r.toLowerCase())===0&&e.push({type:"Hub",value:__("Open {0}",[__(i)]),index:t.fuzzy_search(r,"Hub"),match:i,route:[i,"Item"]}),__("email inbox").indexOf(r.toLowerCase())===0&&e.push({type:"Inbox",value:__("Open {0}",[__("Email Inbox")]),index:t.fuzzy_search(r,"email inbox"),match:i,route:["List","Communication","Inbox"]}),e},get_workspaces:function(r){var t=this,e=[];return frappe.boot.allowed_workspaces.forEach(function(i){var n=t.fuzzy_search(r,i.name);if(n>0){var o={type:"Workspace",label:__("Open {0}",[t.bolden_match_part(__(i.name),r)]),value:__("Open {0}",[__(i.name)]),index:n,route:[frappe.router.slug(i.name)]};e.push(o)}}),e},get_dashboards:function(r){var t=this,e=[];return frappe.boot.dashboards.forEach(function(i){var n=t.fuzzy_search(r,i.name);if(n>0){var o={type:"Dashboard",label:__("{0} Dashboard",[t.bolden_match_part(__(i.name),r)]),value:__("{0} Dashboard",[__(i.name)]),index:n,route:["dashboard-view",i.name]};e.push(o)}}),e},get_global_results:function(r,t,e,i=""){var n=this;function o(a){var s=[],l,u;function c(p){return s.find(function(g){return g.title===p})}function h(p,g){for(var b=p.split(" ||| "),v=300,k=120,C=[],O=0,d="",_=0;_<b.length;_++){var m=b[_];if(m.toLowerCase().indexOf(r)!==-1){if(m.indexOf(" &&& ")!==-1)var y=m.indexOf(" &&& "),x=m.slice(y+5);else var y=m.indexOf(" : "),x=m.slice(y+3);if(x.length>k){var S="",w=x.indexOf(r);S+=w<k/2?x.slice(0,w):"..."+x.slice(w-k/2,w),S+=x.slice(w,w+k/2),S+=w+k/2<x.length?"...":"",x=S}var E=m.slice(0,y),L=v-O;if(O+=E.length+x.length+2,O<v)d='<span class="field-name text-muted">'+n.bolden_match_part(E,r)+": </span> "+n.bolden_match_part(x,r),C.indexOf(d)===-1&&g!==x&&C.push(d);else{E.length<L?(L-=E.length,d='<span class="field-name text-muted">'+n.bolden_match_part(E,r)+": </span> ",x=x.slice(0,L),x=x.slice(0,x.lastIndexOf(" "))+" ...",d+=n.bolden_match_part(x,r),C.push(d)):C.push("...");break}}}return C.join(", ")}return a.forEach(function(p){l={label:p.name,value:p.name,description:h(p.content,p.name),route:["Form",p.doctype,p.name]},(p.image||p.image===null)&&(l.image=p.image),u=c(p.doctype),u?u.results.push(l):(u={title:p.doctype,results:[l],fetch_type:"Global"},s.push(u))}),s}return new Promise(function(a,s){frappe.call({method:"frappe.utils.global_search.search",args:{text:r,start:t,limit:e,doctype:i},callback:function(l){l.message?a(o(l.message)):a([])}})})},get_nav_results:function(r){function t(a){var s=[],l=[];return a.forEach(function(u){if(u.route){u.route[0]==="List"&&u.route[2]&&u.route.splice(2);var c=u.route.join("/");if(s.indexOf(c)===-1)s.push(c),l.push(u);else{var h=s.indexOf(c);l[h].index>u.index&&(l[h]=u)}}else l.push(u)}),l.sort(function(u,c){return c.index-u.index})}var e=[],i=[],n=t(this.get_doctypes(r));n.forEach(function(a){a.type===""?i.push(a):e.push(a)});var o=r.split(" in ")[0];return[{title:__("Recents"),fetch_type:"Nav",results:t(this.get_recent_pages(r))},{title:__("Create a new ..."),fetch_type:"Nav",results:t(this.get_creatables(r))},{title:__("Lists"),fetch_type:"Nav",results:e},{title:__("Reports"),fetch_type:"Nav",results:t(this.get_reports(r))},{title:__("Administration"),fetch_type:"Nav",results:t(this.get_pages(r))},{title:__("Workspace"),fetch_type:"Nav",results:t(this.get_workspaces(r))},{title:__("Dashboard"),fetch_type:"Nav",results:t(this.get_dashboards(r))},{title:__("Setup"),fetch_type:"Nav",results:i},{title:__("Find '{0}' in ...",[o]),fetch_type:"Nav",results:t(this.get_search_in_list(r))}]},fuzzy_search:function(r,t){r=r||"";var e=__(t||""),i=qo(r,e);return i[1]},bolden_match_part:function(r,t){if(qo(t,r)[0]===!1)return r;if(r.indexOf(t)==0){var e=r.split(t)[1];return"<mark>"+t+"</mark>"+e}var i="",n=r,o=r.length;r=r.toLowerCase(),t=t.toLowerCase();e:for(var a=0,s=0;a<t.length;a++){for(var l=t.charCodeAt(a);s<o;){if(r.charCodeAt(s)===l){var u=n.charAt(s);u===u.toLowerCase()?i+="<mark>"+t.charAt(a)+"</mark>":i+="<mark>"+t.charAt(a).toUpperCase()+"</mark>",s++;continue e}i+=n.charAt(s),s++}return n}return i+=n.slice(s),i},get_executables(r){let t=[];return this.searchable_functions.forEach(e=>{let i=e.label.toLowerCase(),n=r.toLowerCase();(n===i||i.indexOf(n)===0)&&t.push({type:"Executable",value:this.bolden_match_part(__(e.label),n),index:this.fuzzy_search(n,i),match:e.label,onclick:()=>e.action.apply(this,e.args)})}),t},make_function_searchable(r,t=null,e=null){if(typeof r!="function")throw new Error("First argument should be a function");this.searchable_functions.push({label:t||r.name,action:r,args:e})},searchable_functions:[]};frappe.provide("frappe.ui.misc");frappe.ui.misc.about=function(){if(!frappe.ui.misc.about_dialog){var r=new frappe.ui.Dialog({title:__("Frappe Framework")});$(r.body).html(repl("<div>		<p>"+__("Open Source Applications for the Web")+"</p>  		<p><i class='fa fa-globe fa-fw'></i>			Website: <a href='https://frappeframework.com' target='_blank'>https://frappeframework.com</a></p>		<p><i class='fa fa-github fa-fw'></i>			Source: <a href='https://github.com/frappe' target='_blank'>https://github.com/frappe</a></p>		<p><i class='fa fa-linkedin fa-fw'></i>			Linkedin: <a href='https://linkedin.com/company/frappe-tech' target='_blank'>https://linkedin.com/company/frappe-tech</a></p>		<p><i class='fa fa-facebook fa-fw'></i>			Facebook: <a href='https://facebook.com/erpnext' target='_blank'>https://facebook.com/erpnext</a></p>		<p><i class='fa fa-twitter fa-fw'></i>			Twitter: <a href='https://twitter.com/erpnext' target='_blank'>https://twitter.com/erpnext</a></p>		<hr>		<h4>Installed Apps</h4>		<div id='about-app-versions'>Loading versions...</div>		<hr>		<p class='text-muted'>&copy; Frappe Technologies Pvt. Ltd. and contributors </p> 		</div>",frappe.app)),frappe.ui.misc.about_dialog=r,frappe.ui.misc.about_dialog.on_page_show=function(){frappe.versions?t(frappe.versions):frappe.call({method:"frappe.utils.change_log.get_versions",callback:function(e){t(e.message)}})};var t=function(e){var i=$("#about-app-versions").empty();$.each(Object.keys(e).sort(),function(n,o){var a=e[o];if(a.branch)var s=$.format("<p><b>{0}:</b> v{1} ({2})<br></p>",[a.title,a.branch_version||a.version,a.branch]);else var s=$.format("<p><b>{0}:</b> v{1}<br></p>",[a.title,a.version]);$(s).appendTo(i)}),frappe.versions=e}}frappe.ui.misc.about_dialog.show()};frappe.templates.navbar=`<header class="navbar navbar-expand sticky-top" role="navigation">
	<div class="container">
		<a class="navbar-brand navbar-home" href="/app">
			<img class="app-logo" style="width: {{ navbar_settings.logo_width || 24 }}px" src="{{ frappe.boot.app_logo_url }}">
		</a>
		<ul class="nav navbar-nav d-none d-sm-flex" id="navbar-breadcrumbs"></ul>
		<div class="collapse navbar-collapse justify-content-end">
			<form class="form-inline fill-width justify-content-end" role="search" onsubmit="return false;">
				{% if (frappe.boot.read_only) { %}
					<span class="indicator-pill yellow no-indicator-dot" title="{%= __("Your site is getting upgraded.") %}">
						{%= __("Read Only Mode") %}
					</span>
				{% } %}
				<div class="input-group search-bar text-muted hidden">
					<input
						id="navbar-search"
						type="text"
						class="form-control"
						placeholder="{%= __("Search or type a command (Ctrl + G)") %}"
						aria-haspopup="true"
					>
					<span class="search-icon">
						<svg class="icon icon-sm"><use href="#icon-search"></use></svg>
					</span>
				</div>
			</form>
			<ul class="navbar-nav">
				<li class="nav-item dropdown dropdown-notifications dropdown-mobile hidden">
					<a
						class="nav-link notifications-icon text-muted"
						data-toggle="dropdown"
						aria-haspopup="true"
						aria-expanded="true"
						href="#"
						onclick="return false;">
						<span class="notifications-seen">
							<svg class="icon icon-md"><use href="#icon-notification"></use></svg>
						</span>
						<span class="notifications-unseen">
							<svg class="icon icon-md"><use href="#icon-notification-with-indicator"></use></svg>
						</span>
					</a>
					<div class="dropdown-menu notifications-list dropdown-menu-right" role="menu">
						<div class="notification-list-header">
							<div class="header-items"></div>
							<div class="header-actions"></div>
						</div>
						<div class="notification-list-body">
							<div class="panel-notifications"></div>
							<div class="panel-events"></div>
						</div>
					</div>
				</li>
				<li class="nav-item dropdown dropdown-message dropdown-mobile hidden">
					<a
						class="nav-link notifications-icon text-muted"
						data-toggle="dropdown"
						aria-haspopup="true"
						aria-expanded="true"
						href="#"
						onclick="return false;">
						<span>
							<svg class="icon icon-md"><use href="#icon-small-message"></use></svg>
						</span>
					</a>
				</li>
				<li class="vertical-bar d-none d-sm-block"></li>
				<li class="nav-item dropdown dropdown-help dropdown-mobile d-none d-lg-block">
					<a class="nav-link" data-toggle="dropdown" href="#" onclick="return false;">
						{{ __("Help") }}
						<span>
							<svg class="icon icon-xs"><use href="#icon-small-down"></use></svg>
						</span>
					</a>
					<div class="dropdown-menu dropdown-menu-right" id="toolbar-help" role="menu">
						<div id="help-links"></div>
						<div class="dropdown-divider documentation-links"></div>
						{% for item in navbar_settings.help_dropdown %}
							{% if (!item.hidden) { %}
								{% if (item.route) { %}
									<a class="dropdown-item" href="{{ item.route }}">
										{%= __(item.item_label) %}
									</a>
								{% } else if (item.action) { %}
									<a class="dropdown-item" onclick="return {{ item.action }}">
										{%= __(item.item_label) %}
									</a>
								{% } else { %}
									<div class="dropdown-divider"></div>
								{% } %}
							{% } %}
						{% endfor %}
					</div>
				</li>
				<li class="nav-item dropdown dropdown-navbar-user dropdown-mobile">
					<a class="nav-link" data-toggle="dropdown" href="#" onclick="return false;">
						{{ avatar }}
					</a>
					<div class="dropdown-menu dropdown-menu-right" id="toolbar-user" role="menu">
						{% for item in navbar_settings.settings_dropdown %}
							{% if (!item.hidden) { %}
								{% if (item.route) { %}
									<a class="dropdown-item" href="{{ item.route }}">
										{%= __(item.item_label) %}
									</a>
								{% } else if (item.action) { %}
									<a class="dropdown-item" onclick="return {{ item.action }}">
										{%= __(item.item_label) %}
									</a>
								{% } else { %}
									<div class="dropdown-divider"></div>
								{% } %}
							{% } %}
						{% endfor %}
					</div>
				</li>
			</ul>
		</div>
	</div>
</header>
`;frappe.provide("frappe.ui.toolbar");frappe.provide("frappe.search");frappe.ui.toolbar.Toolbar=class{constructor(){$("header").replaceWith(frappe.render_template("navbar",{avatar:frappe.avatar(frappe.session.user,"avatar-medium"),navbar_settings:frappe.boot.navbar_settings})),$(".dropdown-toggle").dropdown(),this.setup_awesomebar(),this.setup_notifications(),this.setup_help(),this.make()}make(){this.bind_events(),$(document).trigger("toolbar_setup")}bind_events(){$(document).on("page-change",function(){$("header .navbar .custom-menu").remove()}),$("#search-modal").on("shown.bs.modal",function(){var r=$(this);setTimeout(function(){r.find("#modal-search").focus()},300)}),$(".navbar-toggle-full-width").click(()=>{frappe.ui.toolbar.toggle_full_width()})}setup_help(){if(!frappe.boot.desk_settings.notifications){$(".navbar .vertical-bar").removeClass("d-sm-block"),$(".dropdown-help").removeClass("d-lg-block");return}frappe.provide("frappe.help"),frappe.help.show_results=t,this.search=new frappe.search.SearchDialog,frappe.provide("frappe.searchdialog"),frappe.searchdialog.search=this.search,$(".dropdown-help .dropdown-toggle").on("click",function(){$(".dropdown-help input").focus()}),$(".dropdown-help .dropdown-menu").on("click","input, button",function(e){e.stopPropagation()}),$("#input-help").on("keydown",function(e){e.which==13&&$(this).val("")}),$(document).on("page-change",function(){var e=$(".dropdown-help #help-links");e.html("");for(var i=frappe.get_route_str(),n=i.split("/"),o=[],a=0;a<n.length;a++){var s=i.split("/",a+1),l=s.join("/"),u=frappe.help.help_links[l]||[];o=$.merge(o,u)}o.length===0?e.next().hide():e.next().show();for(var a=0;a<o.length;a++){var c=o[a],h=c.url;$("<a>",{href:h,class:"dropdown-item",text:__(c.label),target:"_blank"}).appendTo(e)}$(".dropdown-help .dropdown-menu").on("click","a",t)});var r=frappe.get_modal("","");r.addClass("help-modal"),$(document).on("click",".help-modal a",t);function t(e){var i=e.target.href;i.indexOf("blob")>0&&window.open(i,"_blank");var n=$(e.target).attr("data-path");n&&e.preventDefault()}}setup_awesomebar(){frappe.boot.desk_settings.search_bar&&(new frappe.search.AwesomeBar().setup("#navbar-search"),frappe.search.utils.make_function_searchable(function(){frappe.set_route("List","Client Script")},__("Custom Script List")))}setup_notifications(){frappe.boot.desk_settings.notifications&&frappe.session.user!=="Guest"&&(this.notifications=new frappe.ui.Notifications)}};$.extend(frappe.ui.toolbar,{add_dropdown_button:function(r,t,e,i){var n=frappe.ui.toolbar.get_menu(r);return n.find("li:not(.custom-menu)").length&&!n.find(".divider").length&&frappe.ui.toolbar.add_menu_divider(n),$('<li class="custom-menu"><a><i class="fa-fw '+i+'"></i> '+t+"</a></li>").insertBefore(n.find(".divider")).find("a").click(function(){e.apply(this)})},get_menu:function(r){return $("#navbar-"+r.toLowerCase())},add_menu_divider:function(r){r=typeof r=="string"?frappe.ui.toolbar.get_menu(r):r,$('<li class="divider custom-menu"></li>').prependTo(r)},add_icon_link(r,t,e,i){let n=$(".navbar-right").get(0),o=$(`<li class="${i}">
			<a class="btn" href="${r}" title="${frappe.utils.to_title_case(i,!0)}" aria-haspopup="true" aria-expanded="true">
				<div>
					<i class="octicon ${t}"></i>
				</div>
			</a>
		</li>`).get(0);n.insertBefore(o,n.children[e])},toggle_full_width(){let r=JSON.parse(localStorage.container_fullwidth||"false");r=!r,localStorage.container_fullwidth=r,frappe.ui.toolbar.set_fullwidth_if_enabled(),$(document.body).trigger("toggleFullWidth")},set_fullwidth_if_enabled(){let r=JSON.parse(localStorage.container_fullwidth||"false");$(document.body).toggleClass("full-width",r)},show_shortcuts(r){return r.preventDefault(),frappe.ui.keys.show_keyboard_shortcut_dialog(),!1}});frappe.ui.toolbar.clear_cache=frappe.utils.throttle(function(){frappe.assets.clear_local_storage(),frappe.xcall("frappe.sessions.clear").then(r=>{frappe.show_alert({message:r,indicator:"info"}),location.reload(!0)})},1e4);frappe.ui.toolbar.show_about=function(){try{frappe.ui.misc.about()}catch(r){console.log(r)}return!1};frappe.ui.toolbar.route_to_user=function(){frappe.set_route("Form","User",frappe.session.user)};frappe.ui.toolbar.view_website=function(){let r=window.open();r.opener=null,r.location="/index"};frappe.ui.toolbar.setup_session_defaults=function(){let r=[];frappe.call({method:"frappe.core.doctype.session_default_settings.session_default_settings.get_session_default_values",callback:function(t){r=JSON.parse(t.message);let e=frappe.perm.get_perm("Session Default Settings");(in_list(frappe.user_roles,"System Manager")||e[0].read==1)&&(r[r.length]={fieldname:"settings",fieldtype:"Button",label:__("Settings"),click:()=>{frappe.set_route("Form","Session Default Settings","Session Default Settings")}}),frappe.prompt(r,function(i){r.forEach(function(n){i[n.fieldname]||(i[n.fieldname]="")}),frappe.call({method:"frappe.core.doctype.session_default_settings.session_default_settings.set_session_default_values",args:{default_values:i},callback:function(n){n.message=="success"?(frappe.show_alert({message:__("Session Defaults Saved"),indicator:"green"}),frappe.ui.toolbar.clear_cache()):frappe.show_alert({message:__("An error occurred while setting Session Defaults"),indicator:"red"})}})},__("Session Defaults"),__("Save"))}})};$(document).on("startup",async()=>{if(!frappe.boot.setup_complete||!frappe.user.has_role("System Manager"))return;let r=frappe.boot.subscription_expiry;if(r){let t=frappe.datetime.get_day_diff(cstr(r),frappe.datetime.get_today())-1,e=__(`Your subscription will end in ${cstr(t).bold()} ${t>1?"days":"day"}. After that your site will be suspended.`),i=$(`
		<div
			class="position-fixed top-100 start-20 translate-middle shadow sm:rounded-lg py-2"
			style="left: 10%; bottom:20px; width:80%; margin: auto; text-align: center; border-radius: 10px; background-color: rgb(240 249 255); z-index: 1"
		>
			<div
				style="display: flex; align-items: center; justify-content: space-between; text-align: center;"
				class="text-muted"
			>
					<p style="float: left; margin: auto; font-size: 17px">${e}</p>
					<div style="display: flex; align-items: center; justify-content: space-between">
					<button
						type="button"
						class="button-renew px-4 py-2 border border-transparent text-white hover:bg-indigo-700 focus:outline-none focus:ring-offset-2 focus:ring-indigo-500"
						style="background-color: #0089FF; border-radius: 5px; margin-right: 10px; height: fit-content;"
					>
					Subscribe
					</button>
					<a
						type="button"
						class="dismiss-upgrade text-muted" data-dismiss="modal" aria-hidden="true" style="font-size:30px; margin-bottom: 5px; margin-right: 10px"
					>
					\xD7
					</a>
				</div>
			</div>
		</div>
		`);$("footer").append(i),i.find(".dismiss-upgrade").on("click",()=>{i.remove()}),i.find(".button-renew").on("click",()=>{jd()})}});function jd(){frappe.call({method:"frappe.utils.subscription.remote_login",callback:r=>{r.message!==!1?window.open(r.message,"_blank"):frappe.msgprint({title:__("Message"),indicator:"orange",message:__("No active subscriptions found.")})}})}$.extend(frappe.ui.toolbar,{redirectToUrl(){jd()}});var dn=Vt(Fd());frappe.last_edited_communication={};var Hd="<div>---</div>";frappe.views.CommunicationComposer=class{constructor(r){$.extend(this,r),this.doc||(this.doc=this.frm&&this.frm.doc||{}),this.make()}make(){let r=this;this.dialog=new frappe.ui.Dialog({title:this.title||this.subject||__("New Email"),no_submit_on_enter:!0,fields:this.get_fields(),primary_action_label:__("Send"),primary_action(){r.send_action()},secondary_action_label:__("Discard"),secondary_action(){r.dialog.hide(),r.clear_cache()},size:"large",minimizable:!0}),$(this.dialog.$wrapper.find(".form-section").get(0)).addClass("to_section"),this.prepare(),this.dialog.show(),this.frm&&$(document).trigger("form-typing",[this.frm])}get_fields(){let r=[{label:__("To"),fieldtype:"MultiSelect",reqd:0,fieldname:"recipients"},{fieldtype:"Button",label:frappe.utils.icon("down"),fieldname:"option_toggle_button",click:()=>{this.toggle_more_options()}},{fieldtype:"Section Break",hidden:1,fieldname:"more_options"},{label:__("CC"),fieldtype:"MultiSelect",fieldname:"cc"},{label:__("BCC"),fieldtype:"MultiSelect",fieldname:"bcc"},{label:__("Email Template"),fieldtype:"Link",options:"Email Template",fieldname:"email_template"},{fieldtype:"Section Break"},{label:__("Subject"),fieldtype:"Data",reqd:1,fieldname:"subject",length:524288},{label:__("Message"),fieldtype:"Text Editor",fieldname:"content",onchange:frappe.utils.debounce(this.save_as_draft.bind(this),300)},{fieldtype:"Button",label:__("Add Signature"),fieldname:"add_signature",hidden:1,click:async()=>{let e=this.dialog.get_value("sender")||"";this.content_set=!1,await this.set_content(e)}},{fieldtype:"Section Break"},{label:__("Send me a copy"),fieldtype:"Check",fieldname:"send_me_a_copy",default:frappe.boot.user.send_me_a_copy},{label:__("Send Read Receipt"),fieldtype:"Check",fieldname:"send_read_receipt"},{label:__("Attach Document Print"),fieldtype:"Check",fieldname:"attach_document_print"},{label:__("Select Print Format"),fieldtype:"Select",fieldname:"select_print_format"},{label:__("Select Languages"),fieldtype:"Select",fieldname:"language_sel"},{fieldtype:"Column Break"},{label:__("Select Attachments"),fieldtype:"HTML",fieldname:"select_attachments"}],t=frappe.boot.email_accounts.filter(e=>!in_list(["All Accounts","Sent","Spam","Trash"],e.email_account)&&e.enable_outgoing);return t.length&&(this.user_email_accounts=t.map(function(e){return e.email_id}),r.unshift({label:__("From"),fieldtype:"Select",reqd:1,fieldname:"sender",options:this.user_email_accounts}),this.user_email_accounts.length==1&&(this.sender=this.user_email_accounts)),r}toggle_more_options(r){r=r||this.dialog.fields_dict.more_options.df.hidden,this.dialog.set_df_property("more_options","hidden",!r);let t=frappe.utils.icon(r?"up-line":"down");this.dialog.get_field("option_toggle_button").set_label(t)}prepare(){this.setup_multiselect_queries(),this.setup_subject_and_recipients(),this.setup_print_language(),this.setup_print(),this.setup_attach(),this.setup_email(),this.setup_email_template(),this.setup_last_edited_communication(),this.setup_add_signature_button(),this.set_values()}setup_add_signature_button(){let r=this.dialog.has_field("sender");this.dialog.set_df_property("add_signature","hidden",!r)}setup_multiselect_queries(){["recipients","cc","bcc"].forEach(r=>{this.dialog.fields_dict[r].get_data=()=>{let e=this.dialog.fields_dict[r].get_value().match(/[^,\s*]*$/)[0]||"";frappe.call({method:"frappe.email.get_contact_list",args:{txt:e},callback:i=>{this.dialog.fields_dict[r].set_data(i.message)}})}})}setup_subject_and_recipients(){if(this.subject=this.subject||"",!this.forward&&!this.recipients&&this.last_email&&(this.recipients=this.last_email.sender,this.cc=this.last_email.cc,this.bcc=this.last_email.bcc),!this.forward&&!this.recipients&&(this.recipients=this.frm&&this.frm.timeline.get_recipient()),!this.subject&&this.frm){let r=this.frm.timeline.get_last_email();r&&(this.subject=r.subject,this.recipients||(this.recipients=r.sender),strip(this.subject.toLowerCase().split(":")[0])!="re"&&(this.subject=__("Re: {0}",[this.subject]))),this.subject||(this.subject=this.frm.doc.name,this.frm.meta.subject_field&&this.frm.doc[this.frm.meta.subject_field]?this.subject=this.frm.doc[this.frm.meta.subject_field]:this.frm.meta.title_field&&this.frm.doc[this.frm.meta.title_field]&&(this.subject=this.frm.doc[this.frm.meta.title_field]));let t=`#${this.frm.doc.name}`;cstr(this.subject).includes(t)||(this.subject=`${this.subject} (${t})`)}this.frm&&!this.recipients&&(this.recipients=this.frm.doc[this.frm.email_field])}setup_email_template(){let r=this;this.dialog.fields_dict.email_template.df.onchange=()=>{let t=r.dialog.fields_dict.email_template.get_value();if(!t)return;function e(i){if(r.reply_added===t)return;let n=r.dialog.fields_dict.content,o=r.dialog.fields_dict.subject,a=n.get_value()||"";n.set_value(`${i.message}<br>${a}`),o.set_value(i.subject),r.reply_added=t}frappe.call({method:"frappe.email.doctype.email_template.email_template.get_email_template",args:{template_name:t,doc:r.doc,_lang:r.dialog.get_value("language_sel")},callback(i){e(i.message)}})}}setup_last_edited_communication(){this.frm?(this.doctype=this.frm.doctype,this.key=this.frm.docname):this.doctype=this.key="Inbox",this.last_email&&(this.key=this.key+":"+this.last_email.name),this.subject&&(this.key=this.key+":"+this.subject),this.dialog.on_hide=()=>{$.extend(this.get_last_edited_communication(!0),this.dialog.get_values(!0)),this.frm&&$(document).trigger("form-stopped-typing",[this.frm])}}get_last_edited_communication(r){return frappe.last_edited_communication[this.doctype]||(frappe.last_edited_communication[this.doctype]={}),(r||!frappe.last_edited_communication[this.doctype][this.key])&&(frappe.last_edited_communication[this.doctype][this.key]={}),frappe.last_edited_communication[this.doctype][this.key]}async set_values(){for(let t of["recipients","cc","bcc","sender"])await this.dialog.set_value(t,this[t]||"");let r=frappe.utils.html2text(this.subject)||"";if(await this.dialog.set_value("subject",r),await this.set_values_from_last_edited_communication(),await this.set_content(),this.frm&&!this.is_a_reply&&!this.content_set){let t=this.frm.meta.default_email_template||"";await this.dialog.set_value("email_template",t)}for(let t of["email_template","cc","bcc"])if(this.dialog.get_value(t)){this.toggle_more_options(!0);break}}async set_values_from_last_edited_communication(){if(this.message)return;let r=this.get_last_edited_communication();!r.content||(r.email_template&&(await this.dialog.fields_dict.email_template.set_model_value(r.email_template),delete r.email_template),await this.dialog.set_values(r),this.content_set=!0)}selected_format(){return this.dialog.fields_dict.select_print_format.input.value||this.frm&&this.frm.meta.default_print_format||"Standard"}get_print_format(r){return r||(r=this.selected_format()),locals["Print Format"]&&locals["Print Format"][r]?locals["Print Format"][r]:{}}setup_print_language(){let r=this.dialog.fields_dict;this.lang_code=this.doc.language||this.get_print_format().default_print_language||frappe.boot.lang;let t=this;$(r.language_sel.input).change(function(){t.lang_code=this.value}),$(r.language_sel.input).empty().add_options(frappe.get_languages()),this.lang_code&&$(r.language_sel.input).val(this.lang_code)}setup_print(){let r=this.dialog.fields_dict;if($(r.attach_document_print.input).click(function(){$(r.select_print_format.wrapper).toggle($(this).prop("checked"))}),$(r.select_print_format.wrapper).toggle(!1),this.frm){let t=frappe.meta.get_print_formats(this.frm.meta.name);$(r.select_print_format.input).empty().add_options(t).val(t[0])}else $(r.attach_document_print.wrapper).toggle(!1)}setup_attach(){let r=this.dialog.fields_dict,t=$(r.select_attachments.wrapper);this.attachments||(this.attachments=[]);let e={folder:"Home/Attachments",on_success:i=>{this.attachments.push(i),this.render_attachment_rows(i)}};this.frm&&(e={doctype:this.frm.doctype,docname:this.frm.docname,folder:"Home/Attachments",on_success:i=>{this.frm.attachments.attachment_uploaded(i),this.render_attachment_rows(i)}}),$(`
			<label class="control-label">
				${__("Select Attachments")}
			</label>
			<div class='attach-list'></div>
			<p class='add-more-attachments'>
				<button class='btn btn-xs btn-default'>
					${frappe.utils.icon("small-add","xs")}&nbsp;
					${__("Add Attachment")}
				</button>
			</p>
		`).appendTo(t.empty()),t.find(".add-more-attachments button").on("click",()=>new frappe.ui.FileUploader(e)),this.render_attachment_rows()}render_attachment_rows(r){let t=this.dialog.fields_dict.select_attachments,e=$(t.wrapper).find(".attach-list");if(r)e.append(this.get_attachment_row(r,!0));else{let i=[];this.attachments&&this.attachments.length&&(i=i.concat(this.attachments)),this.frm&&(i=i.concat(this.frm.get_files())),i.length&&$.each(i,(n,o)=>{!o.file_name||e.find(`[data-file-name="${o.name}"]`).length||(o.file_url=frappe.urllib.get_full_url(o.file_url),e.append(this.get_attachment_row(o)))})}}get_attachment_row(r,t){return $(`<p class="checkbox flex">
			<label class="ellipsis" title="${r.file_name}">
				<input
					type="checkbox"
					data-file-name="${r.name}"
					${t?"checked":""}>
				</input>
				<span class="ellipsis">${r.file_name}</span>
			</label>
			&nbsp;
			<a href="${r.file_url}" target="_blank" class="btn-linkF">
				${frappe.utils.icon("link-url")}
			</a>
		</p>`)}setup_email(){let r=this.dialog.fields_dict;this.attach_document_print&&($(r.attach_document_print.input).click(),$(r.select_print_format.wrapper).toggle(!0)),$(r.send_me_a_copy.input).on("click",()=>{let t=r.send_me_a_copy.get_value();frappe.db.set_value("User",frappe.session.user,"send_me_a_copy",t),frappe.boot.user.send_me_a_copy=t})}send_action(){let r=this,t=r.dialog.get_primary_btn(),e=this.get_values();if(!e)return;let i=$.map($(r.dialog.wrapper).find("[data-file-name]:checked"),function(n){return $(n).attr("data-file-name")});e.attach_document_print?r.send_email(t,e,i,null,e.select_print_format||""):r.send_email(t,e,i)}get_values(){let r=this.dialog.get_values();for(let t=0,e=this.dialog.fields.length;t<e;t++){let i=this.dialog.fields[t];i.is_cc_checkbox&&(r[i.fieldname]&&(r.cc=(r.cc?r.cc+", ":"")+i.fieldname,r.bcc=(r.bcc?r.bcc+", ":"")+i.fieldname),delete r[i.fieldname])}return r}save_as_draft(){if(this.dialog&&this.frm){let r=this.dialog.get_value("content");r=r.split(Hd)[0],dn.default.setItem(this.frm.doctype+this.frm.docname,r).catch(t=>{t&&(console.log(t),console.warn("[Communication] IndexedDB is full. Cannot save message as draft"))})}}clear_cache(){this.delete_saved_draft(),this.get_last_edited_communication(!0)}delete_saved_draft(){this.dialog&&this.frm&&dn.default.removeItem(this.frm.doctype+this.frm.docname).catch(r=>{r&&(console.log(r),console.warn("[Communication] IndexedDB is full. Cannot save message as draft"))})}send_email(r,t,e,i,n){let o=this;if(this.dialog.hide(),!t.recipients){frappe.msgprint(__("Enter Email Recipient(s)"));return}if(t.attach_document_print||(i=null,n=null),this.frm&&!frappe.model.can_email(this.doc.doctype,this.frm)){frappe.msgprint(__("You are not allowed to send emails related to this document"));return}return frappe.call({method:"frappe.core.doctype.communication.email.make",args:{recipients:t.recipients,cc:t.cc,bcc:t.bcc,subject:t.subject,content:t.content,doctype:o.doc.doctype,name:o.doc.name,send_email:1,print_html:i,send_me_a_copy:t.send_me_a_copy,print_format:n,sender:t.sender,sender_full_name:t.sender?frappe.user.full_name():void 0,email_template:t.email_template,attachments:e,_lang:o.lang_code,read_receipt:t.send_read_receipt,print_letterhead:o.is_print_letterhead_checked()},btn:r,callback(a){if(a.exc){if(frappe.msgprint(__("There were errors while sending email. Please try again.")),o.error)try{o.error(a)}catch(s){console.log(s)}}else if(frappe.utils.play_sound("email"),a.message.emails_not_sent_to&&frappe.msgprint(__("Email not sent to {0} (unsubscribed / disabled)",[frappe.utils.escape_html(a.message.emails_not_sent_to)])),o.clear_cache(),o.frm&&o.frm.reload_doc(),o.success)try{o.success(a)}catch(s){console.log(s)}}})}is_print_letterhead_checked(){return this.frm&&$(this.frm.wrapper).find(".form-print-wrapper").is(":visible")?$(this.frm.wrapper).find(".print-letterhead").prop("checked")?1:0:(frappe.model.get_doc(":Print Settings","Print Settings")||{with_letterhead:1}).with_letterhead?1:0}async set_content(r){if(this.content_set)return;let t=this.message||"";if(!t&&this.frm){let{doctype:e,docname:i}=this.frm;t=await dn.default.getItem(e+i)||""}t&&(this.content_set=!0),t+=await this.get_signature(r||null),this.is_a_reply&&!this.reply_set&&(t+=this.get_earlier_reply()),await this.dialog.set_value("content",t)}async get_signature(r){let t=frappe.boot.user.email_signature;if(!t){let e={add_signature:1};r?e.email_id=r:e.default_outgoing=1;let i=await frappe.db.get_list("Email Account",{filters:e,fields:["signature","email_id"],limit:1}),n=null;i.length&&(t=i[0].signature,n=i[0].email_id),!r&&n&&this.user_email_accounts&&this.user_email_accounts.includes(n)&&this.dialog.set_value("sender",n)}return t?(frappe.utils.is_html(t)||(t=t.replace(/\n/g,"<br>")),"<br>"+t):""}get_earlier_reply(){this.reply_set=!1;let r=this.last_email||this.frm&&this.frm.timeline.get_last_email(!0);if(!r)return"";let t=r.original_comment||r.content;t=this.html2text(t).replace(/\n/g,"<br>"),t.length>20*1024&&(t+="<div>"+__("Message clipped")+"</div>"+t,t=t.slice(0,20*1024));let e=frappe.datetime.global_date_format(r.communication_date||r.creation);return this.reply_set=!0,`
			<div><br></div>
			${Hd||""}
			<p>
			${__("On {0}, {1} wrote:",[e,r.sender])}
			</p>
			<blockquote>
			${t}
			</blockquote>
		`}html2text(r){let t=document.createElement("div");return t.innerHTML=r.replace(/<\/div>/g,"<br></div>").replace(/<\/p>/g,"<br></p>").replace(/<br>/g,`
`),t.textContent.replace(/\n{3,}/g,`

`)}};frappe.views.TranslationManager=class{constructor(t){Object.assign(this,t),this.make()}make(){this.data=[],this.dialog=new frappe.ui.Dialog({fields:this.get_fields(),title:__("Translate {0}",[this.df.label]),no_submit_on_enter:!0,primary_action_label:__("Update Translations"),primary_action:t=>this.update_translations(t).then(()=>{this.dialog.hide(),this.data=[],frappe.msgprint({title:__("Success"),message:__("Successfully updated translations"),indicator:"green"})})}),this.get_translations_data().then(t=>{this.data.push(...t||[]),this.dialog.refresh(),this.dialog.show()})}get_fields(){var t=[{label:__("Source Text"),fieldname:"source",fieldtype:"Data",read_only:1,bold:1,default:this.source_text},{label:__("Translations"),fieldname:"translation_data",fieldtype:"Table",fields:[{label:"Language",fieldname:"language",fieldtype:"Link",options:"Language",in_list_view:1,columns:3},{label:"Translation",fieldname:"translation",fieldtype:"Text",in_list_view:1,columns:7}],data:this.data,get_data:()=>this.data}];return t}get_translations_data(){return frappe.db.get_list("Translation",{fields:["name","language","translated_text as translation"],filters:{source_text:strip_html(this.source_text)}})}update_translations({source:t,translation_data:e=[]}){let i={};return e.map(n=>{i[n.language]=n.translation}),frappe.call({method:"frappe.translate.update_translations_for_source",btn:this.dialog.get_primary_btn(),args:{source:t,translation_dict:i}}).fail(()=>{frappe.msgprint({title:__("Something went wrong"),message:__("Please try again"),indicator:"red"})})}};var Wd=Vt(qd()),Vd=Vt(Ud());frappe.standard_pages.Workspaces=function(){var r=frappe.container.add_page("Workspaces");frappe.ui.make_app_page({parent:r,name:"Workspaces",title:__("Workspace")}),frappe.workspace=new frappe.views.Workspace(r),$(r).bind("show",function(){frappe.workspace.show()})};frappe.views.Workspace=class{constructor(t){this.wrapper=$(t),this.page=t.page,this.blocks=frappe.workspace_block.blocks,this.is_read_only=!0,this.pages={},this.sorted_public_items=[],this.sorted_private_items=[],this.current_page={},this.sidebar_items={public:{},private:{}},this.sidebar_categories=["My Workspaces","Public"],this.prepare_container(),this.setup_pages(),this.register_awesomebar_shortcut()}prepare_container(){let t=$(`
			<div class="list-sidebar overlay-sidebar hidden-xs hidden-sm">
				<div class="desk-sidebar list-unstyled sidebar-menu"></div>
			</div>
		`).appendTo(this.wrapper.find(".layout-side-section"));this.sidebar=t.find(".desk-sidebar"),this.body=this.wrapper.find(".layout-main-section")}async setup_pages(t){if(!this.discard&&this.create_page_skeleton(),!this.discard&&this.create_sidebar_skeleton(),this.sidebar_pages=this.discard?this.sidebar_pages:await this.get_pages(),this.cached_pages=$.extend(!0,{},this.sidebar_pages),this.all_pages=this.sidebar_pages.pages,this.has_access=this.sidebar_pages.has_access,this.all_pages.forEach(e=>{e.is_editable=!e.public||this.has_access}),this.public_pages=this.all_pages.filter(e=>e.public),this.private_pages=this.all_pages.filter(e=>!e.public),this.all_pages){frappe.workspaces={};for(let e of this.all_pages)frappe.workspaces[frappe.router.slug(e.name)]={title:e.title};this.make_sidebar(),t&&this.show()}}get_pages(){return frappe.xcall("frappe.desk.desktop.get_workspace_sidebar_items")}sidebar_item_container(t){return $(`
			<div class="sidebar-item-container ${t.is_editable?"is-draggable":""}" item-parent="${t.parent_page}" item-name="${t.title}" item-public="${t.public||0}">
				<div class="desk-sidebar-item standard-sidebar-item ${t.selected?"selected":""}">
					<a
						href="/app/${t.public?frappe.router.slug(t.title):"private/"+frappe.router.slug(t.title)}"
						class="item-anchor ${t.is_editable?"":"block-click"}" title="${__(t.title)}"
					>
						<span class="sidebar-item-icon" item-icon=${t.icon||"folder-normal"}>${frappe.utils.icon(t.icon||"folder-normal","md")}</span>
						<span class="sidebar-item-label">${__(t.title)}<span>
					</a>
					<div class="sidebar-item-control"></div>
				</div>
				<div class="sidebar-child-item nested-container"></div>
			</div>
		`)}make_sidebar(){this.sidebar.find(".standard-sidebar-section")[0]&&this.sidebar.find(".standard-sidebar-section").remove(),this.sidebar_categories.forEach(t=>{let e=this.public_pages.filter(i=>i.parent_page==""||i.parent_page==null);t!="Public"&&(e=this.private_pages.filter(i=>i.parent_page==""||i.parent_page==null)),e=e.uniqBy(i=>i.title),this.build_sidebar_section(t,e)}),this.sidebar.find(".selected").length&&!frappe.dom.is_element_in_viewport(this.sidebar.find(".selected"))&&this.sidebar.find(".selected")[0].scrollIntoView(),this.remove_sidebar_skeleton()}build_sidebar_section(t,e){let i=$(`<div class="standard-sidebar-section nested-container" data-title="${t}"></div>`),n=$(`<div class="standard-sidebar-label">
			<span>${frappe.utils.icon("small-down","xs")}</span>
			<span class="section-title">${__(t)}<span>
		</div>`).appendTo(i);this.prepare_sidebar(e,i,this.sidebar),n.on("click",o=>{let a=$(o.target).find("span use").attr("href")==="#icon-small-down"?"#icon-right":"#icon-small-down";$(o.target).find("span use").attr("href",a),$(o.target).parent().find(".sidebar-item-container").toggleClass("hidden")}),Object.keys(e).length===0&&i.addClass("hidden")}prepare_sidebar(t,e,i){t.forEach(n=>this.append_item(n,e)),e.appendTo(i)}append_item(t,e){let i=frappe.router.slug(t.title)==frappe.router.slug(this.get_page_to_show().name)&&t.public==this.get_page_to_show().public;t.selected=i,i&&(this.current_page={name:t.title,public:t.public});let n=this.sidebar_item_container(t),o=n.find(".sidebar-item-control");this.add_sidebar_actions(t,o);let s=(t.public?this.public_pages:this.private_pages).filter(l=>l.parent_page==t.title);if(s.length>0){let l=n.find(".sidebar-child-item");l.addClass("hidden"),this.prepare_sidebar(s,l,n)}n.appendTo(e),this.sidebar_items[t.public?"public":"private"][t.title]=n,n.parent().hasClass("hidden")&&i&&n.parent().toggleClass("hidden"),this.add_drop_icon(t,o,n)}add_drop_icon(t,e,i){let n="small-down";i.find(`[item-name="${this.current_page.name}"]`).length&&(n="small-up");let o=i.find(".sidebar-child-item"),a=$(`<span class="drop-icon hidden">${frappe.utils.icon(n,"sm")}</span>`).appendTo(e);(t.public?this.public_pages:this.private_pages).some(l=>l.parent_page==t.title)&&a.removeClass("hidden"),a.on("click",()=>{let l=a.find("use").attr("href")==="#icon-small-down"?"#icon-small-up":"#icon-small-down";a.find("use").attr("href",l),o.toggleClass("hidden")})}show(){if(!this.all_pages){setTimeout(()=>this.show(),100);return}let t=this.get_page_to_show();this.page.set_title(__(t.name)),this.update_selected_sidebar(this.current_page,!1),this.update_selected_sidebar(t,!0),this.show_page(t)}update_selected_sidebar(t,e){let i=t.public?"public":"private";if(this.sidebar&&this.sidebar_items[i]&&this.sidebar_items[i][t.name]){let n=this.sidebar_items[i][t.name],a=(t.public?this.public_pages:this.private_pages).find(s=>s.title==t.name);e?(n[0].firstElementChild.classList.add("selected"),a&&(a.selected=!0),n.parent().hasClass("hidden")&&n.parent().removeClass("hidden"),this.current_page={name:t.name,public:t.public},localStorage.current_page=t.name,localStorage.is_current_page_public=t.public):(n[0].firstElementChild.classList.remove("selected"),a&&(a.selected=!1))}}get_data(t){return frappe.call("frappe.desk.desktop.get_desktop_page",{page:t}).then(e=>{if(this.page_data=e.message,this.pages[t.name]&&delete this.pages[t.name],this.pages[t.name]=e.message,!(!this.page_data||Object.keys(this.page_data).length===0)&&!(this.page_data.charts&&this.page_data.charts.items.length===0))return frappe.dashboard_utils.get_dashboard_settings().then(i=>{if(i){let n=i.chart_config?JSON.parse(i.chart_config):{};this.page_data.charts.items.map(o=>{o.chart_settings=n[o.chart_name]||{}}),this.pages[t.name]=this.page_data}})})}get_page_to_show(){let t;localStorage.current_page&&this.all_pages.filter(n=>n.title==localStorage.current_page).length!=0?t={name:localStorage.current_page,public:localStorage.is_current_page_public=="true"}:Object.keys(this.all_pages).length!==0?t={name:this.all_pages[0].title,public:!0}:t={name:"Build",public:!0};let e=(frappe.get_route()[1]=="private"?frappe.get_route()[2]:frappe.get_route()[1])||t.name,i=frappe.get_route()[1]?frappe.get_route()[1]!="private":t.public;return{name:e,public:i}}async show_page(t){if(this.body.find("#editorjs")[0]||(this.$page=$(`
				<div id="editorjs" class="desk-page page-main-content"></div>
			`).appendTo(this.body)),this.all_pages){this.create_page_skeleton();let i=(t.public?this.public_pages:this.private_pages).filter(n=>n.title==t.name)[0];this.content=i&&JSON.parse(i.content),this.add_custom_cards_in_content(),$(".item-anchor").addClass("disable-click"),this.pages&&this.pages[i.name]?this.page_data=this.pages[i.name]:await frappe.after_ajax(()=>this.get_data(i)),this.setup_actions(t),this.prepare_editorjs(),$(".item-anchor").removeClass("disable-click"),this.remove_page_skeleton()}}add_custom_cards_in_content(){let t=-1;this.content.find((e,i)=>{e.type=="card"&&(t=i)}),t!==-1&&(this.content.splice(t+1,0,{type:"card",data:{card_name:"Custom Documents",col:4}}),this.content.splice(t+2,0,{type:"card",data:{card_name:"Custom Reports",col:4}}))}prepare_editorjs(){this.editor?this.editor.isReady.then(()=>{this.editor.configuration.tools.chart.config.page_data=this.page_data,this.editor.configuration.tools.shortcut.config.page_data=this.page_data,this.editor.configuration.tools.card.config.page_data=this.page_data,this.editor.configuration.tools.onboarding.config.page_data=this.page_data,this.editor.configuration.tools.quick_list.config.page_data=this.page_data,this.editor.render({blocks:this.content||[]})}):this.initialize_editorjs(this.content)}setup_actions(t){let i=(t.public?this.public_pages:this.private_pages).filter(n=>n.title==t.name)[0];if(!this.is_read_only){this.setup_customization_buttons(i);return}this.clear_page_actions(),this.page.set_secondary_action(__("Edit"),async()=>{!this.editor||!this.editor.readOnly||(this.is_read_only=!1,await this.editor.readOnly.toggle(),this.editor.isReady.then(()=>{this.initialize_editorjs_undo(),this.setup_customization_buttons(i),this.show_sidebar_actions(),this.make_blocks_sortable()}))}),this.page.add_inner_button(__("Create Workspace"),()=>{this.initialize_new_page()})}initialize_editorjs_undo(){this.undo=new Vd.default({editor:this.editor}),this.undo.initialize({blocks:this.content||[]}),this.undo.readOnly=!1}clear_page_actions(){this.page.clear_primary_action(),this.page.clear_secondary_action(),this.page.clear_inner_toolbar()}setup_customization_buttons(t){this.clear_page_actions(),t.is_editable&&this.page.set_primary_action(__("Save"),()=>{this.clear_page_actions(),this.save_page(t).then(e=>{!e||(this.undo.readOnly=!0,this.editor.readOnly.toggle(),this.is_read_only=!0)})},null,__("Saving")),this.page.set_secondary_action(__("Discard"),async()=>{this.discard=!0,this.clear_page_actions(),await this.editor.readOnly.toggle(),this.is_read_only=!0,this.sidebar_pages=this.cached_pages,this.reload(),frappe.show_alert({message:__("Customizations Discarded"),indicator:"info"})}),t.name&&this.page.add_inner_button(__("Settings"),()=>{frappe.set_route(`workspace/${t.name}`)})}show_sidebar_actions(){this.sidebar.find(".standard-sidebar-section").addClass("show-control"),this.make_sidebar_sortable()}add_sidebar_actions(t,e,i){t.is_editable?(frappe.utils.add_custom_button(frappe.utils.icon("drag","xs"),null,"drag-handle",__("Drag"),null,e),!i&&this.add_settings_button(t,e)):(e.parent().click(()=>{!this.is_read_only&&frappe.show_alert({message:__("Only Workspace Manager can sort or edit this page"),indicator:"info"},5)}),frappe.utils.add_custom_button(frappe.utils.icon("duplicate","sm"),()=>this.duplicate_page(t),"duplicate-page",__("Duplicate Workspace"),null,e))}get_parent_pages(t){if(this.public_parent_pages=["",...this.public_pages.filter(e=>!e.parent_page).map(e=>e.title)],this.private_parent_pages=["",...this.private_pages.filter(e=>!e.parent_page).map(e=>e.title)],t)return t.public?this.public_parent_pages:this.private_parent_pages}edit_page(t){var e=this;let i=t,n=this.get_parent_pages(t),o=n.findIndex(s=>s==t.title);o!==-1&&n.splice(o,1);let a=new frappe.ui.Dialog({title:__("Update Details"),fields:[{label:__("Title"),fieldtype:"Data",fieldname:"title",reqd:1,default:t.title},{label:__("Parent"),fieldtype:"Select",fieldname:"parent",options:n,default:t.parent_page},{label:__("Public"),fieldtype:"Check",fieldname:"is_public",depends_on:`eval:${this.has_access}`,default:t.public,onchange:function(){a.set_df_property("parent","options",this.get_value()?e.public_parent_pages:e.private_parent_pages)}},{fieldtype:"Column Break"},{label:__("Icon"),fieldtype:"Icon",fieldname:"icon",default:t.icon}],primary_action_label:__("Update"),primary_action:s=>{let l=s.title!=i.title,u=s.is_public!=i.public;if(!((l||u)&&!this.validate_page(s,i))){if(a.hide(),frappe.call({method:"frappe.desk.doctype.workspace.workspace.update_page",args:{name:i.name,title:s.title,icon:s.icon||"",parent:s.parent||"",public:s.is_public||0},callback:function(c){if(c.message){let h=__("Workspace {0} Edited Successfully",[i.title.bold()]);frappe.show_alert({message:h,indicator:"green"})}}}),this.update_sidebar(i,s),this.make_page_selected){let h=(s.is_public?"":"private/")+frappe.router.slug(s.title);frappe.set_route(h),this.make_page_selected=!1}this.make_sidebar(),this.show_sidebar_actions()}}});a.show()}update_sidebar(t,e){let i=t.public!=(e.is_public||0),n=t.title!=e.title,o=lt({},t),s=(t.public?this.public_pages:this.private_pages).filter(l=>l.parent_page==t.title);if(this.make_page_selected=t.selected,o.title=e.title,o.icon=e.icon,o.parent_page=e.parent||"",o.public=e.is_public,n||i)if(e.is_public)o.name=e.title,o.label=e.title,o.for_user="";else{let l=frappe.session.user;o.name=`${e.title}-${l}`,o.label=`${e.title}-${l}`,o.for_user=l}this.update_cached_values(t,o),s.length&&s.forEach(l=>{l.parent_page=e.title,i&&this.update_child_sidebar(l,e)})}update_child_sidebar(t,e){let i=lt({},t);if(this.make_page_selected=t.selected,t.public=e.is_public,e.is_public)t.name=t.title,t.label=t.title,t.for_user="";else{let n=frappe.session.user;t.name=`${t.title}-${n}`,t.label=`${t.title}-${n}`,t.for_user=n}this.update_cached_values(i,t)}update_cached_values(t,e,i,n){let[o,a]=t.public?[this.public_pages,this.private_pages]:[this.private_pages,this.public_pages],s=o.findIndex(l=>l.title==t.title);i&&s++,(frappe.workspaces[frappe.router.slug(t.name)]||n)&&(!i&&delete frappe.workspaces[frappe.router.slug(t.name)],e&&(frappe.workspaces[frappe.router.slug(e.name)]={title:e.title})),(this.pages&&this.pages[t.name]||n)&&(e&&(this.pages[e.name]=this.pages[t.name]||{}),!i&&delete this.pages[t.name]),e?t.public!=(e.is_public||e.public||0)?(!i&&o.splice(s,1),a.push(e)):n?o.push(e):o.splice(s,i?0:1,e):o.splice(s,1),this.sidebar_pages.pages=[...this.public_pages,...this.private_pages],this.cached_pages=this.sidebar_pages}add_settings_button(t,e){this.dropdown_list=[{label:__("Edit"),title:__("Edit Workspace"),icon:frappe.utils.icon("edit","sm"),action:()=>this.edit_page(t)},{label:__("Duplicate"),title:__("Duplicate Workspace"),icon:frappe.utils.icon("duplicate","sm"),action:()=>this.duplicate_page(t)},{label:__("Delete"),title:__("Delete Workspace"),icon:frappe.utils.icon("delete-active","sm"),action:()=>this.delete_page(t)}];let i=$(`
			<div class="btn btn-secondary btn-xs setting-btn dropdown-btn" title="${__("Setting")}">
				${frappe.utils.icon("dot-horizontal","xs")}
			</div>
			<div class="dropdown-list hidden"></div>
		`),n=function(o,a,s,l){let u=$(`
				<div class="dropdown-item" title="${a}">
					<span class="dropdown-item-icon">${s}</span>
					<span class="dropdown-item-label">${o}</span>
				</div>
			`);return u.click(c=>{c.stopPropagation(),l&&l()}),u};i.filter(".dropdown-btn").click(o=>{o.stopPropagation(),i.filter(".dropdown-list.hidden").length&&$(".dropdown-list:not(.hidden)").addClass("hidden"),i.filter(".dropdown-list").toggleClass("hidden")}),e.append(i),this.dropdown_list.forEach(o=>{i.filter(".dropdown-list").append(n(o.label,o.title,o.icon,o.action))})}delete_page(t){frappe.confirm(__("Are you sure you want to delete page {0}?",[t.title.bold()]),()=>{frappe.call({method:"frappe.desk.doctype.workspace.workspace.delete_page",args:{page:t},callback:function(e){if(e.message){let i=e.message,n=__("Workspace {0} Deleted Successfully",[i.title.bold()]);frappe.show_alert({message:n,indicator:"green"})}}}),this.page.clear_primary_action(),this.update_cached_values(t),this.current_page.name==t.title&&this.current_page.public==t.public&&frappe.set_route("/"),this.make_sidebar(),this.show_sidebar_actions()})}duplicate_page(t){var e=this;let i=lt({},t);!this.has_access&&i.public&&(i.public=0);let n=this.get_parent_pages({public:i.public}),o=new frappe.ui.Dialog({title:__("Create Duplicate"),fields:[{label:__("Title"),fieldtype:"Data",fieldname:"title",reqd:1},{label:__("Parent"),fieldtype:"Select",fieldname:"parent",options:n,default:i.parent_page},{label:__("Public"),fieldtype:"Check",fieldname:"is_public",depends_on:`eval:${this.has_access}`,default:i.public,onchange:function(){o.set_df_property("parent","options",this.get_value()?e.public_parent_pages:e.private_parent_pages)}},{fieldtype:"Column Break"},{label:__("Icon"),fieldtype:"Icon",fieldname:"icon",default:i.icon}],primary_action_label:__("Duplicate"),primary_action:a=>{if(!this.validate_page(a))return;o.hide(),frappe.call({method:"frappe.desk.doctype.workspace.workspace.duplicate_page",args:{page_name:t.name,new_page:a},callback:function(u){if(u.message){let c=u.message,h=__("Duplicate of {0} named as {1} is created successfully",[t.title.bold(),c.title.bold()]);frappe.show_alert({message:h,indicator:"green"})}}}),i.title=a.title,i.public=a.is_public||0,i.name=a.title+(i.public?"":"-"+frappe.session.user),i.label=i.name,i.icon=a.icon,i.parent_page=a.parent||"",i.for_user=i.public?"":frappe.session.user,i.is_editable=!i.public,i.selected=!0,this.update_cached_values(t,i,!0);let l=(a.is_public?"":"private/")+frappe.router.slug(a.title);frappe.set_route(l),e.make_sidebar(),e.show_sidebar_actions()}});o.show()}make_sidebar_sortable(){let t=this;$(".nested-container").each(function(){new Sortable(this,{handle:".drag-handle",draggable:".sidebar-item-container.is-draggable",group:"nested",animation:150,fallbackOnBody:!0,swapThreshold:.65,onEnd:function(e){let i=$(e.item).attr("item-public")=="1";t.prepare_sorted_sidebar(i),t.update_sorted_sidebar()}})})}prepare_sorted_sidebar(t){let e=t?this.public_pages:this.private_pages;t?this.sorted_public_items=this.sort_sidebar(this.sidebar.find(".standard-sidebar-section").last(),e):this.sorted_private_items=this.sort_sidebar(this.sidebar.find(".standard-sidebar-section").first(),e),this.sidebar_pages.pages=[...this.public_pages,...this.private_pages],this.cached_pages=this.sidebar_pages}sort_sidebar(t,e){let i=[];return Array.from(t.find(".sidebar-item-container")).forEach((n,o)=>{let a="";n.closest(".nested-container").classList.contains("sidebar-child-item")&&(a=n.parentElement.parentElement.attributes["item-name"].value),i.push({title:n.attributes["item-name"].value,parent_page:a,public:n.attributes["item-public"].value});let s=$(n).find(".sidebar-item-control .drop-icon").first();$(n).find(".sidebar-child-item > *").length!=0?s.removeClass("hidden"):s.addClass("hidden");let l=e.findIndex(c=>c.title==n.attributes["item-name"].value),u=e[l];u.parent_page=a,l!=o&&(e.splice(l,1),e.splice(o,0,u))}),i}update_sorted_sidebar(){(this.sorted_public_items||this.sorted_private_items)&&frappe.call({method:"frappe.desk.doctype.workspace.workspace.sort_pages",args:{sb_public_items:this.sorted_public_items,sb_private_items:this.sorted_private_items},callback:function(t){if(t.message){let e="Sidebar Updated Successfully";frappe.show_alert({message:__(e),indicator:"green"})}}})}make_blocks_sortable(){let t=this;this.page_sortable=Sortable.create(this.page.main.find(".codex-editor__redactor").get(0),{handle:".drag-handle",draggable:".ce-block",animation:150,onEnd:function(e){t.editor.blocks.move(e.newIndex,e.oldIndex)},setData:function(){}})}initialize_new_page(){var t=this;this.get_parent_pages();let e=new frappe.ui.Dialog({title:__("New Workspace"),fields:[{label:__("Title"),fieldtype:"Data",fieldname:"title",reqd:1},{label:__("Parent"),fieldtype:"Select",fieldname:"parent",options:this.private_parent_pages},{label:__("Public"),fieldtype:"Check",fieldname:"is_public",depends_on:`eval:${this.has_access}`,onchange:function(){e.set_df_property("parent","options",this.get_value()?t.public_parent_pages:t.private_parent_pages)}},{fieldtype:"Column Break"},{label:__("Icon"),fieldtype:"Icon",fieldname:"icon"}],primary_action_label:__("Create"),primary_action:i=>{if(!this.validate_page(i))return;e.hide(),this.initialize_editorjs_undo(),this.setup_customization_buttons({is_editable:!0});let n=i.title+(i.is_public?"":"-"+frappe.session.user),o=[{type:"header",data:{text:i.title}}],a={content:JSON.stringify(o),name:n,label:n,title:i.title,public:i.is_public||0,for_user:i.is_public?"":frappe.session.user,icon:i.icon,parent_page:i.parent||"",is_editable:!0,selected:!0};this.editor.render({blocks:o}).then(async()=>{this.editor.configuration.readOnly&&(this.is_read_only=!1,await this.editor.readOnly.toggle()),frappe.call({method:"frappe.desk.doctype.workspace.workspace.new_page",args:{new_page:a},callback:function(u){if(u.message){let c=__("Workspace {0} Created Successfully",[a.title.bold()]);frappe.show_alert({message:c,indicator:"green"})}}}),this.update_cached_values(a,a,!0,!0);let l=(a.public?"":"private/")+frappe.router.slug(a.title);frappe.set_route(l),this.make_sidebar(),this.show_sidebar_actions()})}});e.show()}validate_page(t,e){let i="",[n,o]=t.is_public?[this.private_pages,this.public_pages]:[this.public_pages,this.private_pages],a=this.sidebar_categories[t.is_public];o&&o.filter(l=>l.title==t.title)[0]&&(i=__("Page with title {0} already exist.",[t.title.bold()])),frappe.router.doctype_route_exist(frappe.router.slug(t.title))&&(i=__("Doctype with same route already exist. Please choose different title."));let s=e&&n.filter(l=>l.parent_page==e.title);return s&&s.every(l=>o&&o.find(u=>u.title==l.title)?(i=__("One of the child page with name {0} already exist in {1} Section. Please update the name of the child page first before moving",[l.title.bold(),a.bold()]),cur_dialog.hide(),!1):!0),i?(frappe.throw(__(i)),!1):!0}add_page_to_sidebar(t){let e=$(".standard-sidebar-section"),i=lt({},t);i.selected=!0,i.is_editable=!0;let n=this.sidebar_item_container(i);this.add_sidebar_actions(i,n.find(".sidebar-item-control"),!0),n.find(".sidebar-item-control .drag-handle").css("margin-right","8px");let o=i.is_public?e[1]:e[0];if(!i.parent)!i.is_public&&e.first().removeClass("hidden"),n.appendTo(o);else{let s=$(o).find(`[item-name="${i.parent}"]`),l=s.find(".sidebar-child-item"),u=s.find(".drop-icon");l[0]||(l=$('<div class="sidebar-child-item hidden nested-container"></div>').appendTo(s),u.toggleClass("hidden")),n.appendTo(l),l.removeClass("hidden"),s.find(".drop-icon.hidden").removeClass("hidden"),s.find(".drop-icon use").attr("href","#icon-small-up")}let a=i.is_public?"public":"private";this.sidebar_items&&this.sidebar_items[a]&&!this.sidebar_items[a][i.title]&&(this.sidebar_items[a][i.title]=n)}initialize_editorjs(t){this.tools={header:{class:this.blocks.header,inlineToolbar:["HeaderSize","bold","italic","link"],config:{default_size:4}},paragraph:{class:this.blocks.paragraph,inlineToolbar:["HeaderSize","bold","italic","link"],config:{placeholder:__("Choose a block or continue typing")}},chart:{class:this.blocks.chart,config:{page_data:this.page_data||[]}},card:{class:this.blocks.card,config:{page_data:this.page_data||[]}},shortcut:{class:this.blocks.shortcut,config:{page_data:this.page_data||[]}},onboarding:{class:this.blocks.onboarding,config:{page_data:this.page_data||[]}},quick_list:{class:this.blocks.quick_list,config:{page_data:this.page_data||[]}},spacer:this.blocks.spacer,HeaderSize:frappe.workspace_block.tunes.header_size},this.editor=new Wd.default({data:{blocks:t||[]},tools:this.tools,autofocus:!1,readOnly:!0,logLevel:"ERROR"})}save_page(t){let e=this;return this.current_page={name:t.title,public:t.public},this.editor.save().then(i=>{let n={};i.blocks.forEach(a=>{a.data.new&&(n[a.type]||(n[a.type]=[]),n[a.type].push(a.data.new),delete a.data.new)});let o=i.blocks.filter(a=>a.type!="card"||a.data.card_name!=="Custom Documents"&&a.data.card_name!=="Custom Reports");return t.content==JSON.stringify(o)&&Object.keys(n).length===0?(this.setup_customization_buttons(t),frappe.show_alert({message:__("No changes made on the page"),indicator:"warning"}),!1):(this.create_page_skeleton(),t.content=JSON.stringify(o),frappe.call({method:"frappe.desk.doctype.workspace.workspace.save_page",args:{title:t.title,public:t.public||0,new_widgets:n,blocks:JSON.stringify(o)},callback:function(a){a.message&&(e.discard=!0,e.update_cached_values(t,t),e.reload(),frappe.show_alert({message:__("Page Saved Successfully"),indicator:"green"}))}}),!0)}).catch(i=>{})}reload(){this.sorted_public_items=[],this.sorted_private_items=[],this.setup_pages(!0),this.discard=!1,this.undo.readOnly=!0}create_page_skeleton(){$(".layout-main-section").find(".workspace-skeleton").length||($(".layout-main-section").prepend(frappe.render_template("workspace_loading_skeleton")),$(".layout-main-section").find(".codex-editor").addClass("hidden"))}remove_page_skeleton(){$(".layout-main-section").find(".codex-editor").removeClass("hidden"),$(".layout-main-section").find(".workspace-skeleton").remove()}create_sidebar_skeleton(){$(".list-sidebar").find(".workspace-sidebar-skeleton").length||($(".list-sidebar").prepend(frappe.render_template("workspace_sidebar_loading_skeleton")),$(".desk-sidebar").addClass("hidden"))}remove_sidebar_skeleton(){$(".desk-sidebar").removeClass("hidden"),$(".list-sidebar").find(".workspace-sidebar-skeleton").remove()}register_awesomebar_shortcut(){"abcdefghijklmnopqrstuvwxyz".split("").forEach(t=>{let e={action:i=>($("#navbar-search").focus(),!1),page:this.page};frappe.ui.keys.add_shortcut(lt({shortcut:t},e)),frappe.ui.keys.add_shortcut(lt({shortcut:`shift+${t}`},e))})}};var wr=class{constructor(t){Object.assign(this,t),this.editing=Boolean(this.values&&Object.keys(this.values).length)}make(){this.make_dialog(),this.setup_dialog_events(),this.dialog.show(),window.cur_dialog=this.dialog,this.editing&&this.set_default_values()}make_dialog(){this.dialog=new frappe.ui.Dialog({title:this.get_title(),fields:this.get_fields(),primary_action:t=>{t=this.process_data(t),!this.editing&&!t.name&&(t.name=`${this.type}-${this.label}-${frappe.utils.get_random(20)}`),this.dialog.hide(),this.primary_action(t)},primary_action_label:this.primary_action_label||__("Add")})}get_title(){let t=this.editing?"Edit":"Add",e=t=t+" "+frappe.model.unscrub(this.type);return __(e)}get_fields(){}set_default_values(){return this.dialog.set_values(this.values)}process_data(t){return t}setup_dialog_events(){}hide_field(t){this.dialog.set_df_property(t,"hidden",!0)}show_field(t){this.dialog.set_df_property(t,"hidden",!1)}setup_filter(t){this.filter_group&&(this.filter_group.wrapper.empty(),delete this.filter_group);let e=this.dialog.get_field("filter_area_loading").$wrapper;$(`<span class="text-muted">${__("Loading Filters...")}</span>`).appendTo(e),this.filters=[],this.generate_filter_from_json(),this.filter_group=new frappe.ui.FilterGroup({parent:this.dialog.get_field("filter_area").$wrapper,doctype:t,on_change:()=>{}}),frappe.model.with_doctype(t,()=>{this.filter_group.add_filters_to_filter_group(this.filters),this.hide_field("filter_area_loading"),this.show_field("filter_area")})}},Yd=class extends wr{constructor(t){super(t)}get_fields(){return[{fieldtype:"Link",fieldname:"chart_name",label:"Chart Name",options:"Dashboard Chart",reqd:1},{fieldtype:"Data",fieldname:"label",label:"Label"}]}process_data(t){return t.label=t.label?t.label:t.chart_name,t}},Gd=class extends wr{constructor(t){super(t)}get_fields(){return[{fieldtype:"Link",fieldname:"document_type",label:"DocType",options:"DocType",reqd:1,onchange:()=>{this.document_type=this.dialog.get_value("document_type"),this.document_type&&this.setup_filter(this.document_type)},get_query:()=>({filters:{issingle:0,istable:0}})},{fieldtype:"Column Break",fieldname:"column_break_4"},{fieldtype:"Data",fieldname:"label",label:"Label"},{fieldtype:"Section Break",fieldname:"filter_section",label:__("Add Filters"),depends_on:"eval: doc.document_type"},{fieldtype:"HTML",fieldname:"filter_area_loading"},{fieldtype:"HTML",fieldname:"filter_area"}]}generate_filter_from_json(){this.values&&this.values.quick_list_filter&&(this.filters=frappe.utils.get_filter_from_json(this.values.quick_list_filter,this.values.document_type))}process_data(t){if(this.filter_group){let e=this.filter_group.get_filters();t.quick_list_filter=frappe.utils.get_filter_as_json(e)}return t.label=t.label?t.label:t.document_type,t}},Xd=class extends wr{constructor(t){super(t)}get_fields(){return[{fieldtype:"Link",fieldname:"onboarding_name",label:"Onboarding Name",options:"Module Onboarding",reqd:1}]}},Kd=class extends wr{constructor(t){super(t)}get_fields(){let t=this;return[{fieldtype:"Data",fieldname:"label",label:"Label"},{fieldname:"links",fieldtype:"Table",label:__("Card Links"),editable_grid:1,data:t.values?JSON.parse(t.values.links):[],get_data:()=>t.values?JSON.parse(t.values.links):[],fields:[{fieldname:"label",fieldtype:"Data",in_list_view:1,label:"Label"},{fieldname:"icon",fieldtype:"Icon",label:"Icon"},{fieldname:"link_type",fieldtype:"Select",in_list_view:1,label:"Link Type",reqd:1,options:["DocType","Page","Report"]},{fieldname:"link_to",fieldtype:"Dynamic Link",in_list_view:1,label:"Link To",reqd:1,get_options:e=>e.doc.link_type},{fieldname:"column_break_7",fieldtype:"Column Break"},{fieldname:"dependencies",fieldtype:"Data",label:"Dependencies"},{fieldname:"only_for",fieldtype:"Link",label:"Only for",options:"Country"},{default:"0",fieldname:"onboard",fieldtype:"Check",label:"Onboard"},{default:"0",fieldname:"is_query_report",fieldtype:"Check",label:"Is Query Report"}]}]}process_data(t){let e="";return t.links?t.links.map((i,n)=>{let o=n+1;i.link_type||(e=__("Following fields have missing values")+": <br><br><ul>",e+=`<li>${__("Link Type in Row")} ${o}</li>`),i.link_to||(e+=`<li>${__("Link To in Row")} ${o}</li>`),i.label=i.label?i.label:i.link_to}):e=__("You must add atleast one link."),e&&(e+="</ul>",frappe.throw({message:__(e),title:__("Missing Values Required"),indicator:"orange"})),t.label=t.label?t.label:t.chart_name,t}},Jd=class extends wr{constructor(t){super(t)}hide_filters(){this.hide_field("count_section_break"),this.hide_field("filters_section_break")}show_filters(){this.show_field("count_section_break"),this.show_field("filters_section_break")}get_fields(){return[{fieldtype:"Select",fieldname:"type",label:"Type",reqd:1,options:`DocType
Report
Page
Dashboard`,onchange:()=>{this.dialog.get_value("type")=="DocType"?this.dialog.fields_dict.link_to.get_query=()=>({query:"frappe.core.report.permitted_documents_for_user.permitted_documents_for_user.query_doctypes",filters:{user:frappe.session.user}}):this.dialog.fields_dict.link_to.get_query=null}},{fieldtype:"Data",fieldname:"label",label:"Label"},{fieldtype:"Column Break",fieldname:"column_break_4"},{fieldtype:"Dynamic Link",fieldname:"link_to",label:"Link To",reqd:1,options:"type",onchange:()=>{if(this.dialog.get_value("type")=="DocType"){let t=this.dialog.get_value("link_to");t&&frappe.boot.single_types.includes(t)?this.hide_filters():t&&(this.setup_filter(t),this.show_filters());let e=["List","Report Builder","Dashboard","New"];frappe.boot.treeviews.includes(t)&&e.push("Tree"),frappe.boot.calendars.includes(t)&&e.push("Calendar"),this.dialog.set_df_property("doc_view","options",e.join(`
`))}else this.hide_filters()}},{fieldtype:"Select",fieldname:"doc_view",label:"DocType View",options:`List
Report Builder
Dashboard
Tree
New
Calendar`,description:__("Which view of the associated DocType should this shortcut take you to?"),default:"List",depends_on:t=>{if(this.dialog){let e=this.dialog.get_value("link_to"),i=frappe.boot.single_types.includes(e);return t.type=="DocType"&&!i}return!1}},{fieldtype:"Section Break",fieldname:"filters_section_break",label:__("Count Filter"),hidden:1},{fieldtype:"HTML",fieldname:"filter_area_loading"},{fieldtype:"HTML",fieldname:"filter_area",hidden:1},{fieldtype:"Section Break",fieldname:"count_section_break",label:__("Count Customizations"),hidden:1},{fieldtype:"Select",fieldname:"color",label:__("Color"),options:["Grey","Green","Red","Orange","Pink","Yellow","Blue","Cyan"],default:"Grey",input_class:"color-select",onchange:()=>{let t=this.dialog.fields_dict.color.value.toLowerCase(),e=this.dialog.fields_dict.color.$input;e.parent().find(".color-box").get(0)||$('<div class="color-box"></div>').insertBefore(e.get(0)),e.parent().find(".color-box").get(0).style.backgroundColor=`var(--text-on-${t})`}},{fieldtype:"Column Break",fieldname:"column_break_3"},{fieldtype:"Data",fieldname:"format",label:__("Format"),description:__("For Example: {} Open")}]}set_default_values(){super.set_default_values().then(()=>{this.dialog.fields_dict.link_to.df.onchange()})}generate_filter_from_json(){this.values&&this.values.stats_filter&&(this.filters=frappe.utils.get_filter_from_json(this.values.stats_filter,this.values.link_to))}process_data(t){if(this.dialog.get_value("type")=="DocType"&&this.filter_group){let e=this.filter_group.get_filters();t.stats_filter=frappe.utils.get_filter_as_json(e)}return t.label=t.label?t.label:frappe.model.unscrub(t.link_to),t}},Zd=class extends wr{constructor(t){super(t)}get_fields(){let t;return t=[{fieldtype:"Select",label:__("Choose Existing Card or create New Card"),fieldname:"new_or_existing",options:["New Card","Existing Card"]},{fieldtype:"Link",fieldname:"card",label:__("Number Cards"),options:"Number Card",get_query:()=>({query:"frappe.desk.doctype.number_card.number_card.get_cards_for_user",filters:{document_type:this.document_type}}),depends_on:'eval: doc.new_or_existing == "Existing Card"'},{fieldtype:"Section Break",fieldname:"sb_1",depends_on:'eval: doc.new_or_existing == "New Card"'},{label:__("Label"),fieldname:"label",fieldtype:"Data",mandatory_depends_on:'eval: doc.new_or_existing == "New Card"'},{label:__("Doctype"),fieldname:"document_type",fieldtype:"Link",options:"DocType",onchange:()=>{this.document_type=this.dialog.get_value("document_type"),this.set_aggregate_function_fields(this.dialog.get_values()),this.setup_filter(this.document_type)},hidden:1},{label:__("Color"),fieldname:"color",fieldtype:"Color"},{fieldtype:"Column Break",fieldname:"cb_1"},{label:__("Function"),fieldname:"function",fieldtype:"Select",options:["Count","Sum","Average","Minimum","Maximum"],mandatory_depends_on:'eval: doc.new_or_existing == "New Card"'},{label:__("Function Based On"),fieldname:"aggregate_function_based_on",fieldtype:"Select",depends_on:"eval: doc.function !== 'Count'",mandatory_depends_on:'eval: doc.function !== "Count" && doc.new_or_existing == "New Card"'},{fieldtype:"Section Break",fieldname:"sb_1",label:__("Add Filters"),depends_on:'eval: doc.new_or_existing == "New Card"'},{fieldtype:"HTML",fieldname:"filter_area_loading"},{fieldtype:"HTML",fieldname:"filter_area",hidden:1},{fieldtype:"Section Break",fieldname:"sb_1"}],t}setup_dialog_events(){this.document_type||(this.default_values&&this.default_values.doctype?(this.document_type=this.default_values.doctype,this.setup_filter(this.default_values.doctype),this.set_aggregate_function_fields()):this.show_field("document_type"))}set_aggregate_function_fields(){let t=[];this.document_type&&frappe.get_meta(this.document_type)&&frappe.get_meta(this.document_type).fields.map(e=>{if(frappe.model.numeric_fieldtypes.includes(e.fieldtype)){if(e.fieldtype=="Currency"&&(!e.options||e.options!=="Company:company:default_currency"))return;t.push({label:e.label,value:e.fieldname})}}),this.dialog.set_df_property("aggregate_function_based_on","options",t)}process_data(t){return t.new_or_existing=="Existing Card"&&(t.name=t.card),t.stats_filter=this.filter_group&&JSON.stringify(this.filter_group.get_filters()),t.document_type=this.document_type,t}};function gr(r){return{chart:Yd,shortcut:Jd,number_card:Zd,links:Kd,onboarding:Xd,quick_list:Gd}[r]||wr}var Bt=class{constructor(t){Object.assign(this,t)}make(t,e,i=t){let n=this.config.page_data[t+"s"].items.find(o=>frappe.utils.unescape_html(o.label)==frappe.utils.unescape_html(__(e)));return n?(this.wrapper.innerHTML="",n.in_customize_mode=!this.readOnly,this.block_widget=new frappe.widget.SingleWidgetGroup({container:this.wrapper,type:i,class_name:t=="chart"?"widget-charts":"",options:this.options,widgets:n,api:this.api,block:this.block}),this.wrapper.setAttribute(t+"_name",e),this.readOnly||this.block_widget.customize(),!0):!1}rendered(t){t&&(this.wrapper=t),!this.readOnly&&this.resizer();let e=this.wrapper.closest(".ce-block");this.set_col_class(e,this.get_col())}resizer(){this.wrapper.className=this.wrapper.className+" resizable";var t=document.createElement("div");t.className="resizer",this.wrapper.parentElement.appendChild(t),t.addEventListener("mousedown",o,!1);let e=this;var i,n;function o(u){i=u.clientX,n=this.parentElement.offsetWidth,document.documentElement.addEventListener("mousemove",a,!1),document.documentElement.addEventListener("mouseup",l,!1)}function a(u){$(this).css("cursor","col-resize"),$(".widget").css("pointer-events","none"),$(e.wrapper.parentElement).find(".resizer").css("border-right","3px solid var(--gray-400)"),s(),n+u.clientX-i-n>60?(i=u.clientX,e.increase_width()):n+u.clientX-i-n<-60&&(i=u.clientX,e.decrease_width())}function s(){document.selection?document.selection.empty():window.getSelection().removeAllRanges()}function l(){$(this).css("cursor","default"),$(".widget").css("pointer-events","auto"),$(e.wrapper.parentElement).find(".resizer").css("border-right","0px solid transparent"),document.documentElement.removeEventListener("mousemove",a,!1),document.documentElement.removeEventListener("mouseup",l,!1)}}new(t,e=t){let i=this,n=gr(e),o=t+"_name";this.dialog=new n({label:this.label,type:e,primary_action:a=>{a.in_customize_mode=1,this.block_widget=frappe.widget.make_widget(Ht(lt({},a),{widget_type:e,container:this.wrapper,options:Ht(lt({},this.options),{on_delete:()=>this.api.blocks.delete(),on_edit:()=>this.on_edit(this.block_widget)})})),this.block_widget.customize(this.options),this.wrapper.setAttribute(o,this.block_widget.label),$(this.wrapper).find(".widget").addClass(`${e} edit-mode`),this.new_block_widget=this.block_widget.get_config(),this.add_settings_button()}}),!this.readOnly&&this.data&&!this.data[o]&&(this.dialog.make(),this.dialog.dialog.get_close_btn().click(()=>{i.wrapper.closest(".ce-block").remove()}))}on_edit(t){let e=t.edit_dialog.type+"_name";t.edit_dialog.type=="links"&&(e="card_name");let i=t.get_config();this.block_widget.widgets=i,this.wrapper.setAttribute(e,i.label),this.new_block_widget=t.get_config()}add_new_block_button(){let t=$(`
			<div class="new-block-button">${frappe.utils.icon("add-round","lg")}</div>
		`);t.appendTo(this.wrapper),t.click(e=>{e.stopPropagation();let i=this.api.blocks.getCurrentBlockIndex()+1;this.api.blocks.insert("paragraph",{},{},i),this.api.caret.setToBlock(i)})}add_settings_button(){let t=this;this.dropdown_list=[{label:"Delete",title:"Delete Block",icon:frappe.utils.icon("delete-active","sm"),action:()=>this.api.blocks.delete()},{label:"Expand",title:"Expand Block",icon:frappe.utils.icon("expand-alt","sm"),action:()=>this.increase_width()},{label:"Shrink",title:"Shrink Block",icon:frappe.utils.icon("shrink","sm"),action:()=>this.decrease_width()},{label:"Move Up",title:"Move Up",icon:frappe.utils.icon("up-arrow","sm"),action:()=>this.move_block("up")},{label:"Move Down",title:"Move Down",icon:frappe.utils.icon("down-arrow","sm"),action:()=>this.move_block("down")}];let e=$(this.wrapper).find(".widget-control"),i=$(`
			<div class="dropdown-btn">
				<button class="btn btn-secondary btn-xs setting-btn" title="${__("Setting")}">
					${frappe.utils.icon("dot-horizontal","xs")}
				</button>
				<div class="dropdown-list hidden"></div>
			</div>
		`),n=function(o,a,s,l){let u=$(`
				<div class="dropdown-item" title="${__(a)}">
					<span class="dropdown-item-icon">${s}</span>
					<span class="dropdown-item-label">${__(o)}</span>
				</div>
			`);return u.click(c=>{c.stopPropagation(),l&&l()}),u};i.click(o=>{o.stopPropagation(),i.find(".dropdown-list").toggleClass("hidden")}),e.prepend(i),this.dropdown_list.forEach(o=>{(o.label=="Expand"||o.label=="Shrink")&&t.options&&!t.options.allow_resize||i.find(".dropdown-list").append(n(o.label,o.title,o.icon,o.action))})}get_col(){let t=this.col||12,e="col-xs-12",i=this.wrapper.closest(".ce-block"),n=new RegExp(/\bcol-.+?\b/,"g");if(i&&i.className.match(n)){i.classList.forEach(function(a){a.match(n)&&(e=a)});let o=e.split("-");t=parseInt(o[2])}return t}decrease_width(){this.update_width("decrease")}increase_width(){this.update_width("increase")}update_width(t){let e=this.options&&this.options.min_width||3,i=this.api.blocks.getCurrentBlockIndex();if(i<0)return;let n=this.api.blocks.getBlockByIndex(i);if(!n)return;let o=n.holder,a="col-xs-12",s=new RegExp(/\bcol-.+?\b/,"g");if(o.className.match(s)){o.classList.forEach(h=>{h.match(s)&&(a=h)});let l=a.split("-"),u=parseInt(l[2]),c=!0;t=="increase"?(c=u<=11,u=u+1):t=="decrease"&&(c=u>e,u=u-1),c&&this.set_col_class(o,u)}}set_col_class(t,e){let i=$.grep(t.classList,function(o){return o.indexOf("col-")!==0});t.classList="",i.forEach(o=>{t.classList.add(o)});let n="col-xs-12";e<=12&&e>=7?n="col-xs-"+e:e==6||e==5?(t.classList.add("col-xs-12"),n="col-sm-"+e):e==4?(t.classList.add("col-xs-12"),t.classList.add("col-sm-6"),n="col-md-"+e):e==3&&(t.classList.add("col-xs-12"),t.classList.add("col-sm-6"),t.classList.add("col-md-4"),n="col-lg-"+e),t.classList.add(n)}move_block(t){let e=this.api.blocks.getCurrentBlockIndex(),i=e+(t=="down"?1:-1);this.api.blocks.move(i,e)}};var hn=class extends Bt{constructor({data:t,config:e,api:i,readOnly:n}){super({config:e,api:i,readOnly:n});this._settings=this.config,this._data=this.normalizeData(t),this._element=this.getTag(),this.data=t,this.col=this.data.col?this.data.col:"12"}normalizeData(t){let e={};return typeof t!="object"&&(t={}),e.text=t.text||"",e.col=parseInt(t.col)||12,e}render(){if(this.wrapper=document.createElement("div"),!this.readOnly){let t=$('<div class="widget-head"></div>'),e=$('<div class="widget-control"></div>');return t[0].appendChild(this._element),e.appendTo(t),t.appendTo(this.wrapper),this.wrapper.classList.add("widget","header","edit-mode"),this.add_settings_button(),this.add_new_block_button(),frappe.utils.add_custom_button(frappe.utils.icon("drag","xs"),null,"drag-handle",__("Drag"),null,e),this.wrapper}return this._element}merge(t){let e={text:this.data.text+t.text};this.data=e}validate(t){return t.text.trim()!==""}save(){return this.wrapper=this._element,{text:this.wrapper.innerHTML.replace(/&nbsp;/gi,""),col:this.get_col()}}rendered(){super.rendered(this._element)}static get sanitize(){return{level:!1,text:{br:!0,b:!0,i:!0,a:!0,span:!0}}}static get isReadOnlySupported(){return!0}get data(){return this._data.text=this._element.innerHTML,this._data}set data(t){if(this._data=this.normalizeData(t),t.text!==void 0){let e=this._data.text||"",i=/<[a-z][\s\S]*>/i.test(e);this._element.innerHTML=i?e:`<span class="h${this._settings.default_size}">${e}</span>`}!this.readOnly&&this.wrapper&&this.wrapper.classList.add("widget","header")}getTag(){let t=document.createElement("DIV"),e=this._data.text||"&nbsp";return t.innerHTML=`<span class="h${this._settings.default_size}"><b>${e}</b></span>`,t.classList.add("ce-header"),this.readOnly||(t.contentEditable=!0),t.dataset.placeholder=this.api.i18n.t(this._settings.placeholder||""),t}static get toolbox(){return{title:"Heading",icon:frappe.utils.icon("header","sm")}}};var Wr=class extends Bt{static get DEFAULT_PLACEHOLDER(){return""}constructor({data:t,config:e,api:i,readOnly:n}){super({config:e,api:i,readOnly:n});this._CSS={block:this.api.styles.block,wrapper:"ce-paragraph"},this.readOnly||(this.onKeyUp=this.onKeyUp.bind(this)),this._placeholder=this.config.placeholder?this.config.placeholder:Wr.DEFAULT_PLACEHOLDER,this._data={},this._element=this.drawView(),this._preserveBlank=this.config.preserveBlank!==void 0?this.config.preserveBlank:!1,this.data=t,this.col=this.data.col?this.data.col:"12"}onKeyUp(t){if(!this.wrapper||(this.show_hide_block_list(!0),t.code!=="Backspace"&&t.code!=="Delete"))return;let{textContent:e}=this._element;e===""&&(this.show_hide_block_list(),this._element.innerHTML="")}show_hide_block_list(t){let i=($(this.wrapper).hasClass("ce-paragraph")?$(this.wrapper.parentElement):$(this.wrapper)).find(".block-list-container.dropdown-list");i.removeClass("hidden"),t&&i.addClass("hidden")}drawView(){let t=document.createElement("DIV");return t.classList.add(this._CSS.wrapper,this._CSS.block,"widget"),t.contentEditable=!1,this.readOnly||(t.contentEditable=!0,t.addEventListener("focus",()=>{let{textContent:e}=this._element;e===""&&this.show_hide_block_list()}),t.addEventListener("blur",()=>{!this.over_block_list_item&&this.show_hide_block_list(!0)}),t.dataset.placeholder=this.api.i18n.t(this._placeholder),t.addEventListener("keyup",this.onKeyUp)),t}open_block_list(){let t=__("Templates"),e=$(`
			<div class="block-list-container dropdown-list">
				<div class="dropdown-title">${t.toUpperCase()}</div>
			</div>
		`),i=frappe.workspace_block.blocks;Object.keys(i).forEach(n=>{let o=$(`
				<div class="block-list-item dropdown-item">
					<span class="dropdown-item-icon">${i[n].toolbox.icon}</span>
					<span class="dropdown-item-label">${__(i[n].toolbox.title)}</span>
				</div>
			`);o.click(a=>{a.stopPropagation();let s=this.api.blocks.getCurrentBlockIndex();this.api.blocks.delete(),this.api.blocks.insert(n,{},{},s),this.api.caret.setToBlock(s)}),o.mouseenter(()=>{this.over_block_list_item=!0}).mouseleave(()=>{this.over_block_list_item=!1}),e.append(o)}),e.addClass("hidden"),e.appendTo(this.wrapper)}render(){if(this.wrapper=document.createElement("div"),!this.readOnly){let t=$('<div class="widget-control paragraph-control"></div>');return this.wrapper.appendChild(this._element),this._element.classList.remove("widget"),t.appendTo(this.wrapper),this.wrapper.classList.add("widget","paragraph","edit-mode"),this.open_block_list(),this.add_new_block_button(),this.add_settings_button(),frappe.utils.add_custom_button(frappe.utils.icon("drag","xs"),null,"drag-handle",__("Drag"),null,t),this.wrapper}return this._element}merge(t){let e={text:this.data.text+t.text};this.data=e}validate(t){return!(t.text.trim()===""&&!this._preserveBlank)}save(){return this.wrapper=this._element,{text:this.wrapper.innerHTML,col:this.get_col()}}rendered(){super.rendered(this._element)}onPaste(t){let e={text:t.detail.data.innerHTML};this.data=e}static get sanitize(){return{text:{br:!0,b:!0,i:!0,a:!0,span:!0}}}static get isReadOnlySupported(){return!0}get data(){let t=this._element.innerHTML;return this._data.text=t,this._data}set data(t){this._data=t||{},this._element.innerHTML=__(this._data.text)||""}static get pasteConfig(){return{tags:["P"]}}static get toolbox(){return{title:"Text",icon:frappe.utils.icon("text","sm")}}};var _n=class extends Bt{static get toolbox(){return{title:"Card",icon:frappe.utils.icon("card","sm")}}static get isReadOnlySupported(){return!0}constructor({data:t,api:e,config:i,readOnly:n,block:o}){super({data:t,api:e,config:i,readOnly:n,block:o});this.sections={},this.col=this.data.col?this.data.col:"4",this.allow_customization=!this.readOnly,this.options={allow_sorting:this.allow_customization,allow_create:this.allow_customization,allow_delete:this.allow_customization,allow_hiding:!1,allow_edit:!0,allow_resize:!0}}render(){if(this.wrapper=document.createElement("div"),this.new("card","links"),!(this.data&&this.data.card_name&&!this.make("card",this.data.card_name,"links")))return this.readOnly||($(this.wrapper).find(".widget").addClass("links edit-mode"),this.add_settings_button(),this.add_new_block_button()),this.wrapper}validate(t){return!!t.card_name}save(){return{card_name:this.wrapper.getAttribute("card_name"),col:this.get_col(),new:this.new_block_widget}}};var mn=class extends Bt{static get toolbox(){return{title:"Chart",icon:frappe.utils.icon("chart","sm")}}static get isReadOnlySupported(){return!0}constructor({data:t,api:e,config:i,readOnly:n,block:o}){super({data:t,api:e,config:i,readOnly:n,block:o});this.col=this.data.col?this.data.col:"12",this.allow_customization=!this.readOnly,this.options={allow_sorting:this.allow_customization,allow_create:this.allow_customization,allow_delete:this.allow_customization,allow_hiding:!1,allow_edit:!0,allow_resize:!0,min_width:6,max_widget_count:2}}render(){if(this.wrapper=document.createElement("div"),this.new("chart"),!(this.data&&this.data.chart_name&&!this.make("chart",this.data.chart_name)))return this.readOnly||($(this.wrapper).find(".widget").addClass("chart edit-mode"),this.add_settings_button(),this.add_new_block_button()),this.wrapper}validate(t){return!!t.chart_name}save(){return{chart_name:this.wrapper.getAttribute("chart_name"),col:this.get_col(),new:this.new_block_widget}}};var gn=class extends Bt{static get toolbox(){return{title:"Shortcut",icon:frappe.utils.icon("shortcut","sm")}}static get isReadOnlySupported(){return!0}constructor({data:t,api:e,config:i,readOnly:n,block:o}){super({data:t,api:e,config:i,readOnly:n,block:o});this.col=this.data.col?this.data.col:"3",this.allow_customization=!this.readOnly,this.options={allow_sorting:this.allow_customization,allow_create:this.allow_customization,allow_delete:this.allow_customization,allow_hiding:!1,allow_edit:!0,allow_resize:!0}}rendered(){super.rendered(),this.remove_last_divider(),$(window).resize(()=>{this.remove_last_divider()})}remove_last_divider(){let t=this.wrapper.closest(".ce-block"),e=$(".layout-main-section")[0].offsetWidth,i=t.offsetLeft+t.offsetWidth;e-i<=110?$(t).find(".divider").addClass("hidden"):$(t).find(".divider").removeClass("hidden")}render(){if(this.wrapper=document.createElement("div"),this.new("shortcut"),!(this.data&&this.data.shortcut_name&&!this.make("shortcut",this.data.shortcut_name))){if(!this.readOnly)$(this.wrapper).find(".widget").addClass("shortcut edit-mode"),this.add_settings_button(),this.add_new_block_button();else{let t=frappe.utils.icon("arrow-up-right","xs","","stroke: grey","ml-2");$(this.wrapper).find(".widget .widget-title").append(t),$(this.wrapper).append($('<div class="divider"></div>'))}return this.wrapper}}validate(t){return!!t.shortcut_name}save(){return{shortcut_name:this.wrapper.getAttribute("shortcut_name"),col:this.get_col(),new:this.new_block_widget}}};var vn=class extends Bt{static get toolbox(){return{title:"Spacer",icon:frappe.utils.icon("spacer","sm")}}static get isReadOnlySupported(){return!0}constructor({data:t,api:e,config:i,readOnly:n}){super({data:t,api:e,config:i,readOnly:n});this.col=this.data.col?this.data.col:"12"}render(){if(this.wrapper=document.createElement("div"),this.wrapper.classList.add("widget","spacer"),!this.readOnly){let t=$(`
				<div class="widget-head">
					<div class="spacer-left"></div>
					<div>${__("Spacer")}</div>
					<div class="widget-control"></div>
				</div>
			`);t.appendTo(this.wrapper),this.wrapper.classList.add("edit-mode"),this.wrapper.style.minHeight=40+"px";let e=t.find(".widget-control");this.add_settings_button(),this.add_new_block_button(),frappe.utils.add_custom_button(frappe.utils.icon("drag","xs"),null,"drag-handle",__("Drag"),null,e)}return this.wrapper}save(){return{col:this.get_col()}}};var bn=class extends Bt{static get toolbox(){return{title:"Onboarding",icon:frappe.utils.icon("onboarding","sm")}}static get isReadOnlySupported(){return!0}constructor({data:t,api:e,config:i,readOnly:n,block:o}){super({data:t,api:e,config:i,readOnly:n,block:o});this.col=this.data.col?this.data.col:"12",this.allow_customization=!this.readOnly,this.options={allow_sorting:this.allow_customization,allow_create:this.allow_customization,allow_delete:this.allow_customization,allow_hiding:!1,allow_edit:!0,allow_resize:!1}}rendered(){let t=this.wrapper.closest(".ce-block");this.readOnly&&!$(this.wrapper).find(".onboarding-widget-box").is(":visible")&&$(t).hide(),this.set_col_class(t,this.get_col())}new(t,e=t){let i=this,n=gr(e),o=t+"_name";this.dialog=new n({label:this.label,type:e,primary_action:a=>{a.in_customize_mode=1,this.block_widget=frappe.widget.make_widget(Ht(lt({},a),{widget_type:e,container:this.wrapper,options:Ht(lt({},this.options),{on_delete:()=>this.api.blocks.delete(),on_edit:()=>this.on_edit(this.block_widget)}),new:!0})),this.block_widget.customize(this.options),this.wrapper.setAttribute(o,this.block_widget.label||this.block_widget.onboarding_name),$(this.wrapper).find(".widget").addClass(`${e} edit-mode`),this.new_block_widget=this.block_widget.get_config(),this.add_settings_button()}}),!this.readOnly&&this.data&&!this.data[o]&&(this.dialog.make(),this.dialog.dialog.get_close_btn().click(()=>{i.wrapper.closest(".ce-block").remove()}))}make(t,e){let i=this.config.page_data.onboardings.items.find(n=>n.label==__(e));return i?(this.wrapper.innerHTML="",i.in_customize_mode=!this.readOnly,this.block_widget=frappe.widget.make_widget({container:this.wrapper,widget_type:"onboarding",in_customize_mode:i.in_customize_mode,options:Ht(lt({},this.options),{on_delete:()=>this.api.blocks.delete(),on_edit:()=>this.on_edit(this.block_widget)}),label:i.label,title:i.title||__("Let's Get Started"),subtitle:i.subtitle,steps:i.items,success:i.success,docs_url:i.docs_url,user_can_dismiss:i.user_can_dismiss}),this.wrapper.setAttribute(t+"_name",e),this.readOnly||this.block_widget.customize(this.options),!0):!1}render(){if(this.wrapper=document.createElement("div"),this.new("onboarding"),!(this.data&&this.data.onboarding_name&&!this.make("onboarding",this.data.onboarding_name)))return this.readOnly||($(this.wrapper).find(".widget").addClass("onboarding edit-mode"),this.add_settings_button(),this.add_new_block_button()),$(this.wrapper).css("padding-bottom","20px"),this.wrapper}validate(t){return!!t.onboarding_name}save(){return{onboarding_name:this.wrapper.getAttribute("onboarding_name"),col:this.get_col(),new:this.new_block_widget}}};var yn=class extends Bt{static get toolbox(){return{title:"Quick List",icon:frappe.utils.icon("list","sm")}}static get isReadOnlySupported(){return!0}constructor({data:t,api:e,config:i,readOnly:n,block:o}){super({data:t,api:e,config:i,readOnly:n,block:o});this.col=this.data.col?this.data.col:"4",this.allow_customization=!this.readOnly,this.options={allow_sorting:this.allow_customization,allow_create:this.allow_customization,allow_delete:this.allow_customization,allow_hiding:!1,allow_edit:!0,allow_resize:!0,min_width:4,max_widget_count:2}}render(){if(this.wrapper=document.createElement("div"),this.new("quick_list"),!(this.data&&this.data.quick_list_name&&!this.make("quick_list",this.data.quick_list_name)))return this.readOnly||($(this.wrapper).find(".widget").addClass("quick_list edit-mode"),this.add_settings_button(),this.add_new_block_button()),this.wrapper}validate(t){return!!t.quick_list_name}save(){return{quick_list_name:this.wrapper.getAttribute("quick_list_name"),col:this.get_col(),new:this.new_block_widget}}};var wn=class{static get isInline(){return!0}get state(){return this._state}set state(t){this._state=t}get title(){return"Header Size"}constructor({api:t}){this.api=t,this.button=null,this._state=!0,this.selectedText=null,this.range=null,this.headerLevels=[]}render(){return this.button=document.createElement("button"),this.button.type="button",this.button.innerHTML=`${frappe.utils.icon("header","sm")}${frappe.utils.icon("small-down","xs")}`,this.button.classList="header-inline-tool",this.button}checkState(t){let e=this.api.selection.findParentTag("SPAN");for(let n of["h1","h2","h3","h4","h5","h6"])if(e&&e.classList.contains(n)){let o=n.match(/\d+/)[0];$(".header-inline-tool svg:first-child").replaceWith(frappe.utils.icon(`header-${o}`,"md"))}t.anchorNode}change_size(t,e){if(!t)return;let i=document.createElement("SPAN");i.classList.add(`h${e}`),i.innerText=t.toString(),this.remove_parent_tag(t,t.commonAncestorContainer,i),t.extractContents(),t.insertNode(i),this.api.inlineToolbar.close()}remove_parent_tag(t,e,i){let n=t.startContainer.data,o=i.innerText,a=e.parentElement;n!==o&&(a=e),a.innerText==o&&!a.classList.contains("ce-header")&&!a.classList.contains("ce-paragraph")&&(this.remove_parent_tag(t,e.parentElement,i),a.remove())}surround(t){this.selectedText=t.cloneContents(),this.actions.hidden=!this.actions.hidden,this.range=this.actions.hidden?null:t,this.state=!this.actions.hidden}renderActions(){this.actions=document.createElement("div"),this.actions.classList="header-level-select",this.headerLevels=new Array(6).fill().map((t,e)=>{let i=document.createElement("div");return i.classList.add(`h${e+1}`,"header-level"),i.innerText=`Header ${e+1}`,i});for(let[t,e]of this.headerLevels.entries())this.actions.appendChild(e),this.api.listeners.on(e,"click",()=>{this.change_size(this.range,t+1)});return this.actions.hidden=!0,this.actions}destroy(){for(let t of this.headerLevels)this.api.listeners.off(t,"click")}};frappe.provide("frappe.workspace_block");frappe.workspace_block.blocks={header:hn,paragraph:Wr,card:_n,chart:mn,shortcut:gn,spacer:vn,onboarding:bn,quick_list:yn};frappe.workspace_block.tunes={header_size:wn};var zt=class{constructor(t){Object.assign(this,t),this.make()}refresh(){this.set_title(),this.set_actions(),this.set_body(),this.setup_events(),this.set_footer()}get_config(){return{name:this.name,label:this.label}}customize(t){if(this.in_customize_mode=!0,this.action_area.empty(),t.allow_sorting&&frappe.utils.add_custom_button(frappe.utils.icon("drag","xs"),null,"drag-handle",__("Drag"),null,this.action_area),t.allow_hiding){this.hidden&&(this.widget.removeClass("hidden"),this.body.css("opacity",.5),this.title_field.css("opacity",.5),this.footer.css("opacity",.5));let e=this.hidden?"fa fa-eye":"fa fa-eye-slash",i=this.hidden?__("Show"):__("Hide");frappe.utils.add_custom_button(`<i class="${e}" aria-hidden="true"></i>`,()=>this.hide_or_show(),"show-or-hide-button",i,null,this.action_area),this.show_or_hide_button=this.action_area.find(".show-or-hide-button")}t.allow_edit&&frappe.utils.add_custom_button(frappe.utils.icon("edit","xs"),()=>this.edit(),"edit-button",__("Edit"),null,this.action_area)}make(){this.make_widget(),this.widget.appendTo(this.container)}make_widget(){this.widget=$(`<div class="widget" data-widget-name="${this.name?this.name:""}">
			<div class="widget-head">
				<div class="widget-label">
					<div class="widget-title"></div>
					<div class="widget-subtitle"></div>
				</div>
				<div class="widget-control"></div>
			</div>
			<div class="widget-body"></div>
			<div class="widget-footer"></div>
		</div>`),this.title_field=this.widget.find(".widget-title"),this.subtitle_field=this.widget.find(".widget-subtitle"),this.body=this.widget.find(".widget-body"),this.action_area=this.widget.find(".widget-control"),this.head=this.widget.find(".widget-head"),this.footer=this.widget.find(".widget-footer"),this.refresh()}set_title(t){let e=this.title||this.label||this.name,i=t?frappe.ellipsis(e,t):e;if(this.icon){let n=frappe.utils.icon(this.icon,"lg");this.title_field[0].innerHTML=`${n} <span class="ellipsis" title="${i}">${i}</span>`}else this.title_field[0].innerHTML=`<span class="ellipsis" title="${i}">${i}</span>`,t&&this.title_field[0].setAttribute("title",this.title||this.label);this.subtitle&&this.subtitle_field.html(this.subtitle)}delete(t=!0,e=!1){let i=n=>{this.widget.remove(),!e&&this.options.on_delete&&this.options.on_delete(this.name,n)};t?(this.widget.addClass("zoom-out"),setTimeout(()=>{i(!0)},300)):i(!1)}edit(){let t=gr(this.widget_type);this.edit_dialog=new t({label:this.label,type:this.widget_type,values:this.get_config(),primary_action:e=>{Object.assign(this,e),e.name=this.name,this.new=!0,this.refresh(),this.options.on_edit&&this.options.on_edit(e)},primary_action_label:__("Save")}),this.edit_dialog.make()}toggle_width(){this.width=="Full"?(this.widget.removeClass("full-width"),this.width=null,this.refresh()):(this.widget.addClass("full-width"),this.width="Full",this.refresh());let t=this.width=="Full"?__("Collapse"):__("Expand");this.resize_button.attr("title",t)}hide_or_show(){this.hidden?(this.body.css("opacity",1),this.title_field.css("opacity",1),this.footer.css("opacity",1),this.hidden=!1):(this.body.css("opacity",.5),this.title_field.css("opacity",.5),this.footer.css("opacity",.5),this.hidden=!0),this.show_or_hide_button.empty();let t=this.hidden?"fa fa-eye":"fa fa-eye-slash",e=this.hidden?__("Show"):__("Hide");$(`<i class="${t}" aria-hidden="true" title="${e}"></i>`).appendTo(this.show_or_hide_button)}setup_events(){}set_actions(){}set_body(){}set_footer(){}};frappe.provide("frappe.widget.utils");frappe.provide("frappe.dashboards");frappe.provide("frappe.dashboards.chart_sources");var kn=class extends zt{constructor(t){t.shadow=!0;super(t);this.height=this.height||240}get_config(){return{name:this.name,chart_name:this.chart_name,label:this.label,hidden:this.hidden,width:this.width}}refresh(){delete this.dashboard_chart,this.set_body(),this.make_chart()}set_chart_title(){let t=this.widget.width()<600?40:60;this.set_title(t)}set_body(){this.widget.addClass("dashboard-widget-box"),this.width=="Full"&&this.widget.addClass("full-width")}setup_container(){this.body.empty(),this.chart_doc.type=="Heatmap"&&this.setup_heatmap_container(),this.loading=$(`<div class="chart-loading-state text-muted" style="height: ${this.height}px;">${__("Loading...")}</div>`),this.loading.appendTo(this.body),this.empty=$(`<div class="chart-loading-state text-muted" style="height: ${this.height}px;">${__("No Data")}</div>`),this.empty.hide().appendTo(this.body),this.chart_wrapper=$("<div></div>"),this.chart_wrapper.appendTo(this.body),this.$heatmap_legend=null,this.set_chart_title()}setup_heatmap_container(){this.widget.addClass("heatmap-chart"),this.widget.removeClass("full-width").addClass("full-width"),this.width="Full"}set_summary(){this.$summary?this.$summary.empty():(this.$summary=$('<div class="report-summary"></div>').hide(),this.head.after(this.$summary)),this.summary.forEach(t=>{frappe.utils.build_summary_item(t).appendTo(this.$summary)}),this.summary.length&&this.$summary.show()}make_chart(){this.get_settings().then(()=>{if(!this.settings){this.deleted=!0,this.widget.remove();return}this.chart_settings||(this.chart_settings={}),this.setup_container(),this.in_customize_mode||(this.action_area.empty(),this.prepare_chart_actions(),this.chart_doc.timeseries&&this.chart_doc.chart_type!=="Custom"&&this.render_time_series_filters()),frappe.run_serially([()=>this.prepare_chart_object(),()=>this.setup_filter_button(),()=>this.fetch_and_update_chart()])})}render_time_series_filters(){let t=this.get_time_series_filters();frappe.dashboard_utils.render_chart_filters(t,"chart-actions",this.action_area,0)}get_time_series_filters(){let t;return this.chart_doc.type=="Heatmap"?t=[{label:this.chart_settings.heatmap_year||this.chart_doc.heatmap_year,options:frappe.dashboard_utils.get_years_since_creation(frappe.boot.user.creation),action:e=>{this.selected_heatmap_year=e,this.save_chart_config_for_user({heatmap_year:this.selected_heatmap_year}),this.fetch_and_update_chart()}}]:t=[{label:this.chart_settings.time_interval||this.chart_doc.time_interval,options:["Yearly","Quarterly","Monthly","Weekly","Daily"],icon:"calendar",class:"time-interval-filter",action:e=>{this.selected_time_interval=e,this.save_chart_config_for_user({time_interval:this.selected_time_interval}),this.fetch_and_update_chart()}},{label:this.chart_settings.timespan||this.chart_doc.timespan,options:["Select Date Range","Last Year","Last Quarter","Last Month","Last Week"],class:"timespan-filter",action:e=>{this.selected_timespan=e,this.selected_timespan==="Select Date Range"?this.render_date_range_field():(this.selected_from_date=null,this.selected_to_date=null,this.date_field_wrapper&&(this.date_field_wrapper.hide(),this.title_field.show(),this.subtitle_field.show(),this.head.css("flex-direction","row")),this.save_chart_config_for_user({timespan:this.selected_timespan,from_date:null,to_date:null}),this.fetch_and_update_chart())}}],t}fetch_and_update_chart(){this.args={timespan:this.selected_timespan||this.chart_settings.timespan,time_interval:this.selected_time_interval||this.chart_settings.time_interval,from_date:this.selected_from_date||this.chart_settings.from_date,to_date:this.selected_to_date||this.chart_settings.to_date,heatmap_year:this.selected_heatmap_year||this.chart_settings.heatmap_year},this.fetch(this.filters,!0,this.args).then(t=>{this.chart_doc.chart_type=="Report"&&(this.report_result=t,this.summary=t.report_summary,t=this.get_report_chart_data(t)),this.update_chart_object(),this.data=t,this.render()})}render_date_range_field(){(!this.date_field_wrapper||!this.date_field_wrapper.is(":visible"))&&(this.date_field_wrapper=$('<div class="dashboard-date-field pull-right"></div>').insertAfter(this.action_area.find(".timespan-filter")),this.width!=="Full"&&this.widget.width()<700&&(this.title_field.hide(),this.subtitle_field.hide(),this.head.css("flex-direction","row-reverse")),this.date_range_field=frappe.ui.form.make_control({df:{fieldtype:"DateRange",fieldname:"from_date",placeholder:"Date Range",input_class:"input-xs",default:[this.chart_settings.from_date,this.chart_settings.to_date],value:[this.chart_settings.from_date,this.chart_settings.to_date],reqd:1,change:()=>{let t=this.date_range_field.get_value();this.selected_from_date=t[0],this.selected_to_date=t[1],t&&t.length==2&&(this.save_chart_config_for_user({timespan:this.selected_timespan,from_date:this.selected_from_date,to_date:this.selected_to_date}),this.fetch_and_update_chart())}},parent:this.date_field_wrapper,render_input:1}),this.date_range_field.$input.focus())}get_report_chart_data(t){if(t.chart&&this.chart_doc.use_report_chart)return t.chart.data;{let e=[];this.chart_doc.y_axis.map(a=>{e.push(a.y_field)});let i={y_fields:e,x_field:this.chart_doc.x_field,chart_type:this.chart_doc.type,color:this.chart_doc.color},n=t.columns.map(a=>frappe.report_utils.prepare_field_from_column(a));return frappe.report_utils.make_chart_options(n,t,i).data}}prepare_chart_actions(){let t=[{label:__("Refresh"),action:"action-refresh",handler:()=>{delete this.dashboard_chart,this.make_chart()}},{label:__("Edit"),action:"action-edit",handler:()=>{frappe.set_route("Form","Dashboard Chart",this.chart_doc.name)}},{label:__("Reset Chart"),action:"action-reset",handler:()=>{this.reset_chart(),delete this.dashboard_chart,this.make_chart()}}];this.chart_doc.document_type?t.push({label:__("{0} List",[this.chart_doc.document_type]),action:"action-list",handler:()=>{frappe.set_route("List",this.chart_doc.document_type)}}):this.chart_doc.chart_type==="Report"&&t.push({label:__("{0} Report",[this.chart_doc.report_name]),action:"action-list",handler:()=>{frappe.set_route("query-report",this.chart_doc.report_name,this.filters)}}),this.set_chart_actions(t)}setup_filter_button(){this.in_customize_mode||(this.is_document_type=this.chart_doc.chart_type!=="Report"&&this.chart_doc.chart_type!=="Custom",this.filter_button=$(`<div class="filter-chart btn btn-xs pull-right">
				${frappe.utils.icon("filter","sm")}
			</div>`),this.filter_button.appendTo(this.action_area),this.is_document_type?(this.filter_group&&(this.filters=this.filter_group.get_filters()),this.create_filter_group_and_add_filters()):this.filter_button.on("click",()=>{let t;frappe.dashboard_utils.get_filters_for_chart_type(this.chart_doc).then(e=>{this.is_document_type?t=[{fieldtype:"HTML",fieldname:"filter_area"}]:e?t=e.filter(i=>i.fieldname).map(i=>(Object.assign(i,i.dashboard_config||{}),i)):t=[{fieldtype:"HTML",options:__("No Filters Set")}],this.setup_filter_dialog(t)})}))}setup_filter_dialog(t){let e=this,i=new frappe.ui.Dialog({title:__("Set Filters for {0}",[this.chart_doc.chart_name]),fields:t,primary_action:function(){let n=this.get_values();n&&(this.hide(),e.filters=n,e.save_chart_config_for_user({filters:e.filters}),e.fetch_and_update_chart())},primary_action_label:"Set"});i.show(),this.chart_doc.chart_type=="Report"&&(frappe.query_report=new frappe.views.QueryReport({filters:i.fields_list}),frappe.query_reports[this.chart_doc.report_name].onload&&frappe.query_reports[this.chart_doc.report_name].onload(frappe.query_report)),i.set_values(this.filters)}reset_chart(){this.save_chart_config_for_user(null,1),this.chart_settings={},this.filters=null,this.selected_time_interval=null,this.selected_timespan=null,this.selected_heatmap_year=null}save_chart_config_for_user(t,e=0){Object.assign(this.chart_settings,t),frappe.xcall("frappe.desk.doctype.dashboard_settings.dashboard_settings.save_chart_config",{reset:e,config:this.chart_settings,chart_name:this.chart_doc.chart_name})}create_filter_group_and_add_filters(){this.filter_group=new frappe.ui.FilterGroup({doctype:this.chart_doc.document_type,parent_doctype:this.chart_doc.parent_document_type,filter_button:this.filter_button,on_change:()=>{this.filters=this.filter_group.get_filters(),this.save_chart_config_for_user({filters:this.filters}),this.fetch_and_update_chart()}}),this.filters&&frappe.model.with_doctype(this.chart_doc.document_type,()=>{this.filter_group.add_filters_to_filter_group(this.filters)})}set_chart_actions(t){this.chart_actions=$(`<div class="chart-actions dropdown pull-right">
			<button data-toggle="dropdown"
				aria-haspopup="true"aria-expanded="false"
				class="btn btn-xs btn-secondary chart-menu"
			>
				<svg class="icon icon-sm">
					<use href="#icon-dot-horizontal">
					</use>
				</svg>
			</button>
			<ul class="dropdown-menu dropdown-menu-right">
				${t.map(e=>`<li><a class="dropdown-item" data-action="${e.action}">${e.label}</a></li>`).join("")}
			</ul>
		</div>
		`),this.chart_actions.find("a[data-action]").each((e,i)=>{let n=i.dataset.action;$(i).click(t.find(o=>o.action===n))}),this.chart_actions.appendTo(this.action_area)}fetch(t,e=!1,i){let n=this.settings.method;return this.chart_doc.chart_type=="Report"?i={report_name:this.chart_doc.report_name,filters:t,ignore_prepared_report:1}:i={chart_name:this.chart_doc.name,filters:t,refresh:e?1:0,time_interval:i&&i.time_interval?i.time_interval:null,timespan:i&&i.timespan?i.timespan:null,from_date:i&&i.from_date?i.from_date:null,to_date:i&&i.to_date?i.to_date:null,heatmap_year:i&&i.heatmap_year?i.heatmap_year:null},frappe.xcall(n,i)}async get_source_doctype(){if(this.chart_doc.document_type)return this.chart_doc.document_type;if(this.chart_doc.chart_type=="Report"&&this.chart_doc.report_name)return await frappe.db.get_value("Report",this.chart_doc.report_name,"ref_doctype").then(t=>t.message.ref_doctype)}async render(){let t=()=>{let e=this.get_chart_args();this.dashboard_chart?this.dashboard_chart.update(this.data):this.dashboard_chart=frappe.utils.make_chart(this.chart_wrapper[0],e)};!this.data||!this.data.labels||!Object.keys(this.data).length?(this.chart_wrapper.hide(),this.loading.hide(),this.$summary&&this.$summary.hide(),this.empty.show()):(this.loading.hide(),this.empty.hide(),this.chart_wrapper.show(),this.chart_doc.document_type=await this.get_source_doctype(),this.chart_doc.document_type?frappe.model.with_doctype(this.chart_doc.document_type,t):t(),this.width=="Full"&&this.summary&&this.set_summary(),this.chart_doc.type=="Heatmap"&&this.render_heatmap_legend())}get_chart_args(){var l,u;let t=this.get_chart_colors(),e,i,n={Line:"line",Bar:"bar",Percentage:"percentage",Pie:"pie",Donut:"donut",Heatmap:"heatmap"},o=["Pie","Donut"].includes(this.chart_doc.type)?6:9,a={data:this.data,type:n[this.chart_doc.type],colors:t,height:this.height,maxSlices:this.chart_doc.number_of_groups||o,axisOptions:{xIsSeries:this.chart_doc.timeseries,shortenYAxisNumbers:1}};if(this.chart_doc.document_type){let h=frappe.get_meta(this.chart_doc.document_type).fields.find(p=>p.fieldname==this.chart_doc.value_based_on);e=h==null?void 0:h.fieldtype,i=h==null?void 0:h.options}if(this.chart_doc.chart_type=="Report"&&((u=(l=this.report_result)==null?void 0:l.chart)==null?void 0:u.fieldtype)&&(e=this.report_result.chart.fieldtype,i=this.report_result.chart.options),a.tooltipOptions={formatTooltipY:c=>frappe.format(c,{fieldtype:e,options:i},{always_show_decimals:!0,inline:!0})},this.chart_doc.type=="Heatmap"){let c=parseInt(this.selected_heatmap_year||this.chart_settings.heatmap_year||this.chart_doc.heatmap_year);a.data.start=new Date(`${c}-01-01`),a.data.end=new Date(`${c+1}-01-01`)}let s=c=>{let h=JSON.parse(c);for(let p in h)typeof a[p]=="object"&&typeof h[p]=="object"?a[p]=Object.assign(a[p],h[p]):a[p]=h[p]};return this.custom_options&&s(this.custom_options),this.chart_doc.custom_options&&s(this.chart_doc.custom_options),a}get_chart_colors(){let t=[];return this.chart_doc.y_axis.length?this.chart_doc.y_axis.map(e=>{t.push(e.color)}):["Line","Bar"].includes(this.chart_doc.type)?t=[this.chart_doc.color||[]]:this.chart_doc.type=="Heatmap"&&(t=[]),t}render_heatmap_legend(){let t,e=i=>{t=JSON.parse(i).colors};this.custom_options&&e(this.custom_options),this.chart_doc.custom_options&&e(this.chart_doc.custom_options),!this.$heatmap_legend&&this.widget.width()>991&&(this.$heatmap_legend=$(`
				<div class="heatmap-legend">
					<ul class="legend-colors">
						<li style="background-color: ${t[0]||"#ebedf0"}"></li>
						<li style="background-color: ${t[1]||"#c6e48b"}"></li>
						<li style="background-color: ${t[2]||"#7bc96f"}"></li>
						<li style="background-color: ${t[3]||"#239a3b"}"></li>
						<li style="background-color: ${t[4]||"#196127"}"></li>
					</ul>
					<div class="legend-label">
						<div style="margin-bottom: 45px">${__("Less")}</div>
						<div>${__("More")}</div>
					</div>
				</div>
				`),this.body.append(this.$heatmap_legend))}update_last_synced(){if(!this.chart_doc.last_synced_on)return;let t=__("Last synced {0}",[comment_when(this.chart_doc.last_synced_on)]);this.subtitle_field.html(t)}update_chart_object(){frappe.db.get_doc("Dashboard Chart",this.chart_doc.name).then(t=>{this.chart_doc=t,this.update_last_synced()})}prepare_chart_object(){return this.chart_doc.type=="Heatmap"&&!this.chart_doc.heatmap_year&&(this.chart_doc.heatmap_year=frappe.dashboard_utils.get_year(frappe.datetime.now_date())),this.set_chart_filters()}set_chart_filters(){let t=this.chart_settings.filters||null,e=frappe.dashboard_utils.get_all_filters(this.chart_doc);return this.chart_doc.chart_type=="Report"?frappe.dashboard_utils.get_filters_for_chart_type(this.chart_doc).then(i=>{e=this.update_default_date_filters(i,e),this.filters=frappe.utils.parse_array(t)||frappe.utils.parse_array(this.filters)||frappe.utils.parse_array(e)}):(this.filters=frappe.utils.parse_array(t)||frappe.utils.parse_array(this.filters)||frappe.utils.parse_array(e),Promise.resolve())}update_default_date_filters(t,e){return t&&t.map(i=>{["Date","DateRange"].includes(i.fieldtype)&&i.default&&(i.reqd||e[i.fieldname])&&(e[i.fieldname]=i.default)}),e}get_settings(){return frappe.model.with_doc("Dashboard Chart",this.chart_name).then(t=>{if(t)if(this.chart_doc=t,this.chart_doc.chart_type=="Custom"){if(frappe.dashboards.chart_sources[this.chart_doc.source])return this.settings=frappe.dashboards.chart_sources[this.chart_doc.source],Promise.resolve();{let e="frappe.desk.doctype.dashboard_chart_source.dashboard_chart_source.get_config";return frappe.xcall(e,{name:this.chart_doc.source}).then(i=>{frappe.dom.eval(i),this.settings=frappe.dashboards.chart_sources[this.chart_doc.source]})}}else return this.chart_doc.chart_type=="Report"?(this.settings={method:"frappe.desk.query_report.run"},Promise.resolve()):(this.settings={method:"frappe.desk.doctype.dashboard_chart.dashboard_chart.get"},Promise.resolve())})}};frappe.provide("frappe.utils");var xn=class extends zt{constructor(t){t.shadow=!0;super(t)}get_config(){return{name:this.name,icon:this.icon,label:this.label,format:this.format,link_to:this.link_to,doc_view:this.doc_view,color:this.color,restrict_to_domain:this.restrict_to_domain,stats_filter:this.stats_filter,type:this.type}}setup_events(){this.widget.click(()=>{if(this.in_customize_mode)return;let t=frappe.utils.generate_route({route:this.route,name:this.link_to,type:this.type,is_query_report:this.is_query_report,doctype:this.ref_doctype,doc_view:this.doc_view}),e=frappe.utils.get_filter_from_json(this.stats_filter);this.type=="DocType"&&e&&(frappe.route_options=e),frappe.set_route(t)})}set_actions(){if(this.in_customize_mode)return;this.widget.addClass("shortcut-widget-box");let t=frappe.utils.get_filter_from_json(this.stats_filter);this.type=="DocType"&&t&&frappe.db.count(this.link_to,{filters:t}).then(e=>this.set_count(e))}set_count(t){let e=()=>this.format?__(this.format).replace(/{}/g,t):t;this.action_area.empty();let i=e(),n=this.color&&t?this.color.toLowerCase():"gray";$(`<div class="indicator-pill ellipsis ${n}">${i}</div>`).appendTo(this.action_area)}};frappe.provide("frappe.utils");var Cn=class extends zt{constructor(t){t.icon=t.icon||"file";super(t)}get_config(){return{name:this.name,links:JSON.stringify(this.links),link_count:this.links.length,label:this.label,hidden:this.hidden}}set_body(){this.options||(this.options={},this.options.links=this.links),this.widget.addClass("links-widget-box");let t=o=>o.dependencies&&o.incomplete_dependencies,e=o=>t(o)?"disabled-link":"",i=o=>o.open_count?"red":o.onboard?o.count?"blue":"yellow":"gray",n=o=>t(o)?`<span class="link-content ellipsis disabled-link">${o.label?o.label:o.name}</span>
					<div class="module-link-popover popover fade top in" role="tooltip" style="display: none;">
						<div class="arrow"></div>
						<h3 class="popover-title" style="display: none;"></h3>
						<div class="popover-content" style="padding: 12px;">
							<div class="small text-muted">${__("You need to create these first: ")}</div>
							<div class="small">${o.incomplete_dependencies.join(", ")}</div>
						</div>
					</div>`:o.youtube_id?`<span class="link-content help-video-link ellipsis" data-youtubeid="${o.youtube_id}">
						${o.label?o.label:o.name}</span>`:`<span class="link-content ellipsis">${o.label?o.label:o.name}</span>`;this.link_list=this.links.map(o=>{let a={name:o.link_to,type:o.link_type,doctype:o.doctype,is_query_report:o.is_query_report};o.link_type.toLowerCase()=="report"&&!o.is_query_report&&(a.doctype=o.dependencies);let s=frappe.utils.generate_route(a);return $(`<a href="${s}" class="link-item ellipsis ${o.onboard?"onboard-spotlight":""} ${e(o)}" type="${o.type}" title="${o.label?o.label:o.name}">
					<span class="indicator-pill no-margin ${i(o)}"></span>
					${n(o)}
			</a>`)}),this.in_customize_mode&&this.body.empty(),this.link_list.forEach(o=>o.appendTo(this.body))}setup_events(){this.link_list.forEach(t=>{let e=t.find(".link-content");if(t.hasClass("disabled-link")){let i=t.find(".module-link-popover");e.mouseover(()=>{this.in_customize_mode||i.show()}),e.mouseout(()=>i.hide())}else e.click(i=>{if(!this.in_customize_mode&&e.hasClass("help-video-link")){let n=i.currentTarget.dataset.youtubeid;frappe.help.show_video(n)}})})}};frappe.provide("frappe.utils");var Sn=class extends zt{async refresh(){frappe.utils.load_video_player(),this.new&&await this.get_onboarding_data(),this.set_title(),this.set_actions(),this.set_body(),this.setup_events()}get_config(){return{label:this.onboarding_name}}make_body(){this.body.empty(),this.steps_wrapper=$('<div class="onboarding-steps-wrapper"></div>').appendTo(this.body),this.step_preview=$(`<div class="onboarding-step-preview">
			<div class="onboarding-step-body"></div>
			<div class="onboarding-step-footer"></div>
		</div>`).appendTo(this.body),this.step_body=this.step_preview.find(".onboarding-step-body"),this.step_footer=this.step_preview.find(".onboarding-step-footer"),this.steps.forEach((t,e)=>{this.add_step(t,e)}),this.show_step(this.steps[0])}add_step(t,e){let i="pending";t.is_skipped&&(i="skipped"),t.is_complete&&(i="complete");let n=$(`<a class="onboarding-step ${i}">
				<div class="step-title">
					<div class="step-index step-pending">${__(e+1)}</div>
					<div class="step-index step-skipped">${frappe.utils.icon("tick","xs")}</div>
					<div class="step-index step-complete">${frappe.utils.icon("tick","xs")}</div>
					<div>${__(t.title)}</div>
				</div>
			</a>`);if(t.$step=n,!t.is_complete&&!t.is_skipped){let o=$(`<div class="step-skip">${__("Skip")}</div>`);o.appendTo(n),o.on("click",()=>{this.skip_step(t),event.stopPropagation()})}return n.on("click",()=>this.show_step(t)),n.appendTo(this.steps_wrapper),n}show_step(t){this.active_step&&this.active_step.$step.removeClass("active"),t.$step.addClass("active"),this.active_step=t;let e={"Watch Video":a=>this.show_video(a),"Create Entry":a=>{a.is_complete?frappe.set_route(`/app/List/${a.reference_document}`):a.show_full_form?this.create_entry(a):this.show_quick_entry(a)},"Show Form Tour":a=>this.show_form_tour(a),"Update Settings":a=>this.update_settings(a),"View Report":a=>this.open_report(a),"Go to Page":a=>this.go_to_page(a)},i=()=>{this.step_body.empty(),this.step_footer.empty(),n(),t.intro_video_url?$(`<button class="btn btn-primary btn-sm">${__("Watch Tutorial")}</button>`).appendTo(this.step_footer).on("click",o):$(`<button class="btn btn-primary btn-sm">${__(t.action_label||t.action)}</button>`).appendTo(this.step_footer).on("click",()=>e[t.action](t))},n=()=>{let a=t.description?frappe.markdown(t.description):`<h1>${__(t.title)}</h1>`;t.action==="Create Entry"&&(a+=`<p>
					<a href='/app/${frappe.router.slug(t.reference_document)}'>
						${__("Show {0} List",[__(t.reference_document)])}</a>
				</p>`),this.step_body.html(a)},o=()=>{this.step_body.empty(),this.step_footer.empty();let a=$(`<div class="video-player" data-plyr-provider="youtube" data-plyr-embed-id="${t.intro_video_url}"></div>`);a.appendTo(this.step_body);let s=new frappe.Plyr(a[0],{hideControls:!0,resetOnEnd:!0});$(`<button class="btn btn-primary btn-sm">${__(t.action_label||t.action)}</button>`).appendTo(this.step_footer).on("click",()=>{s.pause(),e[t.action](t)}),$(window).one("hashchange",()=>{s.pause()}),$(`<button class="btn btn-secondary ml-2 btn-sm">${__("Back")}</button>`).appendTo(this.step_footer).on("click",i)};i()}go_to_page(t){this.mark_complete(t),frappe.set_route(t.path).then(()=>{let e=t.callback_message||__("You can continue with the onboarding after exploring this page"),i=t.callback_title||__("Awesome Work"),n=frappe.msgprint({message:e,title:i,primary_action:{action:()=>{n.hide()},label:()=>__("Continue")},wide:!0})})}open_report(t){let e=frappe.utils.generate_route({name:t.reference_report,type:"report",is_query_report:t.report_type!=="Report Builder",doctype:t.report_reference_doctype}),i=frappe.get_route();frappe.set_route(e).then(()=>{let n=frappe.msgprint({message:__(t.report_description),title:__(t.reference_report),primary_action:{action:()=>{frappe.set_route(i).then(()=>{this.mark_complete(t)}),n.hide()},label:()=>__("Continue")},secondary_action:{action:()=>{n.hide(),frappe.set_route(i).then(()=>{this.mark_complete(t)})},label:__("Go Back")}});frappe.msg_dialog.custom_onhide=()=>this.mark_complete(t)})}show_form_tour(t){let e;t.is_single?e=frappe.router.slug(t.reference_document):e=`${frappe.router.slug(t.reference_document)}/new`;let i=frappe.get_route();frappe.route_hooks={},frappe.route_hooks.after_load=n=>{let o=()=>{let s=frappe.msgprint({message:__("Let's take you back to onboarding"),title:__("Onboarding complete"),primary_action:{action:()=>{frappe.set_route(i).then(()=>{this.mark_complete(t)}),s.hide()},label:()=>__("Continue")}})},a=t.form_tour;n.tour.init({tour_name:a,on_finish:o}).then(()=>n.tour.start())},frappe.set_route(e)}update_settings(t){let e=frappe.get_route();frappe.route_hooks={},frappe.route_hooks.after_load=i=>{i.scroll_to_field(t.field),i.doc.__unsaved=!0},frappe.route_hooks.after_save=i=>{let n=!1,o={},a=i.doc[t.field],s=null;a&&t.value_to_validate=="%"&&(n=!0),a==t.value_to_validate&&(n=!0),cstr(a)==cstr(t.value_to_validate)&&(n=!0),n?(o.message=__("Let's take you back to onboarding"),o.title=__("Action Complete"),o.primary_action={action:()=>{frappe.set_route(e).then(()=>{this.mark_complete(t)})},label:__("Continue")},s=()=>o.primary_action.action()):(o.message=__("Looks like you didn't change the value"),o.title=__("Try Again"),o.secondary_action={action:()=>frappe.set_route(e),label:__("Go Back")},o.primary_action={action:()=>{frappe.set_route(e).then(()=>{setTimeout(()=>{this.skip_step(t)},300)})},label:__("Skip Step")},s=()=>o.secondary_action.action()),frappe.msgprint(o),frappe.msg_dialog.custom_onhide=()=>s()},frappe.set_route("Form",t.reference_document)}async create_entry(t){let e=frappe.get_route(),i=await this.get_first_document(t.reference_document);frappe.route_hooks={},frappe.route_hooks.after_load=o=>{let a=()=>{frappe.msgprint({message:__("Awesome, now try making an entry yourself"),title:__("Document Saved"),primary_action:{action:()=>{frappe.set_route(e).then(()=>{this.mark_complete(t)})},label:__("Continue")}}),frappe.msg_dialog.custom_onhide=()=>{this.mark_complete(t)}},s=t.form_tour;o.tour.init({tour_name:s,on_finish:a}).then(()=>o.tour.start())};let n=()=>{frappe.msgprint({message:__("Let's take you back to onboarding"),title:__("Action Complete"),primary_action:{action:()=>{frappe.set_route(e).then(()=>{this.mark_complete(t)})},label:__("Continue")}}),frappe.msg_dialog.custom_onhide=()=>{this.mark_complete(t)}};t.is_submittable?(frappe.route_hooks.after_save=()=>{frappe.msgprint({message:__("Submit this document to complete this step."),title:__("Document Saved")})},frappe.route_hooks.after_submit=n):frappe.route_hooks.after_save=n,frappe.set_route("Form",t.reference_document,i)}show_quick_entry(t){let e=frappe.get_route_str();frappe.ui.form.make_quick_entry(t.reference_document,()=>{if(frappe.get_route_str()!=e){let i=frappe.msgprint({message:__("Let's take you back to onboarding"),title:__("Document Saved"),primary_action:{action:()=>{i.hide(),frappe.set_route(e).then(()=>{this.mark_complete(t)})},label:__("Continue")}});frappe.msg_dialog.custom_onhide=()=>{frappe.set_route(e).then(()=>{this.mark_complete(t)})}}else frappe.msgprint({message:__("Let us continue with the onboarding"),title:__("Document Saved")}),this.mark_complete(t)},null,null,!0)}show_video(t){frappe.help.show_video(t.video_url,t.title),this.mark_complete(t)}mark_complete(t){let e=t.$step,i=()=>{t.is_complete=!0,e.removeClass("skipped"),e.addClass("complete")};this.update_step_status(t,"is_complete",1,i)}skip_step(t){let e=t.$step,i=()=>{t.is_skipped=!0,e.removeClass("complete"),e.removeClass("pending"),e.addClass("skipped")};this.update_step_status(t,"is_skipped",1,i)}update_step_status(t,e,i,n){let o={is_complete:"complete",is_skipped:"skipped"};frappe.route_hooks={},frappe.call("frappe.desk.desktop.update_onboarding_step",{name:t.name,field:e,value:i}).then(()=>{n(),t.$step.removeClass("pending").removeClass("complete").removeClass("skipped").addClass(o[e]),this.steps.filter(s=>!(s.is_complete||s.is_skipped)).length==0&&this.show_success()})}show_success(){let t=this.success||__("You seem good to go!"),e=this.success_state_image||"/assets/frappe/images/ui-states/success-color.png",i="";this.docs_url&&(i=__('Congratulations on completing the module setup. If you want to learn more you can refer to the documentation <a target="_blank" href="{0}">here</a>.',[this.docs_url]));let n=$(`<div class="text-center onboarding-success">
					<img src="${e}" alt="Success State" class="zoom-in success-state">
					<h3>${t}</h3>
					<div class="text-muted">${i}</div>
					<button class="btn btn-primary btn-sm">${__("Continue")}</button>
			</div>
		`);n.find(".btn").on("click",()=>this.delete()),this.step_preview.empty(),n.appendTo(this.step_preview)}set_body(){this.widget.addClass("onboarding-widget-box"),this.is_dismissed()?this.widget.hide():this.make_body()}is_dismissed(){if(this.in_customize_mode)return!1;let t=JSON.parse(localStorage.getItem("dismissed-onboarding")||"{}");if(Object.keys(t).includes(this.title)){let e=new Date(t[this.title]),i=new Date;return frappe.datetime.get_hour_diff(i,e)<24}return!1}set_actions(){if(this.in_customize_mode)return;this.action_area.empty();let t=$(`<div class="small" style="cursor:pointer;">${__("Dismiss",null,"Stop showing the onboarding widget.")}</div>`);t.on("click",()=>{let e=JSON.parse(localStorage.getItem("dismissed-onboarding")||"{}");e[this.title]=frappe.datetime.now_datetime(),localStorage.setItem("dismissed-onboarding",JSON.stringify(e)),this.delete(!0,!0),this.widget.closest(".ce-block").hide()}),t.appendTo(this.action_area)}get_onboarding_data(){return frappe.model.with_doc("Module Onboarding",this.onboarding_name).then(t=>{if(t){this.onboarding_doc=t,this.label=t.label,this.title=t.title||__("Let's Get Started"),this.subtitle=t.subtitle,this.success=t.success,this.docs_url=t.docs_url,this.user_can_dismiss=t.user_can_dismiss;let e="frappe.desk.doctype.onboarding_step.onboarding_step.get_onboarding_steps";return frappe.xcall(e,{ob_steps:t.steps}).then(i=>{this.steps=i})}})}async get_first_document(t){let{message:e}=await frappe.db.get_value("Form Tour",{reference_doctype:t},["first_document"]),i;return e.first_document&&await frappe.db.get_list(t,{order_by:"creation"}).then(n=>{Array.isArray(n)&&n.length&&(i=n[0].name)}),i||"new"}};var Tn=class{constructor(t){Object.assign(this,t),this.make()}customize(){}make(){this.make_widget(),this.widget.appendTo(this.container),this.setup_events()}get_title(){let t=`New ${frappe.model.unscrub(this.type)}`;return __(t)}make_widget(){let t=`new-${frappe.scrub(frappe.model.unscrub(this.type),"-")}-widget`;this.widget=$(`<div class="widget new-widget ${t}">
				+ ${this.get_title()}
			</div>`),this.body=this.widget}setup_events(){this.widget.on("click",()=>{this.custom_dialog?this.custom_dialog():this.open_dialog()})}open_dialog(){let t=gr(this.type);this.dialog=new t({label:this.label,type:this.type,values:!1,default_values:this.default_values,primary_action:this.on_create}),this.dialog.make()}delete(){this.widget.remove()}};frappe.provide("frappe.utils");var En=class extends zt{constructor(t){t.shadow=!0;super(t)}get_config(){return{name:this.name,label:this.label,color:this.color,hidden:this.hidden}}refresh(){this.set_body()}set_body(){this.widget.addClass("number-widget-box"),this.make_card()}set_title(){$(this.title_field).html(`<div class="number-label">${this.card_doc.label}</div>`)}make_card(){frappe.model.with_doc("Number Card",this.name).then(t=>{if(t)this.card_doc=t,this.render_card();else if(this.document_type)frappe.run_serially([()=>this.create_number_card(),()=>this.render_card()]);else{this.delete(!1);return}this.set_events()})}create_number_card(){return this.set_doc_args(),frappe.xcall("frappe.desk.doctype.number_card.number_card.create_number_card",{args:this.card_doc}).then(t=>{this.name=t.name,this.card_doc=t,this.widget.attr("data-widget-name",this.name)})}set_events(){$(this.body).click(()=>{this.in_customize_mode||this.card_doc.type=="Custom"||this.set_route()})}set_route(){let t=this.card_doc.type!=="Report",e=t?this.card_doc.document_type:this.card_doc.report_name,i=frappe.utils.generate_route({name:e,type:t?"doctype":"report",is_query_report:!t});if(t){let n=JSON.parse(this.card_doc.filters_json);frappe.route_options=n.reduce((o,a)=>Object.assign(o,{[`${a[0]}.${a[1]}`]:[a[2],a[3]]}),{})}frappe.set_route(i)}set_doc_args(){this.card_doc=Object.assign({},{document_type:this.document_type,label:this.label,function:this.function,aggregate_function_based_on:this.aggregate_function_based_on,color:this.color,filters_json:this.stats_filter})}get_settings(t){return this.filters=this.get_filters(),{Custom:{method:this.card_doc.method,args:{filters:this.filters},get_number:i=>this.get_number_for_custom_card(i)},Report:{method:"frappe.desk.query_report.run",args:{report_name:this.card_doc.report_name,filters:this.filters,ignore_prepared_report:1},get_number:i=>this.get_number_for_report_card(i)},"Document Type":{method:"frappe.desk.doctype.number_card.number_card.get_result",args:{doc:this.card_doc,filters:this.filters},get_number:i=>this.get_number_for_doctype_card(i)}}[t]}get_filters(){return frappe.dashboard_utils.get_all_filters(this.card_doc)}render_card(){this.prepare_actions(),this.set_title(),this.set_loading_state(),this.card_doc.type||(this.card_doc.type="Document Type"),this.settings=this.get_settings(this.card_doc.type),frappe.run_serially([()=>this.render_number(),()=>this.render_stats()])}set_loading_state(){$(this.body).html(`<div class="number-card-loading text-muted">
			${__("Loading...")}
		</div>`)}get_number(){return frappe.xcall(this.settings.method,this.settings.args).then(t=>this.settings.get_number(t))}get_number_for_custom_card(t){typeof t=="object"?(this.number=t.value,this.set_formatted_number(t)):this.formatted_number=t}get_number_for_doctype_card(t){if(this.number=t,this.card_doc.function!=="Count")return frappe.model.with_doctype(this.card_doc.document_type,()=>{let e=frappe.meta.get_docfield(this.card_doc.document_type,this.card_doc.aggregate_function_based_on);this.set_formatted_number(e)});this.formatted_number=t}get_number_for_report_card(t){let e=this.card_doc.report_field,i=t.result.reduce((o,a)=>(a[e]&&o.push(a[e]),o),[]),n=t.columns.find(o=>o.fieldname==e);this.number=frappe.report_utils.get_result_of_fn(this.card_doc.report_function,i),this.set_formatted_number(n)}set_formatted_number(t){let e=frappe.sys_defaults.country,n=frappe.utils.shorten_number(this.number,e,5).split(" "),o=n[1]||"",a=$(frappe.format(n[0],t)).text();this.formatted_number=a+" "+__(o)}render_number(){return this.get_number().then(()=>{$(this.body).html(`<div class="widget-content">
				<div class="number" style="color:${this.card_doc.color}">${this.formatted_number}</div>
				</div>`)})}render_stats(){if(this.card_doc.type!=="Document Type")return;let t="",e="";return this.get_percentage_stats().then(()=>{this.percentage_stat==0||this.percentage_stat==null?e="grey-stat":this.percentage_stat>0?(t=`<span class="indicator-pill-round green">
						${frappe.utils.icon("arrow-up-right","xs")}
					</span>`,e="green-stat"):(t=`<span class="indicator-pill-round red">
						${frappe.utils.icon("arrow-down-left","xs")}
					</span>`,e="red-stat");let n={Daily:__("since yesterday"),Weekly:__("since last week"),Monthly:__("since last month"),Yearly:__("since last year")}[this.card_doc.stats_time_interval],o=(()=>{if(this.percentage_stat==null)return NaN;let a=this.percentage_stat.split(" "),s=a[1]||"";return Math.abs(a[0])+" "+s})();isNaN(o)||$(this.body).find(".widget-content").append(`<div class="card-stats ${e}">
				<span class="percentage-stat-area">
					${t}
					<span class="percentage-stat">
						${o} %
					</span>
				</span>
				<span class="stat-period text-muted">
					${n}
				</span>
			</div>`)})}get_percentage_stats(){return frappe.xcall("frappe.desk.doctype.number_card.number_card.get_percentage_difference",{doc:this.card_doc,filters:this.filters,result:this.number}).then(t=>{t!==void 0&&(this.percentage_stat=frappe.utils.shorten_number(t))})}prepare_actions(){let t=[{label:__("Refresh"),action:"action-refresh",handler:()=>{this.render_card()}},{label:__("Edit"),action:"action-edit",handler:()=>{frappe.set_route("Form","Number Card",this.name)}}];this.set_card_actions(t)}set_card_actions(t){this.card_actions=$(`<div class="card-actions dropdown pull-right">
				<a data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
				...
				</a>
				<ul class="dropdown-menu" style="max-height: 300px; overflow-y: auto;">
					${t.map(e=>`<li class="dropdown-item">
									<a data-action="${e.action}">${e.label}</a>
								</li>`).join("")}
				</ul>
			</div>`),this.card_actions.find("a[data-action]").each((e,i)=>{let n=i.dataset.action;$(i).click(t.find(o=>o.action===n))}),this.action_area.html(this.card_actions)}};frappe.provide("frappe.utils");var An=class extends zt{constructor(t){t.shadow=!0;super(t)}get_config(){return{document_type:this.document_type,label:this.label,quick_list_filter:this.quick_list_filter}}set_actions(){this.in_customize_mode||(this.setup_add_new_button(),this.setup_refresh_list_button(),this.setup_filter_list_button())}setup_add_new_button(){this.add_new_button=$(`<div class="add-new btn btn-xs pull-right"
			title="${__("Add New")}  ${__(this.document_type)}
			">
				${frappe.utils.icon("add","sm")}
			</div>`),this.add_new_button.appendTo(this.action_area),this.add_new_button.on("click",()=>{frappe.set_route(frappe.utils.generate_route({type:"doctype",name:this.document_type,doc_view:"New"}))})}setup_refresh_list_button(){this.refresh_list=$(`<div class="refresh-list btn btn-xs pull-right" title="${__("Refresh List")}">
				${frappe.utils.icon("refresh","sm")}
			</div>`),this.refresh_list.appendTo(this.action_area),this.refresh_list.on("click",()=>{this.body.empty(),this.set_body()})}setup_filter_list_button(){this.filter_list=$(`<div class="filter-list btn btn-xs pull-right" title="${__("Add/Update Filter")}">
				${frappe.utils.icon("filter","sm")}
			</div>`),this.filter_list.appendTo(this.action_area),this.filter_list.on("click",()=>this.setup_filter_dialog())}setup_filter(t){this.filter_group&&(this.filter_group.wrapper.empty(),delete this.filter_group),this.filters=frappe.utils.get_filter_from_json(this.quick_list_filter,t),this.filter_group=new frappe.ui.FilterGroup({parent:this.dialog.get_field("filter_area").$wrapper,doctype:t,on_change:()=>{}}),frappe.model.with_doctype(t,()=>{this.filter_group.add_filters_to_filter_group(this.filters),this.dialog.set_df_property("filter_area","hidden",!1)})}setup_filter_dialog(){let t=[{fieldtype:"HTML",fieldname:"filter_area"}],e=this;this.dialog=new frappe.ui.Dialog({title:__("Set Filters for {0}",[__(this.document_type)]),fields:t,primary_action:function(){let i=e.quick_list_filter,n=e.filter_group.get_filters();e.quick_list_filter=frappe.utils.get_filter_as_json(n),this.hide(),i!=e.quick_list_filter&&(e.body.empty(),e.set_footer(),e.set_body())},primary_action_label:__("Set")}),this.dialog.show(),this.setup_filter(this.document_type)}render_loading_state(){this.body.empty(),this.loading=$(`<div class="list-loading-state text-muted">${__("Loading...")}</div>`),this.loading.appendTo(this.body)}render_no_data_state(){this.loading=$(`<div class="list-no-data-state text-muted">${__("No Data...")}</div>`),this.loading.appendTo(this.body)}setup_quick_list_item(t){let e=frappe.get_indicator(t,this.document_type),i=$(`
			<div class="quick-list-item">
				<div class="ellipsis left">
					<div class="ellipsis title"
						title="${strip_html(t[this.title_field_name])}">
						${strip_html(t[this.title_field_name])}
					</div>
					<div class="timestamp text-muted">
						${frappe.datetime.prettyDate(t.modified)}
					</div>
				</div>
			</div>
		`);return e&&$(`
				<div class="status indicator-pill ${e[1]} ellipsis">
					${__(e[0])}
				</div>
			`).appendTo(i),$(`<div class="right-arrow">${frappe.utils.icon("right","xs")}</div>`).appendTo(i),i.click(()=>{frappe.set_route(`${frappe.utils.get_form_link(this.document_type,t.name)}`)}),i}set_body(){this.widget.addClass("quick-list-widget-box"),this.render_loading_state(),frappe.model.with_doctype(this.document_type,()=>{let t=["name"];if(!this.title_field_name){let n=frappe.get_meta(this.document_type);this.title_field_name=n&&n.title_field||"name"}if(this.title_field_name&&this.title_field_name!="name"&&t.push(this.title_field_name),this.has_status_field=frappe.meta.has_field(this.document_type,"status"),this.has_status_field){t.push("status"),t.push("docstatus");let n=frappe.workflow.get_state_fieldname(this.document_type);n&&t.push(n)}t.push("modified");let e=frappe.utils.get_filter_from_json(this.quick_list_filter),i={method:"frappe.desk.reportview.get",args:{doctype:this.document_type,fields:t,filters:e,order_by:"modified desc",start:0,page_length:4}};frappe.call(i).then(n=>{if(!n.message)return;let o=n.message;if(this.body.empty(),o=Array.isArray(o)?o:frappe.utils.dict(o.keys,o.values),!o.length){this.render_no_data_state();return}this.quick_list=o.map(a=>this.setup_quick_list_item(a)),this.quick_list.forEach(a=>a.appendTo(this.body))})})}set_footer(){this.footer.empty();let t=frappe.utils.get_filter_from_json(this.quick_list_filter);t&&(frappe.route_options=t);let e=frappe.utils.generate_route({type:"doctype",name:this.document_type});this.see_all_button=$(`
			<a href="${e}"class="see-all btn btn-xs">${__("View List")}</a>
		`).appendTo(this.footer)}};frappe.provide("frappe.widget");frappe.widget.widget_factory={chart:kn,base:zt,shortcut:xn,links:Cn,onboarding:Sn,number_card:En,quick_list:An};frappe.widget.make_widget=r=>{let t=frappe.widget.widget_factory[r.widget_type];if(t)return new t(r);console.warn("Invalid Widget Name: "+r.widget_type)};var Yo=class{constructor(t){Object.assign(this,t),this.widgets_list=[],this.widgets_dict={},this.widget_order=[],this.make()}make(){this.make_container(),this.title?this.set_title():this.title_area.remove(),this.widgets&&this.make_widgets()}make_container(){let t=$(`<div class="widget-group ${this.class_name||""}">
				<div class="widget-group-head">
					<div class="widget-group-title"></div>
					<div class="widget-group-control"></div>
				</div>
				<div class="widget-group-body grid-col-${this.columns}">
				</div>
			</div>`);this.widget_area=t,this.hidden&&this.widget_area.hide(),this.title_area=t.find(".widget-group-title"),this.control_area=t.find(".widget-group-control"),this.body=t.find(".widget-group-body"),!this.widgets.length&&this.widget_area.hide(),t.appendTo(this.container)}set_title(){this.title_area[0].innerText=this.title}make_widgets(){this.body.empty(),this.widgets.forEach(t=>{this.add_widget(t)})}add_widget(t){let e=frappe.widget.make_widget(Ht(lt({},t),{widget_type:this.type,container:this.body,height:this.height||null,options:Ht(lt({},this.options),{on_delete:i=>this.on_delete(i)})}));return this.widgets_list.push(e),this.widgets_dict[t.name]=e,e}remove_widget(t){t.widget.remove(),this.widgets_list.filter(e=>{if(e.name==t.name)return!1}),delete this.widgets_dict[t.name]}customize(){this.hidden||this.widget_area.show(),this.widgets_list.forEach(t=>{t.customize(this.options)}),this.options.allow_create&&this.setup_new_widget(),this.options.allow_sorting&&this.setup_sortable()}setup_new_widget(){let t=this.options&&this.options.max_widget_count||Number.POSITIVE_INFINITY;this.widgets_list.length<t&&(this.new_widget=new Tn({container:this.body,type:this.type,custom_dialog:this.custom_dialog,default_values:this.default_values,on_create:e=>{this.new_widget.delete(),delete this.new_widget,e.in_customize_mode=1,this.add_widget(e).customize(this.options),this.widgets_list.length<t&&this.setup_new_widget()}}))}on_delete(t,e){this.widgets_list=this.widgets_list.filter(i=>t!=i.name),delete this.widgets_dict[t],this.update_widget_order(),!this.new_widget&&e&&this.setup_new_widget()}update_widget_order(){this.widget_order=[],this.body.children().each((t,e)=>{let i=e.dataset.widgetName;i&&this.widget_order.push(i)})}setup_sortable(){let t=this.body[0];this.sortable=new Sortable(t,{animation:150,handle:".drag-handle",onEnd:()=>this.update_widget_order()})}get_widget_config(){this.update_widget_order();let t={};return this.widgets_list.forEach(e=>{let i=e.get_config(),n=i.docname?i.docname:i.name;t[n]=i}),{order:this.widget_order,widgets:t}}},Qd=class{constructor(t){Object.assign(this,t),this.widgets_list=[],this.widgets_dict={},this.make()}make(){this.add_widget(this.widgets)}add_widget(t){let e=frappe.widget.make_widget(Ht(lt({},t),{widget_type:this.type,container:this.container,height:this.height||null,options:Ht(lt({},this.options),{on_delete:()=>this.on_delete(),on_edit:()=>this.on_edit(e)})}));return this.widgets_list.push(e),this.widgets_dict[t.name]=e,e}on_delete(){this.api.blocks.delete()}on_edit(t){this.block.call("on_edit",t)}customize(){this.widgets_list.forEach(t=>{t.customize(this.options)})}};frappe.widget.WidgetGroup=Yo;frappe.widget.SingleWidgetGroup=Qd;frappe.templates.sort_selector=`<div class="sort-selector">
	<div class="btn-group">
		<button class="btn btn-default btn-sm btn-order"
			data-value="{{ sort_order }}"
			title="{{ sort_order==="desc" ? __("descending") : __("ascending") }}">
			<span class="sort-order">
				<svg class="icon icon-sm">
					<use href="#icon-{{ sort_order==="desc" ? "sort-descending" : "sort-ascending" }}"></use>
				</svg>
			</span>
		</button>
		<button type="button" class="btn btn-default btn-sm sort-selector-button" data-toggle="dropdown">
			<span class="dropdown-text">{{ __(sort_by_label) }}</span>
			<ul class="dropdown-menu dropdown-menu-right">
				{% for value in options %}
				<li>
					<a class="dropdown-item option" data-value="{{ value.fieldname }}">
						{{ __(value.label) }}
					</a>
				</li>
				{% endfor %}
			</ul>
		</button>
	</div>
</div>
`;frappe.ui.SortSelector=class{constructor(t){$.extend(this,t),this.labels={},this.make()}make(){this.prepare_args(),this.parent.find(".sort-selector").remove(),this.wrapper=$(frappe.render_template("sort_selector",this.args)).appendTo(this.parent),this.bind_events()}bind_events(){var t=this;this.wrapper.find(".btn-order").on("click",function(){let e=$(this),i=$(this).attr("data-value")==="desc"?"asc":"desc",n=$(this).attr("data-value")==="desc"?__("ascending"):__("descending");e.attr("data-value",i),e.attr("title",n),t.sort_order=i;let o=i==="asc"?"sort-ascending":"sort-descending";e.find(".sort-order").html(frappe.utils.icon(o,"sm")),(t.onchange||t.change)(t.sort_by,t.sort_order)}),this.wrapper.find(".dropdown-menu a.option").on("click",function(){t.sort_by=$(this).attr("data-value"),t.wrapper.find(".dropdown-text").html($(this).html()),(t.onchange||t.change)(t.sort_by,t.sort_order)})}prepare_args(){var t=this;if(this.args||(this.args={}),this.args&&typeof this.args=="string"){var e=this.args;this.args={},e.includes("`.`")&&(e=e.split(".")[1]);var i=e.split(" ");if(i.length===2){var n=strip(i[0],"`");this.args.sort_by=n,this.args.sort_order=i[1]}}this.args.options&&this.args.options.forEach(function(o){t.labels[o.fieldname]=o.label}),this.setup_from_doctype(),this.args.sort_by&&!this.args.sort_by_label&&this.args.options.every(function(o){return o.fieldname===t.args.sort_by?(t.args.sort_by_label=o.label,!1):!0})}setup_from_doctype(){var t=this,e=frappe.get_meta(this.doctype);if(!!e){var{meta_sort_field:i,meta_sort_order:n}=this.get_meta_sort_field();if(this.args.sort_by||(i?(this.args.sort_by=i,this.args.sort_order=n):(this.args.sort_by="modified",this.args.sort_order="desc")),this.args.sort_by_label||(this.args.sort_by_label=this.get_label(this.args.sort_by)),!this.args.options){var o=[{fieldname:"modified"},{fieldname:"name"},{fieldname:"creation"},{fieldname:"idx"}];e.title_field&&o.splice(1,0,{fieldname:e.title_field}),i&&o.splice(1,0,{fieldname:i}),e.fields.forEach(function(a){(a.mandatory||a.bold||a.in_list_view||a.reqd)&&frappe.model.is_value_type(a.fieldtype)&&frappe.perm.has_perm(t.doctype,a.permlevel,"read")&&o.push({fieldname:a.fieldname,label:a.label})}),o.forEach(a=>{a.label||(a.label=t.get_label(a.fieldname))}),this.args.options=o.uniqBy(a=>a.fieldname)}this.sort_by=this.args.sort_by,this.sort_order=this.args.sort_order}}get_meta_sort_field(){var t=frappe.get_meta(this.doctype);if(!t)return{meta_sort_field:null,meta_sort_order:null};if(t.sort_field&&t.sort_field.includes(",")){var e=t.sort_field.split(",")[0].split(" ");return{meta_sort_field:e[0],meta_sort_order:e[1]}}else return{meta_sort_field:t.sort_field||"modified",meta_sort_order:t.sort_order?t.sort_order.toLowerCase():""}}get_label(t){return t==="idx"?__("Most Used"):this.labels[t]||frappe.meta.get_label(this.doctype,t)}get_sql_string(){return"`tab"+this.doctype+"`.`"+this.sort_by+"` "+this.sort_order}};frappe.templates.change_log=`{% for (var i=0, l=change_log.length; i < l; i++) {
    var app_info = change_log[i]; %}
	{% if (i > 0) { %} <hr> {% } %}
	<div class="text-left app-change-log">
		<h2 style="margin-top: 10px;">
            {{ app_info.title }}
			<small>{{ __("updated to {0}", [app_info.version]) }}</small>
		</h2>
		<div class="app-change-log-body">
		{% for (var x=0, y=app_info.change_log.length; x < y; x++) {
            var version_info = app_info.change_log[x];
            if(version_info) { %}
    			<p>{{ frappe.markdown(version_info[1]) }}</p>
		    {% }
        } %}
    	</div>
	</div>
{% } %}
`;frappe.templates.workspace_loading_skeleton=`<div class="workspace-skeleton">
	<div class="widget-group">
		<div class="widget-group-head skeleton-header">
			<div class="widget-group-title skeleton-card"></div>
		</div>
		<div class="widget-group-body grid-col-3">
			<div class="widget shortcut-widget-box skeleton-card"></div>
			<div class="widget shortcut-widget-box skeleton-card"></div>
			<div class="widget shortcut-widget-box skeleton-card"></div>
		</div>
	</div>
	<div class="widget-group skeleton-body">
		<div class="widget-group-head skeleton-header">
			<div class="widget-group-title skeleton-card"></div>
		</div>
		<div class="widget-group-body grid-col-3">
			<div class="widget links-widget-box skeleton-card"></div>
			<div class="widget links-widget-box skeleton-card"></div>
			<div class="widget links-widget-box skeleton-card"></div>
			<div class="widget links-widget-box skeleton-card"></div>
			<div class="widget links-widget-box skeleton-card"></div>
		</div>
	</div>
</div>
`;frappe.templates.workspace_sidebar_loading_skeleton=`<div class="workspace-sidebar-skeleton">
	<div class="widget-group-body">
		<div class="widget sidebar-box skeleton-card"></div>
		<div class="widget sidebar-box child skeleton-card"></div>
		<div class="widget sidebar-box child skeleton-card"></div>
		<div class="widget sidebar-box skeleton-card"></div>
	</div>
	<div class="widget-group-body">
		<div class="widget sidebar-box skeleton-card"></div>
		<div class="widget sidebar-box skeleton-card"></div>
		<div class="widget sidebar-box skeleton-card"></div>
		<div class="widget sidebar-box child skeleton-card"></div>
		<div class="widget sidebar-box child skeleton-card"></div>
		<div class="widget sidebar-box child skeleton-card"></div>
		<div class="widget sidebar-box child skeleton-card"></div>
		<div class="widget sidebar-box skeleton-card"></div>
		<div class="widget sidebar-box skeleton-card"></div>
		<div class="widget sidebar-box skeleton-card"></div>
		<div class="widget sidebar-box skeleton-card"></div>
		<div class="widget sidebar-box skeleton-card"></div>
	</div>
</div>`;frappe.start_app=function(){!frappe.Application||(frappe.assets.check(),frappe.provide("frappe.app"),frappe.provide("frappe.desk"),frappe.app=new frappe.Application)};$(document).ready(function(){frappe.utils.supportsES6||frappe.msgprint({indicator:"red",title:__("Browser not supported"),message:__("Some of the features might not work in your browser. Please update your browser to the latest version.")}),frappe.start_app()});frappe.Application=class{constructor(){this.startup()}startup(){if(frappe.socketio.init(),frappe.model.init(),frappe.boot.status==="failed")throw frappe.msgprint({message:frappe.boot.error,title:__("Session Start Failed"),indicator:"red"}),"boot failed";this.setup_frappe_vue(),this.load_bootinfo(),this.load_user_permissions(),this.make_nav_bar(),this.set_favicon(),this.setup_analytics(),this.set_fullwidth_if_enabled(),this.add_browser_class(),this.setup_energy_point_listeners(),this.setup_copy_doc_listener(),frappe.ui.keys.setup(),frappe.ui.keys.add_shortcut({shortcut:"shift+ctrl+g",description:__("Switch Theme"),action:()=>{frappe.theme_switcher&&frappe.theme_switcher.dialog.is_visible?frappe.theme_switcher.hide():(frappe.theme_switcher=new frappe.ui.ThemeSwitcher,frappe.theme_switcher.show())}}),frappe.ui.add_system_theme_switch_listener();let t=document.documentElement;if(new MutationObserver(()=>{frappe.ui.set_theme()}).observe(t,{attributes:!0,attributeFilter:["data-theme-mode"]}),frappe.ui.set_theme(),this.make_page_container(),this.set_route(),$(document).trigger("startup"),$(document).trigger("app_ready"),frappe.boot.messages&&frappe.msgprint(frappe.boot.messages),frappe.user_roles.includes("System Manager")&&setTimeout(()=>{this.show_change_log(),this.show_update_available()},1e3),!frappe.boot.developer_mode){let o=__("Using this console may allow attackers to impersonate you and steal your information. Do not enter or paste code that you do not understand.");console.log(`%c${o}`,"font-size: large")}if(this.show_notes(),frappe.ui.startup_setup_dialog&&!frappe.boot.setup_complete&&(frappe.ui.startup_setup_dialog.pre_show(),frappe.ui.startup_setup_dialog.show()),frappe.realtime.on("version-update",function(){var o=frappe.msgprint({message:__("The application has been updated to a new version, please refresh this page"),indicator:"green",title:__("Version Updated")});o.set_primary_action(__("Refresh"),function(){location.reload(!0)}),o.get_close_btn().toggle(!1)}),this.setup_build_events(),frappe.sys_defaults.email_user_password){var i=frappe.sys_defaults.email_user_password.split(",");for(var n in i)i[n]===frappe.user.name&&this.set_password(i[n])}this.link_preview=new frappe.ui.LinkPreview,frappe.boot.developer_mode||frappe.user.has_role("System Manager")&&setInterval(function(){frappe.call({method:"frappe.core.doctype.log_settings.log_settings.has_unseen_error_log",args:{user:frappe.session.user},callback:function(o){o.message.show_alert&&frappe.show_alert({indicator:"red",message:o.message.message})}})},6e5)}set_route(){frappe.flags.setting_original_route=!0,frappe.boot&&localStorage.getItem("session_last_route")?(frappe.set_route(localStorage.getItem("session_last_route")),localStorage.removeItem("session_last_route")):frappe.router.route(),frappe.after_ajax(()=>frappe.flags.setting_original_route=!1),frappe.router.on("change",()=>{$(".tooltip").hide()})}setup_frappe_vue(){Vue.prototype.__=window.__,Vue.prototype.frappe=window.frappe}set_password(t){var e=this;frappe.call({method:"frappe.core.doctype.user.user.get_email_awaiting",args:{user:t},callback:function(i){if(i=i.message,i){var n=0;n<i.length&&e.email_password_prompt(i,t,n)}}})}email_password_prompt(t,e,i){var n=this;let o=t[i].email_id,a=new frappe.ui.Dialog({title:__("Password missing in Email Account"),fields:[{fieldname:"password",fieldtype:"Password",label:__("Please enter the password for: <b>{0}</b>",[o],"Email Account"),reqd:1},{fieldname:"submit",fieldtype:"Button",label:__("Submit",null,"Submit password for Email Account")}]});a.get_input("submit").on("click",function(){a.hide();var s=new frappe.ui.Dialog({title:__("Checking one moment"),fields:[{fieldtype:"HTML",fieldname:"checking"}]});s.fields_dict.checking.$wrapper.html('<i class="fa fa-spinner fa-spin fa-4x"></i>'),s.show(),frappe.call({method:"frappe.email.doctype.email_account.email_account.set_email_password",args:{email_account:t[i].email_account,password:a.get_value("password")},callback:function(l){s.hide(),a.hide(),l.message?i+1<t.length&&(i=i+1,n.email_password_prompt(t,e,i)):(frappe.show_alert({message:__("Login Failed please try again"),indicator:"error"},5),n.email_password_prompt(t,e,i))}})}),a.show()}load_bootinfo(){frappe.boot?(this.setup_workspaces(),frappe.model.sync(frappe.boot.docs),this.check_metadata_cache_status(),this.set_globals(),this.sync_pages(),frappe.router.setup(),this.setup_moment(),frappe.boot.print_css&&frappe.dom.set_style(frappe.boot.print_css,"print-style"),frappe.user.name=frappe.boot.user.name,frappe.router.setup()):this.set_as_guest()}setup_workspaces(){frappe.modules={},frappe.workspaces={};for(let t of frappe.boot.allowed_workspaces||[])frappe.modules[t.module]=t,frappe.workspaces[frappe.router.slug(t.name)]=t}load_user_permissions(){frappe.defaults.update_user_permissions(),frappe.realtime.on("update_user_permissions",frappe.utils.debounce(()=>{frappe.defaults.update_user_permissions()},500))}check_metadata_cache_status(){frappe.boot.metadata_version!=localStorage.metadata_version&&(frappe.assets.clear_local_storage(),frappe.assets.init_local_storage())}set_globals(){frappe.session.user=frappe.boot.user.name,frappe.session.logged_in_user=frappe.boot.user.name,frappe.session.user_email=frappe.boot.user.email,frappe.session.user_fullname=frappe.user_info().fullname,frappe.user_defaults=frappe.boot.user.defaults,frappe.user_roles=frappe.boot.user.roles,frappe.sys_defaults=frappe.boot.sysdefaults,frappe.ui.py_date_format=frappe.boot.sysdefaults.date_format.replace("dd","%d").replace("mm","%m").replace("yyyy","%Y"),frappe.boot.user.last_selected_values={},Object.defineProperties(window,{user:{get:function(){return console.warn("Please use `frappe.session.user` instead of `user`. It will be deprecated soon."),frappe.session.user}},user_fullname:{get:function(){return console.warn("Please use `frappe.session.user_fullname` instead of `user_fullname`. It will be deprecated soon."),frappe.session.user}},user_email:{get:function(){return console.warn("Please use `frappe.session.user_email` instead of `user_email`. It will be deprecated soon."),frappe.session.user_email}},user_defaults:{get:function(){return console.warn("Please use `frappe.user_defaults` instead of `user_defaults`. It will be deprecated soon."),frappe.user_defaults}},roles:{get:function(){return console.warn("Please use `frappe.user_roles` instead of `roles`. It will be deprecated soon."),frappe.user_roles}},sys_defaults:{get:function(){return console.warn("Please use `frappe.sys_defaults` instead of `sys_defaults`. It will be deprecated soon."),frappe.user_roles}}})}sync_pages(){if(localStorage.page_info){frappe.boot.allowed_pages=[];var t=JSON.parse(localStorage.page_info);$.each(frappe.boot.page_info,function(e,i){(!t[e]||t[e].modified!=i.modified)&&delete localStorage["_page:"+e],frappe.boot.allowed_pages.push(e)})}else frappe.boot.allowed_pages=Object.keys(frappe.boot.page_info);localStorage.page_info=JSON.stringify(frappe.boot.page_info)}set_as_guest(){frappe.session.user="Guest",frappe.session.user_email="",frappe.session.user_fullname="Guest",frappe.user_defaults={},frappe.user_roles=["Guest"],frappe.sys_defaults={}}make_page_container(){$("#body").length&&($(".splash").remove(),frappe.temp_container=$("<div id='temp-container' style='display: none;'>").appendTo("body"),frappe.container=new frappe.views.Container)}make_nav_bar(){frappe.boot&&frappe.boot.home_page!=="setup-wizard"&&(frappe.frappe_toolbar=new frappe.ui.toolbar.Toolbar)}logout(){var t=this;return t.logged_out=!0,frappe.call({method:"logout",callback:function(e){e.exc||t.redirect_to_login()}})}handle_session_expired(){if(!frappe.app.session_expired_dialog){var t=new frappe.ui.Dialog({title:__("Session Expired"),keep_open:!0,fields:[{fieldtype:"Password",fieldname:"password",label:__("Please Enter Your Password to Continue")}],onhide:()=>{t.logged_in||frappe.app.redirect_to_login()}});t.set_primary_action(__("Login"),()=>{t.set_message(__("Authenticating...")),frappe.call({method:"login",args:{usr:frappe.session.user,pwd:t.get_values().password},callback:e=>{e.message==="Logged In"&&(t.logged_in=!0,$(".modal-backdrop").css({opacity:"","background-color":"#334143"})),t.hide()},statusCode:()=>{t.hide()}})}),frappe.app.session_expired_dialog=t}frappe.app.session_expired_dialog.display||(frappe.app.session_expired_dialog.show(),$(".modal-backdrop").css({opacity:1,"background-color":"#4B4C9D"}))}redirect_to_login(){window.location.href="/"}set_favicon(){var t=$('link[type="image/x-icon"]').remove().attr("href");$('<link rel="shortcut icon" href="'+t+'" type="image/x-icon">').appendTo("head"),$('<link rel="icon" href="'+t+'" type="image/x-icon">').appendTo("head")}trigger_primary_action(){$(document.activeElement).blur(),setTimeout(()=>{window.cur_dialog&&cur_dialog.display?cur_dialog.get_primary_btn().trigger("click"):cur_frm&&cur_frm.page.btn_primary.is(":visible")?cur_frm.page.btn_primary.trigger("click"):frappe.container.page.save_action&&frappe.container.page.save_action()},100)}show_change_log(){var t=this;let e=frappe.boot.change_log;if(!(!Array.isArray(e)||!e.length||window.Cypress||cint(frappe.boot.sysdefaults.disable_change_log_notification))){var i=frappe.msgprint({message:frappe.render_template("change_log",{change_log:e}),title:__("Updated To A New Version \u{1F389}"),wide:!0});i.keep_open=!0,i.custom_onhide=function(){frappe.call({method:"frappe.utils.change_log.update_last_known_versions"}),t.show_notes()}}}show_update_available(){frappe.boot.sysdefaults.disable_system_update_notification||frappe.call({method:"frappe.utils.change_log.show_update_popup"})}setup_analytics(){window.mixpanel&&(window.mixpanel.identify(frappe.session.user),window.mixpanel.people.set({$first_name:frappe.boot.user.first_name,$last_name:frappe.boot.user.last_name,$created:frappe.boot.user.creation,$email:frappe.session.user}))}add_browser_class(){$("html").addClass(frappe.utils.get_browser().name.toLowerCase())}set_fullwidth_if_enabled(){frappe.ui.toolbar.set_fullwidth_if_enabled()}show_notes(){var t=this;frappe.boot.notes.length&&frappe.boot.notes.forEach(function(e){if(!e.seen||e.notify_on_every_login){var i=frappe.msgprint({message:e.content,title:e.title});i.keep_open=!0,i.custom_onhide=function(){e.seen=!0,e.notify_on_every_login||frappe.call({method:"frappe.desk.doctype.note.note.mark_as_seen",args:{note:e.name}}),t.show_notes()}}})}setup_build_events(){frappe.boot.developer_mode&&frappe.require("build_events.bundle.js")}setup_energy_point_listeners(){frappe.realtime.on("energy_point_alert",t=>{frappe.show_alert(t)})}setup_copy_doc_listener(){$("body").on("paste",t=>{try{let e=frappe.utils.get_clipboard_data(t),i=JSON.parse(e);if(i.doctype){t.preventDefault();let n=frappe.utils.sleep;frappe.dom.freeze(__("Creating {0}",[i.doctype])+"..."),n(500).then(()=>{let o=frappe.model.with_doctype(i.doctype,()=>{let a=frappe.model.copy_doc(i);a.__newname=i.name,delete i.name,a.idx=null,a.__run_link_triggers=!1,frappe.set_route("Form",a.doctype,a.name),frappe.dom.unfreeze()});o&&o.fail(frappe.dom.unfreeze)})}}catch(e){}})}setup_moment(){moment.updateLocale("en",{week:{dow:frappe.datetime.get_first_day_of_the_week_index()}}),moment.locale("en"),moment.user_utc_offset=moment().utcOffset(),frappe.boot.timezone_info&&moment.tz.add(frappe.boot.timezone_info)}};frappe.get_module=function(r,t){var e=frappe.modules[r]||t;if(!!e)return e._setup||(e.label||(e.label=r),e._label||(e._label=__(e.label)),e._setup=!0),e};frappe.provide("frappe.utils");function E0(r){return ef()[r]||""}function A0(r){return r.includes("?")?r.slice(r.indexOf("?")+1):""}function ef(r){var t={};r||(r=location.search.substring(1));for(var e=r.split("&"),i=0,n=e.length;i<n;i++){var o=e[i].split(/=(.+)/),a=o[0];if(!!a){var s=o[1];if(typeof s=="string"){s=s.replace(/\+/g,"%20");try{s=decodeURIComponent(s)}catch(l){}}a in t?(typeof t[a]=="undefined"?t[a]=[]:typeof t[a]=="string"&&(t[a]=[t[a]]),t[a].push(s)):t[a]=s}}return t}function $0(r,t=!0){let e=[];for(let i in r){let n=r[i];n===void 0||n===""||n===null||(typeof n=="object"&&(n=JSON.stringify(n)),t&&(i=encodeURIComponent(i),n=encodeURIComponent(n)),e.push(`${i}=${n}`))}return"?"+e.join("&")}Object.assign(frappe.utils,{get_url_arg:E0,get_query_string:A0,get_query_params:ef,make_query_string:$0});frappe.provide("frappe.energy_points");Object.assign(frappe.energy_points,{get_points(r){return`<span class="bold" style="color: ${r>=0?"#45A163":"#e42121"}">
			${r>0?"+":""}${r}
		</span>`},format_form_log(r){let t="<span>&nbsp;-&nbsp;</span>";return`<span>
			<!--${this.get_points(r.points)}&nbsp;-->
			<a href="/app/energy-point-log/${r.name}">${this.get_form_log_message(r)}</a>
			${r.reason?t+r.reason:""}
		</span>`},format_history_log(r){let t="<span>&nbsp;-&nbsp;</span>",e=frappe.utils.get_form_link(r.reference_doctype,r.reference_name);return`<div class="flex">
			<span class="${r.points>=0?"green":"red"} mr-2">
				${this.get_points(r.points)}
			</span>
			<a href="${e}" class="text-muted">${this.get_history_log_message(r)}</a>
			${r.reason?t+r.reason:""}
			${t+frappe.datetime.comment_when(r.creation)}
		</div>`},get_history_log_message(r){let t=frappe.user.full_name(r.owner).bold(),e=r.reference_name;return r.type==="Appreciation"?__("{0} appreciated on {1}",[t,e]):r.type==="Criticism"?__("{0} criticized on {1}",[t,e]):r.type==="Revert"?__("{0} reverted {1}",[t,r.revert_of]):__("via automatic rule {0} on {1}",[r.rule.bold(),e])},get_form_log_message(r){let t=frappe.user.full_name(r.owner).bold(),e=frappe.user.full_name(r.user).bold();return r.type==="Appreciation"?__("{0} appreciated {1}",[t,e]):r.type==="Criticism"?__("{0} criticized {1}",[t,e]):r.type==="Revert"?__("{0} reverted {1}",[t,r.revert_of]):__("gained by {0} via automatic rule {1}",[e,r.rule.bold()])}});var l$=Vt(tf());function Bn(r){return(Bn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(r)}function pr(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function rf(r,t){for(var e=0;e<t.length;e++){var i=t[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,i.key,i)}}function vr(r,t,e){return t&&rf(r.prototype,t),e&&rf(r,e),r}function Gr(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),t&&bf(r,t)}function Ut(r){return(Ut=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(r)}function bf(r,t){return(bf=Object.setPrototypeOf||function(e,i){return e.__proto__=i,e})(r,t)}function O0(r,t){return!t||typeof t!="object"&&typeof t!="function"?function(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(r):t}function Xr(r){var t=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var e,i=Ut(r);if(t){var n=Ut(this).constructor;e=Reflect.construct(i,arguments,n)}else e=i.apply(this,arguments);return O0(this,e)}}function cr(r,t,e){return(cr=typeof Reflect!="undefined"&&Reflect.get?Reflect.get:function(i,n,o){var a=function(l,u){for(;!Object.prototype.hasOwnProperty.call(l,u)&&(l=Ut(l))!==null;);return l}(i,n);if(a){var s=Object.getOwnPropertyDescriptor(a,n);return s.get?s.get.call(o):s.value}})(r,t,e||r)}function Mt(r,t){return function(e){if(Array.isArray(e))return e}(r)||function(e,i){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(e)))){var n=[],o=!0,a=!1,s=void 0;try{for(var l,u=e[Symbol.iterator]();!(o=(l=u.next()).done)&&(n.push(l.value),!i||n.length!==i);o=!0);}catch(c){a=!0,s=c}finally{try{o||u.return==null||u.return()}finally{if(a)throw s}}return n}}(r,t)||yf(r,t)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function ur(r){return function(t){if(Array.isArray(t))return Zo(t)}(r)||function(t){if(typeof Symbol!="undefined"&&Symbol.iterator in Object(t))return Array.from(t)}(r)||yf(r)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function yf(r,t){if(r){if(typeof r=="string")return Zo(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);return e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set"?Array.from(r):e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?Zo(r,t):void 0}}function Zo(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,i=new Array(t);e<t;e++)i[e]=r[e];return i}function kr(r,t){return typeof r=="string"?(t||document).querySelector(r):r||null}function Rn(r){var t=r.getBoundingClientRect();return{top:t.top+(document.documentElement.scrollTop||document.body.scrollTop),left:t.left+(document.documentElement.scrollLeft||document.body.scrollLeft)}}function R0(r){return r.offsetParent===null}function L0(r){var t=r.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)}(function(r,t){t===void 0&&(t={});var e=t.insertAt;if(r&&typeof document!="undefined"){var i=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",e==="top"&&i.firstChild?i.insertBefore(n,i.firstChild):i.appendChild(n),n.styleSheet?n.styleSheet.cssText=r:n.appendChild(document.createTextNode(r))}})(`:root {
  --charts-label-color: #313b44;
  --charts-axis-line-color: #f4f5f6;
  --charts-tooltip-title: var(--charts-label-color);
  --charts-tooltip-label: var(--charts-label-color);
  --charts-tooltip-value: #192734;
  --charts-tooltip-bg: #ffffff;
  --charts-stroke-width: 2px;
  --charts-dataset-circle-stroke: #ffffff;
  --charts-dataset-circle-stroke-width: var(--charts-stroke-width);
  --charts-legend-label: var(--charts-label-color);
  --charts-legend-value: var(--charts-label-color); }

.chart-container {
  position: relative;
  /* for absolutely positioned tooltip */
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", "Oxygen", "Ubuntu", "Cantarell", "Fira Sans", "Droid Sans", "Helvetica Neue", sans-serif; }
  .chart-container .axis,
  .chart-container .chart-label {
    fill: var(--charts-label-color); }
    .chart-container .axis line,
    .chart-container .chart-label line {
      stroke: var(--charts-axis-line-color); }
  .chart-container .dataset-units circle {
    stroke: var(--charts-dataset-circle-stroke);
    stroke-width: var(--charts-dataset-circle-stroke-width); }
  .chart-container .dataset-units path {
    fill: none;
    stroke-opacity: 1;
    stroke-width: var(--charts-stroke-width); }
  .chart-container .dataset-path {
    stroke-width: var(--charts-stroke-width); }
  .chart-container .path-group path {
    fill: none;
    stroke-opacity: 1;
    stroke-width: var(--charts-stroke-width); }
  .chart-container line.dashed {
    stroke-dasharray: 5, 3; }
  .chart-container .axis-line .specific-value {
    text-anchor: start; }
  .chart-container .axis-line .y-line {
    text-anchor: end; }
  .chart-container .axis-line .x-line {
    text-anchor: middle; }
  .chart-container .legend-dataset-label {
    fill: var(--charts-legend-label);
    font-weight: 600; }
  .chart-container .legend-dataset-value {
    fill: var(--charts-legend-value); }

.graph-svg-tip {
  position: absolute;
  z-index: 99999;
  padding: 10px;
  font-size: 12px;
  text-align: center;
  background: var(--charts-tooltip-bg);
  box-shadow: 0px 1px 4px rgba(17, 43, 66, 0.1), 0px 2px 6px rgba(17, 43, 66, 0.08), 0px 40px 30px -30px rgba(17, 43, 66, 0.1);
  border-radius: 6px; }
  .graph-svg-tip ul {
    padding-left: 0;
    display: flex; }
  .graph-svg-tip ol {
    padding-left: 0;
    display: flex; }
  .graph-svg-tip ul.data-point-list li {
    min-width: 90px;
    font-weight: 600; }
  .graph-svg-tip .svg-pointer {
    position: absolute;
    height: 12px;
    width: 12px;
    border-radius: 2px;
    background: var(--charts-tooltip-bg);
    transform: rotate(45deg);
    margin-top: -7px;
    margin-left: -6px; }
  .graph-svg-tip.comparison {
    text-align: left;
    padding: 0px;
    pointer-events: none; }
    .graph-svg-tip.comparison .title {
      display: block;
      padding: 16px;
      margin: 0;
      color: var(--charts-tooltip-title);
      font-weight: 600;
      line-height: 1;
      pointer-events: none;
      text-transform: uppercase; }
      .graph-svg-tip.comparison .title strong {
        color: var(--charts-tooltip-value); }
    .graph-svg-tip.comparison ul {
      margin: 0;
      white-space: nowrap;
      list-style: none; }
      .graph-svg-tip.comparison ul.tooltip-grid {
        display: grid;
        grid-template-columns: repeat(4, minmax(0, 1fr));
        gap: 5px; }
    .graph-svg-tip.comparison li {
      display: inline-block;
      display: flex;
      flex-direction: row;
      font-weight: 600;
      line-height: 1;
      padding: 5px 15px 15px 15px; }
      .graph-svg-tip.comparison li .tooltip-legend {
        height: 12px;
        width: 12px;
        margin-right: 8px;
        border-radius: 2px; }
      .graph-svg-tip.comparison li .tooltip-label {
        margin-top: 4px;
        font-size: 11px;
        line-height: 1.25;
        max-width: 150px;
        white-space: normal;
        color: var(--charts-tooltip-label); }
      .graph-svg-tip.comparison li .tooltip-value {
        color: var(--charts-tooltip-value); }
`),kr.create=function(r,t){var e=document.createElement(r);for(var i in t){var n=t[i];if(i==="inside")kr(n).appendChild(e);else if(i==="around"){var o=kr(n);o.parentNode.insertBefore(e,o),e.appendChild(o)}else i==="styles"?Bn(n)==="object"&&Object.keys(n).map(function(a){e.style[a]=n[a]}):i in e?e[i]=n:e.setAttribute(i,n)}return e};var B0={margins:{top:10,bottom:10,left:20,right:20},paddings:{top:20,bottom:40,left:30,right:10},baseHeight:240,titleHeight:20,legendHeight:30,titleFontSize:12};function Ln(r){return r.titleHeight+r.margins.top+r.paddings.top}function On(r){return r.margins.left+r.paddings.left}function oa(r){return r.margins.top+r.margins.bottom+r.paddings.top+r.paddings.bottom+r.titleHeight+r.legendHeight}function Qo(r){return r.margins.left+r.margins.right+r.paddings.left+r.paddings.right}var wi=["pink","blue","green","grey","red","yellow","purple","teal","cyan","orange"],I0={bar:wi,line:wi,pie:wi,percentage:wi,heatmap:["#ebedf0","#c6e48b","#7bc96f","#239a3b","#196127"],donut:wi},nf=Math.PI/180,M0=function(){function r(t){var e=t.parent,i=e===void 0?null:e,n=t.colors,o=n===void 0?[]:n;pr(this,r),this.parent=i,this.colors=o,this.titleName="",this.titleValue="",this.listValues=[],this.titleValueFirst=0,this.x=0,this.y=0,this.top=0,this.left=0,this.setup()}return vr(r,[{key:"setup",value:function(){this.makeTooltip()}},{key:"refresh",value:function(){this.fill(),this.calcPosition()}},{key:"makeTooltip",value:function(){var t=this;this.container=kr.create("div",{inside:this.parent,className:"graph-svg-tip comparison",innerHTML:`<span class="title"></span>
				<ul class="data-point-list"></ul>
				<div class="svg-pointer"></div>`}),this.hideTip(),this.title=this.container.querySelector(".title"),this.list=this.container.querySelector(".data-point-list"),this.dataPointList=this.container.querySelector(".data-point-list"),this.parent.addEventListener("mouseleave",function(){t.hideTip()})}},{key:"fill",value:function(){var t,e=this;this.index&&this.container.setAttribute("data-point-index",this.index),t=this.titleValueFirst?"<strong>".concat(this.titleValue,"</strong>").concat(this.titleName):"".concat(this.titleName,"<strong>").concat(this.titleValue,"</strong>"),this.listValues.length>4?this.list.classList.add("tooltip-grid"):this.list.classList.remove("tooltip-grid"),this.title.innerHTML=t,this.dataPointList.innerHTML="",this.listValues.map(function(i,n){var o=e.colors[n]||"black",a=i.formatted===0||i.formatted?i.formatted:i.value,s=kr.create("li",{innerHTML:'<div class="tooltip-legend" style="background: '.concat(o,`;"></div>
					<div>
						<div class="tooltip-value">`).concat(a===0||a?a:"",`</div>
						<div class="tooltip-label">`).concat(i.title?i.title:"",`</div>
					</div>`)});e.dataPointList.appendChild(s)})}},{key:"calcPosition",value:function(){var t=this.container.offsetWidth;this.top=this.y-this.container.offsetHeight-7.48,this.left=this.x-t/2;var e=this.parent.offsetWidth-t,i=this.container.querySelector(".svg-pointer");if(this.left<0)i.style.left="calc(50% - ".concat(-1*this.left,"px)"),this.left=0;else if(this.left>e){var n=this.left-e,o="calc(50% + ".concat(n,"px)");i.style.left=o,this.left=e}else i.style.left="50%"}},{key:"setValues",value:function(t,e){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[],o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:-1;this.titleName=i.name,this.titleValue=i.value,this.listValues=n,this.x=t,this.y=e,this.titleValueFirst=i.valueFirst||0,this.index=o,this.refresh()}},{key:"hideTip",value:function(){this.container.style.top="0px",this.container.style.left="0px",this.container.style.opacity="0"}},{key:"showTip",value:function(){this.container.style.top=this.top+"px",this.container.style.left=this.left+"px",this.container.style.opacity="1"}}]),r}();function wf(r){return parseFloat(r.toFixed(2))}function ea(r,t,e){var i=arguments.length>3&&arguments[3]!==void 0&&arguments[3];e||(e=i?r[0]:r[r.length-1]);var n=new Array(Math.abs(t)).fill(e);return r=i?n.concat(r):r.concat(n)}function of(r,t){return(r+"").length*t}function Go(r,t){return{x:Math.sin(r*nf)*t,y:Math.cos(r*nf)*t}}function Rr(r){var t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return!Number.isNaN(r)&&r!==void 0&&!!Number.isFinite(r)&&!(t&&r<0)}function kf(r){return Number(Math.round(r+"e4")+"e-4")}function ta(r){var t,e,i;if(r instanceof Date)return new Date(r.getTime());if(Bn(r)!=="object"||r===null)return r;for(i in t=Array.isArray(r)?[]:{},r)e=r[i],t[i]=ta(e);return t}function af(r,t){var e,i;return r<=t?(e=t-r,i=r):(e=r-t,i=t),[e,i]}function Gt(r,t){var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t.length-r.length;return e>0?r=ea(r,e):t=ea(t,e),[r,t]}function N0(r,t){if(r)return r.length>t?r.slice(0,t-3)+"...":r}function P0(r){var t;if(typeof r=="number")t=r;else if(typeof r=="string"&&(t=Number(r),Number.isNaN(t)))return r;var e=Math.floor(Math.log10(Math.abs(t)));if(e<=2)return t;var i=Math.floor(e/3),n=Math.pow(10,e-3*i)*+(t/Math.pow(10,e)).toFixed(1);return Math.round(100*n)/100+["","K","M","B","T"][i]}function sf(r,t){for(var e=[],i=(Math.min(r.length,t.length),0);i<r.length;i++)e.push([r[i],t[i]]);var n=function(o,a,s,l){var u,c,h,p,g=(u=a||o,h=(c=s||o)[0]-u[0],p=c[1]-u[1],{length:Math.sqrt(Math.pow(h,2)+Math.pow(p,2)),angle:Math.atan2(p,h)}),b=g.angle+(l?Math.PI:0),v=.2*g.length;return[o[0]+Math.cos(b)*v,o[1]+Math.sin(b)*v]};return function(o,a){return o.reduce(function(s,l,u,c){return u===0?"".concat(l[0],",").concat(l[1]):"".concat(s," ").concat(a(l,u,c))},"")}(e,function(o,a,s){var l=n(s[a-1],s[a-2],o),u=n(o,s[a-1],s[a+1],!0);return"C ".concat(l[0],",").concat(l[1]," ").concat(u[0],",").concat(u[1]," ").concat(o[0],",").concat(o[1])})}function lf(r,t){return typeof r=="string"?(t||document).querySelector(r):r||null}function ut(r,t){var e=document.createElementNS("http://www.w3.org/2000/svg",r);for(var i in t){var n=t[i];if(i==="inside")lf(n).appendChild(e);else if(i==="around"){var o=lf(n);o.parentNode.insertBefore(e,o),e.appendChild(o)}else i==="styles"?Bn(n)==="object"&&Object.keys(n).map(function(a){e.style[a]=n[a]}):(i==="className"&&(i="class"),i==="innerHTML"?e.textContent=n:e.setAttribute(i,n))}return e}function D0(r,t){return ut("linearGradient",{inside:r,id:t,x1:0,x2:0,y1:0,y2:1})}function Xo(r,t,e,i){return ut("stop",{inside:r,style:"stop-color: ".concat(e),offset:t,"stop-opacity":i})}function ra(r){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0,i={className:r,transform:t};return e&&(i.inside=e),ut("g",i)}function Vr(r){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"none",i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"none",n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:2;return ut("path",{className:t,d:r,styles:{stroke:e,fill:i,"stroke-width":n}})}function j0(r,t,e,i){var n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1,o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:0,a=e.x+r.x,s=e.y+r.y,l=e.x+t.x,u=e.y+t.y;return"M".concat(e.x," ").concat(e.y,`
		L`).concat(a," ").concat(s,`
		A `).concat(i," ").concat(i," 0 ").concat(o," ").concat(n?1:0,`
		`).concat(l," ").concat(u," z")}function z0(r,t,e,i){var n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1,o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:0,a=e.x+r.x,s=e.y+r.y,l=e.x+t.x,u=2*e.y,c=e.y+t.y;return"M".concat(e.x," ").concat(e.y,`
		L`).concat(a," ").concat(s,`
		A `).concat(i," ").concat(i," 0 ").concat(o," ").concat(n?1:0,`
		`).concat(l," ").concat(u,` z
		L`).concat(a," ").concat(u,`
		A `).concat(i," ").concat(i," 0 ").concat(o," ").concat(n?1:0,`
		`).concat(l," ").concat(c," z")}function F0(r,t,e,i){var n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1,o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:0,a=e.x+r.x,s=e.y+r.y,l=e.x+t.x,u=e.y+t.y;return"M".concat(a," ").concat(s,`
		A `).concat(i," ").concat(i," 0 ").concat(o," ").concat(n?1:0,`
		`).concat(l," ").concat(u)}function H0(r,t,e,i){var n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1,o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:0,a=e.x+r.x,s=e.y+r.y,l=e.x+t.x,u=2*i+s,c=e.y+r.y;return"M".concat(a," ").concat(s,`
		A `).concat(i," ").concat(i," 0 ").concat(o," ").concat(n?1:0,`
		`).concat(l," ").concat(u,`
		M`).concat(a," ").concat(u,`
		A `).concat(i," ").concat(i," 0 ").concat(o," ").concat(n?1:0,`
		`).concat(l," ").concat(c)}function cf(r,t){var e=arguments.length>2&&arguments[2]!==void 0&&arguments[2],i="path-fill-gradient-"+t+"-"+(e?"lighter":"default"),n=D0(r,i),o=[1,.6,.2];return e&&(o=[.15,.05,0]),Xo(n,"0%",t,o[0]),Xo(n,"50%",t,o[1]),Xo(n,"100%",t,o[2]),i}function q0(r,t,e){var i=e/2,n=t-i;return"M".concat(r,",0 h").concat(n," q").concat(i,",0 ").concat(i,",").concat(i," q0,").concat(i," -").concat(i,",").concat(i," h-").concat(n," v").concat(e,"z")}function U0(r,t,e){var i=e/2,n=t-i;return"M".concat(r+i,",0 h").concat(n," v").concat(e," h-").concat(n," q-").concat(i,", 0 -").concat(i,",-").concat(i," q0,-").concat(i," ").concat(i,",-").concat(i,"z")}function xf(r,t,e,i,n){var o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:"none",a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:{},s={className:r,x:t,y:e,width:i,height:i,rx:n,fill:o};return Object.keys(a).map(function(l){s[l]=a[l]}),ut("rect",s)}function Cf(r,t,e,i){var n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"none",o=arguments.length>5?arguments[5]:void 0,a=arguments.length>6?arguments[6]:void 0,s=arguments.length>7&&arguments[7]!==void 0?arguments[7]:null,l=arguments.length>8&&arguments[8]!==void 0&&arguments[8];s||(s=10);var u={className:"legend-dot",x:0,y:4-e,height:e,width:e,rx:i,fill:n},c=ut("text",{className:"legend-dataset-label",x:e,y:0,dx:s+"px",dy:s/3+"px","font-size":1.6*s+"px","text-anchor":"start",innerHTML:o=l?N0(o,18):o}),h=null;a&&(h=ut("text",{className:"legend-dataset-value",x:e,y:20,dx:"10px",dy:10/3+"px","font-size":"12px","text-anchor":"start",innerHTML:a}));var p=ut("g",{transform:"translate(".concat(r,", ").concat(t,")")});return p.appendChild(ut("rect",u)),p.appendChild(c),a&&h&&p.appendChild(h),p}function Si(r,t,e,i){var n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{},o=n.fontSize||10,a=n.dy!==void 0?n.dy:o/2,s=n.fill||"var(--charts-label-color)",l=n.textAnchor||"start";return ut("text",{className:r,x:t,y:e,dy:a+"px","font-size":o+"px",fill:s,"text-anchor":l,innerHTML:i})}function W0(r,t,e,i){var n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{},o=ut("line",{className:"line-vertical "+n.className,x1:0,x2:0,y1:e,y2:i,styles:{stroke:n.stroke}}),a=ut("text",{x:0,y:e>i?e+4:e-4-10,dy:"10px","font-size":"10px","text-anchor":"middle",innerHTML:t+""}),s=ut("g",{transform:"translate(".concat(r,", 0)")});return s.appendChild(o),s.appendChild(a),s}function uf(r,t,e,i){var n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};n.lineType||(n.lineType=""),n.shortenNumbers&&(t=n.numberFormatter?n.numberFormatter(t):P0(t));var o="line-horizontal "+n.className+(n.lineType==="dashed"?"dashed":""),a=ut("line",{className:o,x1:e,x2:i,y1:0,y2:0,styles:{stroke:n.stroke}}),s=ut("text",{x:e<i?e-4:e+4,y:0,dy:"3px","font-size":"10px","text-anchor":e<i?"end":"start",innerHTML:t+""}),l=ut("g",{transform:"translate(0, ".concat(r,")"),"stroke-opacity":1});return s!==0&&s!=="0"||(l.style.stroke="rgba(27, 31, 35, 0.6)"),l.appendChild(a),l.appendChild(s),l}function df(r,t,e,i){var n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"",o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:0,a=arguments.length>6&&arguments[6]!==void 0&&arguments[6],s=ut("circle",{style:"fill: ".concat(i,"; ").concat(a?"stroke: ".concat(i):""),"data-point-index":o,cx:r,cy:t,r:e});if((n+="")||n.length){s.setAttribute("cy",0),s.setAttribute("cx",0);var l=ut("text",{className:"data-point-value",x:0,y:0,dy:-5-e+"px","font-size":"10px","text-anchor":"middle",innerHTML:n}),u=ut("g",{"data-point-index":o,transform:"translate(".concat(r,", ").concat(t,")")});return u.appendChild(s),u.appendChild(l),u}return s}var V0={bar:function(r){var t;r.nodeName!=="rect"&&(t=r.getAttribute("transform"),r=r.childNodes[0]);var e=r.cloneNode();return e.style.fill="#000000",e.style.opacity="0.4",t&&e.setAttribute("transform",t),e},dot:function(r){var t;r.nodeName!=="circle"&&(t=r.getAttribute("transform"),r=r.childNodes[0]);var e=r.cloneNode(),i=r.getAttribute("r"),n=r.getAttribute("fill");return e.setAttribute("r",parseInt(i)+4),e.setAttribute("fill",n),e.style.opacity="0.6",t&&e.setAttribute("transform",t),e},heat_square:function(r){var t;r.nodeName!=="circle"&&(t=r.getAttribute("transform"),r=r.childNodes[0]);var e=r.cloneNode(),i=r.getAttribute("r"),n=r.getAttribute("fill");return e.setAttribute("r",parseInt(i)+4),e.setAttribute("fill",n),e.style.opacity="0.6",t&&e.setAttribute("transform",t),e}},Y0={bar:function(r,t){var e;r.nodeName!=="rect"&&(e=r.getAttribute("transform"),r=r.childNodes[0]);var i=["x","y","width","height"];Object.values(r.attributes).filter(function(n){return i.includes(n.name)&&n.specified}).map(function(n){t.setAttribute(n.name,n.nodeValue)}),e&&t.setAttribute("transform",e)},dot:function(r,t){var e;r.nodeName!=="circle"&&(e=r.getAttribute("transform"),r=r.childNodes[0]);var i=["cx","cy"];Object.values(r.attributes).filter(function(n){return i.includes(n.name)&&n.specified}).map(function(n){t.setAttribute(n.name,n.nodeValue)}),e&&t.setAttribute("transform",e)},heat_square:function(r,t){var e;r.nodeName!=="circle"&&(e=r.getAttribute("transform"),r=r.childNodes[0]);var i=["cx","cy"];Object.values(r.attributes).filter(function(n){return i.includes(n.name)&&n.specified}).map(function(n){t.setAttribute(n.name,n.nodeValue)}),e&&t.setAttribute("transform",e)}},G0={pink:"#F683AE",blue:"#318AD8",green:"#48BB74",grey:"#A6B1B9",red:"#F56B6B",yellow:"#FACF7A",purple:"#44427B",teal:"#5FD8C4",cyan:"#15CCEF",orange:"#F8814F","light-pink":"#FED7E5","light-blue":"#BFDDF7","light-green":"#48BB74","light-grey":"#F4F5F6","light-red":"#F6DFDF","light-yellow":"#FEE9BF","light-purple":"#E8E8F7","light-teal":"#D3FDF6","light-cyan":"#DDF8FD","light-orange":"#FECDB8"};function xi(r,t,e,i){var n=typeof t=="string"?t:t.join(", ");return[r,{transform:e.join(", ")},i,"easein","translate",{transform:n}]}function ff(r,t,e){return xi(r,[0,e],[0,t],350)}function pf(r,t){return[r,{d:t},350,"easein"]}var X0={ease:"0.25 0.1 0.25 1",linear:"0 0 1 1",easein:"0.1 0.8 0.2 1",easeout:"0 0 0.58 1",easeinout:"0.42 0 0.58 1"};function K0(r,t,e){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"linear",n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:void 0,o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{},a=r.cloneNode(!0),s=r.cloneNode(!0);for(var l in t){var u=void 0;u=l==="transform"?document.createElementNS("http://www.w3.org/2000/svg","animateTransform"):document.createElementNS("http://www.w3.org/2000/svg","animate");var c=o[l]||r.getAttribute(l),h=t[l],p={attributeName:l,from:c,to:h,begin:"0s",dur:e/1e3+"s",values:c+";"+h,keySplines:X0[i],keyTimes:"0;1",calcMode:"spline",fill:"freeze"};for(var g in n&&(p.type=n),p)u.setAttribute(g,p[g]);a.appendChild(u),n?s.setAttribute(l,"translate(".concat(h,")")):s.setAttribute(l,h)}return[a,s]}function ia(r,t){r.style.transform=t,r.style.webkitTransform=t,r.style.msTransform=t,r.style.mozTransform=t,r.style.oTransform=t}function J0(r,t){var e=[],i=[];t.map(function(o){var a,s,l=o[0],u=l.parentNode;o[0]=l;var c=Mt(K0.apply(void 0,ur(o)),2);a=c[0],s=c[1],e.push(s),i.push([a,u]),u.replaceChild(a,l)});var n=r.cloneNode(!0);return i.map(function(o,a){o[1].replaceChild(e[a],o[0]),t[a][0]=e[a]}),n}function Z0(r,t,e){if(e.length!==0){var i=J0(t,e);t.parentNode==r&&(r.removeChild(t),r.appendChild(i)),setTimeout(function(){i.parentNode==r&&(r.removeChild(i),r.appendChild(t))},250)}}var aa=function(){function r(t,e){if(pr(this,r),e=ta(e),this.parent=typeof t=="string"?document.querySelector(t):t,!(this.parent instanceof HTMLElement))throw new Error("No `parent` element to render on was provided.");this.rawChartArgs=e,this.title=e.title||"",this.type=e.type||"",this.realData=this.prepareData(e.data),this.data=this.prepareFirstData(this.realData),this.colors=this.validateColors(e.colors,this.type),this.config={showTooltip:1,showLegend:e.showLegend!==void 0?e.showLegend:1,isNavigable:e.isNavigable||0,animate:e.animate!==void 0?e.animate:1,disableEntryAnimation:e.disableEntryAnimation||0,truncateLegends:e.truncateLegends||1},this.measures=JSON.parse(JSON.stringify(B0));var i=this.measures;this.setMeasures(e),this.title.length||(i.titleHeight=0),this.config.showLegend||(i.legendHeight=0),this.argHeight=e.height||i.baseHeight,this.state={},this.options={},this.initTimeout=700,this.config.isNavigable&&(this.overlays=[]),this.configure(e)}return vr(r,[{key:"prepareData",value:function(t){return t}},{key:"prepareFirstData",value:function(t){return t}},{key:"validateColors",value:function(t,e){var i=[];return(t=(t||[]).concat(I0[e])).forEach(function(n){var o=function(a){return/rgb[a]{0,1}\([\d, ]+\)/gim.test(a)?/\D+(\d*)\D+(\d*)\D+(\d*)/gim.exec(a).map(function(s,l){return l!==0?Number(s).toString(16):"#"}).reduce(function(s,l){return"".concat(s).concat(l)}):G0[a]||a}(n);(function(a){return/(^\s*)(#)((?:[A-Fa-f0-9]{3}){1,2})$/i.test(a)||/(^\s*)(rgb|hsl)(a?)[(]\s*([\d.]+\s*%?)\s*,\s*([\d.]+\s*%?)\s*,\s*([\d.]+\s*%?)\s*(?:,\s*([\d.]+)\s*)?[)]$/i.test(a)})(o)?i.push(o):console.warn('"'+n+'" is not a valid color.')}),i}},{key:"setMeasures",value:function(){}},{key:"configure",value:function(){var t=this,e=this.argHeight;this.baseHeight=e,this.height=e-oa(this.measures),this.boundDrawFn=function(){return t.draw(!0)},ResizeObserver&&(this.resizeObserver=new ResizeObserver(this.boundDrawFn),this.resizeObserver.observe(this.parent)),window.addEventListener("resize",this.boundDrawFn),window.addEventListener("orientationchange",this.boundDrawFn)}},{key:"destroy",value:function(){this.resizeObserver&&this.resizeObserver.disconnect(),window.removeEventListener("resize",this.boundDrawFn),window.removeEventListener("orientationchange",this.boundDrawFn)}},{key:"setup",value:function(){this.makeContainer(),this.updateWidth(),this.makeTooltip(),this.draw(!1,!0)}},{key:"makeContainer",value:function(){this.parent.innerHTML="";var t={inside:this.parent,className:"chart-container"};this.independentWidth&&(t.styles={width:this.independentWidth+"px"}),this.container=kr.create("div",t)}},{key:"makeTooltip",value:function(){this.tip=new M0({parent:this.container,colors:this.colors}),this.bindTooltip()}},{key:"bindTooltip",value:function(){}},{key:"draw",value:function(){var t=this,e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],i=arguments.length>1&&arguments[1]!==void 0&&arguments[1];e&&R0(this.parent)||(this.updateWidth(),this.calc(e),this.makeChartArea(),this.setupComponents(),this.components.forEach(function(n){return n.setup(t.drawArea)}),this.render(this.components,!1),i&&(this.data=this.realData,setTimeout(function(){t.update(t.data,!0)},this.initTimeout)),this.config.showLegend&&this.renderLegend(),this.setupNavigation(i))}},{key:"calc",value:function(){}},{key:"updateWidth",value:function(){var t,e,i;this.baseWidth=(t=this.parent,e=window.getComputedStyle(t),i=parseFloat(e.paddingLeft)+parseFloat(e.paddingRight),t.clientWidth-i),this.width=this.baseWidth-Qo(this.measures)}},{key:"makeChartArea",value:function(){this.svg&&this.container.removeChild(this.svg);var t,e,i,n,o=this.measures;this.svg=(t=this.container,e="frappe-chart chart",i=this.baseWidth,n=this.baseHeight,ut("svg",{className:e,inside:t,width:i,height:n})),this.svgDefs=ut("defs",{inside:this.svg}),this.title.length&&(this.titleEL=Si("title",o.margins.left,o.margins.top,this.title,{fontSize:o.titleFontSize,fill:"#666666",dy:o.titleFontSize}));var a=Ln(o);this.drawArea=ra(this.type+"-chart chart-draw-area","translate(".concat(On(o),", ").concat(a,")")),this.config.showLegend&&(a+=this.height+o.paddings.bottom,this.legendArea=ra("chart-legend","translate(".concat(On(o),", ").concat(a,")"))),this.title.length&&this.svg.appendChild(this.titleEL),this.svg.appendChild(this.drawArea),this.config.showLegend&&this.svg.appendChild(this.legendArea),this.updateTipOffset(On(o),Ln(o))}},{key:"updateTipOffset",value:function(t,e){this.tip.offset={x:t,y:e}}},{key:"setupComponents",value:function(){this.components=new Map}},{key:"update",value:function(t){var e=arguments.length>1&&arguments[1]!==void 0&&arguments[1];t||console.error("No data to update."),e||(t=ta(t));var i=e?!this.config.disableEntryAnimation:this.config.animate;this.data=this.prepareData(t),this.calc(),this.render(this.components,i)}},{key:"render",value:function(){var t=this,e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.components,i=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];this.config.isNavigable&&this.overlays.map(function(o){return o.parentNode.removeChild(o)});var n=[];e.forEach(function(o){n=n.concat(o.update(i))}),n.length>0?(Z0(this.container,this.svg,n),setTimeout(function(){e.forEach(function(o){return o.make()}),t.updateNav()},400)):(e.forEach(function(o){return o.make()}),this.updateNav())}},{key:"updateNav",value:function(){this.config.isNavigable&&(this.makeOverlay(),this.bindUnits())}},{key:"renderLegend",value:function(t){var e=this;this.legendArea.textContent="";var i=0,n=0;t.map(function(o,a){var s=Math.floor(e.width/150);i>s&&(i=0,n+=e.config.legendRowHeight);var l=150*i,u=e.makeLegend(o,a,l,n);e.legendArea.appendChild(u),i++})}},{key:"makeLegend",value:function(){}},{key:"setupNavigation",value:function(){var t=this,e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];this.config.isNavigable&&e&&(this.bindOverlay(),this.keyActions={13:this.onEnterKey.bind(this),37:this.onLeftArrow.bind(this),38:this.onUpArrow.bind(this),39:this.onRightArrow.bind(this),40:this.onDownArrow.bind(this)},document.addEventListener("keydown",function(i){L0(t.container)&&(i=i||window.event,t.keyActions[i.keyCode]&&t.keyActions[i.keyCode]())}))}},{key:"makeOverlay",value:function(){}},{key:"updateOverlay",value:function(){}},{key:"bindOverlay",value:function(){}},{key:"bindUnits",value:function(){}},{key:"onLeftArrow",value:function(){}},{key:"onRightArrow",value:function(){}},{key:"onUpArrow",value:function(){}},{key:"onDownArrow",value:function(){}},{key:"onEnterKey",value:function(){}},{key:"addDataPoint",value:function(){}},{key:"removeDataPoint",value:function(){}},{key:"getDataPoint",value:function(){}},{key:"setCurrentDataPoint",value:function(){}},{key:"updateDataset",value:function(){}},{key:"export",value:function(){var t=function(e){var i=e.cloneNode(!0);i.classList.add("chart-container"),i.setAttribute("xmlns","http://www.w3.org/2000/svg"),i.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink");var n=kr.create("style",{innerHTML:".chart-container{position:relative;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI','Roboto','Oxygen','Ubuntu','Cantarell','Fira Sans','Droid Sans','Helvetica Neue',sans-serif}.chart-container .axis,.chart-container .chart-label{fill:#555b51}.chart-container .axis line,.chart-container .chart-label line{stroke:#dadada}.chart-container .dataset-units circle{stroke:#fff;stroke-width:2}.chart-container .dataset-units path{fill:none;stroke-opacity:1;stroke-width:2px}.chart-container .dataset-path{stroke-width:2px}.chart-container .path-group path{fill:none;stroke-opacity:1;stroke-width:2px}.chart-container line.dashed{stroke-dasharray:5,3}.chart-container .axis-line .specific-value{text-anchor:start}.chart-container .axis-line .y-line{text-anchor:end}.chart-container .axis-line .x-line{text-anchor:middle}.chart-container .legend-dataset-text{fill:#6c7680;font-weight:600}.graph-svg-tip{position:absolute;z-index:99999;padding:10px;font-size:12px;color:#959da5;text-align:center;background:rgba(0,0,0,.8);border-radius:3px}.graph-svg-tip ul{padding-left:0;display:flex}.graph-svg-tip ol{padding-left:0;display:flex}.graph-svg-tip ul.data-point-list li{min-width:90px;flex:1;font-weight:600}.graph-svg-tip strong{color:#dfe2e5;font-weight:600}.graph-svg-tip .svg-pointer{position:absolute;height:5px;margin:0 0 0 -5px;content:' ';border:5px solid transparent;}.graph-svg-tip.comparison{padding:0;text-align:left;pointer-events:none}.graph-svg-tip.comparison .title{display:block;padding:10px;margin:0;font-weight:600;line-height:1;pointer-events:none}.graph-svg-tip.comparison ul{margin:0;white-space:nowrap;list-style:none}.graph-svg-tip.comparison li{display:inline-block;padding:5px 10px}"});i.insertBefore(n,i.firstChild);var o=kr.create("div");return o.appendChild(i),o.innerHTML}(this.svg);(function(e,i){var n=document.createElement("a");n.style="display: none";var o=new Blob(i,{type:"image/svg+xml; charset=utf-8"}),a=window.URL.createObjectURL(o);n.href=a,n.download=e,document.body.appendChild(n),n.click(),setTimeout(function(){document.body.removeChild(n),window.URL.revokeObjectURL(a)},300)})(this.title||"Chart",[t])}}]),r}(),Sf=function(r){Gr(e,aa);var t=Xr(e);function e(i,n){return pr(this,e),t.call(this,i,n)}return vr(e,[{key:"configure",value:function(i){cr(Ut(e.prototype),"configure",this).call(this,i),this.config.formatTooltipY=(i.tooltipOptions||{}).formatTooltipY,this.config.maxSlices=i.maxSlices||20,this.config.maxLegendPoints=i.maxLegendPoints||20,this.config.legendRowHeight=60}},{key:"calc",value:function(){var i=this,n=this.state,o=this.config.maxSlices;n.sliceTotals=[];var a=this.data.labels.map(function(c,h){var p=0;return i.data.datasets.map(function(g){p+=g.values[h]}),[p,c]}).filter(function(c){return c[0]>=0}),s=a;if(a.length>o){a.sort(function(c,h){return h[0]-c[0]}),s=a.slice(0,o-1);var l=a.slice(o-1),u=0;l.map(function(c){u+=c[0]}),s.push([u,"Rest"]),this.colors[o-1]="grey"}n.labels=[],s.map(function(c){n.sliceTotals.push(kf(c[0])),n.labels.push(c[1])}),n.grandTotal=n.sliceTotals.reduce(function(c,h){return c+h},0),this.center={x:this.width/2,y:this.height/2}}},{key:"renderLegend",value:function(){var i=this.state;this.legendArea.textContent="",this.legendTotals=i.sliceTotals.slice(0,this.config.maxLegendPoints),cr(Ut(e.prototype),"renderLegend",this).call(this,this.legendTotals)}},{key:"makeLegend",value:function(i,n,o,a){var s=this.config.formatTooltipY?this.config.formatTooltipY(i):i;return Cf(o,a,12,3,this.colors[n],this.state.labels[n],s,null,this.config.truncateLegends)}}]),e}(),Q0=["January","February","March","April","May","June","July","August","September","October","November","December"],ek=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];function hf(r){var t=new Date(r);return t.setMinutes(t.getMinutes()-t.getTimezoneOffset()),t}function Ko(r){var t=r.getDate(),e=r.getMonth()+1;return[r.getFullYear(),(e>9?"":"0")+e,(t>9?"":"0")+t].join("-")}function Lr(r){return new Date(r.getTime())}function Jo(r,t){var e=Ef(r);return Math.ceil(function(i,n){return(hf(n)-hf(i))/864e5}(e,t)/7)}function tk(r,t){return r.getMonth()===t.getMonth()&&r.getFullYear()===t.getFullYear()}function Tf(r){var t=arguments.length>1&&arguments[1]!==void 0&&arguments[1],e=Q0[r];return t?e.slice(0,3):e}function _f(r,t){return new Date(t,r+1,0)}function Ef(r){var t=Lr(r),e=t.getDay();return e!==0&&Yr(t,-1*e),t}function Yr(r,t){r.setDate(r.getDate()+t)}var rk=function(){function r(t){var e=t.layerClass,i=e===void 0?"":e,n=t.layerTransform,o=n===void 0?"":n,a=t.constants,s=t.getData,l=t.makeElements,u=t.animateElements;pr(this,r),this.layerTransform=o,this.constants=a,this.makeElements=l,this.getData=s,this.animateElements=u,this.store=[],this.labels=[],this.layerClass=i,this.layerClass=typeof this.layerClass=="function"?this.layerClass():this.layerClass,this.refresh()}return vr(r,[{key:"refresh",value:function(t){this.data=t||this.getData()}},{key:"setup",value:function(t){this.layer=ra(this.layerClass,this.layerTransform,t)}},{key:"make",value:function(){this.render(this.data),this.oldData=this.data}},{key:"render",value:function(t){var e=this;this.store=this.makeElements(t),this.layer.textContent="",this.store.forEach(function(i){e.layer.appendChild(i)}),this.labels.forEach(function(i){e.layer.appendChild(i)})}},{key:"update",value:function(){var t=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];this.refresh();var e=[];return t&&(e=this.animateElements(this.data)||[]),e}}]),r}(),mf={donutSlices:{layerClass:"donut-slices",makeElements:function(r){return r.sliceStrings.map(function(t,e){var i=Vr(t,"donut-path",r.colors[e],"none",r.strokeWidth);return i.style.transition="transform .3s;",i})},animateElements:function(r){return this.store.map(function(t,e){return pf(t,r.sliceStrings[e])})}},pieSlices:{layerClass:"pie-slices",makeElements:function(r){return r.sliceStrings.map(function(t,e){var i=Vr(t,"pie-path","none",r.colors[e]);return i.style.transition="transform .3s;",i})},animateElements:function(r){return this.store.map(function(t,e){return pf(t,r.sliceStrings[e])})}},percentageBars:{layerClass:"percentage-bars",makeElements:function(r){var t=this,e=r.xPositions.length;return r.xPositions.map(function(i,n){var o=n==e-1,a=n==0;return function(s,l,u,c,h,p){var g=arguments.length>6&&arguments[6]!==void 0?arguments[6]:"none";if(p){var b=q0(s,u,c);return Vr(b,"percentage-bar",null,g)}if(h){var v=U0(s,u,c);return Vr(v,"percentage-bar",null,g)}var k={className:"percentage-bar",x:s,y:l,width:u,height:c,fill:g};return ut("rect",k)}(i,0,r.widths[n],t.constants.barHeight,a,o,r.colors[n])})},animateElements:function(r){if(r)return[]}},yAxis:{layerClass:"y axis",makeElements:function(r){var t=this;return r.positions.map(function(e,i){return function(n,o,a){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};Rr(n)||(n=0),s.pos||(s.pos="left"),s.offset||(s.offset=0),s.mode||(s.mode="span"),s.stroke||(s.stroke="#E2E6E9"),s.className||(s.className="");var l=-6,u=s.mode==="span"?a+6:0;return s.mode==="tick"&&s.pos==="right"&&(l=a+6,u=a),l+=s.offset,u+=s.offset,typeof o=="number"&&(o=kf(o)),uf(n,o,l,u,{className:s.className,lineType:s.lineType,shortenNumbers:s.shortenNumbers,numberFormatter:s.numberFormatter})}(e,r.labels[i],t.constants.width,{mode:t.constants.mode,pos:t.constants.pos,shortenNumbers:t.constants.shortenNumbers,numberFormatter:t.constants.numberFormatter})})},animateElements:function(r){var t=r.positions,e=r.labels,i=this.oldData.positions,n=this.oldData.labels,o=Mt(Gt(i,t),2);i=o[0],t=o[1];var a=Mt(Gt(n,e),2);return n=a[0],e=a[1],this.render({positions:i,labels:e}),this.store.map(function(s,l){return ff(s,t[l],i[l])})}},xAxis:{layerClass:"x axis",makeElements:function(r){var t=this;return r.positions.map(function(e,i){return function(n,o,a){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};Rr(n)||(n=0),s.pos||(s.pos="bottom"),s.offset||(s.offset=0),s.mode||(s.mode="span"),s.className||(s.className="");var l=a+6,u=s.mode==="span"?-6:a;return s.mode==="tick"&&s.pos==="top"&&(l=-6,u=0),W0(n,o,l,u,{className:s.className,lineType:s.lineType})}(e,r.calcLabels[i],t.constants.height,{mode:t.constants.mode,pos:t.constants.pos})})},animateElements:function(r){var t=r.positions,e=r.calcLabels,i=this.oldData.positions,n=this.oldData.calcLabels,o=Mt(Gt(i,t),2);i=o[0],t=o[1];var a=Mt(Gt(n,e),2);return n=a[0],e=a[1],this.render({positions:i,calcLabels:e}),this.store.map(function(s,l){return function(u,c,h){return xi(u,[h,0],[c,0],350)}(s,t[l],i[l])})}},yMarkers:{layerClass:"y-markers",makeElements:function(r){var t=this;return r.map(function(e){return function(i,n,o){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};Rr(i)||(i=0),a.labelPos||(a.labelPos="right"),a.lineType||(a.lineType="dashed");var s=a.labelPos==="left"?4:o-of(n,5)-4,l=ut("text",{className:"chart-label",x:s,y:0,dy:"-5px","font-size":"10px","text-anchor":"start",innerHTML:n+""}),u=uf(i,"",0,o,{stroke:a.stroke||"#E2E6E9",className:a.className||"",lineType:a.lineType});return u.appendChild(l),u}(e.position,e.label,t.constants.width,{labelPos:e.options.labelPos,stroke:e.options.stroke,mode:"span",lineType:e.options.lineType})})},animateElements:function(r){var t=Mt(Gt(this.oldData,r),2);this.oldData=t[0];var e=(r=t[1]).map(function(a){return a.position}),i=r.map(function(a){return a.label}),n=r.map(function(a){return a.options}),o=this.oldData.map(function(a){return a.position});return this.render(o.map(function(a,s){return{position:o[s],label:i[s],options:n[s]}})),this.store.map(function(a,s){return ff(a,e[s],o[s])})}},yRegions:{layerClass:"y-regions",makeElements:function(r){var t=this;return r.map(function(e){return function(i,n,o,a){var s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{},l=i-n,u=ut("rect",{className:"bar mini",styles:{fill:s.fill||"rgba(228, 234, 239, 0.49)",stroke:s.stroke||"#E2E6E9","stroke-dasharray":"".concat(o,", ").concat(l)},x:0,y:0,width:o,height:l});s.labelPos||(s.labelPos="right");var c=s.labelPos==="left"?4:o-of(a+"",4.5)-4,h=ut("text",{className:"chart-label",x:c,y:0,dy:"-5px","font-size":"10px","text-anchor":"start",innerHTML:a+""}),p=ut("g",{transform:"translate(0, ".concat(n,")")});return p.appendChild(u),p.appendChild(h),p}(e.startPos,e.endPos,t.constants.width,e.label,{labelPos:e.options.labelPos,stroke:e.options.stroke,fill:e.options.fill})})},animateElements:function(r){var t=Mt(Gt(this.oldData,r),2);this.oldData=t[0];var e=(r=t[1]).map(function(u){return u.endPos}),i=r.map(function(u){return u.label}),n=r.map(function(u){return u.startPos}),o=r.map(function(u){return u.options}),a=this.oldData.map(function(u){return u.endPos}),s=this.oldData.map(function(u){return u.startPos});this.render(a.map(function(u,c){return{startPos:s[c],endPos:a[c],label:i[c],options:o[c]}}));var l=[];return this.store.map(function(u,c){l=l.concat(function(h,p,g,b){var v=p-g,k=h.childNodes[0],C=k.getAttribute("width");return[[k,{height:v,"stroke-dasharray":"".concat(C,", ").concat(v)},350,"easein"],xi(h,[0,b],[0,g],350)]}(u,n[c],e[c],a[c]))}),l}},heatDomain:{layerClass:function(){return"heat-domain domain-"+this.constants.index},makeElements:function(r){var t=this,e=this.constants,i=e.index,n=e.colWidth,o=e.rowHeight,a=e.squareSize,s=e.radius,l=e.xTranslate,u=l,c=0;return this.serializedSubDomains=[],r.cols.map(function(h,p){p===1&&t.labels.push(Si("domain-name",u,-12,Tf(i,!0).toUpperCase(),{fontSize:9})),h.map(function(g,b){if(g.fill){var v={"data-date":g.yyyyMmDd,"data-value":g.dataValue,"data-day":b},k=xf("day",u,c,a,s,g.fill,v);t.serializedSubDomains.push(k)}c+=o}),c=0,u+=n}),this.serializedSubDomains},animateElements:function(r){if(r)return[]}},barGraph:{layerClass:function(){return"dataset-units dataset-bars dataset-"+this.constants.index},makeElements:function(r){var t=this.constants;return this.unitType="bar",this.units=r.yPositions.map(function(e,i){return function(n,o,a,s){var l=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"",u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:0,c=arguments.length>6&&arguments[6]!==void 0?arguments[6]:0,h=arguments.length>7&&arguments[7]!==void 0?arguments[7]:{},p=af(o,h.zeroLine),g=Mt(p,2),b=g[0],v=g[1];v-=c,b===0&&(b=h.minHeight,v-=h.minHeight),Rr(n)||(n=0),Rr(v)||(v=0),Rr(b,!0)||(b=0),Rr(a,!0)||(a=0);var k=ut("rect",{className:"bar mini",style:"fill: ".concat(s),"data-point-index":u,x:n,y:v,width:a,height:b});if((l+="")||l.length){k.setAttribute("y",0),k.setAttribute("x",0);var C=ut("text",{className:"data-point-value",x:a/2,y:0,dy:"-5px","font-size":"10px","text-anchor":"middle",innerHTML:l}),O=ut("g",{"data-point-index":u,transform:"translate(".concat(n,", ").concat(v,")")});return O.appendChild(k),O.appendChild(C),O}return k}(r.xPositions[i],e,r.barWidth,t.color,r.labels[i],i,r.offsets[i],{zeroLine:r.zeroLine,barsWidth:r.barsWidth,minHeight:t.minHeight})}),this.units},animateElements:function(r){var t=r.xPositions,e=r.yPositions,i=r.offsets,n=r.labels,o=this.oldData.xPositions,a=this.oldData.yPositions,s=this.oldData.offsets,l=this.oldData.labels,u=Mt(Gt(o,t),2);o=u[0],t=u[1];var c=Mt(Gt(a,e),2);a=c[0],e=c[1];var h=Mt(Gt(s,i),2);s=h[0],i=h[1];var p=Mt(Gt(l,n),2);l=p[0],n=p[1],this.render({xPositions:o,yPositions:a,offsets:s,labels:n,zeroLine:this.oldData.zeroLine,barsWidth:this.oldData.barsWidth,barWidth:this.oldData.barWidth});var g=[];return this.store.map(function(b,v){g=g.concat(function(k,C,O,d){var _=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0,m=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{},y=af(O,m.zeroLine),x=Mt(y,2),S=x[0],w=x[1];if(w-=_,k.nodeName!=="rect"){var E=k.childNodes[0],L=[E,{width:d,height:S},350,"easein"],I=k.getAttribute("transform").split("(")[1].slice(0,-1),A=xi(k,I,[C,w],350);return[L,A]}return[[k,{width:d,height:S,x:C,y:w},350,"easein"]]}(b,t[v],e[v],r.barWidth,i[v],{zeroLine:r.zeroLine}))}),g}},lineGraph:{layerClass:function(){return"dataset-units dataset-line dataset-"+this.constants.index},makeElements:function(r){var t=this.constants;if(this.unitType="dot",this.paths={},t.hideLine||(this.paths=function(n,o,a){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},l=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{},u=o.map(function(k,C){return n[C]+","+k}),c=u.join("L");s.spline&&(c=sf(n,o));var h=Vr("M"+c,"line-graph-path",a);if(s.heatline){var p=cf(l.svgDefs,a);h.style.stroke="url(#".concat(p,")")}var g={path:h};if(s.regionFill){var b=cf(l.svgDefs,a,!0),v="M"+"".concat(n[0],",").concat(l.zeroLine,"L")+c+"L".concat(n.slice(-1)[0],",").concat(l.zeroLine);g.region=Vr(v,"region-fill","none","url(#".concat(b,")"))}return g}(r.xPositions,r.yPositions,t.color,{heatline:t.heatline,regionFill:t.regionFill,spline:t.spline},{svgDefs:t.svgDefs,zeroLine:r.zeroLine})),this.units=[],t.showDots&&(this.units=r.yPositions.map(function(n,o){return df(r.xPositions[o],n,r.radius,t.color,t.valuesOverPoints?r.values[o]:"",o,t.hideDotBorder)})),t.trailingDot&&!t.showDots){var e=r.yPositions.length-1,i=df(r.xPositions[e],r.yPositions[e],r.radius,t.color,t.valuesOverPoints?r.values[e]:"",e,t.hideDotBorder);this.units.push(i)}return Object.values(this.paths).concat(this.units)},animateElements:function(r){var t=r.xPositions,e=r.yPositions,i=r.values,n=this.oldData.xPositions,o=this.oldData.yPositions,a=this.oldData.values,s=Mt(Gt(n,t),2);n=s[0],t=s[1];var l=Mt(Gt(o,e),2);o=l[0],e=l[1];var u=Mt(Gt(a,i),2);a=u[0],i=u[1],this.render({xPositions:n,yPositions:o,values:i,zeroLine:this.oldData.zeroLine,radius:this.oldData.radius});var c=[];return Object.keys(this.paths).length&&(c=c.concat(function(h,p,g,b,v){var k=[],C=g.map(function(y,x){return p[x]+","+y}).join("L");v&&(C=sf(p,g));var O=[h.path,{d:"M"+C},350,"easein"];if(k.push(O),h.region){var d="".concat(p[0],",").concat(b,"L"),_="L".concat(p.slice(-1)[0],", ").concat(b),m=[h.region,{d:"M"+d+C+_},350,"easein"];k.push(m)}return k}(this.paths,t,e,r.zeroLine,this.constants.spline))),this.units.length&&this.units.map(function(h,p){c=c.concat(function(g,b,v){if(g.nodeName!=="circle"){var k=g.getAttribute("transform").split("(")[1].slice(0,-1);return[xi(g,k,[b,v],350)]}return[[g,{cx:b,cy:v},350,"easein"]]}(h,t[p],e[p]))}),c}}};function Ti(r,t,e){var i=Object.keys(mf).filter(function(o){return r.includes(o)}),n=mf[i[0]];return Object.assign(n,{constants:t,getData:e}),new rk(n)}var ik=function(r){Gr(e,Sf);var t=Xr(e);function e(i,n){var o;return pr(this,e),(o=t.call(this,i,n)).type="percentage",o.setup(),o}return vr(e,[{key:"setMeasures",value:function(i){var n=this.measures;this.barOptions=i.barOptions||{};var o=this.barOptions;o.height=o.height||16,n.paddings.right=30,n.paddings.top=60,n.paddings.bottom=0,n.legendHeight=80,n.baseHeight=8*o.height+oa(n)}},{key:"setupComponents",value:function(){var i=this.state,n=[["percentageBars",{barHeight:this.barOptions.height},function(){return{xPositions:i.xPositions,widths:i.widths,colors:this.colors}}.bind(this)]];this.components=new Map(n.map(function(o){var a=Ti.apply(void 0,ur(o));return[o[0],a]}))}},{key:"calc",value:function(){var i=this;cr(Ut(e.prototype),"calc",this).call(this);var n=this.state;n.xPositions=[],n.widths=[];var o=0;n.sliceTotals.map(function(a){var s=i.width*a/n.grandTotal;n.widths.push(s),n.xPositions.push(o),o+=s})}},{key:"makeDataByIndex",value:function(){}},{key:"bindTooltip",value:function(){var i=this,n=this.state;this.container.addEventListener("mousemove",function(o){var a=i.components.get("percentageBars").store,s=o.target;if(a.includes(s)){var l=a.indexOf(s),u=Rn(i.container),c=Rn(s),h=s.getAttribute("width")||s.getBoundingClientRect().width,p=c.left-u.left+parseInt(h)/2,g=c.top-u.top,b=(i.formattedLabels&&i.formattedLabels.length>0?i.formattedLabels[l]:i.state.labels[l])+": ",v=n.sliceTotals[l]/n.grandTotal;i.tip.setValues(p,g,{name:b,value:(100*v).toFixed(1)+"%"}),i.tip.showTip()}})}}]),e}(),gf=function(r){Gr(e,Sf);var t=Xr(e);function e(i,n){var o;return pr(this,e),(o=t.call(this,i,n)).initTimeout=0,o.init=1,o.setup(),o}return vr(e,[{key:"configure",value:function(i){cr(Ut(e.prototype),"configure",this).call(this,i),this.mouseMove=this.mouseMove.bind(this),this.mouseLeave=this.mouseLeave.bind(this),this.hoverRadio=i.hoverRadio||.1,this.config.startAngle=i.startAngle||0,this.type="pie",this.sliceName="pieSlices",this.arcFunc=j0,this.shapeFunc=z0,this.clockWise=i.clockWise||!1}},{key:"getRadius",value:function(){return this.height>this.width?this.center.x:this.center.y}},{key:"calc",value:function(){var i=this;cr(Ut(e.prototype),"calc",this).call(this);var n=this.state;this.radius=this.getRadius();var o=this.radius,a=this.clockWise,s=n.slicesProperties||[];n.sliceStrings=[],n.slicesProperties=[];var l=180-this.config.startAngle;n.sliceTotals.map(function(u,c){var h,p,g=l,b=u/n.grandTotal*360,v=b>180?1:0,k=a?-b:b,C=l+=k,O=Go(g,o),d=Go(C,o),_=i.init&&s[c];i.init?(h=_?_.startPosition:O,p=_?_.endPosition:O):(h=O,p=d);var m=b===360?i.shapeFunc(h,p,i.center,i.radius,a,v):i.arcFunc(h,p,i.center,i.radius,a,v);n.sliceStrings.push(m),n.slicesProperties.push({startPosition:O,endPosition:d,value:u,total:n.grandTotal,startAngle:g,endAngle:C,angle:k})}),this.init=0}},{key:"setupComponents",value:function(){var i=this.state,n=[["pieSlices",{},function(){return{sliceStrings:i.sliceStrings,colors:this.colors}}.bind(this)]];this.components=new Map(n.map(function(o){var a=Ti.apply(void 0,ur(o));return[o[0],a]}))}},{key:"calTranslateByAngle",value:function(i){var n=this.radius,o=this.hoverRadio,a=Go(i.startAngle+i.angle/2,n);return"translate3d(".concat(a.x*o,"px,").concat(a.y*o,"px,0)")}},{key:"hoverSlice",value:function(i,n,o,a){if(i){var s=this.colors[n];if(o){ia(i,this.calTranslateByAngle(this.state.slicesProperties[n]));var l=Rn(this.svg),u=a.pageX-l.left+10,c=a.pageY-l.top-10,h=(this.formatted_labels&&this.formatted_labels.length>0?this.formatted_labels[n]:this.state.labels[n])+": ",p=(100*this.state.sliceTotals[n]/this.state.grandTotal).toFixed(1);this.tip.setValues(u,c,{name:h,value:p+"%"}),this.tip.showTip()}else this.resetHover(i,s)}}},{key:"resetHover",value:function(i,n){ia(i,"translate3d(0,0,0)"),this.tip.hideTip(),i.style.fill=n}},{key:"bindTooltip",value:function(){this.container.addEventListener("mousemove",this.mouseMove),this.container.addEventListener("mouseleave",this.mouseLeave)}},{key:"mouseMove",value:function(i){var n=i.target,o=this.components.get(this.sliceName).store,a=this.curActiveSliceIndex,s=this.curActiveSlice;if(o.includes(n)){var l=o.indexOf(n);this.hoverSlice(s,a,!1),this.curActiveSlice=n,this.curActiveSliceIndex=l,this.hoverSlice(n,l,!0,i)}else this.mouseLeave()}},{key:"mouseLeave",value:function(){this.hoverSlice(this.curActiveSlice,this.curActiveSliceIndex,!1)}}]),e}();function Ci(r){if(r===0)return[0,0];if(isNaN(r))return{mantissa:-6755399441055744,exponent:972};var t=r>0?1:-1;if(!isFinite(r))return{mantissa:4503599627370496*t,exponent:972};r=Math.abs(r);var e=Math.floor(Math.log10(r));return[t*(r/Math.pow(10,e)),e]}function nk(r){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,e=Math.ceil(r),i=Math.floor(t),n=e-i,o=n,a=1;n>5&&(n%2!=0&&(n=++e-i),o=n/2,a=2),n<=2&&(a=n/(o=4)),n===0&&(o=5,a=1);for(var s=[],l=0;l<=o;l++)s.push(i+a*l);return s}function ki(r){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,e=Ci(r),i=Mt(e,2),n=i[0],o=i[1],a=t?t/Math.pow(10,o):0,s=nk(n=n.toFixed(6),a);return s=s.map(function(l){return l*Math.pow(10,o)})}function ok(r){var t=arguments.length>1&&arguments[1]!==void 0&&arguments[1],e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=Math.max.apply(Math,ur(r)),n=Math.min.apply(Math,ur(r));e.max!==void 0&&(i=i>e.max?i:e.max),e.min!==void 0&&(n=n<e.min?n:e.min);var o=[];function a(h,p){for(var g=ki(h),b=g[1]-g[0],v=0,k=1;v<p;k++)v+=b,g.unshift(-1*v);return g}if(i>=0&&n>=0)Ci(i)[1],o=t?ki(i,n):ki(i);else if(i>0&&n<0){var s=Math.abs(n);if(i>=s)Ci(i)[1],o=a(i,s);else{Ci(s)[1];var l=a(s,i);o=l.reverse().map(function(h){return-1*h})}}else if(i<=0&&n<=0){var u=Math.abs(n),c=Math.abs(i);Ci(u)[1],o=(o=t?ki(u,c):ki(u)).reverse().map(function(h){return-1*h})}return o}function ak(r){var t,e=Af(r);return r.indexOf(0)>=0?t=r.indexOf(0):r[0]>0?t=-1*r[0]/e:t=-1*r[r.length-1]/e+(r.length-1),t}function Af(r){return r[1]-r[0]}function sk(r){return r[r.length-1]-r[0]}function $n(r,t){return wf(t.zeroLine-r*t.scaleMultiplier)}var lk=function(r){Gr(e,aa);var t=Xr(e);function e(i,n){var o;pr(this,e),(o=t.call(this,i,n)).type="heatmap",o.countLabel=n.countLabel||"";var a=["Sunday","Monday"],s=a.includes(n.startSubDomain)?n.startSubDomain:"Sunday";return o.startSubDomainIndex=a.indexOf(s),o.setup(),o}return vr(e,[{key:"setMeasures",value:function(i){var n=this.measures;this.discreteDomains=i.discreteDomains===0?0:1,n.paddings.top=36,n.paddings.bottom=0,n.legendHeight=24,n.baseHeight=84+oa(n);var o=this.data,a=this.discreteDomains?12:0;this.independentWidth=12*(Jo(o.start,o.end)+a)+Qo(n)}},{key:"updateWidth",value:function(){var i=this.discreteDomains?12:0,n=this.state.noOfWeeks?this.state.noOfWeeks:52;this.baseWidth=12*(n+i)+Qo(this.measures)}},{key:"prepareData",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.data;if(i.start&&i.end&&i.start>i.end)throw new Error("Start date cannot be greater than end date.");if(i.start||(i.start=new Date,i.start.setFullYear(i.start.getFullYear()-1)),i.end||(i.end=new Date),i.dataPoints=i.dataPoints||{},parseInt(Object.keys(i.dataPoints)[0])>1e5){var n={};Object.keys(i.dataPoints).forEach(function(o){var a=new Date(1e3*o);n[Ko(a)]=i.dataPoints[o]}),i.dataPoints=n}return i}},{key:"calc",value:function(){var i=this.state;i.start=Lr(this.data.start),i.end=Lr(this.data.end),i.firstWeekStart=Lr(i.start),i.noOfWeeks=Jo(i.start,i.end),i.distribution=function(n,o){for(var a=Math.max.apply(Math,ur(n)),s=1/(o-1),l=[],u=0;u<o;u++){var c=a*(s*u);l.push(c)}return l}(Object.values(this.data.dataPoints),5),i.domainConfigs=this.getDomains()}},{key:"setupComponents",value:function(){var i=this,n=this.state,o=this.discreteDomains?0:1,a=n.domainConfigs.map(function(l,u){return["heatDomain",{index:l.index,colWidth:12,rowHeight:12,squareSize:10,radius:i.rawChartArgs.radius||0,xTranslate:12*n.domainConfigs.filter(function(c,h){return h<u}).map(function(c){return c.cols.length-o}).reduce(function(c,h){return c+h},0)},function(){return n.domainConfigs[u]}.bind(i)]});this.components=new Map(a.map(function(l,u){var c=Ti.apply(void 0,ur(l));return[l[0]+"-"+u,c]}));var s=0;ek.forEach(function(l,u){if([1,3,5].includes(u)){var c=Si("subdomain-name",-6,s,l,{fontSize:10,dy:8,textAnchor:"end"});i.drawArea.appendChild(c)}s+=12})}},{key:"update",value:function(i){i||console.error("No data to update."),this.data=this.prepareData(i),this.draw(),this.bindTooltip()}},{key:"bindTooltip",value:function(){var i=this;this.container.addEventListener("mousemove",function(n){i.components.forEach(function(o){var a=o.store,s=n.target;if(a.includes(s)){var l=s.getAttribute("data-value"),u=s.getAttribute("data-date").split("-"),c=Tf(parseInt(u[1])-1,!0),h=i.container.getBoundingClientRect(),p=s.getBoundingClientRect(),g=parseInt(n.target.getAttribute("width")),b=p.left-h.left+g/2,v=p.top-h.top,k=l+" "+i.countLabel,C=" on "+c+" "+u[0]+", "+u[2];i.tip.setValues(b,v,{name:C,value:k,valueFirst:1},[]),i.tip.showTip()}})})}},{key:"renderLegend",value:function(){var i=this;this.legendArea.textContent="";var n=0,o=this.rawChartArgs.radius||0,a=Si("subdomain-name",n,12,"Less",{fontSize:11,dy:9});n=30,this.legendArea.appendChild(a),this.colors.slice(0,5).map(function(l,u){var c=xf("heatmap-legend-unit",n+15*u,12,10,o,l);i.legendArea.appendChild(c)});var s=Si("subdomain-name",n+75+3,12,"More",{fontSize:11,dy:9});this.legendArea.appendChild(s)}},{key:"getDomains",value:function(){for(var i=this.state,n=[i.start.getMonth(),i.start.getFullYear()],o=n[0],a=n[1],s=[i.end.getMonth(),i.end.getFullYear()],l=s[0]-o+1+12*(s[1]-a),u=[],c=Lr(i.start),h=0;h<l;h++){var p=i.end;if(!tk(c,i.end)){var g=[c.getMonth(),c.getFullYear()];p=_f(g[0],g[1])}u.push(this.getDomainConfig(c,p)),Yr(p,1),c=p}return u}},{key:"getDomainConfig",value:function(i){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",o=[i.getMonth(),i.getFullYear()],a=o[0],s=o[1],l=Ef(i),u={index:a,cols:[]};Yr(n=Lr(n)||_f(a,s),1);for(var c,h=Jo(l,n),p=[],g=0;g<h;g++)c=this.getCol(l,a),p.push(c),Yr(l=new Date(c[6].yyyyMmDd),1);return c[6].dataValue!==void 0&&(Yr(l,1),p.push(this.getCol(l,a,!0))),u.cols=p,u}},{key:"getCol",value:function(i,n){for(var o=arguments.length>2&&arguments[2]!==void 0&&arguments[2],a=this.state,s=Lr(i),l=[],u=0;u<7;u++,Yr(s,1)){var c={},h=s>=a.start&&s<=a.end;o||s.getMonth()!==n||!h?c.yyyyMmDd=Ko(s):c=this.getSubDomainConfig(s),l.push(c)}return l}},{key:"getSubDomainConfig",value:function(i){var n,o,a=Ko(i),s=this.data.dataPoints[a];return{yyyyMmDd:a,dataValue:s||0,fill:this.colors[n=s,o=this.state.distribution,o.filter(function(l){return l<n}).length]}}}]),e}();function ck(r,t){r.labels=r.labels||[];var e=r.labels.length,i=r.datasets,n=new Array(e).fill(0);return i||(i=[{values:n}]),i.map(function(o){if(o.values){var a=o.values;a=(a=a.map(function(s){return isNaN(s)?0:s})).length>e?a.slice(0,e):ea(a,e-a.length,0),o.values=a}else o.values=n;o.chartType||(o.chartType=t)}),r.yRegions&&r.yRegions.map(function(o){if(o.end<o.start){var a=[o.end,o.start];o.start=a[0],o.end=a[1]}}),r}function uk(r){var t=r.labels.length,e=new Array(t).fill(0),i={labels:r.labels.slice(0,-1),datasets:r.datasets.map(function(n){return{name:"",values:e.slice(0,-1),chartType:n.chartType}})};return r.yMarkers&&(i.yMarkers=[{value:0,label:""}]),r.yRegions&&(i.yRegions=[{start:0,end:0,label:""}]),i}var na=function(r){Gr(e,aa);var t=Xr(e);function e(i,n){var o;return pr(this,e),(o=t.call(this,i,n)).barOptions=n.barOptions||{},o.lineOptions=n.lineOptions||{},o.type=n.type||"line",o.init=1,o.setup(),o}return vr(e,[{key:"setMeasures",value:function(){this.data.datasets.length<=1&&(this.config.showLegend=0,this.measures.paddings.bottom=30)}},{key:"configure",value:function(i){cr(Ut(e.prototype),"configure",this).call(this,i),i.axisOptions=i.axisOptions||{},i.tooltipOptions=i.tooltipOptions||{},this.config.xAxisMode=i.axisOptions.xAxisMode||"span",this.config.yAxisMode=i.axisOptions.yAxisMode||"span",this.config.xIsSeries=i.axisOptions.xIsSeries||0,this.config.shortenYAxisNumbers=i.axisOptions.shortenYAxisNumbers||0,this.config.numberFormatter=i.axisOptions.numberFormatter,this.config.yAxisRange=i.axisOptions.yAxisRange||{},this.config.formatTooltipX=i.tooltipOptions.formatTooltipX,this.config.formatTooltipY=i.tooltipOptions.formatTooltipY,this.config.valuesOverPoints=i.valuesOverPoints,this.config.legendRowHeight=30}},{key:"prepareData",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.data;return ck(i,this.type)}},{key:"prepareFirstData",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.data;return uk(i)}},{key:"calc",value:function(){var i=arguments.length>0&&arguments[0]!==void 0&&arguments[0];this.calcXPositions(),i||this.calcYAxisParameters(this.getAllYValues(),this.type==="line"),this.makeDataByIndex()}},{key:"calcXPositions",value:function(){var i=this.state,n=this.data.labels;i.datasetLength=n.length,i.unitWidth=this.width/i.datasetLength,i.xOffset=i.unitWidth/2,i.xAxis={labels:n,positions:n.map(function(o,a){return wf(i.xOffset+a*i.unitWidth)})}}},{key:"calcYAxisParameters",value:function(i){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"false",o=ok(i,n,this.config.yAxisRange),a=this.height/sk(o),s=Af(o)*a,l=this.height-ak(o)*s;this.state.yAxis={labels:o,positions:o.map(function(u){return l-u*a}),scaleMultiplier:a,zeroLine:l},this.calcDatasetPoints(),this.calcYExtremes(),this.calcYRegions()}},{key:"calcDatasetPoints",value:function(){var i=this.state,n=function(o){return o.map(function(a){return $n(a,i.yAxis)})};i.datasets=this.data.datasets.map(function(o,a){var s=o.values,l=o.cumulativeYs||[];return{name:o.name&&o.name.replace(/<|>|&/g,function(u){return u=="&"?"&amp;":u=="<"?"&lt;":"&gt;"}),index:a,chartType:o.chartType,values:s,yPositions:n(s),cumulativeYs:l,cumulativeYPos:n(l)}})}},{key:"calcYExtremes",value:function(){var i=this.state;this.barOptions.stacked?i.yExtremes=i.datasets[i.datasets.length-1].cumulativeYPos:(i.yExtremes=new Array(i.datasetLength).fill(9999),i.datasets.map(function(n){n.yPositions.map(function(o,a){o<i.yExtremes[a]&&(i.yExtremes[a]=o)})}))}},{key:"calcYRegions",value:function(){var i=this.state;this.data.yMarkers&&(this.state.yMarkers=this.data.yMarkers.map(function(n){return n.position=$n(n.value,i.yAxis),n.options||(n.options={}),n})),this.data.yRegions&&(this.state.yRegions=this.data.yRegions.map(function(n){return n.startPos=$n(n.start,i.yAxis),n.endPos=$n(n.end,i.yAxis),n.options||(n.options={}),n}))}},{key:"getAllYValues",value:function(){var i,n=this,o="values";if(this.barOptions.stacked){o="cumulativeYs";var a=new Array(this.state.datasetLength).fill(0);this.data.datasets.map(function(l,u){var c=n.data.datasets[u].values;l[o]=a=a.map(function(h,p){return h+c[p]})})}var s=this.data.datasets.map(function(l){return l[o]});return this.data.yMarkers&&s.push(this.data.yMarkers.map(function(l){return l.value})),this.data.yRegions&&this.data.yRegions.map(function(l){s.push([l.end,l.start])}),(i=[]).concat.apply(i,ur(s))}},{key:"setupComponents",value:function(){var i=this,n=[["yAxis",{mode:this.config.yAxisMode,width:this.width,shortenNumbers:this.config.shortenYAxisNumbers,numberFormatter:this.config.numberFormatter},function(){return this.state.yAxis}.bind(this)],["xAxis",{mode:this.config.xAxisMode,height:this.height},function(){var h=this.state;return h.xAxis.calcLabels=function(p){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],b=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2],v=p/g.length*.6;v<=0&&(v=1);var k,C=v/7;if(b){var O=Math.max.apply(Math,ur(g.map(function(_){return _.length})));k=Math.ceil(O/C)}var d=g.map(function(_,m){return(_+="").length>C&&(b?m%k!=0?m!==g.length-1&&(_=""):m>g.length-k/2&&(_=""):_=C-3>0?_.slice(0,C-3)+" ...":_.slice(0,C)+".."),_});return d}(this.width,h.xAxis.labels,this.config.xIsSeries),h.xAxis}.bind(this)],["yRegions",{width:this.width,pos:"right"},function(){return this.state.yRegions}.bind(this)]],o=this.state.datasets.filter(function(h){return h.chartType==="bar"}),a=this.state.datasets.filter(function(h){return h.chartType==="line"}),s=o.map(function(h){var p=h.index;return["barGraph-"+h.index,{index:p,color:i.colors[p],stacked:i.barOptions.stacked,valuesOverPoints:i.config.valuesOverPoints,minHeight:0*i.height},function(){var g=this.state,b=g.datasets[p],v=this.barOptions.stacked,k=this.barOptions.spaceRatio||.5,C=g.unitWidth*(1-k),O=C/(v?1:o.length),d=g.xAxis.positions.map(function(y){return y-C/2});v||(d=d.map(function(y){return y+O*p}));var _=new Array(g.datasetLength).fill("");this.config.valuesOverPoints&&(_=v&&b.index===g.datasets.length-1?b.cumulativeYs:b.values);var m=new Array(g.datasetLength).fill(0);return v&&(m=b.yPositions.map(function(y,x){return y-b.cumulativeYPos[x]})),{xPositions:d,yPositions:b.yPositions,offsets:m,labels:_,zeroLine:g.yAxis.zeroLine,barsWidth:C,barWidth:O}}.bind(i)]}),l=a.map(function(h){var p=h.index;return["lineGraph-"+h.index,{index:p,color:i.colors[p],svgDefs:i.svgDefs,heatline:i.lineOptions.heatline,regionFill:i.lineOptions.regionFill,spline:i.lineOptions.spline,showDots:i.lineOptions.showDots,trailingDot:i.lineOptions.trailingDot,hideDotBorder:i.lineOptions.hideDotBorder,hideLine:i.lineOptions.hideLine,valuesOverPoints:i.config.valuesOverPoints},function(){var g=this.state,b=g.datasets[p],v=g.yAxis.positions[0]<g.yAxis.zeroLine?g.yAxis.positions[0]:g.yAxis.zeroLine;return{xPositions:g.xAxis.positions,yPositions:b.yPositions,values:b.values,zeroLine:v,radius:this.lineOptions.dotSize||4}}.bind(i)]}),u=[["yMarkers",{width:this.width,pos:"right"},function(){return this.state.yMarkers}.bind(this)]];n=n.concat(s,l,u);var c=["yMarkers","yRegions"];this.dataUnitComponents=[],this.components=new Map(n.filter(function(h){return!c.includes(h[0])||i.state[h[0]]}).map(function(h){var p=Ti.apply(void 0,ur(h));return(h[0].includes("lineGraph")||h[0].includes("barGraph"))&&i.dataUnitComponents.push(p),[h[0],p]}))}},{key:"makeDataByIndex",value:function(){var i=this;this.dataByIndex={};var n=this.state,o=this.config.formatTooltipX,a=this.config.formatTooltipY;n.xAxis.labels.map(function(s,l){var u=i.state.datasets.map(function(c,h){var p=c.values[l];return{title:c.name,value:p,yPos:c.yPositions[l],color:i.colors[h],formatted:a?a(p):p}});i.dataByIndex[l]={label:s,formattedLabel:o?o(s):s,xPos:n.xAxis.positions[l],values:u,yExtreme:n.yExtremes[l]}})}},{key:"bindTooltip",value:function(){var i=this;this.container.addEventListener("mousemove",function(n){var o=i.measures,a=Rn(i.container),s=n.pageX-a.left-On(o),l=n.pageY-a.top;l<i.height+Ln(o)&&l>Ln(o)?i.mapTooltipXPosition(s):i.tip.hideTip()})}},{key:"mapTooltipXPosition",value:function(i){var n=this.state;if(n.yExtremes){var o=function(s,l){var u=arguments.length>2&&arguments[2]!==void 0&&arguments[2],c=l.reduce(function(h,p){return Math.abs(p-s)<Math.abs(h-s)?p:h},[]);return u?l.indexOf(c):c}(i,n.xAxis.positions,!0);if(o>=0){var a=this.dataByIndex[o];this.tip.setValues(a.xPos+this.tip.offset.x,a.yExtreme+this.tip.offset.y,{name:a.formattedLabel,value:""},a.values,o),this.tip.showTip()}}}},{key:"renderLegend",value:function(){var i=this.data;i.datasets.length>1&&cr(Ut(e.prototype),"renderLegend",this).call(this,i.datasets)}},{key:"makeLegend",value:function(i,n,o,a){return Cf(o,a+5,12,3,this.colors[n],i.name,null,8.75,this.config.truncateLegends)}},{key:"makeOverlay",value:function(){var i=this;this.init?this.init=0:(this.overlayGuides&&this.overlayGuides.forEach(function(n){var o=n.overlay;o.parentNode.removeChild(o)}),this.overlayGuides=this.dataUnitComponents.map(function(n){return{type:n.unitType,overlay:void 0,units:n.units}}),this.state.currentIndex===void 0&&(this.state.currentIndex=this.state.datasetLength-1),this.overlayGuides.map(function(n){var o=n.units[i.state.currentIndex];n.overlay=V0[n.type](o),i.drawArea.appendChild(n.overlay)}))}},{key:"updateOverlayGuides",value:function(){this.overlayGuides&&this.overlayGuides.forEach(function(i){var n=i.overlay;n.parentNode.removeChild(n)})}},{key:"bindOverlay",value:function(){var i=this;this.parent.addEventListener("data-select",function(){i.updateOverlay()})}},{key:"bindUnits",value:function(){var i=this;this.dataUnitComponents.map(function(n){n.units.map(function(o){o.addEventListener("click",function(){var a=o.getAttribute("data-point-index");i.setCurrentDataPoint(a)})})}),this.tip.container.addEventListener("click",function(){var n=i.tip.container.getAttribute("data-point-index");i.setCurrentDataPoint(n)})}},{key:"updateOverlay",value:function(){var i=this;this.overlayGuides.map(function(n){var o=n.units[i.state.currentIndex];Y0[n.type](o,n.overlay)})}},{key:"onLeftArrow",value:function(){this.setCurrentDataPoint(this.state.currentIndex-1)}},{key:"onRightArrow",value:function(){this.setCurrentDataPoint(this.state.currentIndex+1)}},{key:"getDataPoint",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.state.currentIndex,n=this.state,o={index:i,label:n.xAxis.labels[i],values:n.datasets.map(function(a){return a.values[i]})};return o}},{key:"setCurrentDataPoint",value:function(i){var n=this.state;(i=parseInt(i))<0&&(i=0),i>=n.xAxis.labels.length&&(i=n.xAxis.labels.length-1),i!==n.currentIndex&&(n.currentIndex=i,function(o,a,s){var l=document.createEvent("HTMLEvents");for(var u in l.initEvent(a,!0,!0),s)l[u]=s[u];o.dispatchEvent(l)}(this.parent,"data-select",this.getDataPoint()))}},{key:"addDataPoint",value:function(i,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.state.datasetLength;cr(Ut(e.prototype),"addDataPoint",this).call(this,i,n,o),this.data.labels.splice(o,0,i),this.data.datasets.map(function(a,s){a.values.splice(o,0,n[s])}),this.update(this.data)}},{key:"removeDataPoint",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.state.datasetLength-1;this.data.labels.length<=1||(cr(Ut(e.prototype),"removeDataPoint",this).call(this,i),this.data.labels.splice(i,1),this.data.datasets.map(function(n){n.values.splice(i,1)}),this.update(this.data))}},{key:"updateDataset",value:function(i){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.data.datasets[n].values=i,this.update(this.data)}},{key:"updateDatasets",value:function(i){this.data.datasets.map(function(n,o){i[o]&&(n.values=i[o])}),this.update(this.data)}}]),e}(),vf={bar:na,line:na,percentage:ik,heatmap:lk,pie:gf,donut:function(r){Gr(e,gf);var t=Xr(e);function e(i,n){return pr(this,e),t.call(this,i,n)}return vr(e,[{key:"configure",value:function(i){cr(Ut(e.prototype),"configure",this).call(this,i),this.type="donut",this.sliceName="donutSlices",this.arcFunc=F0,this.shapeFunc=H0,this.strokeWidth=i.strokeWidth||30}},{key:"getRadius",value:function(){return this.height>this.width?this.center.x-this.strokeWidth/2:this.center.y-this.strokeWidth/2}},{key:"resetHover",value:function(i,n){ia(i,"translate3d(0,0,0)"),this.tip.hideTip(),i.style.stroke=n}},{key:"setupComponents",value:function(){var i=this.state,n=[[this.sliceName,{},function(){return{sliceStrings:i.sliceStrings,colors:this.colors,strokeWidth:this.strokeWidth}}.bind(this)]];this.components=new Map(n.map(function(o){var a=Ti.apply(void 0,ur(o));return[o[0],a]}))}}]),e}()},$f=function r(t,e){return pr(this,r),function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"line",n=arguments.length>1?arguments[1]:void 0,o=arguments.length>2?arguments[2]:void 0;return i==="axis-mixed"?(o.type="line",new na(n,o)):vf[i]?new vf[i](n,o):void console.error("Undefined chart type: "+i)}(e.type,t,e)};frappe.provide("frappe.ui");frappe.Chart=$f;frappe.ui.RealtimeChart=class extends frappe.Chart{constructor(t,e,i=8,n){super(t,n);n.data.datasets[0].values.length>i&&frappe.throw(__("Length of passed data array is greater than value of maximum allowed label points!")),this.currentSize=n.data.datasets[0].values.length,this.socketEvent=e,this.maxLabelPoints=i,this.start_updating=function(){frappe.realtime.on(this.socketEvent,o=>{this.update_chart(o.label,o.points)})},this.stop_updating=function(){frappe.realtime.off(this.socketEvent)},this.update_chart=function(o,a){this.currentSize>=this.maxLabelPoints?this.removeDataPoint(0):this.currentSize++,this.addDataPoint(o,a)}}};var ep=Vt(Qf());frappe.DataTable=ep.default;var rp=Vt(tp());frappe.Driver=rp.default;frappe.provide("frappe.ui");frappe.ui.Scanner=class{constructor(t){this.dialog=null,this.handler=null,this.options=t,this.is_alive=!1,"multiple"in this.options||(this.options.multiple=!1),t.container&&(this.$scan_area=$(t.container),this.scan_area_id=frappe.dom.set_unique_id(this.$scan_area)),t.dialog&&(this.dialog=this.make_dialog(),this.dialog.show())}scan(){this.load_lib().then(()=>this.start_scan())}start_scan(){this.handler||(this.handler=new Html5Qrcode(this.scan_area_id)),this.handler.start({facingMode:"environment"},{fps:10,qrbox:250},(t,e)=>{if(this.options.on_scan)try{this.options.on_scan(e)}catch(i){console.error(i)}this.options.multiple||(this.stop_scan(),this.hide_dialog())},t=>{}).catch(t=>{this.is_alive=!1,this.hide_dialog(),console.error(t)}),this.is_alive=!0}stop_scan(){this.handler&&this.is_alive&&this.handler.stop().then(()=>{this.is_alive=!1,this.$scan_area.empty(),this.hide_dialog()})}make_dialog(){let t=new frappe.ui.Dialog({title:__("Scan QRCode"),fields:[{fieldtype:"HTML",fieldname:"scan_area"}],on_page_show:()=>{this.$scan_area=t.get_field("scan_area").$wrapper,this.$scan_area.addClass("barcode-scanner"),this.scan_area_id=frappe.dom.set_unique_id(this.$scan_area),this.scan()},on_hide:()=>{this.stop_scan()}});return t}hide_dialog(){this.dialog&&this.dialog.hide()}load_lib(){return frappe.require("/assets/frappe/node_modules/html5-qrcode/dist/html5-qrcode.min.js")}};})();
/*!
    localForage -- Offline Storage, Improved
    Version 1.9.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/
/*!
 * Cropper.js v1.5.12
 * https://fengyuanchen.github.io/cropperjs
 *
 * Copyright 2015-present Chen Fengyuan
 * Released under the MIT license
 *
 * Date: 2021-06-12T08:00:17.411Z
 */
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
/*! For license information please see editor.js.LICENSE.txt */
/*! showdown v 2.1.0 - 21-04-2022 */
/**!
 * Sortable
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */
//# sourceMappingURL=desk.bundle.2LGUDHAG.js.map
